[2025-11-05 06:15:21.375972 +00:00] INFO [src/fuzzer.rs:44] Using OpenAI handler
[2025-11-05 06:15:21.535181 +00:00] DEBUG [src/program/gadget.rs:197] Parsed 20 typed gadgets
[2025-11-05 06:15:22.059508 +00:00] DEBUG [src/program/gadget.rs:48] Parsed 70 function gadgets.
[2025-11-05 06:15:22.059563 +00:00] DEBUG [src/fuzzer.rs:344] Initial combination: cre2_replace_re
[2025-11-05 06:15:22.059578 +00:00] DEBUG [src/fuzzer.rs:344] Initial combination: cre2_strings_to_ranges
[2025-11-05 06:15:22.059593 +00:00] DEBUG [src/fuzzer.rs:344] Initial combination: cre2_easy_match
[2025-11-05 06:15:22.059606 +00:00] DEBUG [src/fuzzer.rs:344] Initial combination: cre2_full_match_re
[2025-11-05 06:15:22.060301 +00:00] INFO [src/request/prompt.rs:140] selected combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_full_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 06:15:22.110507 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:15:22.110888 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_full_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\n\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:15:22.195751 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.196165 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.196469 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.196816 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.197121 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.197418 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.197713 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.198007 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.198305 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:15:22.198598 +00:00] DEBUG [/usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.19/src/connect.rs:753] starting new connection: https://api.openai.com/
[2025-11-05 06:16:15.747541 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 53s
[2025-11-05 06:16:15.747661 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 20840, Completion: 29114, Total: 49954
[2025-11-05 06:16:15.747681 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:16:15.972560 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000000/id_000000.cc
[2025-11-05 06:16:15.972616 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:16.202564 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:16.202630 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:16.217940 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:16.217977 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:16.436357 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000001/id_000001.cc
[2025-11-05 06:16:16.436405 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:16.664448 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:16.664516 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:16.667069 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:16.667096 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:16.886026 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000002/id_000002.cc
[2025-11-05 06:16:16.886107 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:17.114194 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:17.114258 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:17.117124 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:17.117156 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:17.335812 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000003/id_000003.cc
[2025-11-05 06:16:17.335860 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:17.566537 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:17.566604 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:17.569466 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:17.569498 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:17.789102 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000004/id_000004.cc
[2025-11-05 06:16:17.789151 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:18.019895 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:18.019989 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:18.022817 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:18.022847 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:18.240414 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000005/id_000005.cc
[2025-11-05 06:16:18.240463 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:18.470024 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:18.470098 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:18.472980 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:18.473006 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:18.692267 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000006/id_000006.cc
[2025-11-05 06:16:18.692314 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:18.922381 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:18.922436 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:18.925232 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:18.925260 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:19.143374 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000007/id_000007.cc
[2025-11-05 06:16:19.143454 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:19.370807 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:19.370861 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:19.373669 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:19.373697 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:19.591511 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000008/id_000008.cc
[2025-11-05 06:16:19.591559 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:19.821560 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:19.821615 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:19.824438 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:19.824465 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:20.043527 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000009/id_000009.cc
[2025-11-05 06:16:20.043576 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:16:20.272399 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:16:20.272504 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:16:20.275122 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:16:20.275154 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:16:20.275192 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:16:20.275208 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:16:20.275222 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:16:20.275249 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:16:20.567746 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 9 as an example for the next prompt.
[2025-11-05 06:16:20.567799 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 67 new API pairs in this round.
[2025-11-05 06:16:20.567898 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 67
[2025-11-05 06:16:20.567948 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [1.0,1.0,1.0,1.0,1.0,19.0,1.0,1.0,1.0,1.0,4.0,1.0,4.0,1.0,1.0,11.0,1.0,1.0,1.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,3.0,9.0,1.0,19.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,5.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:16:20.567966 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:16:20.568040 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 19
[2025-11-05 06:16:20.568072 +00:00] INFO [src/feedback/schedule.rs:246] Loop 1: Replaced with lowest energy API: cre2_check_rewrite_string (energy: 1), prob: 0.2978
[2025-11-05 06:16:20.568087 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 1
[2025-11-05 06:16:20.568119 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 3
[2025-11-05 06:16:20.568145 +00:00] INFO [src/feedback/schedule.rs:246] Loop 1: Replaced with lowest energy API: cre2_check_rewrite_string (energy: 1), prob: 0.2978
[2025-11-05 06:16:20.568169 +00:00] INFO [src/feedback/schedule.rs:246] Loop 1: Replaced with lowest energy API: cre2_check_rewrite_string (energy: 1), prob: 0.2978
[2025-11-05 06:16:20.568197 +00:00] INFO [src/feedback/schedule.rs:246] Loop 1: Replaced with lowest energy API: cre2_check_rewrite_string (energy: 1), prob: 0.2978
[2025-11-05 06:16:20.568234 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_posix_syntax energy: 1
[2025-11-05 06:16:20.568262 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 23
[2025-11-05 06:16:20.568323 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    int cre2_opt_posix_syntax(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 06:16:20.569017 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 1, quiet_round: 0, discovered_api_pairs: 67
[2025-11-05 06:16:20.619353 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:16:20.619726 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    int cre2_opt_posix_syntax(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"test\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is test and more test\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char replacement[] = \"X\";\n    const int replacement_len = (int)(sizeof(replacement) - 1);\n    cre2_regexp_t * re = cre2_new(pattern, pattern_len, NULL);\n    cre2_string_t easy_match;\n    cre2_range_t ranges[1];\n    cre2_string_t strings_for_ranges[1];\n    cre2_string_t full_input;\n    cre2_string_t full_results[1];\n    char buffer[128];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n\n    // step 2: Setup (clear structures and prepare buffers)\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(ranges, 0, sizeof(ranges));\n    memset(strings_for_ranges, 0, sizeof(strings_for_ranges));\n    memset(&full_input, 0, sizeof(full_input));\n    memset(full_results, 0, sizeof(full_results));\n    memset(buffer, 0, sizeof(buffer));\n    memcpy(buffer, text, (size_t)text_len);\n    text_and_target.data = buffer;\n    text_and_target.length = text_len;\n    rewrite.data = replacement;\n    rewrite.length = replacement_len;\n\n    // step 3: Operate (match using easy API)\n    int easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &easy_match, 1);\n\n    // step 4: Operate (convert matched strings to ranges)\n    strings_for_ranges[0] = easy_match;\n    cre2_strings_to_ranges(text, ranges, strings_for_ranges, 1);\n\n    // step 5: Operate (full match against compiled regexp)\n    full_input.data = text;\n    full_input.length = text_len;\n    int full_res = cre2_full_match_re(re, &full_input, full_results, 1);\n\n    // step 6: Operate (perform a replace using compiled regexp) and Cleanup\n    int replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    (void)easy_res;\n    (void)full_res;\n    (void)replace_res;\n    (void)ranges;\n    (void)full_results;\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:17:33.548243 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 72s
[2025-11-05 06:17:33.548360 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 26400, Completion: 22991, Total: 49391
[2025-11-05 06:17:33.548380 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:17:33.766656 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000010/id_000010.cc
[2025-11-05 06:17:33.766704 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:33.996781 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:33.996834 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:33.999521 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:33.999554 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:34.217080 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000011/id_000011.cc
[2025-11-05 06:17:34.217128 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:34.448251 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:34.448325 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:34.451098 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:34.451124 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:34.669173 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000012/id_000012.cc
[2025-11-05 06:17:34.669254 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:34.900027 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:34.900100 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:34.903012 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:34.903044 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:35.122712 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000013/id_000013.cc
[2025-11-05 06:17:35.122761 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:35.351240 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:35.351314 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:35.354073 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:35.354104 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:35.571792 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000014/id_000014.cc
[2025-11-05 06:17:35.571840 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:35.802288 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:35.802403 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:35.805228 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:35.805262 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:36.024196 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000015/id_000015.cc
[2025-11-05 06:17:36.024253 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:36.253343 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:36.253418 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:36.256056 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:36.256089 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:36.474274 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000016/id_000016.cc
[2025-11-05 06:17:36.474324 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:36.705328 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:36.705383 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:36.708258 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:36.708289 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:36.926835 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000017/id_000017.cc
[2025-11-05 06:17:36.926916 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:37.155835 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:37.155907 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:37.158834 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:37.158865 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:37.377403 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000018/id_000018.cc
[2025-11-05 06:17:37.377450 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:37.606964 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:37.607036 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:37.609925 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:37.609953 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:37.827893 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000019/id_000019.cc
[2025-11-05 06:17:37.827942 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:17:38.057950 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:17:38.058033 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:17:38.060851 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:17:38.060883 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:17:38.060924 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:17:38.060939 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 20, succ: 20, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:17:38.060954 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:17:38.060978 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:17:38.351867 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 19 as an example for the next prompt.
[2025-11-05 06:17:38.351929 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 16 new API pairs in this round.
[2025-11-05 06:17:38.351969 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 16
[2025-11-05 06:17:38.352016 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [8.0,1.0,1.0,1.0,1.0,19.0,1.0,1.0,1.0,1.0,4.0,1.0,4.0,1.0,1.0,14.0,1.0,1.0,1.0,1.0,7.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,8.0,9.0,1.0,23.0,1.0,1.0,8.0,1.0,1.0,1.0,29.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:17:38.352038 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:17:38.352088 +00:00] INFO [src/feedback/schedule.rs:246] Loop 2: Replaced with lowest energy API: cre2_global_replace (energy: 1), prob: 0.2976
[2025-11-05 06:17:38.352110 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace energy: 1
[2025-11-05 06:17:38.352141 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 23
[2025-11-05 06:17:38.352167 +00:00] INFO [src/feedback/schedule.rs:246] Loop 2: Replaced with lowest energy API: cre2_global_replace (energy: 1), prob: 0.2976
[2025-11-05 06:17:38.352193 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 9
[2025-11-05 06:17:38.352218 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 29
[2025-11-05 06:17:38.352254 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 06:17:38.352876 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 2, quiet_round: 0, discovered_api_pairs: 83
[2025-11-05 06:17:38.399845 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:17:38.400199 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"test\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is test and more test\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char replacement[] = \"X\";\n    const int replacement_len = (int)(sizeof(replacement) - 1);\n    cre2_regexp_t * re = cre2_new(pattern, pattern_len, NULL);\n    cre2_string_t easy_match;\n    cre2_range_t ranges[1];\n    cre2_string_t strings_for_ranges[1];\n    cre2_string_t full_input;\n    cre2_string_t full_results[1];\n    char buffer[128];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n\n    // step 2: Setup (clear structures and prepare buffers)\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(ranges, 0, sizeof(ranges));\n    memset(strings_for_ranges, 0, sizeof(strings_for_ranges));\n    memset(&full_input, 0, sizeof(full_input));\n    memset(full_results, 0, sizeof(full_results));\n    memset(buffer, 0, sizeof(buffer));\n    memcpy(buffer, text, (size_t)text_len);\n    text_and_target.data = buffer;\n    text_and_target.length = text_len;\n    rewrite.data = replacement;\n    rewrite.length = replacement_len;\n\n    // step 3: Operate (match using easy API)\n    int easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &easy_match, 1);\n\n    // step 4: Operate (convert matched strings to ranges)\n    strings_for_ranges[0] = easy_match;\n    cre2_strings_to_ranges(text, ranges, strings_for_ranges, 1);\n\n    // step 5: Operate (full match against compiled regexp)\n    full_input.data = text;\n    full_input.length = text_len;\n    int full_res = cre2_full_match_re(re, &full_input, full_results, 1);\n\n    // step 6: Operate (perform a replace using compiled regexp) and Cleanup\n    int replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    (void)easy_res;\n    (void)full_res;\n    (void)replace_res;\n    (void)ranges;\n    (void)full_results;\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is testing and test only\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"${1}_REPL\";\n    const int rewrite_template_len = (int)(sizeof(rewrite_template) - 1);\n    cre2_options_t * opt = cre2_opt_new();\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    char errmsg_buf[128];\n\n    // step 2: Setup (initialize structures and configure options)\n    memset(&match, 0, sizeof(match));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    cre2_opt_set_perl_classes(opt, 1);\n    int posix_flag = cre2_opt_posix_syntax(opt);\n\n    // step 3: Operate (compile the pattern with configured options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (perform an easy match using the same pattern)\n    int easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &match, 1);\n\n    // step 5: Validate (prepare rewrite and check it against the compiled regexp)\n    rewrite.data = rewrite_template;\n    rewrite.length = rewrite_template_len;\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n    int check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    (void)posix_flag;\n    (void)easy_res;\n    (void)check_res;\n    (void)match;\n    (void)rewrite;\n    (void)errmsg;\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:18:13.387561 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 35s
[2025-11-05 06:18:13.387681 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30890, Completion: 21767, Total: 52657
[2025-11-05 06:18:13.387700 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:18:13.605211 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000020/id_000020.cc
[2025-11-05 06:18:13.605260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:13.833954 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:13.834024 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:13.836829 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:13.836861 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:14.054390 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000021/id_000021.cc
[2025-11-05 06:18:14.054438 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:14.286428 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:14.286499 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:14.289251 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:14.289281 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:14.506720 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000022/id_000022.cc
[2025-11-05 06:18:14.506801 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:14.735135 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:14.735206 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:14.738088 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:14.738119 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:14.955326 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000023/id_000023.cc
[2025-11-05 06:18:14.955376 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:15.184109 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:15.184176 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:15.187070 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:15.187101 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:15.404712 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000024/id_000024.cc
[2025-11-05 06:18:15.404762 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:15.634586 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:15.634703 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:15.637402 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:15.637433 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:15.856471 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000025/id_000025.cc
[2025-11-05 06:18:15.856530 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:16.086253 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:16.086316 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:16.089154 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:16.089186 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:16.305533 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000026/id_000026.cc
[2025-11-05 06:18:16.305581 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:16.534946 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:16.535002 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:16.537866 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:16.537898 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:16.756318 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000027/id_000027.cc
[2025-11-05 06:18:16.756398 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:16.984536 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:16.984605 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:16.987267 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:16.987294 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:17.205241 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000028/id_000028.cc
[2025-11-05 06:18:17.205290 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:17.434269 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:17.434324 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:17.437187 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:17.437219 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:17.656082 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000029/id_000029.cc
[2025-11-05 06:18:17.656130 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:17.886104 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:17.886218 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:17.889110 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:17.889142 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:17.889181 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:18:17.889196 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 30, succ: 30, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:18:17.889211 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:18:17.889237 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:18:18.181274 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 29 as an example for the next prompt.
[2025-11-05 06:18:18.181333 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 06:18:18.181370 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 06:18:18.181415 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [8.0,7.0,1.0,1.0,1.0,19.0,1.0,1.0,1.0,1.0,4.0,1.0,4.0,1.0,1.0,18.0,1.0,1.0,1.0,1.0,9.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,8.0,15.0,1.0,29.0,1.0,1.0,8.0,1.0,1.0,1.0,38.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,8.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:18:18.181433 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:18:18.181484 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 38
[2025-11-05 06:18:18.181515 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 1
[2025-11-05 06:18:18.181544 +00:00] INFO [src/feedback/schedule.rs:246] Loop 3: Replaced with lowest energy API: cre2_opt_literal (energy: 1), prob: 0.2973
[2025-11-05 06:18:18.181559 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 1
[2025-11-05 06:18:18.181588 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 1
[2025-11-05 06:18:18.181624 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_opt_literal(cre2_options_t * opt),
    int cre2_opt_case_sensitive(cre2_options_t * opt)
[2025-11-05 06:18:18.182213 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 3, quiet_round: 0, discovered_api_pairs: 98
[2025-11-05 06:18:18.220230 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:18:18.220565 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_opt_literal(cre2_options_t * opt),\n    int cre2_opt_case_sensitive(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is testing and test only\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"${1}_REPL\";\n    const int rewrite_template_len = (int)(sizeof(rewrite_template) - 1);\n    cre2_options_t * opt = cre2_opt_new();\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    char errmsg_buf[128];\n\n    // step 2: Setup (initialize structures and configure options)\n    memset(&match, 0, sizeof(match));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    cre2_opt_set_perl_classes(opt, 1);\n    int posix_flag = cre2_opt_posix_syntax(opt);\n\n    // step 3: Operate (compile the pattern with configured options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (perform an easy match using the same pattern)\n    int easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &match, 1);\n\n    // step 5: Validate (prepare rewrite and check it against the compiled regexp)\n    rewrite.data = rewrite_template;\n    rewrite.length = rewrite_template_len;\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n    int check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    (void)posix_flag;\n    (void)easy_res;\n    (void)check_res;\n    (void)match;\n    (void)rewrite;\n    (void)errmsg;\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is testing and test only\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char replacement[] = \"X\";\n    const int replacement_len = (int)(sizeof(replacement) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    char buffer[256];\n    int easy_res = 0;\n    int replace_res = 0;\n\n    // step 2: Setup (initialize structures and create options)\n    memset(&match, 0, sizeof(match));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(buffer, 0, sizeof(buffer));\n    memcpy(buffer, text, (size_t)text_len);\n    text_and_target.data = buffer;\n    text_and_target.length = text_len;\n    rewrite.data = replacement;\n    rewrite.length = replacement_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure (set case sensitivity on options)\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Operate (compile the pattern with configured options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Operate (perform an easy match and a global replace using the pattern)\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &match, 1);\n    replace_res = cre2_global_replace(pattern, &text_and_target, &rewrite);\n\n    // step 6: Cleanup (release compiled regexp and options)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    (void)easy_res;\n    (void)replace_res;\n    (void)match;\n    (void)text_and_target;\n    (void)rewrite;\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:18:52.094671 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 06:18:52.094805 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29880, Completion: 23940, Total: 53820
[2025-11-05 06:18:52.094829 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:18:52.314748 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000030/id_000030.cc
[2025-11-05 06:18:52.314799 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:52.544000 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:52.544071 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:52.546711 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:52.546742 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:52.764644 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000031/id_000031.cc
[2025-11-05 06:18:52.764693 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:52.993495 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:52.993566 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:52.996035 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:18:52.996061 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:18:53.213592 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000032/id_000032.cc
[2025-11-05 06:18:53.213675 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:18:53.443625 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:18:53.443697 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:18:53.448567 +00:00] ERROR [src/execution/sanitize.rs:336] cre2 execution failed: stderr=*** stack smashing detected ***: terminated
, stdout=
[2025-11-05 06:18:53.448613 +00:00] WARN [src/fuzzer.rs:205] Program 32 failed validation. Attempting to repair. Error: Execution Error: cre2 execution failed: stderr=*** stack smashing detected ***: terminated
, stdout=
[2025-11-05 06:18:53.487800 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:18:53.488130 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"abc(\\\\d+)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"abc123xyz\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = cre2_opt_new();\n    cre2_string_t text_str;\n    cre2_string_t match_partial;\n    cre2_string_t match_easy;\n    int literal_flag = 0;\n    int case_flag = 0;\n    int nmatch = 1;\n    int partial_res = 0;\n    int easy_res = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&match_partial, 0, sizeof(match_partial));\n    memset(&match_easy, 0, sizeof(match_easy));\n    text_str.data = text;\n    text_str.length = text_len;\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    literal_flag = cre2_opt_literal(opt);\n    case_flag = cre2_opt_case_sensitive(opt);\n    nmatch = literal_flag + case_flag + 1;\n\n    // step 4: Operate\n    partial_res = cre2_partial_match(pattern, &text_str, &match_partial, nmatch);\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &match_easy, nmatch);\n\n    // step 5: Validate & Cleanup\n    cre2_opt_delete(opt);\n    (void)partial_res;\n    (void)easy_res;\n    (void)literal_flag;\n    (void)case_flag;\n    (void)nmatch;\n    (void)match_partial;\n    (void)match_easy;\n    (void)text_str;\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Execution Error\nError Details:cre2 execution failed: stderr=*** stack smashing detected ***: terminated\n, stdout=\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:19:27.716050 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 06:19:27.716166 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 20940, Completion: 17856, Total: 38796
[2025-11-05 06:19:27.937515 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000032/id_000032.cc
[2025-11-05 06:19:27.937571 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:28.171686 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:28.171761 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:28.174758 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:28.174791 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:28.174823 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 32!
[2025-11-05 06:19:28.396713 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000033/id_000033.cc
[2025-11-05 06:19:28.396761 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:28.629179 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:28.629263 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:28.632163 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:28.632193 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:28.857687 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000034/id_000034.cc
[2025-11-05 06:19:28.857766 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:29.089107 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:29.089181 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:29.091909 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:29.091940 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:29.312299 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000035/id_000035.cc
[2025-11-05 06:19:29.312349 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:29.541330 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:29.541403 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:29.543951 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:29.543982 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:29.762341 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000036/id_000036.cc
[2025-11-05 06:19:29.762390 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:29.993677 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:29.993789 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:29.996571 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:29.996602 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:30.216219 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000037/id_000037.cc
[2025-11-05 06:19:30.216269 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:30.447326 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:30.447401 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:30.449919 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:30.449950 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:30.671070 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000038/id_000038.cc
[2025-11-05 06:19:30.671120 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:30.899434 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:30.899497 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:30.902172 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:30.902204 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:31.122178 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000039/id_000039.cc
[2025-11-05 06:19:31.122257 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:31.354294 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:31.354365 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:31.356845 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:31.356876 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:31.356913 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:19:31.356931 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 40, succ: 40, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:19:31.356945 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:19:31.356968 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:19:31.637572 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 39 as an example for the next prompt.
[2025-11-05 06:19:31.637623 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 27 new API pairs in this round.
[2025-11-05 06:19:31.637672 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 27
[2025-11-05 06:19:31.637718 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [8.0,7.0,9.0,1.0,1.0,19.0,1.0,1.0,1.0,1.0,4.0,1.0,4.0,1.0,1.0,21.0,1.0,1.0,1.0,1.0,12.0,9.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,8.0,21.0,1.0,35.0,1.0,1.0,8.0,11.0,1.0,1.0,49.0,1.0,1.0,12.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,11.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:19:31.637736 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:19:31.637787 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 49
[2025-11-05 06:19:31.637815 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 1
[2025-11-05 06:19:31.637843 +00:00] INFO [src/feedback/schedule.rs:246] Loop 4: Replaced with lowest energy API: cre2_full_match (energy: 1), prob: 0.2970
[2025-11-05 06:19:31.637857 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_full_match energy: 1
[2025-11-05 06:19:31.637893 +00:00] INFO [src/feedback/schedule.rs:246] Loop 4: Replaced with lowest energy API: cre2_full_match (energy: 1), prob: 0.2970
[2025-11-05 06:19:31.637919 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 21
[2025-11-05 06:19:31.637953 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_program_size(const cre2_regexp_t * re),
    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 06:19:31.638581 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 4, quiet_round: 0, discovered_api_pairs: 125
[2025-11-05 06:19:31.678605 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:19:31.678944 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_program_size(const cre2_regexp_t * re),\n    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is testing and test only\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char replacement[] = \"X\";\n    const int replacement_len = (int)(sizeof(replacement) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    char buffer[256];\n    int easy_res = 0;\n    int replace_res = 0;\n\n    // step 2: Setup (initialize structures and create options)\n    memset(&match, 0, sizeof(match));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(buffer, 0, sizeof(buffer));\n    memcpy(buffer, text, (size_t)text_len);\n    text_and_target.data = buffer;\n    text_and_target.length = text_len;\n    rewrite.data = replacement;\n    rewrite.length = replacement_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure (set case sensitivity on options)\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Operate (compile the pattern with configured options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Operate (perform an easy match and a global replace using the pattern)\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &match, 1);\n    replace_res = cre2_global_replace(pattern, &text_and_target, &rewrite);\n\n    // step 6: Cleanup (release compiled regexp and options)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    (void)easy_res;\n    (void)replace_res;\n    (void)match;\n    (void)text_and_target;\n    (void)rewrite;\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar foobaz foo\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = cre2_opt_new();\n    cre2_string_t easy_match;\n    cre2_string_t partial_matches[3];\n    cre2_string_t text_str;\n    int easy_res = 0;\n    int partial_res = 0;\n    int literal_flag = 0;\n    int case_flag = 0;\n\n    // step 2: Setup\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    memset(&text_str, 0, sizeof(text_str));\n    text_str.data = text;\n    text_str.length = text_len;\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_case_sensitive(opt, 1);\n    literal_flag = cre2_opt_literal(opt);\n    case_flag = cre2_opt_case_sensitive(opt);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &easy_match, 2);\n    partial_res = cre2_partial_match(pattern, &text_str, partial_matches, 3);\n\n    // step 5: Validate\n    (void)literal_flag;\n    (void)case_flag;\n    (void)easy_res;\n    (void)partial_res;\n    (void)easy_match;\n    (void)partial_matches;\n    (void)text_str;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:19:59.305467 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 06:19:59.305590 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29250, Completion: 19726, Total: 48976
[2025-11-05 06:19:59.305612 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:19:59.523935 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000040/id_000040.cc
[2025-11-05 06:19:59.523985 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:19:59.751945 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:19:59.752013 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:19:59.754721 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:19:59.754750 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:19:59.974697 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000041/id_000041.cc
[2025-11-05 06:19:59.974748 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:00.204340 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:00.204410 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:00.207195 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:00.207234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:00.426188 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000042/id_000042.cc
[2025-11-05 06:20:00.426280 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:00.656516 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:00.656570 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:00.659138 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:00.659164 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:00.877380 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000043/id_000043.cc
[2025-11-05 06:20:00.877432 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:01.106373 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:01.106441 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:01.108922 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:01.108950 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:01.326471 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000044/id_000044.cc
[2025-11-05 06:20:01.326525 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:01.555698 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:01.555804 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:01.558386 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:01.558417 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:01.779463 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000045/id_000045.cc
[2025-11-05 06:20:01.779512 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:02.010942 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:02.011003 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:02.013480 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:02.013509 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:02.234923 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000046/id_000046.cc
[2025-11-05 06:20:02.234972 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:02.468089 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:02.468154 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:02.470671 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:02.470702 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:02.692159 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000047/id_000047.cc
[2025-11-05 06:20:02.692240 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:02.923309 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:02.923373 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:02.925862 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:02.925892 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:03.144107 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000048/id_000048.cc
[2025-11-05 06:20:03.144157 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:03.375920 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:03.375994 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:03.378543 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:03.378570 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:03.596104 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000049/id_000049.cc
[2025-11-05 06:20:03.596155 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:03.825680 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:03.825784 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:03.828428 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:03.828459 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:03.828496 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:20:03.828510 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 50, succ: 50, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:20:03.828524 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:20:03.828548 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:20:04.106205 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 49 as an example for the next prompt.
[2025-11-05 06:20:04.106259 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 18 new API pairs in this round.
[2025-11-05 06:20:04.106300 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 18
[2025-11-05 06:20:04.106346 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [8.0,7.0,9.0,9.0,1.0,19.0,1.0,1.0,1.0,12.0,4.0,1.0,4.0,1.0,1.0,26.0,1.0,1.0,1.0,1.0,14.0,9.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,12.0,25.0,1.0,43.0,1.0,1.0,8.0,11.0,1.0,1.0,57.0,1.0,1.0,12.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,13.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:20:04.106365 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:20:04.106417 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 1
[2025-11-05 06:20:04.106448 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_possible_match_range energy: 1
[2025-11-05 06:20:04.106476 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 14
[2025-11-05 06:20:04.106530 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 6
[2025-11-05 06:20:04.106559 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_string energy: 1
[2025-11-05 06:20:04.106591 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen),
    cre2_options_t *cre2_opt_new(),
    const char *cre2_pattern(const cre2_regexp_t * re),
    const char *cre2_version_string()
[2025-11-05 06:20:04.107317 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 5, quiet_round: 0, discovered_api_pairs: 143
[2025-11-05 06:20:04.141701 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:20:04.142036 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen),\n    cre2_options_t *cre2_opt_new(),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    const char *cre2_version_string()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar foobaz foo\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = cre2_opt_new();\n    cre2_string_t easy_match;\n    cre2_string_t partial_matches[3];\n    cre2_string_t text_str;\n    int easy_res = 0;\n    int partial_res = 0;\n    int literal_flag = 0;\n    int case_flag = 0;\n\n    // step 2: Setup\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    memset(&text_str, 0, sizeof(text_str));\n    text_str.data = text;\n    text_str.length = text_len;\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_case_sensitive(opt, 1);\n    literal_flag = cre2_opt_literal(opt);\n    case_flag = cre2_opt_case_sensitive(opt);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &easy_match, 2);\n    partial_res = cre2_partial_match(pattern, &text_str, partial_matches, 3);\n\n    // step 5: Validate\n    (void)literal_flag;\n    (void)case_flag;\n    (void)easy_res;\n    (void)partial_res;\n    (void)easy_match;\n    (void)partial_matches;\n    (void)text_str;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is testing and test only\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_str;\n    int easy_res = 0;\n    int full_res = 0;\n    int prog_size = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    memset(&text_str, 0, sizeof(text_str));\n    text_str.data = text;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &match, 2);\n    full_res = cre2_full_match(pattern, &text_str, &match, 2);\n\n    // step 5: Validate\n    (void)prog_size;\n    (void)easy_res;\n    (void)full_res;\n    (void)match;\n    (void)text_str;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:20:33.691719 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 06:20:33.691834 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28440, Completion: 18836, Total: 47276
[2025-11-05 06:20:33.691855 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:20:33.919006 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000050/id_000050.cc
[2025-11-05 06:20:33.919055 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:34.150964 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:34.151038 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:34.153925 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:34.153957 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:34.372632 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000051/id_000051.cc
[2025-11-05 06:20:34.372683 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:34.602082 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:34.602138 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:34.604864 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:34.604896 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:34.823334 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000052/id_000052.cc
[2025-11-05 06:20:34.823412 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:35.053174 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:35.053241 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:35.055700 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:35.055731 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:35.276702 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000053/id_000053.cc
[2025-11-05 06:20:35.276751 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:35.509015 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:35.509088 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:35.511621 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:35.511653 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:35.730113 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000054/id_000054.cc
[2025-11-05 06:20:35.730164 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:35.959433 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:35.959546 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:35.962400 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:35.962430 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:36.183752 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000055/id_000055.cc
[2025-11-05 06:20:36.183801 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:36.413552 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:36.413605 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:36.416301 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:36.416331 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:36.635918 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000056/id_000056.cc
[2025-11-05 06:20:36.635967 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:36.865425 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:36.865482 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:36.868179 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:36.868210 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:37.086537 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000057/id_000057.cc
[2025-11-05 06:20:37.086617 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:37.314893 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:37.314961 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:37.317613 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:37.317643 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:37.535552 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000058/id_000058.cc
[2025-11-05 06:20:37.535601 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:37.765188 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:37.765257 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:37.767765 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:37.767796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:37.985752 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000059/id_000059.cc
[2025-11-05 06:20:37.985802 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:20:38.217773 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:20:38.217892 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:20:38.220359 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:20:38.220388 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:20:38.220427 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:20:38.220470 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 60, succ: 60, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:20:38.220490 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:20:38.220517 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:20:38.492995 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 59 as an example for the next prompt.
[2025-11-05 06:20:38.493054 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 38 new API pairs in this round.
[2025-11-05 06:20:38.493118 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 38
[2025-11-05 06:20:38.493175 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [8.0,7.0,9.0,9.0,1.0,19.0,13.0,17.0,1.0,12.0,4.0,1.0,4.0,1.0,1.0,33.0,1.0,1.0,1.0,14.0,21.0,9.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,12.0,31.0,1.0,57.0,1.0,1.0,8.0,11.0,1.0,1.0,57.0,1.0,1.0,12.0,1.0,1.0,1.0,17.0,1.0,1.0,1.0,1.0,1.0,15.0,1.0,20.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:20:38.493200 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:20:38.493258 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 12
[2025-11-05 06:20:38.493299 +00:00] INFO [src/feedback/schedule.rs:246] Loop 6: Replaced with lowest energy API: cre2_consume_re (energy: 1), prob: 0.2964
[2025-11-05 06:20:38.493318 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 1
[2025-11-05 06:20:38.493355 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 13
[2025-11-05 06:20:38.493393 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 33
[2025-11-05 06:20:38.493422 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 8
[2025-11-05 06:20:38.493464 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg)
[2025-11-05 06:20:38.494216 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 6, quiet_round: 0, discovered_api_pairs: 181
[2025-11-05 06:20:38.544135 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:20:38.544500 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"this is testing and test only\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_str;\n    int easy_res = 0;\n    int full_res = 0;\n    int prog_size = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    memset(&text_str, 0, sizeof(text_str));\n    text_str.data = text;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &match, 2);\n    full_res = cre2_full_match(pattern, &text_str, &match, 2);\n\n    // step 5: Validate\n    (void)prog_size;\n    (void)easy_res;\n    (void)full_res;\n    (void)match;\n    (void)text_str;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(?:a|ab|abc)+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t min_str;\n    cre2_string_t max_str;\n    int possible_range_res = 0;\n    int maxlen = 64;\n    const char * extracted_pattern = NULL;\n    cre2_encoding_t encoding = CRE2_UNKNOWN;\n    const char * ver = NULL;\n\n    // step 2: Setup\n    memset(&min_str, 0, sizeof(min_str));\n    memset(&max_str, 0, sizeof(max_str));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    extracted_pattern = cre2_pattern(re);\n    possible_range_res = cre2_possible_match_range(re, &min_str, &max_str, maxlen);\n    encoding = cre2_opt_encoding(opt);\n    ver = cre2_version_string();\n\n    // step 5: Validate\n    (void)possible_range_res;\n    (void)extracted_pattern;\n    (void)min_str;\n    (void)max_str;\n    (void)encoding;\n    (void)ver;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:21:16.793298 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 06:21:16.793422 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28250, Completion: 21945, Total: 50195
[2025-11-05 06:21:16.793445 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:21:17.010918 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000060/id_000060.cc
[2025-11-05 06:21:17.010969 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:17.241279 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:17.241384 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:17.243967 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:17.243996 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:17.463122 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000061/id_000061.cc
[2025-11-05 06:21:17.463176 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:17.691611 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:17.691680 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:17.694344 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:17.694374 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:17.912411 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000062/id_000062.cc
[2025-11-05 06:21:17.912500 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:18.140588 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:18.140680 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:18.143163 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:18.143189 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:18.361686 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000063/id_000063.cc
[2025-11-05 06:21:18.361740 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:18.592268 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:18.592339 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:18.594892 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:18.594918 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:18.812498 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000064/id_000064.cc
[2025-11-05 06:21:18.812550 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:19.043075 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:19.043198 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:19.045693 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:19.045722 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:19.262674 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000065/id_000065.cc
[2025-11-05 06:21:19.262726 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:19.491972 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:19.492043 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:19.494693 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:19.494724 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:19.713255 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000066/id_000066.cc
[2025-11-05 06:21:19.713309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:19.945949 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:19.946022 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:19.948738 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:19.948770 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:20.166138 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000067/id_000067.cc
[2025-11-05 06:21:20.166221 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:20.399375 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:20.399448 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:20.402092 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:20.402123 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:20.618385 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000068/id_000068.cc
[2025-11-05 06:21:20.618437 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:20.849789 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:20.849854 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:20.852494 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:20.852525 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:21.069156 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000069/id_000069.cc
[2025-11-05 06:21:21.069207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:21:21.298328 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:21:21.298416 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:21:21.301070 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:21:21.301104 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:21:21.301141 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:21:21.301157 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 70, succ: 70, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:21:21.301172 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:21:21.301199 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:21:21.600185 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 69 as an example for the next prompt.
[2025-11-05 06:21:21.600238 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 4 new API pairs in this round.
[2025-11-05 06:21:21.600266 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 4
[2025-11-05 06:21:21.600312 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [10.0,7.0,9.0,9.0,4.0,19.0,14.0,17.0,1.0,12.0,4.0,1.0,4.0,1.0,1.0,34.0,1.0,1.0,1.0,14.0,21.0,9.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,12.0,31.0,1.0,59.0,1.0,1.0,8.0,11.0,1.0,1.0,57.0,1.0,1.0,15.0,1.0,1.0,1.0,17.0,1.0,1.0,1.0,1.0,1.0,15.0,1.0,20.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:21:21.600332 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:21:21.600381 +00:00] INFO [src/feedback/schedule.rs:246] Loop 7: Replaced with lowest energy API: cre2_opt_perl_classes (energy: 1), prob: 0.2960
[2025-11-05 06:21:21.600414 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 1
[2025-11-05 06:21:21.600444 +00:00] INFO [src/feedback/schedule.rs:246] Loop 7: Replaced with lowest energy API: cre2_opt_perl_classes (energy: 1), prob: 0.2960
[2025-11-05 06:21:21.600472 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 15
[2025-11-05 06:21:21.600497 +00:00] INFO [src/feedback/schedule.rs:246] Loop 7: Replaced with lowest energy API: cre2_opt_perl_classes (energy: 1), prob: 0.2960
[2025-11-05 06:21:21.600521 +00:00] INFO [src/feedback/schedule.rs:246] Loop 7: Replaced with lowest energy API: cre2_opt_perl_classes (energy: 1), prob: 0.2960
[2025-11-05 06:21:21.600545 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 4
[2025-11-05 06:21:21.600570 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 9
[2025-11-05 06:21:21.600595 +00:00] INFO [src/feedback/schedule.rs:246] Loop 7: Replaced with lowest energy API: cre2_opt_perl_classes (energy: 1), prob: 0.2960
[2025-11-05 06:21:21.600625 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 57
[2025-11-05 06:21:21.600662 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_perl_classes(cre2_options_t * opt),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 06:21:21.601396 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 7, quiet_round: 0, discovered_api_pairs: 185
[2025-11-05 06:21:21.651406 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:21:21.651754 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_perl_classes(cre2_options_t * opt),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(?:a|ab|abc)+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t min_str;\n    cre2_string_t max_str;\n    int possible_range_res = 0;\n    int maxlen = 64;\n    const char * extracted_pattern = NULL;\n    cre2_encoding_t encoding = CRE2_UNKNOWN;\n    const char * ver = NULL;\n\n    // step 2: Setup\n    memset(&min_str, 0, sizeof(min_str));\n    memset(&max_str, 0, sizeof(max_str));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    extracted_pattern = cre2_pattern(re);\n    possible_range_res = cre2_possible_match_range(re, &min_str, &max_str, maxlen);\n    encoding = cre2_opt_encoding(opt);\n    ver = cre2_version_string();\n\n    // step 5: Validate\n    (void)possible_range_res;\n    (void)extracted_pattern;\n    (void)min_str;\n    (void)max_str;\n    (void)encoding;\n    (void)ver;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"$1-REWRITTEN\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t match1;\n    cre2_string_t match2;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int partial_res = 0;\n    int consume_res = 0;\n    int check_res = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&match1, 0, sizeof(match1));\n    memset(&match2, 0, sizeof(match2));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    text_str.data = text;\n    text_str.length = text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    partial_res = cre2_partial_match(pattern, &text_str, &match1, 2);\n    consume_res = cre2_consume_re(re, &text_str, &match2, 2);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    (void)partial_res;\n    (void)consume_res;\n    (void)check_res;\n    (void)match1;\n    (void)match2;\n    (void)text_str;\n    (void)rewrite;\n    (void)errmsg;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:22:03.486440 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 06:22:03.486573 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29200, Completion: 25166, Total: 54366
[2025-11-05 06:22:03.486597 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:22:03.704705 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000070/id_000070.cc
[2025-11-05 06:22:03.704763 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:03.935142 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:03.935211 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:03.938113 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:03.938166 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:04.157314 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000071/id_000071.cc
[2025-11-05 06:22:04.157364 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:04.389959 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:04.390024 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:04.392463 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:04.392493 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:04.610993 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000072/id_000072.cc
[2025-11-05 06:22:04.611074 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:04.839319 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:04.839391 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:04.842344 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:04.842375 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:05.061147 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000073/id_000073.cc
[2025-11-05 06:22:05.061204 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:05.290419 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:05.290486 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:05.293419 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:05.293453 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:05.512388 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000074/id_000074.cc
[2025-11-05 06:22:05.512439 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:05.740553 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:05.740663 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:05.743306 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:05.743330 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:05.965137 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000075/id_000075.cc
[2025-11-05 06:22:05.965189 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:06.197085 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:06.197158 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:06.199852 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:06.199882 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:06.418527 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000076/id_000076.cc
[2025-11-05 06:22:06.418585 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:06.645164 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:06.645232 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:06.647802 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:06.647834 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:06.867768 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000077/id_000077.cc
[2025-11-05 06:22:06.867853 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:07.096774 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:07.096847 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:07.099370 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:07.099402 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:07.317881 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000078/id_000078.cc
[2025-11-05 06:22:07.317933 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:07.549847 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:07.549920 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:07.552754 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:07.552787 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:07.770335 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000079/id_000079.cc
[2025-11-05 06:22:07.770387 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:07.998980 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:07.999093 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:08.001936 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:08.001967 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:08.002005 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:22:08.002021 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 80, succ: 80, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:22:08.002035 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:22:08.002060 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:22:08.288098 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 79 as an example for the next prompt.
[2025-11-05 06:22:08.288153 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 21 new API pairs in this round.
[2025-11-05 06:22:08.288196 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 21
[2025-11-05 06:22:08.288243 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [10.0,7.0,9.0,9.0,4.0,19.0,14.0,17.0,9.0,12.0,4.0,1.0,14.0,1.0,1.0,40.0,1.0,1.0,1.0,14.0,23.0,14.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,15.0,31.0,1.0,68.0,1.0,1.0,8.0,11.0,1.0,1.0,66.0,1.0,1.0,24.0,1.0,1.0,1.0,17.0,1.0,1.0,1.0,1.0,1.0,17.0,1.0,20.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:22:08.288260 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:22:08.288324 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 31
[2025-11-05 06:22:08.288379 +00:00] INFO [src/feedback/schedule.rs:246] Loop 8: Replaced with lowest energy API: cre2_opt_set_posix_syntax (energy: 1), prob: 0.2956
[2025-11-05 06:22:08.288412 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_posix_syntax energy: 1
[2025-11-05 06:22:08.288459 +00:00] INFO [src/feedback/schedule.rs:246] Loop 8: Replaced with lowest energy API: cre2_opt_set_posix_syntax (energy: 1), prob: 0.2956
[2025-11-05 06:22:08.288500 +00:00] INFO [src/feedback/schedule.rs:246] Loop 8: Replaced with lowest energy API: cre2_opt_set_posix_syntax (energy: 1), prob: 0.2956
[2025-11-05 06:22:08.288536 +00:00] INFO [src/feedback/schedule.rs:246] Loop 8: Replaced with lowest energy API: cre2_opt_set_posix_syntax (energy: 1), prob: 0.2956
[2025-11-05 06:22:08.288574 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace energy: 7
[2025-11-05 06:22:08.288612 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 17
[2025-11-05 06:22:08.288655 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 20
[2025-11-05 06:22:08.288700 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),
    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 06:22:08.289453 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 8, quiet_round: 0, discovered_api_pairs: 206
[2025-11-05 06:22:08.330837 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:22:08.331205 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),\n    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"$1-REWRITTEN\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t match1;\n    cre2_string_t match2;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int partial_res = 0;\n    int consume_res = 0;\n    int check_res = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&match1, 0, sizeof(match1));\n    memset(&match2, 0, sizeof(match2));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    text_str.data = text;\n    text_str.length = text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    partial_res = cre2_partial_match(pattern, &text_str, &match1, 2);\n    consume_res = cre2_consume_re(re, &text_str, &match2, 2);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    (void)partial_res;\n    (void)consume_res;\n    (void)check_res;\n    (void)match1;\n    (void)match2;\n    (void)text_str;\n    (void)rewrite;\n    (void)errmsg;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t easy_match_result;\n    cre2_string_t partial_matches[16];\n    int perl_flag = 0;\n    int set_literal_flag = 0;\n    int n_captures = 0;\n    int nm = 0;\n    int easy_res = 0;\n    int partial_res = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&easy_match_result, 0, sizeof(easy_match_result));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_str.data = text;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    set_literal_flag = 0;\n    cre2_opt_set_literal(opt, set_literal_flag);\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    n_captures = cre2_num_capturing_groups(re);\n    nm = n_captures + 1;\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &easy_match_result, nm);\n    partial_res = cre2_partial_match(pattern, &text_str, partial_matches, nm);\n\n    // step 5: Validate\n    (void)perl_flag;\n    (void)set_literal_flag;\n    (void)n_captures;\n    (void)nm;\n    (void)easy_res;\n    (void)partial_res;\n    (void)text_str;\n    (void)easy_match_result;\n    (void)partial_matches;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:22:40.613939 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 06:22:40.614062 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30780, Completion: 19529, Total: 50309
[2025-11-05 06:22:40.614083 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:22:40.841470 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000080/id_000080.cc
[2025-11-05 06:22:40.841520 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:41.073365 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:41.073435 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:41.076102 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:41.076148 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:41.297764 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000081/id_000081.cc
[2025-11-05 06:22:41.297814 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:41.530606 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:41.530677 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:41.533170 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:41.533197 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:41.750441 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000082/id_000082.cc
[2025-11-05 06:22:41.750522 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:41.983510 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:41.983579 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:41.986479 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:41.986511 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:42.205118 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000083/id_000083.cc
[2025-11-05 06:22:42.205169 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:42.437603 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:42.437671 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:42.440187 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:42.440213 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:42.660664 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000084/id_000084.cc
[2025-11-05 06:22:42.660715 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:42.892897 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:42.893008 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:42.895468 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:42.895493 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:43.113243 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000085/id_000085.cc
[2025-11-05 06:22:43.113295 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:43.345087 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:43.345158 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:43.347602 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:43.347628 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:43.567167 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000086/id_000086.cc
[2025-11-05 06:22:43.567219 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:43.796118 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:43.796200 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:43.798806 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:43.798836 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:44.017761 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000087/id_000087.cc
[2025-11-05 06:22:44.017846 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:44.248448 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:44.248517 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:44.250982 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:44.251010 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:44.468934 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000088/id_000088.cc
[2025-11-05 06:22:44.468985 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:44.702234 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:44.702303 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:44.704970 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:44.704997 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:44.925112 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000089/id_000089.cc
[2025-11-05 06:22:44.925164 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:22:45.157775 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:22:45.157886 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:22:45.160576 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:22:45.160607 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:22:45.160650 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:22:45.160666 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 90, succ: 90, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:22:45.160683 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:22:45.160708 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:22:45.443152 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 89 as an example for the next prompt.
[2025-11-05 06:22:45.443206 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 06:22:45.443247 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 06:22:45.443292 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [10.0,14.0,9.0,9.0,4.0,19.0,16.0,17.0,9.0,12.0,4.0,8.0,14.0,1.0,1.0,44.0,1.0,1.0,1.0,14.0,26.0,14.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,15.0,36.0,1.0,74.0,1.0,1.0,8.0,11.0,1.0,1.0,66.0,1.0,1.0,24.0,1.0,1.0,1.0,26.0,1.0,1.0,1.0,1.0,1.0,18.0,1.0,27.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:22:45.443312 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:22:45.443361 +00:00] INFO [src/feedback/schedule.rs:246] Loop 9: Replaced with lowest energy API: cre2_extract (energy: 1), prob: 0.2951
[2025-11-05 06:22:45.443383 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract energy: 1
[2025-11-05 06:22:45.443424 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 66
[2025-11-05 06:22:45.443491 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 9
[2025-11-05 06:22:45.443519 +00:00] INFO [src/feedback/schedule.rs:246] Loop 9: Replaced with lowest energy API: cre2_extract (energy: 1), prob: 0.2951
[2025-11-05 06:22:45.443544 +00:00] INFO [src/feedback/schedule.rs:246] Loop 9: Replaced with lowest energy API: cre2_extract (energy: 1), prob: 0.2951
[2025-11-05 06:22:45.443568 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 74
[2025-11-05 06:22:45.443594 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 26
[2025-11-05 06:22:45.443631 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_extract(const char * pattern, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_perl_classes(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_options_t *cre2_opt_new()
[2025-11-05 06:22:45.444347 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 9, quiet_round: 0, discovered_api_pairs: 225
[2025-11-05 06:22:45.491293 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:22:45.491644 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_extract(const char * pattern, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_perl_classes(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_options_t *cre2_opt_new()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t easy_match_result;\n    cre2_string_t partial_matches[16];\n    int perl_flag = 0;\n    int set_literal_flag = 0;\n    int n_captures = 0;\n    int nm = 0;\n    int easy_res = 0;\n    int partial_res = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&easy_match_result, 0, sizeof(easy_match_result));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_str.data = text;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    set_literal_flag = 0;\n    cre2_opt_set_literal(opt, set_literal_flag);\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    n_captures = cre2_num_capturing_groups(re);\n    nm = n_captures + 1;\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &easy_match_result, nm);\n    partial_res = cre2_partial_match(pattern, &text_str, partial_matches, nm);\n\n    // step 5: Validate\n    (void)perl_flag;\n    (void)set_literal_flag;\n    (void)n_captures;\n    (void)nm;\n    (void)easy_res;\n    (void)partial_res;\n    (void)text_str;\n    (void)easy_match_result;\n    (void)partial_matches;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"foo and foo again\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"bar\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_encoding_t enc;\n    const char * re_pattern_from_obj = NULL;\n    int replace_res = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_posix_syntax(opt, 0);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pattern_from_obj = cre2_pattern(re);\n    replace_res = cre2_global_replace(re_pattern_from_obj, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    (void)enc;\n    (void)replace_res;\n    (void)text_and_target;\n    (void)rewrite;\n    (void)re_pattern_from_obj;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:23:23.200056 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 06:23:23.200156 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29930, Completion: 22409, Total: 52339
[2025-11-05 06:23:23.200176 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:23:23.418276 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000090/id_000090.cc
[2025-11-05 06:23:23.418327 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:23.647266 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:23.647322 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:23.650218 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:23.650251 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:23.867387 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000091/id_000091.cc
[2025-11-05 06:23:23.867449 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:24.096805 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:24.096880 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:24.099461 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:24.099494 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:24.316429 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000092/id_000092.cc
[2025-11-05 06:23:24.316512 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:24.546060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:24.546136 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:24.548958 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:24.548992 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:24.767564 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000093/id_000093.cc
[2025-11-05 06:23:24.767615 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:24.997112 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:24.997186 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:24.999842 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:24.999873 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:25.218096 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000094/id_000094.cc
[2025-11-05 06:23:25.218148 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:25.448107 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:25.448224 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:25.451135 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:25.451168 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:25.670472 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000095/id_000095.cc
[2025-11-05 06:23:25.670523 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:25.901207 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:25.901264 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:25.904120 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:25.904152 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:26.122938 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000096/id_000096.cc
[2025-11-05 06:23:26.122990 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:26.352011 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:26.352067 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:26.354951 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:26.354983 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:26.572537 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000097/id_000097.cc
[2025-11-05 06:23:26.572619 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:26.801613 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:26.801669 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:26.804404 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:26.804435 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:27.022754 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000098/id_000098.cc
[2025-11-05 06:23:27.022805 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:27.251060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:27.251134 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:27.254079 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:27.254112 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:27.472151 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000099/id_000099.cc
[2025-11-05 06:23:27.472202 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:23:27.700268 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:23:27.700388 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:23:27.703237 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:23:27.703270 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:23:27.703309 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:23:27.703325 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 100, succ: 100, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:23:27.703344 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:23:27.703374 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:23:28.006450 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 99 as an example for the next prompt.
[2025-11-05 06:23:28.006506 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 06:23:28.006538 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 06:23:28.006587 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [10.0,14.0,9.0,9.0,4.0,19.0,16.0,17.0,13.0,12.0,4.0,8.0,15.0,5.0,1.0,46.0,1.0,1.0,1.0,14.0,30.0,14.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,21.0,17.0,36.0,1.0,77.0,1.0,1.0,8.0,11.0,1.0,1.0,70.0,1.0,1.0,24.0,1.0,1.0,1.0,26.0,1.0,1.0,1.0,1.0,1.0,19.0,1.0,27.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:23:28.006605 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:23:28.006665 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 70
[2025-11-05 06:23:28.006703 +00:00] INFO [src/feedback/schedule.rs:246] Loop 10: Replaced with lowest energy API: cre2_opt_word_boundary (energy: 1), prob: 0.2946
[2025-11-05 06:23:28.006722 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_word_boundary energy: 1
[2025-11-05 06:23:28.006753 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 23
[2025-11-05 06:23:28.006794 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 30
[2025-11-05 06:23:28.006837 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 26
[2025-11-05 06:23:28.006876 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_word_boundary(cre2_options_t * opt),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    cre2_options_t *cre2_opt_new(),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 06:23:28.007625 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 10, quiet_round: 0, discovered_api_pairs: 234
[2025-11-05 06:23:28.052542 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:23:28.052905 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_word_boundary(cre2_options_t * opt),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    cre2_options_t *cre2_opt_new(),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"foo and foo again\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"bar\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_encoding_t enc;\n    const char * re_pattern_from_obj = NULL;\n    int replace_res = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_posix_syntax(opt, 0);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pattern_from_obj = cre2_pattern(re);\n    replace_res = cre2_global_replace(re_pattern_from_obj, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    (void)enc;\n    (void)replace_res;\n    (void)text_and_target;\n    (void)rewrite;\n    (void)re_pattern_from_obj;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    cre2_string_t matches[16];\n    int perl_flag = 0;\n    int n_captures = 0;\n    int nm = 0;\n    int easy_res = 0;\n    int extract_res = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&target, 0, sizeof(target));\n    memset(matches, 0, sizeof(matches));\n    text_str.data = text;\n    text_str.length = text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    n_captures = cre2_num_capturing_groups(re);\n    nm = n_captures + 1;\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &matches[0], nm);\n    extract_res = cre2_extract(pattern, &text_str, &rewrite, &target);\n\n    // step 5: Validate\n    (void)perl_flag;\n    (void)n_captures;\n    (void)nm;\n    (void)easy_res;\n    (void)extract_res;\n    (void)matches;\n    (void)text_str;\n    (void)rewrite;\n    (void)target;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:23:59.912580 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 06:23:59.912732 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30190, Completion: 19280, Total: 49470
[2025-11-05 06:23:59.912757 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:24:00.130537 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000100/id_000100.cc
[2025-11-05 06:24:00.130589 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:00.358370 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:00.358441 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:00.361334 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:00.361373 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:00.578595 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000101/id_000101.cc
[2025-11-05 06:24:00.578647 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:00.813181 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:00.813254 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:00.815971 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:00.816000 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:01.033853 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000102/id_000102.cc
[2025-11-05 06:24:01.033941 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:01.262327 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:01.262402 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:01.265254 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:01.265289 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:01.483145 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000103/id_000103.cc
[2025-11-05 06:24:01.483196 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:01.713415 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:01.713490 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:01.716244 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:01.716275 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:01.934434 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000104/id_000104.cc
[2025-11-05 06:24:01.934484 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:02.163556 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:02.163641 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:02.166331 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:02.166360 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:02.385297 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000105/id_000105.cc
[2025-11-05 06:24:02.385348 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:02.613455 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:02.613523 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:02.616313 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:02.616343 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:02.833815 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000106/id_000106.cc
[2025-11-05 06:24:02.833865 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:03.062378 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:03.062443 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:03.065322 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:03.065353 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:03.281489 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000107/id_000107.cc
[2025-11-05 06:24:03.281571 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:03.510422 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:03.510496 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:03.513455 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:03.513511 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:03.731780 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000108/id_000108.cc
[2025-11-05 06:24:03.731830 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:03.960498 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:03.960573 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:03.963353 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:03.963390 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:04.181987 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000109/id_000109.cc
[2025-11-05 06:24:04.182037 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:04.411397 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:04.411518 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:04.414455 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:04.414489 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:04.414532 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:24:04.414555 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 110, succ: 110, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:24:04.414576 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:24:04.414604 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:24:04.694253 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 109 as an example for the next prompt.
[2025-11-05 06:24:04.694306 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 06:24:04.694341 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 06:24:04.694388 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [10.0,14.0,9.0,9.0,4.0,19.0,16.0,17.0,13.0,12.0,4.0,8.0,15.0,5.0,9.0,46.0,1.0,1.0,1.0,14.0,35.0,14.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,26.0,1.0,21.0,17.0,36.0,1.0,77.0,1.0,1.0,8.0,11.0,1.0,1.0,75.0,1.0,1.0,24.0,1.0,1.0,1.0,33.0,1.0,1.0,1.0,1.0,1.0,20.0,1.0,27.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:24:04.694407 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:24:04.694461 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 16
[2025-11-05 06:24:04.694492 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 10
[2025-11-05 06:24:04.694522 +00:00] INFO [src/feedback/schedule.rs:246] Loop 11: Replaced with lowest energy API: cre2_match (energy: 1), prob: 0.2940
[2025-11-05 06:24:04.694538 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 1
[2025-11-05 06:24:04.694564 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 46
[2025-11-05 06:24:04.694600 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 06:24:04.695249 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 11, quiet_round: 0, discovered_api_pairs: 246
[2025-11-05 06:24:04.745214 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:24:04.745574 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    cre2_string_t matches[16];\n    int perl_flag = 0;\n    int n_captures = 0;\n    int nm = 0;\n    int easy_res = 0;\n    int extract_res = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&target, 0, sizeof(target));\n    memset(matches, 0, sizeof(matches));\n    text_str.data = text;\n    text_str.length = text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    n_captures = cre2_num_capturing_groups(re);\n    nm = n_captures + 1;\n    easy_res = cre2_easy_match(pattern, pattern_len, text, text_len, &matches[0], nm);\n    extract_res = cre2_extract(pattern, &text_str, &rewrite, &target);\n\n    // step 5: Validate\n    (void)perl_flag;\n    (void)n_captures;\n    (void)nm;\n    (void)easy_res;\n    (void)extract_res;\n    (void)matches;\n    (void)text_str;\n    (void)rewrite;\n    (void)target;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"this is a testing string for cre2\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int word_boundary_flag = 0;\n    cre2_string_t matches[4];\n    cre2_range_t ranges[4];\n    int nm = 4;\n    int easy_res = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n\n    // step 3: Configure / Query options\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate - perform a simple match and convert found strings to ranges\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nm);\n    cre2_strings_to_ranges(input_text, ranges, &matches[0], nm);\n\n    // step 5: Validate (use results to satisfy data-flow; no branching)\n    (void)easy_res;\n    (void)word_boundary_flag;\n    (void)enc;\n    (void)matches;\n    (void)ranges;\n    (void)input_text;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:24:28.278817 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 23s
[2025-11-05 06:24:28.278941 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30180, Completion: 18834, Total: 49014
[2025-11-05 06:24:28.278961 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:24:28.496989 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000110/id_000110.cc
[2025-11-05 06:24:28.497041 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:28.726364 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:28.726430 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:28.729134 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:28.729167 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:28.945756 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000111/id_000111.cc
[2025-11-05 06:24:28.945808 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:29.174632 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:29.174699 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:29.177532 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:29.177564 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:29.396717 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000112/id_000112.cc
[2025-11-05 06:24:29.396800 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:29.626218 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:29.626276 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:29.628995 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:29.629027 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:29.846399 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000113/id_000113.cc
[2025-11-05 06:24:29.846451 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:30.082844 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:30.082920 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:30.085643 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:30.085676 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:30.303589 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000114/id_000114.cc
[2025-11-05 06:24:30.303640 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:30.532849 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:30.532946 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:30.535479 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:30.535512 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:30.754497 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000115/id_000115.cc
[2025-11-05 06:24:30.754549 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:30.983380 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:30.983456 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:30.986318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:30.986351 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:31.204108 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000116/id_000116.cc
[2025-11-05 06:24:31.204167 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:31.433851 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:31.433908 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:31.436637 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:31.436668 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:31.654714 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000117/id_000117.cc
[2025-11-05 06:24:31.654797 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:31.882664 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:31.882740 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:31.885604 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:31.885637 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:32.103640 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000118/id_000118.cc
[2025-11-05 06:24:32.103692 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:32.331981 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:32.332058 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:32.334944 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:32.334975 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:32.553091 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000119/id_000119.cc
[2025-11-05 06:24:32.553153 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:24:32.782945 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:24:32.783048 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:24:32.785839 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:24:32.785871 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:24:32.785909 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:24:32.785925 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 120, succ: 120, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:24:32.785941 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:24:32.785966 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:24:33.072186 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 119 as an example for the next prompt.
[2025-11-05 06:24:33.072240 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 14 new API pairs in this round.
[2025-11-05 06:24:33.072276 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 14
[2025-11-05 06:24:33.072322 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [16.0,14.0,9.0,9.0,4.0,19.0,21.0,17.0,13.0,12.0,4.0,8.0,22.0,5.0,9.0,49.0,10.0,1.0,1.0,14.0,37.0,14.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,26.0,1.0,21.0,17.0,36.0,1.0,85.0,1.0,1.0,8.0,11.0,1.0,1.0,75.0,1.0,1.0,24.0,1.0,1.0,1.0,33.0,1.0,1.0,1.0,1.0,1.0,21.0,1.0,27.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:24:33.072341 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:24:33.072393 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 19
[2025-11-05 06:24:33.072426 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 16
[2025-11-05 06:24:33.072452 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 75
[2025-11-05 06:24:33.072480 +00:00] INFO [src/feedback/schedule.rs:246] Loop 12: Replaced with lowest energy API: cre2_quote_meta (energy: 1), prob: 0.2934
[2025-11-05 06:24:33.072496 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_quote_meta energy: 1
[2025-11-05 06:24:33.072523 +00:00] INFO [src/feedback/schedule.rs:246] Loop 12: Replaced with lowest energy API: cre2_quote_meta (energy: 1), prob: 0.2934
[2025-11-05 06:24:33.072549 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 33
[2025-11-05 06:24:33.072587 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_quote_meta(cre2_string_t * quoted, cre2_string_t * original),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 06:24:33.073332 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 12, quiet_round: 0, discovered_api_pairs: 260
[2025-11-05 06:24:33.123233 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:24:33.123580 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_quote_meta(cre2_string_t * quoted, cre2_string_t * original),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"this is a testing string for cre2\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int word_boundary_flag = 0;\n    cre2_string_t matches[4];\n    cre2_range_t ranges[4];\n    int nm = 4;\n    int easy_res = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n\n    // step 3: Configure / Query options\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate - perform a simple match and convert found strings to ranges\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nm);\n    cre2_strings_to_ranges(input_text, ranges, &matches[0], nm);\n\n    // step 5: Validate (use results to satisfy data-flow; no branching)\n    (void)easy_res;\n    (void)word_boundary_flag;\n    (void)enc;\n    (void)matches;\n    (void)ranges;\n    (void)input_text;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int match_res = 0;\n    int check_res = 0;\n    int nmatch = 3;\n    int startpos = 0;\n    int endpos = text_len;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate - compile regex and perform a match\n    re = cre2_new(pattern, pattern_len, opt);\n    match_res = cre2_match(re, text, text_len, startpos, endpos, CRE2_UNANCHORED, &matches[0], nmatch);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate (use results to satisfy data-flow)\n    (void)match_res;\n    (void)check_res;\n    (void)matches;\n    (void)rewrite;\n    (void)errmsg;\n    (void)pattern_len;\n    (void)text_len;\n    (void)startpos;\n    (void)endpos;\n    (void)nmatch;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:25:19.855263 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 06:25:19.855385 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29620, Completion: 26152, Total: 55772
[2025-11-05 06:25:19.855405 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:25:20.080565 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000120/id_000120.cc
[2025-11-05 06:25:20.080615 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:20.310014 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:20.310079 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:20.312925 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:20.312952 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:20.530778 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000121/id_000121.cc
[2025-11-05 06:25:20.530830 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:20.759477 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:20.759554 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:20.762471 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:20.762501 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:20.979869 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000122/id_000122.cc
[2025-11-05 06:25:20.979953 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:21.208667 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:21.208722 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:21.211494 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:21.211526 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:21.431643 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000123/id_000123.cc
[2025-11-05 06:25:21.431695 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:21.662315 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:21.662373 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:21.665242 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:21.665276 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:21.883046 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000124/id_000124.cc
[2025-11-05 06:25:21.883108 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:22.111676 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:22.111774 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:22.114659 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:22.114691 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:22.331200 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000125/id_000125.cc
[2025-11-05 06:25:22.331250 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:22.561196 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:22.561271 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:22.563846 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:22.563878 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:22.782209 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000126/id_000126.cc
[2025-11-05 06:25:22.782260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:23.011734 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:23.011808 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:23.014701 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:23.014734 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:23.232319 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000127/id_000127.cc
[2025-11-05 06:25:23.232403 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:23.461520 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:23.461590 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:23.464214 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:23.464244 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:23.682974 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000128/id_000128.cc
[2025-11-05 06:25:23.683024 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:23.911693 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:23.911763 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:23.914654 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:23.914686 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:24.134708 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000129/id_000129.cc
[2025-11-05 06:25:24.134759 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:24.363625 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:24.363738 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:24.366619 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:24.366650 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:24.366710 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:25:24.366728 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 130, succ: 130, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:25:24.366743 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:25:24.366768 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:25:24.685427 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 129 as an example for the next prompt.
[2025-11-05 06:25:24.685482 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 31 new API pairs in this round.
[2025-11-05 06:25:24.685534 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 31
[2025-11-05 06:25:24.685581 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,9.0,4.0,25.0,25.0,17.0,13.0,12.0,4.0,8.0,22.0,5.0,9.0,51.0,10.0,21.0,1.0,14.0,40.0,14.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,26.0,1.0,21.0,17.0,36.0,1.0,100.0,1.0,1.0,8.0,11.0,1.0,1.0,90.0,1.0,1.0,24.0,1.0,1.0,1.0,43.0,1.0,1.0,1.0,1.0,1.0,21.0,1.0,27.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:25:24.685599 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:25:24.685659 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 12
[2025-11-05 06:25:24.685699 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 100
[2025-11-05 06:25:24.685732 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 43
[2025-11-05 06:25:24.685771 +00:00] INFO [src/feedback/schedule.rs:246] Loop 13: Replaced with lowest energy API: cre2_opt_set_one_line (energy: 1), prob: 0.2928
[2025-11-05 06:25:24.685787 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 1
[2025-11-05 06:25:24.685812 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 36
[2025-11-05 06:25:24.685847 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_program_size(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)
[2025-11-05 06:25:24.686599 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 13, quiet_round: 0, discovered_api_pairs: 291
[2025-11-05 06:25:24.726282 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:25:24.726641 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_program_size(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int match_res = 0;\n    int check_res = 0;\n    int nmatch = 3;\n    int startpos = 0;\n    int endpos = text_len;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate - compile regex and perform a match\n    re = cre2_new(pattern, pattern_len, opt);\n    match_res = cre2_match(re, text, text_len, startpos, endpos, CRE2_UNANCHORED, &matches[0], nmatch);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate (use results to satisfy data-flow)\n    (void)match_res;\n    (void)check_res;\n    (void)matches;\n    (void)rewrite;\n    (void)errmsg;\n    (void)pattern_len;\n    (void)text_len;\n    (void)startpos;\n    (void)endpos;\n    (void)nmatch;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t quoted;\n    cre2_string_t original;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    cre2_string_t text_and_target;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int easy_res = 0;\n    int check_res = 0;\n    int replace_res = 0;\n    int nmatch = 3;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&quoted, 0, sizeof(quoted));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    original.data = pattern;\n    original.length = pattern_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure / Query options\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate - quote meta, easy match, compile regex, check rewrite, replace\n    cre2_quote_meta(&quoted, &original);\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    re = cre2_new(pattern, pattern_len, opt);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (use results to satisfy data-flow; no branching)\n    (void)easy_res;\n    (void)check_res;\n    (void)replace_res;\n    (void)matches;\n    (void)quoted;\n    (void)original;\n    (void)rewrite;\n    (void)errmsg;\n    (void)text_and_target;\n    (void)enc;\n    (void)nmatch;\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:25:57.767574 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 06:25:57.767698 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31500, Completion: 19535, Total: 51035
[2025-11-05 06:25:57.767718 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:25:57.983639 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000130/id_000130.cc
[2025-11-05 06:25:57.983689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:58.212432 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:58.212507 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:58.214997 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:58.215024 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:58.432847 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000131/id_000131.cc
[2025-11-05 06:25:58.432899 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:58.662019 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:58.662084 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:58.664711 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:58.664744 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:58.883468 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000132/id_000132.cc
[2025-11-05 06:25:58.883550 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:59.112291 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:59.112360 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:59.115093 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:59.115125 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:59.331588 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000133/id_000133.cc
[2025-11-05 06:25:59.331639 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:25:59.559842 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:25:59.559914 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:25:59.562534 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:25:59.562565 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:25:59.779860 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000134/id_000134.cc
[2025-11-05 06:25:59.779920 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:00.008559 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:00.008661 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:00.011241 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:00.011268 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:00.229494 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000135/id_000135.cc
[2025-11-05 06:26:00.229546 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:00.458864 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:00.458930 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:00.461778 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:00.461811 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:00.678557 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000136/id_000136.cc
[2025-11-05 06:26:00.678608 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:00.906966 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:00.907042 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:00.909943 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:00.909974 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:01.128337 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000137/id_000137.cc
[2025-11-05 06:26:01.128420 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:01.358121 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:01.358196 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:01.360957 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:01.360990 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:01.579699 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000138/id_000138.cc
[2025-11-05 06:26:01.579750 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:01.809304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:01.809375 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:01.811996 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:01.812028 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:02.028541 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000139/id_000139.cc
[2025-11-05 06:26:02.028592 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:02.258290 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:02.258374 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:02.261046 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:02.261077 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:02.261116 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:26:02.261145 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 140, succ: 140, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:26:02.261161 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:26:02.261186 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:26:02.529888 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 139 as an example for the next prompt.
[2025-11-05 06:26:02.529953 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 25 new API pairs in this round.
[2025-11-05 06:26:02.530003 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 25
[2025-11-05 06:26:02.530058 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,9.0,4.0,25.0,31.0,17.0,13.0,21.0,4.0,8.0,22.0,5.0,9.0,57.0,10.0,21.0,18.0,14.0,44.0,14.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,26.0,1.0,21.0,17.0,50.0,1.0,108.0,1.0,1.0,8.0,11.0,1.0,1.0,90.0,1.0,1.0,24.0,1.0,1.0,1.0,51.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,27.0,1.0,6.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:26:02.530081 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:26:02.530166 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 25
[2025-11-05 06:26:02.530198 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 90
[2025-11-05 06:26:02.530226 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 57
[2025-11-05 06:26:02.530262 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 21
[2025-11-05 06:26:02.530306 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_program_size(const cre2_regexp_t * re)
[2025-11-05 06:26:02.530974 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 14, quiet_round: 0, discovered_api_pairs: 316
[2025-11-05 06:26:02.568819 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:26:02.569182 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_program_size(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t quoted;\n    cre2_string_t original;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    cre2_string_t text_and_target;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int easy_res = 0;\n    int check_res = 0;\n    int replace_res = 0;\n    int nmatch = 3;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&quoted, 0, sizeof(quoted));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    original.data = pattern;\n    original.length = pattern_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure / Query options\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate - quote meta, easy match, compile regex, check rewrite, replace\n    cre2_quote_meta(&quoted, &original);\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    re = cre2_new(pattern, pattern_len, opt);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (use results to satisfy data-flow; no branching)\n    (void)easy_res;\n    (void)check_res;\n    (void)replace_res;\n    (void)matches;\n    (void)quoted;\n    (void)original;\n    (void)rewrite;\n    (void)errmsg;\n    (void)text_and_target;\n    (void)enc;\n    (void)nmatch;\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int prog_size = 0;\n    int combined = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate (compile and inspect)\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 5: Validate / propagate results (use values meaningfully)\n    combined = prog_size + (int)enc;\n    cre2_opt_set_case_sensitive(opt, combined & 1);\n    cre2_opt_set_one_line(opt, (combined >> 1) & 1);\n    (void)combined;\n    (void)prog_size;\n    (void)enc;\n    (void)pattern_len;\n    (void)pattern;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:26:33.626395 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 06:26:33.626552 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29820, Completion: 19619, Total: 49439
[2025-11-05 06:26:33.626576 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:26:33.845178 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000140/id_000140.cc
[2025-11-05 06:26:33.845237 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:34.074186 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:34.074253 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:34.077101 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:34.077138 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:34.295940 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000141/id_000141.cc
[2025-11-05 06:26:34.295994 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:34.525765 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:34.525844 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:34.528688 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:34.528718 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:34.745547 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000142/id_000142.cc
[2025-11-05 06:26:34.745636 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:34.975608 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:34.975685 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:34.978569 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:34.978604 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:35.197013 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000143/id_000143.cc
[2025-11-05 06:26:35.197074 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:35.429296 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:35.429377 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:35.432099 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:35.432131 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:35.650813 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000144/id_000144.cc
[2025-11-05 06:26:35.650865 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:35.880256 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:35.880343 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:35.883147 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:35.883179 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:36.099991 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000145/id_000145.cc
[2025-11-05 06:26:36.100041 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:36.329621 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:36.329723 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:36.332265 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:36.332291 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:36.548936 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000146/id_000146.cc
[2025-11-05 06:26:36.548989 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:36.778293 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:36.778357 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:36.781165 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:36.781193 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:36.999391 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000147/id_000147.cc
[2025-11-05 06:26:36.999472 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:37.229704 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:37.229761 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:37.232483 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:37.232511 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:37.450486 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000148/id_000148.cc
[2025-11-05 06:26:37.450537 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:37.680787 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:37.680859 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:37.683600 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:37.683628 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:37.901076 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000149/id_000149.cc
[2025-11-05 06:26:37.901127 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:26:38.130902 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:26:38.131019 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:26:38.133922 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:26:38.133954 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:26:38.133998 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:26:38.134021 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 150, succ: 150, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:26:38.134039 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:26:38.134069 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:26:38.445434 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 149 as an example for the next prompt.
[2025-11-05 06:26:38.445488 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 23 new API pairs in this round.
[2025-11-05 06:26:38.445532 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 23
[2025-11-05 06:26:38.445591 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,9.0,4.0,37.0,31.0,17.0,13.0,30.0,4.0,8.0,22.0,5.0,9.0,60.0,10.0,21.0,27.0,14.0,44.0,14.0,1.0,1.0,1.0,1.0,1.0,4.0,1.0,1.0,1.0,26.0,1.0,21.0,20.0,60.0,1.0,116.0,1.0,1.0,8.0,11.0,1.0,1.0,98.0,1.0,1.0,24.0,1.0,1.0,1.0,51.0,1.0,1.0,1.0,1.0,1.0,23.0,1.0,27.0,1.0,6.0,4.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:26:38.445610 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:26:38.445662 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 116
[2025-11-05 06:26:38.445695 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 37
[2025-11-05 06:26:38.445721 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 60
[2025-11-05 06:26:38.445749 +00:00] INFO [src/feedback/schedule.rs:246] Loop 15: Replaced with lowest energy API: cre2_error_code (energy: 1), prob: 0.2912
[2025-11-05 06:26:38.445765 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 1
[2025-11-05 06:26:38.445798 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_error_code(const cre2_regexp_t * re)
[2025-11-05 06:26:38.446440 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 15, quiet_round: 0, discovered_api_pairs: 339
[2025-11-05 06:26:38.482668 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:26:38.483004 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_error_code(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int prog_size = 0;\n    int combined = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate (compile and inspect)\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 5: Validate / propagate results (use values meaningfully)\n    combined = prog_size + (int)enc;\n    cre2_opt_set_case_sensitive(opt, combined & 1);\n    cre2_opt_set_one_line(opt, (combined >> 1) & 1);\n    (void)combined;\n    (void)prog_size;\n    (void)enc;\n    (void)pattern_len;\n    (void)pattern;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t rewrite;\n    cre2_string_t text_and_target;\n    int easy_res = 0;\n    int prog_size = 0;\n    int replace_res = 0;\n    int combined = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 4: Operate - quick match, compile, inspect program, then replace\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    combined = prog_size + easy_res + matches[0].length;\n    text_and_target.length = text_and_target.length + (combined & 7);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / propagate results (use values to influence state; no branching)\n    (void)easy_res;\n    (void)prog_size;\n    (void)replace_res;\n    (void)combined;\n    (void)matches;\n    (void)rewrite;\n    (void)text_and_target;\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:27:06.692410 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 06:27:06.692529 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29070, Completion: 18738, Total: 47808
[2025-11-05 06:27:06.692550 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:27:06.910678 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000150/id_000150.cc
[2025-11-05 06:27:06.910731 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:07.139230 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:07.139299 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:07.142200 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:07.142233 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:07.359681 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000151/id_000151.cc
[2025-11-05 06:27:07.359742 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:07.588791 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:07.588868 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:07.591593 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:07.591626 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:07.808481 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000152/id_000152.cc
[2025-11-05 06:27:07.808564 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:08.038976 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:08.039034 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:08.041764 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:08.041795 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:08.261546 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000153/id_000153.cc
[2025-11-05 06:27:08.261597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:08.491499 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:08.491565 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:08.494366 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:08.494400 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:08.712686 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000154/id_000154.cc
[2025-11-05 06:27:08.712739 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:08.941553 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:08.941638 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:08.944413 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:08.944446 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:09.161364 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000155/id_000155.cc
[2025-11-05 06:27:09.161416 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:09.390230 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:09.390300 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:09.393175 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:09.393209 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:09.610829 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000156/id_000156.cc
[2025-11-05 06:27:09.610881 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:09.839624 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:09.839682 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:09.842570 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:09.842605 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:10.058568 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000157/id_000157.cc
[2025-11-05 06:27:10.058659 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:10.289090 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:10.289148 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:10.291984 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:10.292016 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:10.509419 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000158/id_000158.cc
[2025-11-05 06:27:10.509472 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:10.738372 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:10.738446 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:10.741273 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:10.741305 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:10.958271 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000159/id_000159.cc
[2025-11-05 06:27:10.958322 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:11.187580 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:11.187686 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:11.190574 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:11.190604 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:11.190641 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:27:11.190656 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 160, succ: 160, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:27:11.190671 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:27:11.190695 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:27:11.477792 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 159 as an example for the next prompt.
[2025-11-05 06:27:11.477846 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 06:27:11.477884 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 06:27:11.477932 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,9.0,4.0,49.0,31.0,17.0,13.0,30.0,7.0,8.0,22.0,5.0,9.0,65.0,10.0,21.0,32.0,14.0,44.0,14.0,12.0,1.0,1.0,1.0,1.0,4.0,1.0,1.0,1.0,26.0,1.0,21.0,20.0,63.0,1.0,124.0,1.0,1.0,8.0,11.0,1.0,1.0,98.0,1.0,1.0,24.0,1.0,1.0,1.0,51.0,1.0,1.0,1.0,1.0,1.0,25.0,1.0,27.0,1.0,6.0,4.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:27:11.477950 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:27:11.478003 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 124
[2025-11-05 06:27:11.478035 +00:00] INFO [src/feedback/schedule.rs:246] Loop 16: Replaced with lowest energy API: cre2_global_replace_re (energy: 1), prob: 0.2903
[2025-11-05 06:27:11.478050 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 1
[2025-11-05 06:27:11.478080 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 98
[2025-11-05 06:27:11.478106 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_full_match energy: 9
[2025-11-05 06:27:11.478155 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 26
[2025-11-05 06:27:11.478197 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch)
[2025-11-05 06:27:11.478935 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 16, quiet_round: 0, discovered_api_pairs: 356
[2025-11-05 06:27:11.540266 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:27:11.540629 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t rewrite;\n    cre2_string_t text_and_target;\n    int easy_res = 0;\n    int prog_size = 0;\n    int replace_res = 0;\n    int combined = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 4: Operate - quick match, compile, inspect program, then replace\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    combined = prog_size + easy_res + matches[0].length;\n    text_and_target.length = text_and_target.length + (combined & 7);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / propagate results (use values to influence state; no branching)\n    (void)easy_res;\n    (void)prog_size;\n    (void)replace_res;\n    (void)combined;\n    (void)matches;\n    (void)rewrite;\n    (void)text_and_target;\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"xx foobar yy\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$2-$1\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_res = 0;\n    int err_code = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Operate (compile and replace)\n    re = cre2_new(pattern, pattern_len, opt);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n    err_code = cre2_error_code(re);\n\n    // step 4: Validate / propagate results (use values meaningfully)\n    text_and_target.length = text_and_target.length + (replace_res & 7);\n    cre2_opt_set_one_line(opt, (err_code + replace_res) & 1);\n    cre2_opt_set_case_sensitive(opt, (err_code >> 1) & 1);\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:27:51.526319 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 06:27:51.526445 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30980, Completion: 24018, Total: 54998
[2025-11-05 06:27:51.526466 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:27:51.752951 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000160/id_000160.cc
[2025-11-05 06:27:51.753003 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:51.982896 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:51.982965 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:51.985787 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:51.985818 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:52.203038 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000161/id_000161.cc
[2025-11-05 06:27:52.203101 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:52.430346 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:52.430422 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:52.433334 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:52.433365 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:52.651272 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000162/id_000162.cc
[2025-11-05 06:27:52.651352 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:52.880912 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:52.880990 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:52.883640 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:52.883673 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:53.099683 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000163/id_000163.cc
[2025-11-05 06:27:53.099738 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:53.330771 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:53.330848 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:53.333770 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:53.333804 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:53.551219 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000164/id_000164.cc
[2025-11-05 06:27:53.551270 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:53.778999 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:53.779107 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:53.781916 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:53.781949 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:53.999182 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000165/id_000165.cc
[2025-11-05 06:27:53.999232 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:54.227712 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:54.227790 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:54.230670 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:54.230703 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:54.449543 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000166/id_000166.cc
[2025-11-05 06:27:54.449596 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:54.678936 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:54.679011 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:54.681818 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:54.681851 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:54.901270 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000167/id_000167.cc
[2025-11-05 06:27:54.901366 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:55.131067 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:55.131144 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:55.133983 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:55.134015 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:55.350727 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000168/id_000168.cc
[2025-11-05 06:27:55.350779 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:55.582681 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:55.582756 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:55.585609 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:55.585642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:55.804393 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000169/id_000169.cc
[2025-11-05 06:27:55.804445 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:27:56.034180 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:27:56.034286 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:27:56.037149 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:27:56.037180 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:27:56.037220 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:27:56.037236 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 170, succ: 170, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:27:56.037251 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:27:56.037277 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:27:56.358857 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 169 as an example for the next prompt.
[2025-11-05 06:27:56.358913 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 22 new API pairs in this round.
[2025-11-05 06:27:56.358965 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 22
[2025-11-05 06:27:56.359016 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,49.0,31.0,17.0,13.0,30.0,10.0,8.0,22.0,5.0,9.0,69.0,10.0,21.0,38.0,14.0,44.0,14.0,12.0,13.0,1.0,1.0,1.0,4.0,1.0,1.0,1.0,37.0,1.0,21.0,20.0,67.0,1.0,132.0,1.0,1.0,8.0,11.0,1.0,1.0,104.0,1.0,1.0,24.0,1.0,1.0,1.0,51.0,1.0,1.0,1.0,1.0,1.0,26.0,1.0,27.0,1.0,6.0,4.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:27:56.359034 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:27:56.359089 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 51
[2025-11-05 06:27:56.359123 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 30
[2025-11-05 06:27:56.359152 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 12
[2025-11-05 06:27:56.359181 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 132
[2025-11-05 06:27:56.359210 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 49
[2025-11-05 06:27:56.359268 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_program_size(const cre2_regexp_t * re),
    int cre2_error_code(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 06:27:56.360039 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 17, quiet_round: 0, discovered_api_pairs: 378
[2025-11-05 06:27:56.400001 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:27:56.400393 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_program_size(const cre2_regexp_t * re),\n    int cre2_error_code(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"xx foobar yy\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$2-$1\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_res = 0;\n    int err_code = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Operate (compile and replace)\n    re = cre2_new(pattern, pattern_len, opt);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n    err_code = cre2_error_code(re);\n\n    // step 4: Validate / propagate results (use values meaningfully)\n    text_and_target.length = text_and_target.length + (replace_res & 7);\n    cre2_opt_set_one_line(opt, (err_code + replace_res) & 1);\n    cre2_opt_set_case_sensitive(opt, (err_code >> 1) & 1);\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t rewrite;\n    cre2_string_t text_and_target;\n    cre2_range_t ranges[4];\n    int easy_res = 0;\n    int full_res = 0;\n    int replace_res = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&ranges, 0, sizeof(ranges));\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 4: Operate - quick match, compile, convert matches to ranges, full match, then global replace\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_strings_to_ranges(input_text, ranges, &matches[0], nmatch);\n    full_res = cre2_full_match(pattern, &text_and_target, &matches[0], nmatch);\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / propagate results (use values to influence state; no branching)\n    text_and_target.length = text_and_target.length + ((easy_res + full_res + replace_res) & 7);\n    cre2_opt_set_one_line(opt, (easy_res + replace_res) & 1);\n    cre2_opt_set_case_sensitive(opt, (full_res >> 1) & 1);\n    ranges[0].start = ranges[0].start + (easy_res & 3);\n    (void)matches;\n    (void)rewrite;\n    (void)input_text_len;\n    (void)pattern_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:28:22.073085 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 25s
[2025-11-05 06:28:22.073205 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31360, Completion: 19274, Total: 50634
[2025-11-05 06:28:22.073225 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:28:22.291225 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000170/id_000170.cc
[2025-11-05 06:28:22.291276 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:22.521246 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:22.521321 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:22.524140 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:22.524173 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:22.741317 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000171/id_000171.cc
[2025-11-05 06:28:22.741368 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:22.979237 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:22.979313 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:22.982180 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:22.982216 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:23.200812 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000172/id_000172.cc
[2025-11-05 06:28:23.200895 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:23.429919 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:23.429975 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:23.432680 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:23.432713 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:23.651362 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000173/id_000173.cc
[2025-11-05 06:28:23.651412 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:23.880989 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:23.881065 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:23.883687 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:23.883719 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:24.103935 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000174/id_000174.cc
[2025-11-05 06:28:24.103986 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:24.333968 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:24.334073 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:24.336917 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:24.336949 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:24.555679 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000175/id_000175.cc
[2025-11-05 06:28:24.555731 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:24.786162 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:24.786238 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:24.789042 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:24.789075 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:25.005735 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000176/id_000176.cc
[2025-11-05 06:28:25.005787 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:25.234917 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:25.234988 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:25.237857 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:25.237888 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:25.456970 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000177/id_000177.cc
[2025-11-05 06:28:25.457053 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:25.687236 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:25.687330 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:25.690219 +00:00] ERROR [src/execution/sanitize.rs:336] cre2 execution failed: stderr=CRE2: internal error: unknown encoding 3
, stdout=
[2025-11-05 06:28:25.690265 +00:00] WARN [src/fuzzer.rs:205] Program 177 failed validation. Attempting to repair. Error: Execution Error: cre2 execution failed: stderr=CRE2: internal error: unknown encoding 3
, stdout=
[2025-11-05 06:28:25.730156 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:28:25.730488 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"start helloworld end\";\n    const char rewrite_template[] = \"$2,$1\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int program_size_val = 0;\n    int err_code = 0;\n    int replace_res = 0;\n    cre2_encoding_t enc_val = CRE2_UNKNOWN;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = input_text;\n    text_and_target.length = (int)(sizeof(input_text) - 1);\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Core operations (compile, query, replace)\n    enc_val = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    program_size_val = cre2_program_size(re);\n    err_code = cre2_error_code(re);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Validate / propagate results (use API outputs meaningfully)\n    text_and_target.length = text_and_target.length + ((program_size_val + err_code + replace_res + (int)enc_val) & 7);\n    cre2_opt_set_one_line(opt, (err_code + replace_res) & 1);\n    cre2_opt_set_case_sensitive(opt, (program_size_val >> 1) & 1);\n    cre2_opt_set_encoding(opt, (cre2_encoding_t)((program_size_val + err_code + replace_res) & 3));\n    (void)pattern_len;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Execution Error\nError Details:cre2 execution failed: stderr=CRE2: internal error: unknown encoding 3\n, stdout=\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:28:47.659284 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 06:28:47.659420 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22200, Completion: 15268, Total: 37468
[2025-11-05 06:28:47.881911 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000177/id_000177.cc
[2025-11-05 06:28:47.881962 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:48.114126 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:48.114191 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:48.116927 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:48.116958 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:48.116989 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 177!
[2025-11-05 06:28:48.334844 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000178/id_000178.cc
[2025-11-05 06:28:48.334896 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:48.562609 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:48.562688 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:48.565377 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:48.565406 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:48.783086 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000179/id_000179.cc
[2025-11-05 06:28:48.783168 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:28:49.013920 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:28:49.013990 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:28:49.016463 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:28:49.016495 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:28:49.016531 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:28:49.016547 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 180, succ: 180, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:28:49.016562 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 0
[2025-11-05 06:28:49.016586 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:28:49.324216 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 179 as an example for the next prompt.
[2025-11-05 06:28:49.324271 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 47 new API pairs in this round.
[2025-11-05 06:28:49.324337 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 47
[2025-11-05 06:28:49.324385 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,62.0,42.0,17.0,13.0,41.0,16.0,8.0,22.0,5.0,9.0,74.0,10.0,21.0,57.0,14.0,46.0,14.0,27.0,13.0,1.0,1.0,1.0,7.0,1.0,1.0,1.0,37.0,1.0,21.0,29.0,81.0,1.0,144.0,1.0,1.0,8.0,11.0,1.0,1.0,104.0,1.0,1.0,24.0,1.0,1.0,1.0,67.0,1.0,1.0,1.0,1.0,1.0,28.0,1.0,27.0,4.0,6.0,4.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
[2025-11-05 06:28:49.324403 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:28:49.324452 +00:00] INFO [src/feedback/schedule.rs:246] Loop 18: Replaced with lowest energy API: cre2_set_delete (energy: 1), prob: 0.2883
[2025-11-05 06:28:49.324474 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 1
[2025-11-05 06:28:49.324505 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 42
[2025-11-05 06:28:49.324532 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 10
[2025-11-05 06:28:49.324558 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 81
[2025-11-05 06:28:49.324592 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_set_delete(cre2_set * set),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)
[2025-11-05 06:28:49.325262 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 18, quiet_round: 0, discovered_api_pairs: 425
[2025-11-05 06:28:49.376337 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:28:49.376723 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_set_delete(cre2_set * set),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$1-$2\";\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t rewrite;\n    cre2_string_t text_and_target;\n    cre2_range_t ranges[4];\n    int easy_res = 0;\n    int full_res = 0;\n    int replace_res = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&ranges, 0, sizeof(ranges));\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 4: Operate - quick match, compile, convert matches to ranges, full match, then global replace\n    easy_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_strings_to_ranges(input_text, ranges, &matches[0], nmatch);\n    full_res = cre2_full_match(pattern, &text_and_target, &matches[0], nmatch);\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / propagate results (use values to influence state; no branching)\n    text_and_target.length = text_and_target.length + ((easy_res + full_res + replace_res) & 7);\n    cre2_opt_set_one_line(opt, (easy_res + replace_res) & 1);\n    cre2_opt_set_case_sensitive(opt, (full_res >> 1) & 1);\n    ranges[0].start = ranges[0].start + (easy_res & 3);\n    (void)matches;\n    (void)rewrite;\n    (void)input_text_len;\n    (void)pattern_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"greeting: helloworld end\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$2,$1!\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_res = 0;\n    int prog_size = 0;\n    int err_code = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Core operations (compile and replace)\n    re = cre2_new(pattern, pattern_len, opt);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Inspect results\n    prog_size = cre2_program_size(re);\n    err_code = cre2_error_code(re);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate / propagate results (use values meaningfully; no branching)\n    text_and_target.length = text_and_target.length + ((replace_res + prog_size + err_code) & 7);\n    rewrite.length = rewrite.length + ((err_code ^ replace_res) & 3);\n    cre2_opt_set_one_line(opt, ((int)enc + replace_res + prog_size) & 1);\n    cre2_opt_set_case_sensitive(opt, (prog_size >> 1) & 1);\n    cre2_opt_set_never_nl(opt, (err_code + replace_res) & 1);\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:29:21.970921 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 06:29:21.971047 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32840, Completion: 23230, Total: 56070
[2025-11-05 06:29:21.971067 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:29:22.191141 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000180/id_000180.cc
[2025-11-05 06:29:22.191194 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:29:22.420244 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:29:22.420320 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:29:22.423122 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:29:22.423153 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:29:22.640075 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000181/id_000181.cc
[2025-11-05 06:29:22.640127 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:29:22.870099 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:29:22.870168 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:29:22.872861 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:29:22.872914 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:29:23.093046 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000182/id_000182.cc
[2025-11-05 06:29:23.093132 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:29:23.321796 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:29:23.321873 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:29:23.324567 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:29:23.324598 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:29:23.545469 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000183/id_000183.cc
[2025-11-05 06:29:23.545519 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:29:23.774143 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:29:23.774220 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:29:23.777010 +00:00] ERROR [src/execution/sanitize.rs:336] cre2 execution failed: stderr=CRE2: internal error: unknown encoding 0
, stdout=
[2025-11-05 06:29:23.777056 +00:00] WARN [src/fuzzer.rs:205] Program 183 failed validation. Attempting to repair. Error: Execution Error: cre2 execution failed: stderr=CRE2: internal error: unknown encoding 0
, stdout=
[2025-11-05 06:29:23.828196 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:29:23.828527 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    int match_res = 0;\n    int nmatch = 3;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure set and compile it\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, \"foo\");\n    cre2_set_add_simple(set, \"bar\");\n    cre2_set_compile(set);\n\n    // step 4: Compile regexp and perform a match\n    re = cre2_new(pattern, pattern_len, opt);\n    match_res = cre2_match(re, input_text, input_text_len, 0, input_text_len, CRE2_UNANCHORED, &matches[0], nmatch);\n\n    // step 5: Validate / propagate results (use values to influence state; no branching)\n    matches[0].length = matches[0].length + ((match_res + pattern_len) & 7);\n    cre2_opt_set_case_sensitive(opt, (match_res >> 1) & 1);\n    cre2_opt_set_encoding(opt, (cre2_encoding_t)(CRE2_UTF8 + ((match_res & 1) * (CRE2_Latin1 - CRE2_UTF8))));\n    (void)nmatch;\n    (void)input_text_len;\n    (void)pattern_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_set_case_sensitive(opt, 0);\n    cre2_opt_set_encoding(opt, CRE2_UNKNOWN);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Execution Error\nError Details:cre2 execution failed: stderr=CRE2: internal error: unknown encoding 0\n, stdout=\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:30:10.310528 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 06:30:10.310654 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22420, Completion: 24957, Total: 47377
[2025-11-05 06:30:10.528458 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000183/id_000183.cc
[2025-11-05 06:30:10.528513 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:10.758075 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:10.758150 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:10.760927 +00:00] ERROR [src/execution/sanitize.rs:336] cre2 execution failed: stderr=CRE2: internal error: unknown encoding 0
, stdout=
[2025-11-05 06:30:10.760971 +00:00] ERROR [src/fuzzer.rs:220] Repair failed for program 183. Final error: Execution Error: cre2 execution failed: stderr=CRE2: internal error: unknown encoding 0
, stdout=
[2025-11-05 06:30:10.978670 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000184/id_000184.cc
[2025-11-05 06:30:10.978720 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:11.213304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:11.213381 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:11.216204 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:11.216236 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:11.436294 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000185/id_000185.cc
[2025-11-05 06:30:11.436378 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:11.668021 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:11.668097 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:11.670769 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:11.670802 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:11.892828 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000186/id_000186.cc
[2025-11-05 06:30:11.892882 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:12.124689 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:12.124765 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:12.127485 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:12.127518 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:12.346108 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000187/id_000187.cc
[2025-11-05 06:30:12.346160 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:12.574503 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:12.574632 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:12.577262 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:12.577297 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:12.799503 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000188/id_000188.cc
[2025-11-05 06:30:12.799557 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:13.029331 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:13.029408 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:13.032166 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:13.032198 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:13.252938 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000189/id_000189.cc
[2025-11-05 06:30:13.252990 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:13.482895 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:13.482981 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:13.485689 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:13.485719 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:13.485766 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 9, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:30:13.485786 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 190, succ: 189, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:30:13.485802 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:30:13.485830 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 9 successful programs. Sanitize those programs!
[2025-11-05 06:30:13.749746 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 189 as an example for the next prompt.
[2025-11-05 06:30:13.749825 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 49 new API pairs in this round.
[2025-11-05 06:30:13.749894 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 49
[2025-11-05 06:30:13.749941 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,62.0,64.0,17.0,13.0,41.0,16.0,8.0,22.0,5.0,9.0,81.0,22.0,21.0,57.0,14.0,51.0,14.0,27.0,13.0,7.0,1.0,1.0,7.0,1.0,1.0,14.0,37.0,1.0,21.0,29.0,104.0,1.0,155.0,1.0,18.0,8.0,11.0,1.0,1.0,104.0,1.0,1.0,24.0,4.0,1.0,1.0,67.0,1.0,1.0,7.0,1.0,1.0,30.0,1.0,27.0,4.0,6.0,4.0,1.0,1.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:30:13.749957 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:30:13.750013 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 81
[2025-11-05 06:30:13.750044 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 104
[2025-11-05 06:30:13.750073 +00:00] INFO [src/feedback/schedule.rs:246] Loop 19: Replaced with lowest energy API: cre2_named_groups_iter_next (energy: 1), prob: 0.2871
[2025-11-05 06:30:13.750087 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_next energy: 1
[2025-11-05 06:30:13.750142 +00:00] INFO [src/feedback/schedule.rs:246] Loop 19: Replaced with lowest energy API: cre2_named_groups_iter_next (energy: 1), prob: 0.2871
[2025-11-05 06:30:13.750170 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 155
[2025-11-05 06:30:13.750205 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 06:30:13.750847 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 19, quiet_round: 0, discovered_api_pairs: 474
[2025-11-05 06:30:13.800765 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:30:13.801166 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"greeting: helloworld end\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_template[] = \"$2,$1!\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_res = 0;\n    int prog_size = 0;\n    int err_code = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = input_text;\n    text_and_target.length = input_text_len;\n    rewrite.data = rewrite_template;\n    rewrite.length = (int)(sizeof(rewrite_template) - 1);\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Core operations (compile and replace)\n    re = cre2_new(pattern, pattern_len, opt);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Inspect results\n    prog_size = cre2_program_size(re);\n    err_code = cre2_error_code(re);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate / propagate results (use values meaningfully; no branching)\n    text_and_target.length = text_and_target.length + ((replace_res + prog_size + err_code) & 7);\n    rewrite.length = rewrite.length + ((err_code ^ replace_res) & 3);\n    cre2_opt_set_one_line(opt, ((int)enc + replace_res + prog_size) & 1);\n    cre2_opt_set_case_sensitive(opt, (prog_size >> 1) & 1);\n    cre2_opt_set_never_nl(opt, (err_code + replace_res) & 1);\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"pre testing post\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t matches[4];\n    int set_match_idxs[4];\n    int match_res = 0;\n    size_t set_res = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&set_match_idxs, 0, sizeof(set_match_idxs));\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    match_res = cre2_match(re, input_text, input_text_len, 0, input_text_len, CRE2_UNANCHORED, &matches[0], nmatch);\n    set_res = cre2_set_match(set, input_text, (size_t)input_text_len, set_match_idxs, 4);\n\n    // step 5: Validate / propagate results (use values to influence state; no branching)\n    matches[0].length = matches[0].length + ((match_res + (int)set_res) & 7);\n    cre2_opt_set_case_sensitive(opt, (match_res >> 1) & 1);\n    cre2_opt_set_encoding(opt, ((set_res & 1) != 0) ? CRE2_Latin1 : CRE2_UTF8);\n    set_match_idxs[0] = set_match_idxs[0] + ((int)match_res & 3);\n    (void)matches;\n    (void)set_match_idxs;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:30:53.954964 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 06:30:53.955089 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31570, Completion: 23761, Total: 55331
[2025-11-05 06:30:53.955109 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:30:54.175880 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000190/id_000190.cc
[2025-11-05 06:30:54.175937 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:54.405229 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:54.405297 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:54.408060 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:54.408092 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:54.625656 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000191/id_000191.cc
[2025-11-05 06:30:54.625709 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:54.857010 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:54.857079 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:54.859844 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:54.859874 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:55.077767 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000192/id_000192.cc
[2025-11-05 06:30:55.077852 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:55.308705 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:55.308800 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:55.311866 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:55.311898 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:55.532822 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000193/id_000193.cc
[2025-11-05 06:30:55.532873 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:55.762284 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:55.762354 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:55.764785 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:55.764817 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:55.983085 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000194/id_000194.cc
[2025-11-05 06:30:55.983138 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:56.211457 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:56.211551 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:56.213992 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:56.214024 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:56.436060 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000195/id_000195.cc
[2025-11-05 06:30:56.436112 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:56.665916 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:56.665983 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:56.668877 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:56.668909 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:56.886893 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000196/id_000196.cc
[2025-11-05 06:30:56.886947 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:57.114735 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:57.114809 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:57.117837 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:57.117866 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:57.335573 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000197/id_000197.cc
[2025-11-05 06:30:57.335657 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:57.563011 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:57.563076 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:57.565754 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:57.565784 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:57.784398 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000198/id_000198.cc
[2025-11-05 06:30:57.784452 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:58.011398 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:58.011466 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:58.014468 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:58.014500 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:58.232285 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000199/id_000199.cc
[2025-11-05 06:30:58.232339 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:30:58.459924 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:30:58.460027 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:30:58.462654 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:30:58.462686 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:30:58.462725 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:30:58.462740 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 200, succ: 199, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:30:58.462755 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:30:58.462782 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:30:58.753365 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 199 as an example for the next prompt.
[2025-11-05 06:30:58.753419 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 28 new API pairs in this round.
[2025-11-05 06:30:58.753473 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 28
[2025-11-05 06:30:58.753523 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,62.0,64.0,17.0,13.0,44.0,16.0,8.0,22.0,5.0,9.0,89.0,22.0,21.0,64.0,14.0,51.0,14.0,30.0,13.0,7.0,13.0,1.0,7.0,1.0,1.0,14.0,37.0,1.0,21.0,32.0,108.0,1.0,162.0,13.0,18.0,8.0,11.0,1.0,1.0,114.0,1.0,1.0,24.0,4.0,1.0,1.0,67.0,1.0,1.0,7.0,1.0,1.0,32.0,1.0,27.0,4.0,6.0,4.0,1.0,13.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:30:58.753541 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:30:58.753594 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 89
[2025-11-05 06:30:58.753626 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 13
[2025-11-05 06:30:58.753665 +00:00] INFO [src/feedback/schedule.rs:246] Loop 20: Replaced with lowest energy API: cre2_extract_re (energy: 1), prob: 0.2858
[2025-11-05 06:30:58.753681 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 1
[2025-11-05 06:30:58.753710 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 13
[2025-11-05 06:30:58.753746 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)
[2025-11-05 06:30:58.754397 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 20, quiet_round: 0, discovered_api_pairs: 502
[2025-11-05 06:30:58.789390 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:30:58.789723 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"pre testing post\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t matches[4];\n    int set_match_idxs[4];\n    int match_res = 0;\n    size_t set_res = 0;\n\n    // step 2: Setup\n    memset(&matches, 0, sizeof(matches));\n    memset(&set_match_idxs, 0, sizeof(set_match_idxs));\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Operate\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    match_res = cre2_match(re, input_text, input_text_len, 0, input_text_len, CRE2_UNANCHORED, &matches[0], nmatch);\n    set_res = cre2_set_match(set, input_text, (size_t)input_text_len, set_match_idxs, 4);\n\n    // step 5: Validate / propagate results (use values to influence state; no branching)\n    matches[0].length = matches[0].length + ((match_res + (int)set_res) & 7);\n    cre2_opt_set_case_sensitive(opt, (match_res >> 1) & 1);\n    cre2_opt_set_encoding(opt, ((set_res & 1) != 0) ? CRE2_Latin1 : CRE2_UTF8);\n    set_match_idxs[0] = set_match_idxs[0] + ((int)match_res & 3);\n    (void)matches;\n    (void)set_match_idxs;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[4];\n    const char * ng_name = NULL;\n    int ng_index = 0;\n    int match_res = 0;\n    const int nmatch = 4;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Core operations\n    match_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    cre2_named_groups_iter_next(iter, &ng_name, &ng_index);\n\n    // step 4: Inspect results\n    matches[0].length = matches[0].length + ((match_res + ng_index) & 7);\n    ng_index = ng_index + (matches[0].length & 3);\n    (void)ng_name;\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 5: Validate / propagate results\n    matches[1].length = matches[1].length + ((matches[0].length + match_res) & 3);\n    matches[2].length = matches[2].length + ((ng_index ^ match_res) & 1);\n    (void)matches;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:31:34.938597 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 36s
[2025-11-05 06:31:34.938730 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30260, Completion: 26697, Total: 56957
[2025-11-05 06:31:34.938754 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:31:35.159448 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000200/id_000200.cc
[2025-11-05 06:31:35.159499 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:35.389298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:35.389367 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:35.392246 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:35.392278 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:35.609815 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000201/id_000201.cc
[2025-11-05 06:31:35.609865 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:35.838309 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:35.838385 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:35.841297 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:35.841328 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:36.058280 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000202/id_000202.cc
[2025-11-05 06:31:36.058361 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:36.291354 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:36.291431 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:36.294119 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:36.294152 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:36.515532 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000203/id_000203.cc
[2025-11-05 06:31:36.515583 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:36.747828 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:36.747905 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:36.750755 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:36.750787 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:36.968925 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000204/id_000204.cc
[2025-11-05 06:31:36.968978 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:37.196273 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:37.196388 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:37.199643 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:37.199676 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:37.415979 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000205/id_000205.cc
[2025-11-05 06:31:37.416030 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:37.646036 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:37.646096 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:37.648712 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:37.648739 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:37.866461 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000206/id_000206.cc
[2025-11-05 06:31:37.866516 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:38.097940 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:38.098013 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:38.100469 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:38.100501 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:38.316576 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000207/id_000207.cc
[2025-11-05 06:31:38.316669 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:38.547949 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:38.548023 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:38.550861 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:38.550893 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:38.769374 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000208/id_000208.cc
[2025-11-05 06:31:38.769434 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:38.997831 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:38.997904 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:39.000400 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:39.000432 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:39.218651 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000209/id_000209.cc
[2025-11-05 06:31:39.218703 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:31:39.450848 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:31:39.450991 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:31:39.453665 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:31:39.453698 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:31:39.453736 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:31:39.453753 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 210, succ: 209, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:31:39.453769 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:31:39.453793 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:31:39.771161 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 209 as an example for the next prompt.
[2025-11-05 06:31:39.771216 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 36 new API pairs in this round.
[2025-11-05 06:31:39.771278 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 36
[2025-11-05 06:31:39.771326 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,62.0,68.0,17.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,91.0,22.0,21.0,64.0,14.0,52.0,14.0,30.0,30.0,7.0,19.0,16.0,10.0,1.0,1.0,14.0,37.0,1.0,21.0,35.0,121.0,1.0,171.0,26.0,18.0,8.0,11.0,1.0,1.0,114.0,1.0,1.0,24.0,4.0,1.0,1.0,67.0,1.0,1.0,7.0,1.0,1.0,32.0,1.0,27.0,4.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:31:39.771345 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:31:39.771394 +00:00] INFO [src/feedback/schedule.rs:246] Loop 21: Replaced with lowest energy API: cre2_opt_never_capture (energy: 1), prob: 0.2844
[2025-11-05 06:31:39.771417 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_capture energy: 1
[2025-11-05 06:31:39.771444 +00:00] INFO [src/feedback/schedule.rs:246] Loop 21: Replaced with lowest energy API: cre2_opt_never_capture (energy: 1), prob: 0.2844
[2025-11-05 06:31:39.771470 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 62
[2025-11-05 06:31:39.771499 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 114
[2025-11-05 06:31:39.771525 +00:00] INFO [src/feedback/schedule.rs:246] Loop 21: Replaced with lowest energy API: cre2_opt_never_capture (energy: 1), prob: 0.2844
[2025-11-05 06:31:39.771550 +00:00] INFO [src/feedback/schedule.rs:246] Loop 21: Replaced with lowest energy API: cre2_opt_never_capture (energy: 1), prob: 0.2844
[2025-11-05 06:31:39.771577 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 67
[2025-11-05 06:31:39.771602 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 68
[2025-11-05 06:31:39.771640 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_never_capture(cre2_options_t * opt),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc)
[2025-11-05 06:31:39.772405 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 21, quiet_round: 0, discovered_api_pairs: 538
[2025-11-05 06:31:39.820640 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:31:39.820999 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_never_capture(cre2_options_t * opt),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[4];\n    const char * ng_name = NULL;\n    int ng_index = 0;\n    int match_res = 0;\n    const int nmatch = 4;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Core operations\n    match_res = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    cre2_named_groups_iter_next(iter, &ng_name, &ng_index);\n\n    // step 4: Inspect results\n    matches[0].length = matches[0].length + ((match_res + ng_index) & 7);\n    ng_index = ng_index + (matches[0].length & 3);\n    (void)ng_name;\n    (void)pattern_len;\n    (void)input_text_len;\n\n    // step 5: Validate / propagate results\n    matches[1].length = matches[1].length + ((matches[0].length + match_res) & 3);\n    matches[2].length = matches[2].length + ((ng_index ^ match_res) & 1);\n    (void)matches;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char original_text[] = \"prefix foobar suffix\";\n    const int original_text_len = (int)(sizeof(original_text) - 1);\n    char text_buf[128];\n    char target_buf[128];\n    const char rewrite_literal[] = \"$2-$1\";\n    const int rewrite_len = (int)(sizeof(rewrite_literal) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_s;\n    cre2_string_t target_s;\n    const char * ng_name = NULL;\n    int ng_index = 0;\n    int res_replace = 0;\n    int res_extract = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_s, 0, sizeof(rewrite_s));\n    memset(&target_s, 0, sizeof(target_s));\n    /* initialize regex and iterator */\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    /* prepare strings */\n    /* copy original text into mutable buffer for in-place global replace */\n    memcpy(text_buf, original_text, (size_t)original_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = original_text_len;\n    rewrite_s.data = rewrite_literal;\n    rewrite_s.length = rewrite_len;\n    target_s.data = target_buf;\n    target_s.length = 0;\n    (void)opt;\n    (void)pattern_len;\n    (void)original_text_len;\n\n    // step 3: Core operations\n    /* perform a global replace using the compiled regex */\n    res_replace = cre2_global_replace_re(re, &text_and_target, &rewrite_s);\n    /* attempt to extract using the same regex and rewrite pattern into target */\n    res_extract = cre2_extract_re(re, &text_and_target, &rewrite_s, &target_s);\n    /* fetch one named group from the regex (if any) */\n    cre2_named_groups_iter_next(iter, &ng_name, &ng_index);\n\n    // step 4: Inspect results\n    /* propagate integer results into string lengths to influence state */\n    target_s.length = target_s.length + ((res_replace + res_extract + ng_index) & 7);\n    text_and_target.length = text_and_target.length + ((target_s.length) & 3);\n    rewrite_s.length = rewrite_s.length + (res_replace & 1);\n    /* touch retrieved name pointer to avoid unused warning */\n    (void)ng_name;\n\n    // step 5: Validate / propagate results\n    /* further mix values into buffers to reflect dependent state */\n    /* adjust first characters within bounds without branching */\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)text_and_target.length & 0x7));\n    target_buf[0] = (char)((unsigned char)target_buf[0] + ((unsigned)target_s.length & 0x7));\n    (void)rewrite_s;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:32:20.730201 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 06:32:20.730322 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33040, Completion: 25854, Total: 58894
[2025-11-05 06:32:20.730343 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:32:20.950643 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000210/id_000210.cc
[2025-11-05 06:32:20.950694 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:21.183854 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:21.183930 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:21.186804 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:21.186837 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:21.405568 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000211/id_000211.cc
[2025-11-05 06:32:21.405622 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:21.637901 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:21.637988 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:21.640732 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:21.640792 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:21.857799 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000212/id_000212.cc
[2025-11-05 06:32:21.857888 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:22.087971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:22.088045 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:22.090838 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:22.090871 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:22.308711 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000213/id_000213.cc
[2025-11-05 06:32:22.308763 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:22.538756 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:22.538826 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:22.541344 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:22.541377 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:22.759487 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000214/id_000214.cc
[2025-11-05 06:32:22.759540 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:22.989755 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:22.989871 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:22.992755 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:22.992788 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:23.211134 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000215/id_000215.cc
[2025-11-05 06:32:23.211186 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:23.441894 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:23.441972 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:23.444840 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:23.444871 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:23.663992 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000216/id_000216.cc
[2025-11-05 06:32:23.664044 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:23.896878 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:23.896938 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:23.899653 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:23.899685 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:24.117219 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000217/id_000217.cc
[2025-11-05 06:32:24.117303 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:24.349386 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:24.349445 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:24.352098 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:24.352130 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:24.570170 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000218/id_000218.cc
[2025-11-05 06:32:24.570223 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:24.803163 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:24.803230 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:24.805798 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:24.805830 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:25.026174 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000219/id_000219.cc
[2025-11-05 06:32:25.026226 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:32:25.256358 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:32:25.256463 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:32:25.259100 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:32:25.259132 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:32:25.259171 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:32:25.259187 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 220, succ: 219, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:32:25.259202 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:32:25.259227 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:32:25.588188 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 219 as an example for the next prompt.
[2025-11-05 06:32:25.588247 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 37 new API pairs in this round.
[2025-11-05 06:32:25.588304 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 37
[2025-11-05 06:32:25.588352 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,69.0,81.0,17.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,93.0,22.0,21.0,64.0,14.0,55.0,14.0,30.0,30.0,7.0,19.0,16.0,10.0,18.0,1.0,14.0,37.0,1.0,21.0,35.0,121.0,1.0,188.0,26.0,18.0,8.0,11.0,1.0,1.0,124.0,1.0,1.0,24.0,4.0,10.0,1.0,84.0,1.0,1.0,7.0,1.0,1.0,32.0,1.0,27.0,4.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:32:25.588371 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:32:25.588423 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 188
[2025-11-05 06:32:25.588455 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 121
[2025-11-05 06:32:25.588482 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 35
[2025-11-05 06:32:25.588510 +00:00] INFO [src/feedback/schedule.rs:246] Loop 22: Replaced with lowest energy API: cre2_find_and_consume (energy: 1), prob: 0.2828
[2025-11-05 06:32:25.588526 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume energy: 1
[2025-11-05 06:32:25.588554 +00:00] INFO [src/feedback/schedule.rs:246] Loop 22: Replaced with lowest energy API: cre2_find_and_consume (energy: 1), prob: 0.2828
[2025-11-05 06:32:25.588580 +00:00] INFO [src/feedback/schedule.rs:246] Loop 22: Replaced with lowest energy API: cre2_find_and_consume (energy: 1), prob: 0.2828
[2025-11-05 06:32:25.588609 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_string energy: 17
[2025-11-05 06:32:25.588664 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    const char *cre2_version_string()
[2025-11-05 06:32:25.589444 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 22, quiet_round: 0, discovered_api_pairs: 575
[2025-11-05 06:32:25.633851 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:32:25.634216 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    const char *cre2_version_string()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char original_text[] = \"prefix foobar suffix\";\n    const int original_text_len = (int)(sizeof(original_text) - 1);\n    char text_buf[128];\n    char target_buf[128];\n    const char rewrite_literal[] = \"$2-$1\";\n    const int rewrite_len = (int)(sizeof(rewrite_literal) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_s;\n    cre2_string_t target_s;\n    const char * ng_name = NULL;\n    int ng_index = 0;\n    int res_replace = 0;\n    int res_extract = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_s, 0, sizeof(rewrite_s));\n    memset(&target_s, 0, sizeof(target_s));\n    /* initialize regex and iterator */\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    /* prepare strings */\n    /* copy original text into mutable buffer for in-place global replace */\n    memcpy(text_buf, original_text, (size_t)original_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = original_text_len;\n    rewrite_s.data = rewrite_literal;\n    rewrite_s.length = rewrite_len;\n    target_s.data = target_buf;\n    target_s.length = 0;\n    (void)opt;\n    (void)pattern_len;\n    (void)original_text_len;\n\n    // step 3: Core operations\n    /* perform a global replace using the compiled regex */\n    res_replace = cre2_global_replace_re(re, &text_and_target, &rewrite_s);\n    /* attempt to extract using the same regex and rewrite pattern into target */\n    res_extract = cre2_extract_re(re, &text_and_target, &rewrite_s, &target_s);\n    /* fetch one named group from the regex (if any) */\n    cre2_named_groups_iter_next(iter, &ng_name, &ng_index);\n\n    // step 4: Inspect results\n    /* propagate integer results into string lengths to influence state */\n    target_s.length = target_s.length + ((res_replace + res_extract + ng_index) & 7);\n    text_and_target.length = text_and_target.length + ((target_s.length) & 3);\n    rewrite_s.length = rewrite_s.length + (res_replace & 1);\n    /* touch retrieved name pointer to avoid unused warning */\n    (void)ng_name;\n\n    // step 5: Validate / propagate results\n    /* further mix values into buffers to reflect dependent state */\n    /* adjust first characters within bounds without branching */\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)text_and_target.length & 0x7));\n    target_buf[0] = (char)((unsigned char)target_buf[0] + ((unsigned)target_s.length & 0x7));\n    (void)rewrite_s;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_literal[] = \"$2-$1\";\n    const int rewrite_len = (int)(sizeof(rewrite_literal) - 1);\n    char text_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_s;\n    int res_match = 0;\n    int res_replace = 0;\n    const int nmatch = 4;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int never_cap = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(matches, 0, sizeof(matches));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_s, 0, sizeof(rewrite_s));\n    memcpy(text_buf, input_text, (size_t)input_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = input_text_len;\n    rewrite_s.data = rewrite_literal;\n    rewrite_s.length = rewrite_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_never_capture(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    enc = cre2_opt_encoding(opt);\n    never_cap = cre2_opt_never_capture(opt);\n    res_match = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    res_replace = cre2_replace_re(re, &text_and_target, &rewrite_s);\n\n    // step 4: Inspect results\n    matches[0].length = matches[0].length + ((res_match + (int)enc) & 7);\n    matches[1].length = matches[1].length + ((res_replace + never_cap) & 3);\n    text_and_target.length = text_and_target.length + ((matches[0].length ^ matches[1].length) & 0xF);\n    rewrite_s.length = rewrite_s.length + ((res_replace + res_match) & 1);\n\n    // step 5: Validate / propagate results\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)text_and_target.length & 0x7));\n    text_buf[1] = (char)((unsigned char)text_buf[1] + ((unsigned)matches[0].length & 0x7));\n    (void)matches;\n    (void)enc;\n    (void)never_cap;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:33:06.703457 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 06:33:06.703583 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 35140, Completion: 23984, Total: 59124
[2025-11-05 06:33:06.703604 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:33:06.920364 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000220/id_000220.cc
[2025-11-05 06:33:06.920417 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:07.149595 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:07.149662 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:07.152277 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:07.152308 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:07.372601 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000221/id_000221.cc
[2025-11-05 06:33:07.372671 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:07.601914 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:07.601971 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:07.604883 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:07.604915 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:07.823458 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000222/id_000222.cc
[2025-11-05 06:33:07.823540 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:08.053135 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:08.053200 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:08.055989 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:08.056021 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:08.272302 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000223/id_000223.cc
[2025-11-05 06:33:08.272358 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:08.502985 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:08.503053 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:08.505898 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:08.505930 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:08.723504 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000224/id_000224.cc
[2025-11-05 06:33:08.723560 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:08.953569 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:08.953664 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:08.956375 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:08.956406 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:09.174919 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000225/id_000225.cc
[2025-11-05 06:33:09.174972 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:09.403314 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:09.403370 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:09.406126 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:09.406158 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:09.624109 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000226/id_000226.cc
[2025-11-05 06:33:09.624163 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:09.853356 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:09.853416 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:09.856294 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:09.856326 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:10.073614 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000227/id_000227.cc
[2025-11-05 06:33:10.073699 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:10.311436 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:10.311508 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:10.314254 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:10.314286 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:10.531573 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000228/id_000228.cc
[2025-11-05 06:33:10.531629 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:10.761267 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:10.761324 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:10.764155 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:10.764186 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:10.984050 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000229/id_000229.cc
[2025-11-05 06:33:10.984103 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:11.214764 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:11.214851 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:11.217558 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:11.217591 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:11.217629 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:33:11.217644 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 230, succ: 229, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:33:11.217658 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:33:11.217685 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:33:11.537389 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 229 as an example for the next prompt.
[2025-11-05 06:33:11.537444 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 18 new API pairs in this round.
[2025-11-05 06:33:11.537483 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 18
[2025-11-05 06:33:11.537531 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,99.0,22.0,21.0,64.0,14.0,55.0,14.0,30.0,30.0,7.0,19.0,16.0,10.0,18.0,13.0,14.0,37.0,1.0,21.0,41.0,124.0,1.0,195.0,26.0,18.0,8.0,11.0,1.0,1.0,124.0,1.0,1.0,24.0,4.0,10.0,1.0,84.0,1.0,1.0,7.0,1.0,1.0,34.0,1.0,29.0,4.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:33:11.537549 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:33:11.537602 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 84
[2025-11-05 06:33:11.537635 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 195
[2025-11-05 06:33:11.537662 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 124
[2025-11-05 06:33:11.537687 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 24
[2025-11-05 06:33:11.537720 +00:00] INFO [src/feedback/schedule.rs:246] Loop 23: Replaced with lowest energy API: cre2_error_arg (energy: 1), prob: 0.2811
[2025-11-05 06:33:11.537740 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_arg energy: 1
[2025-11-05 06:33:11.537786 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    void cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg)
[2025-11-05 06:33:11.538595 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 23, quiet_round: 0, discovered_api_pairs: 593
[2025-11-05 06:33:11.585799 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:33:11.586175 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    void cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"prefix foobar suffix\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    const char rewrite_literal[] = \"$2-$1\";\n    const int rewrite_len = (int)(sizeof(rewrite_literal) - 1);\n    char text_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_s;\n    int res_match = 0;\n    int res_replace = 0;\n    const int nmatch = 4;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int never_cap = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(matches, 0, sizeof(matches));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_s, 0, sizeof(rewrite_s));\n    memcpy(text_buf, input_text, (size_t)input_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = input_text_len;\n    rewrite_s.data = rewrite_literal;\n    rewrite_s.length = rewrite_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_never_capture(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    enc = cre2_opt_encoding(opt);\n    never_cap = cre2_opt_never_capture(opt);\n    res_match = cre2_easy_match(pattern, pattern_len, input_text, input_text_len, &matches[0], nmatch);\n    res_replace = cre2_replace_re(re, &text_and_target, &rewrite_s);\n\n    // step 4: Inspect results\n    matches[0].length = matches[0].length + ((res_match + (int)enc) & 7);\n    matches[1].length = matches[1].length + ((res_replace + never_cap) & 3);\n    text_and_target.length = text_and_target.length + ((matches[0].length ^ matches[1].length) & 0xF);\n    rewrite_s.length = rewrite_s.length + ((res_replace + res_match) & 1);\n\n    // step 5: Validate / propagate results\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)text_and_target.length & 0x7));\n    text_buf[1] = (char)((unsigned char)text_buf[1] + ((unsigned)matches[0].length & 0x7));\n    (void)matches;\n    (void)enc;\n    (void)never_cap;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"item-123 extra\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    char text_buf[128];\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t match_s;\n    const char * ver = NULL;\n    const char * compiled_pat = NULL;\n    int res_find = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&match_s, 0, sizeof(match_s));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    memcpy(text_buf, input_text, (size_t)input_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = input_text_len;\n    match_s.data = target_buf;\n    match_s.length = 0;\n\n    // step 3: Core operations\n    res_find = cre2_find_and_consume(pattern, &text_and_target, &match_s, nmatch);\n    ver = cre2_version_string();\n    compiled_pat = cre2_pattern(re);\n\n    // step 4: Inspect results\n    match_s.length = match_s.length + ((res_find & 7) + ((ver != NULL) ? ((int)ver[0] & 3) : 0));\n    text_and_target.length = text_and_target.length + ((match_s.length ^ (int)(compiled_pat != NULL ? compiled_pat[0] : 0)) & 0xF);\n\n    // step 5: Validate / propagate results\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)text_and_target.length & 0x7));\n    target_buf[0] = (char)((unsigned char)target_buf[0] + ((unsigned)match_s.length & 0x7));\n    (void)ver;\n    (void)compiled_pat;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:33:42.343931 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 06:33:42.344057 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33610, Completion: 22176, Total: 55786
[2025-11-05 06:33:42.344077 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:33:42.561458 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000230/id_000230.cc
[2025-11-05 06:33:42.561509 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:42.791442 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:42.791514 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:42.794391 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:42.794422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:43.012825 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000231/id_000231.cc
[2025-11-05 06:33:43.012877 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:43.242371 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:43.242445 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:43.245324 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:43.245357 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:43.464153 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000232/id_000232.cc
[2025-11-05 06:33:43.464238 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:43.695653 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:43.695727 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:43.698611 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:43.698643 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:43.916443 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000233/id_000233.cc
[2025-11-05 06:33:43.916495 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:44.146666 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:44.146739 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:44.149547 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:44.149576 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:44.369257 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000234/id_000234.cc
[2025-11-05 06:33:44.369319 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:44.598702 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:44.598818 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:44.601625 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:44.601658 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:44.818642 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000235/id_000235.cc
[2025-11-05 06:33:44.818693 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:45.048215 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:45.048273 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:45.051149 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:45.051181 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:45.268882 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000236/id_000236.cc
[2025-11-05 06:33:45.268934 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:45.497491 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:45.497564 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:45.500422 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:45.500454 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:45.725000 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000237/id_000237.cc
[2025-11-05 06:33:45.725084 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:45.956981 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:45.957052 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:45.959754 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:45.959786 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:46.179018 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000238/id_000238.cc
[2025-11-05 06:33:46.179071 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:46.407501 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:46.407574 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:46.410385 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:46.410414 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:46.629615 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000239/id_000239.cc
[2025-11-05 06:33:46.629668 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:33:46.858786 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:33:46.858896 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:33:46.861784 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:33:46.861816 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:33:46.861879 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:33:46.861900 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 240, succ: 239, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:33:46.861921 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:33:46.861953 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:33:47.189352 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 239 as an example for the next prompt.
[2025-11-05 06:33:47.189407 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 06:33:47.189440 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 06:33:47.189487 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,102.0,22.0,21.0,64.0,14.0,56.0,14.0,30.0,30.0,7.0,19.0,16.0,10.0,18.0,13.0,14.0,37.0,7.0,21.0,41.0,127.0,1.0,200.0,26.0,18.0,8.0,11.0,1.0,1.0,124.0,1.0,1.0,31.0,4.0,10.0,1.0,91.0,1.0,1.0,7.0,1.0,1.0,35.0,1.0,29.0,4.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:33:47.189507 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:33:47.189584 +00:00] INFO [src/feedback/schedule.rs:246] Loop 24: Replaced with lowest energy API: cre2_version_interface_age (energy: 1), prob: 0.2793
[2025-11-05 06:33:47.189606 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_age energy: 1
[2025-11-05 06:33:47.189636 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 200
[2025-11-05 06:33:47.189676 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 124
[2025-11-05 06:33:47.189704 +00:00] INFO [src/feedback/schedule.rs:246] Loop 24: Replaced with lowest energy API: cre2_version_interface_age (energy: 1), prob: 0.2793
[2025-11-05 06:33:47.189729 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 29
[2025-11-05 06:33:47.189765 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_version_interface_age(),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 06:33:47.190433 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 24, quiet_round: 0, discovered_api_pairs: 604
[2025-11-05 06:33:47.228953 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:33:47.229299 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_version_interface_age(),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char input_text[] = \"item-123 extra\";\n    const int input_text_len = (int)(sizeof(input_text) - 1);\n    char text_buf[128];\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t match_s;\n    const char * ver = NULL;\n    const char * compiled_pat = NULL;\n    int res_find = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&match_s, 0, sizeof(match_s));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    memcpy(text_buf, input_text, (size_t)input_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = input_text_len;\n    match_s.data = target_buf;\n    match_s.length = 0;\n\n    // step 3: Core operations\n    res_find = cre2_find_and_consume(pattern, &text_and_target, &match_s, nmatch);\n    ver = cre2_version_string();\n    compiled_pat = cre2_pattern(re);\n\n    // step 4: Inspect results\n    match_s.length = match_s.length + ((res_find & 7) + ((ver != NULL) ? ((int)ver[0] & 3) : 0));\n    text_and_target.length = text_and_target.length + ((match_s.length ^ (int)(compiled_pat != NULL ? compiled_pat[0] : 0)) & 0xF);\n\n    // step 5: Validate / propagate results\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)text_and_target.length & 0x7));\n    target_buf[0] = (char)((unsigned char)target_buf[0] + ((unsigned)match_s.length & 0x7));\n    (void)ver;\n    (void)compiled_pat;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"PRE-1234-suf\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char input_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input_s;\n    cre2_string_t match_s;\n    cre2_string_t err_arg;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int res_partial = 0;\n    int case_flag = 1;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(input_buf, 0, sizeof(input_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&input_s, 0, sizeof(input_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memset(&err_arg, 0, sizeof(err_arg));\n    memcpy(input_buf, sample_text, (size_t)sample_text_len);\n    input_s.data = input_buf;\n    input_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    err_arg.data = NULL;\n    err_arg.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    enc = cre2_opt_encoding(opt);\n    res_partial = cre2_partial_match(pattern, &input_s, &match_s, nmatch);\n    cre2_error_arg(re, &err_arg);\n\n    // step 4: Inspect results\n    match_s.length = match_s.length + ((res_partial + (int)enc) & 0xF);\n    input_s.length = input_s.length + ((match_s.length ^ (int)err_arg.length) & 0x7);\n    err_arg.length = err_arg.length + ((match_s.length + res_partial) & 0x3);\n\n    // step 5: Validate / propagate results\n    input_buf[0] = (char)((unsigned char)input_buf[0] + ((unsigned)match_s.length & 0x7));\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)err_arg.length & 0x7));\n    (void)enc;\n    (void)case_flag;\n    (void)res_partial;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:34:24.683571 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 06:34:24.683682 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32440, Completion: 20482, Total: 52922
[2025-11-05 06:34:24.683702 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:34:24.902309 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000240/id_000240.cc
[2025-11-05 06:34:24.902361 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:25.131861 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:25.131925 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:25.134826 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:25.134859 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:25.351860 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000241/id_000241.cc
[2025-11-05 06:34:25.351911 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:25.579904 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:25.579974 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:25.582873 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:25.582904 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:25.800872 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000242/id_000242.cc
[2025-11-05 06:34:25.800956 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:26.030586 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:26.030644 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:26.033285 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:26.033316 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:26.251602 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000243/id_000243.cc
[2025-11-05 06:34:26.251653 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:26.482322 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:26.482378 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:26.485098 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:26.485131 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:26.701677 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000244/id_000244.cc
[2025-11-05 06:34:26.701729 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:26.931872 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:26.931971 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:26.934829 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:26.934861 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:27.152572 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000245/id_000245.cc
[2025-11-05 06:34:27.152637 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:27.381370 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:27.381427 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:27.384021 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:27.384049 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:27.601350 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000246/id_000246.cc
[2025-11-05 06:34:27.601402 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:27.830586 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:27.830660 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:27.833697 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:27.833729 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:28.052408 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000247/id_000247.cc
[2025-11-05 06:34:28.052489 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:28.281722 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:28.281790 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:28.284690 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:28.284722 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:28.502105 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000248/id_000248.cc
[2025-11-05 06:34:28.502156 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:28.732395 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:28.732470 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:28.735028 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:28.735056 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:28.952463 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000249/id_000249.cc
[2025-11-05 06:34:28.952514 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:29.181241 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:29.181327 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:29.184071 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:29.184117 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:29.184157 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:34:29.184174 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 250, succ: 249, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:34:29.184189 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:34:29.184214 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:34:29.499943 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 249 as an example for the next prompt.
[2025-11-05 06:34:29.500029 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 06:34:29.500108 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 06:34:29.500172 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,107.0,22.0,21.0,64.0,14.0,56.0,14.0,30.0,30.0,7.0,19.0,16.0,10.0,18.0,13.0,14.0,37.0,7.0,21.0,41.0,127.0,18.0,209.0,26.0,18.0,8.0,11.0,1.0,1.0,134.0,1.0,1.0,31.0,4.0,10.0,1.0,91.0,1.0,1.0,7.0,1.0,1.0,36.0,1.0,39.0,4.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:34:29.500194 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:34:29.500269 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 107
[2025-11-05 06:34:29.500312 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 41
[2025-11-05 06:34:29.500350 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_never_nl energy: 4
[2025-11-05 06:34:29.500379 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 134
[2025-11-05 06:34:29.500418 +00:00] INFO [src/feedback/schedule.rs:246] Loop 25: Replaced with lowest energy API: cre2_version_interface_revision (energy: 1), prob: 0.2772
[2025-11-05 06:34:29.500436 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 1
[2025-11-05 06:34:29.500551 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_version_interface_revision()
[2025-11-05 06:34:29.501491 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 25, quiet_round: 0, discovered_api_pairs: 624
[2025-11-05 06:34:29.546125 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:34:29.546656 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_version_interface_revision()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"PRE-1234-suf\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char input_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input_s;\n    cre2_string_t match_s;\n    cre2_string_t err_arg;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int res_partial = 0;\n    int case_flag = 1;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(input_buf, 0, sizeof(input_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&input_s, 0, sizeof(input_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memset(&err_arg, 0, sizeof(err_arg));\n    memcpy(input_buf, sample_text, (size_t)sample_text_len);\n    input_s.data = input_buf;\n    input_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    err_arg.data = NULL;\n    err_arg.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    enc = cre2_opt_encoding(opt);\n    res_partial = cre2_partial_match(pattern, &input_s, &match_s, nmatch);\n    cre2_error_arg(re, &err_arg);\n\n    // step 4: Inspect results\n    match_s.length = match_s.length + ((res_partial + (int)enc) & 0xF);\n    input_s.length = input_s.length + ((match_s.length ^ (int)err_arg.length) & 0x7);\n    err_arg.length = err_arg.length + ((match_s.length + res_partial) & 0x3);\n\n    // step 5: Validate / propagate results\n    input_buf[0] = (char)((unsigned char)input_buf[0] + ((unsigned)match_s.length & 0x7));\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)err_arg.length & 0x7));\n    (void)enc;\n    (void)case_flag;\n    (void)res_partial;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_src[] = \"item-1234 trailing\";\n    const int text_src_len = (int)(sizeof(text_src) - 1);\n    char input_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input_s;\n    cre2_string_t match_s;\n    const char * compiled_pat = NULL;\n    int ver_age = 0;\n    int match_res = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(input_buf, 0, sizeof(input_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&input_s, 0, sizeof(input_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memcpy(input_buf, text_src, (size_t)text_src_len);\n    input_s.data = input_buf;\n    input_s.length = text_src_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Create / Configure regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Core operations\n    match_res = cre2_easy_match(pattern, pattern_len, input_s.data, input_s.length, &match_s, nmatch);\n    ver_age = cre2_version_interface_age();\n    compiled_pat = cre2_pattern(re);\n\n    // step 5: Inspect / propagate results\n    match_s.length = match_s.length + ((match_res & 7) + (ver_age & 3));\n    input_s.length = input_s.length + (((int)(compiled_pat != NULL ? compiled_pat[0] : 0)) & 0xF);\n    input_buf[0] = (char)((unsigned char)input_buf[0] + ((unsigned)match_s.length & 0x7));\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)input_s.length & 0x7));\n    (void)ver_age;\n    (void)compiled_pat;\n    (void)match_res;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:34:59.021496 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 06:34:59.021632 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32300, Completion: 18085, Total: 50385
[2025-11-05 06:34:59.021660 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:34:59.341544 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000250/id_000250.cc
[2025-11-05 06:34:59.341606 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:34:59.661656 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:34:59.661743 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:34:59.664956 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:34:59.665002 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:34:59.984054 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000251/id_000251.cc
[2025-11-05 06:34:59.984119 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:00.233171 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:00.233292 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:00.236074 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:00.236120 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:00.554363 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000252/id_000252.cc
[2025-11-05 06:35:00.554427 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:00.885154 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:00.885242 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:00.888639 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:00.888683 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:01.211186 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000253/id_000253.cc
[2025-11-05 06:35:01.211252 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:01.467521 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:01.467647 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:01.470309 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:01.470388 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:01.697476 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000254/id_000254.cc
[2025-11-05 06:35:01.697539 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:01.953700 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:01.953787 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:01.957313 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:01.957364 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:02.274296 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000255/id_000255.cc
[2025-11-05 06:35:02.274363 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:02.603581 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:02.603713 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:02.607159 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:02.607200 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:02.925040 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000256/id_000256.cc
[2025-11-05 06:35:02.925101 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:03.252873 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:03.252954 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:03.256384 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:03.256427 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:03.576680 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000257/id_000257.cc
[2025-11-05 06:35:03.576742 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:03.904644 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:03.904781 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:03.908121 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:03.908166 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:04.220399 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000258/id_000258.cc
[2025-11-05 06:35:04.220465 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:04.548559 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:04.548650 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:04.552100 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:04.552153 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:04.867488 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000259/id_000259.cc
[2025-11-05 06:35:04.867556 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:05.189590 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:05.189719 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:05.193254 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:05.193304 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:05.193360 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:35:05.193387 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 260, succ: 259, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:35:05.193409 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:35:05.193444 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:35:05.656496 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 259 as an example for the next prompt.
[2025-11-05 06:35:05.656603 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 7 new API pairs in this round.
[2025-11-05 06:35:05.656661 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 7
[2025-11-05 06:35:05.656742 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,9.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,109.0,22.0,21.0,64.0,14.0,58.0,14.0,30.0,30.0,7.0,19.0,16.0,10.0,18.0,13.0,14.0,37.0,7.0,21.0,44.0,127.0,18.0,212.0,26.0,18.0,8.0,11.0,4.0,1.0,137.0,1.0,1.0,31.0,4.0,10.0,1.0,91.0,1.0,1.0,7.0,1.0,1.0,37.0,1.0,39.0,7.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:35:05.656769 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:35:05.656853 +00:00] INFO [src/feedback/schedule.rs:246] Loop 26: Replaced with lowest energy API: cre2_opt_never_nl (energy: 1), prob: 0.2750
[2025-11-05 06:35:05.656890 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_nl energy: 1
[2025-11-05 06:35:05.656936 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 137
[2025-11-05 06:35:05.656980 +00:00] INFO [src/feedback/schedule.rs:246] Loop 26: Replaced with lowest energy API: cre2_opt_never_nl (energy: 1), prob: 0.2750
[2025-11-05 06:35:05.657021 +00:00] INFO [src/feedback/schedule.rs:246] Loop 26: Replaced with lowest energy API: cre2_opt_never_nl (energy: 1), prob: 0.2750
[2025-11-05 06:35:05.657060 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 9
[2025-11-05 06:35:05.657104 +00:00] INFO [src/feedback/schedule.rs:246] Loop 26: Replaced with lowest energy API: cre2_opt_never_nl (energy: 1), prob: 0.2750
[2025-11-05 06:35:05.657146 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 39
[2025-11-05 06:35:05.657203 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_never_nl(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_literal(cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 06:35:05.658281 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 26, quiet_round: 0, discovered_api_pairs: 631
[2025-11-05 06:35:05.712557 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:35:05.713299 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_never_nl(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_literal(cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_src[] = \"item-1234 trailing\";\n    const int text_src_len = (int)(sizeof(text_src) - 1);\n    char input_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input_s;\n    cre2_string_t match_s;\n    const char * compiled_pat = NULL;\n    int ver_age = 0;\n    int match_res = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(input_buf, 0, sizeof(input_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&input_s, 0, sizeof(input_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memcpy(input_buf, text_src, (size_t)text_src_len);\n    input_s.data = input_buf;\n    input_s.length = text_src_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Create / Configure regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Core operations\n    match_res = cre2_easy_match(pattern, pattern_len, input_s.data, input_s.length, &match_s, nmatch);\n    ver_age = cre2_version_interface_age();\n    compiled_pat = cre2_pattern(re);\n\n    // step 5: Inspect / propagate results\n    match_s.length = match_s.length + ((match_res & 7) + (ver_age & 3));\n    input_s.length = input_s.length + (((int)(compiled_pat != NULL ? compiled_pat[0] : 0)) & 0xF);\n    input_buf[0] = (char)((unsigned char)input_buf[0] + ((unsigned)match_s.length & 0x7));\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)input_s.length & 0x7));\n    (void)ver_age;\n    (void)compiled_pat;\n    (void)match_res;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"ITEM-4242 extra\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char input_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_s;\n    cre2_string_t match_s;\n    int match_res = 0;\n    int ver_rev = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(input_buf, 0, sizeof(input_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&text_s, 0, sizeof(text_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memcpy(input_buf, sample_text, (size_t)sample_text_len);\n    text_s.data = input_buf;\n    text_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure options\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 4: Create regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Core operations and inspection\n    match_res = cre2_easy_match(pattern, pattern_len, text_s.data, text_s.length, &match_s, nmatch);\n    ver_rev = cre2_version_interface_revision();\n    match_s.length = match_s.length + ((match_res & 0x7) + (ver_rev & 0x3));\n    text_s.length = text_s.length + ((int)match_s.length & 0xF);\n    input_buf[0] = (char)((unsigned char)input_buf[0] + ((unsigned)match_s.length & 0x7));\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)text_s.length & 0x7));\n    (void)match_res;\n    (void)ver_rev;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:35:46.433645 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 06:35:46.433780 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31490, Completion: 22142, Total: 53632
[2025-11-05 06:35:46.433804 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:35:46.730749 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000260/id_000260.cc
[2025-11-05 06:35:46.730815 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:47.044160 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:47.044264 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:47.047933 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:47.047992 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:47.359602 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000261/id_000261.cc
[2025-11-05 06:35:47.359673 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:47.685609 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:47.685720 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:47.688945 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:47.688985 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:48.009326 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000262/id_000262.cc
[2025-11-05 06:35:48.009390 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:48.321439 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:48.321564 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:48.324912 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:48.324972 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:48.640174 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000263/id_000263.cc
[2025-11-05 06:35:48.640268 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:48.949254 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:48.949396 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:48.953114 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:48.953175 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:49.273149 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000264/id_000264.cc
[2025-11-05 06:35:49.273241 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:49.605006 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:49.605111 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:49.611839 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:49.611905 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:49.921431 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000265/id_000265.cc
[2025-11-05 06:35:49.921647 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:50.254341 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:50.254497 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:50.257737 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:50.257792 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:50.572245 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000266/id_000266.cc
[2025-11-05 06:35:50.572349 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:35:50.899709 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:35:50.899826 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:35:50.903303 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:35:50.903360 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:35:51.215462 +00:00] WARN [src/fuzzer.rs:205] Program 267 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000267/id_000267.cc:47:21: error: no matching function for call to 'cre2_opt_never_nl'
   47 |     flag_never_nl = cre2_opt_never_nl(opt, 1);
      |                     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:77:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   77 | cre2_decl int cre2_opt_never_nl                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/cre2/work/id_000267/id_000267.cc:48:20: error: no matching function for call to 'cre2_opt_literal'
   48 |     flag_literal = cre2_opt_literal(opt, 0);
      |                    ^~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:76:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   76 | cre2_decl int cre2_opt_literal                  (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
2 errors generated.

[2025-11-05 06:35:51.267067 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:35:51.267708 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"widget-2025 extra\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char input_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input_s;\n    cre2_string_t match_s;\n    const char * compiled_pat = NULL;\n    int flag_never_nl = 0;\n    int flag_literal = 0;\n    int match_res = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(input_buf, 0, sizeof(input_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&input_s, 0, sizeof(input_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memcpy(input_buf, sample_text, (size_t)sample_text_len);\n    input_s.data = input_buf;\n    input_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure options\n    flag_never_nl = cre2_opt_never_nl(opt, 1);\n    flag_literal = cre2_opt_literal(opt, 0);\n\n    // step 4: Create regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Core operations and validation\n    match_res = cre2_easy_match(pattern, pattern_len, input_s.data, input_s.length, &match_s, nmatch);\n    compiled_pat = cre2_pattern(re);\n    match_s.length = match_s.length + ((match_res & 0x7) + (flag_never_nl & flag_literal));\n    input_s.length = input_s.length + (((int)(compiled_pat ? compiled_pat[0] : 0)) & 0xF);\n    input_buf[0] = (char)((unsigned char)input_buf[0] + ((unsigned)match_s.length & 0xF));\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)input_s.length & 0xF));\n    (void)compiled_pat;\n    (void)match_res;\n    (void)flag_never_nl;\n    (void)flag_literal;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000267/id_000267.cc:47:21: error: no matching function for call to 'cre2_opt_never_nl'\n   47 |     flag_never_nl = cre2_opt_never_nl(opt, 1);\n      |                     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:77:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   77 | cre2_decl int cre2_opt_never_nl                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/cre2/work/id_000267/id_000267.cc:48:20: error: no matching function for call to 'cre2_opt_literal'\n   48 |     flag_literal = cre2_opt_literal(opt, 0);\n      |                    ^~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:76:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   76 | cre2_decl int cre2_opt_literal                  (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n2 errors generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:36:12.824688 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 06:36:12.824819 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 25390, Completion: 14654, Total: 40044
[2025-11-05 06:36:13.126680 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000267/id_000267.cc
[2025-11-05 06:36:13.126772 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:36:13.439987 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:36:13.440092 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:36:13.443308 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:36:13.443360 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:36:13.443441 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 267!
[2025-11-05 06:36:13.744166 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000268/id_000268.cc
[2025-11-05 06:36:13.744229 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:36:14.057612 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:36:14.057736 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:36:14.061129 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:36:14.061174 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:36:14.363715 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000269/id_000269.cc
[2025-11-05 06:36:14.363775 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:36:14.674509 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:36:14.674587 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:36:14.677916 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:36:14.677966 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:36:14.678013 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:36:14.678033 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 270, succ: 269, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:36:14.678049 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:36:14.678077 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:36:15.159751 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 269 as an example for the next prompt.
[2025-11-05 06:36:15.159891 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 30 new API pairs in this round.
[2025-11-05 06:36:15.159959 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 30
[2025-11-05 06:36:15.160029 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,114.0,22.0,21.0,64.0,14.0,62.0,22.0,30.0,30.0,7.0,19.0,16.0,10.0,18.0,13.0,14.0,37.0,7.0,21.0,44.0,127.0,18.0,223.0,26.0,18.0,8.0,11.0,4.0,16.0,148.0,1.0,1.0,31.0,4.0,10.0,1.0,91.0,1.0,1.0,7.0,1.0,1.0,38.0,1.0,49.0,14.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:36:15.160050 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:36:15.160139 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 223
[2025-11-05 06:36:15.160189 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 148
[2025-11-05 06:36:15.160227 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 127
[2025-11-05 06:36:15.160276 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 16
[2025-11-05 06:36:15.160332 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)
[2025-11-05 06:36:15.161318 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 27, quiet_round: 0, discovered_api_pairs: 661
[2025-11-05 06:36:15.228398 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:36:15.229027 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"ITEM-4242 extra\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char input_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_s;\n    cre2_string_t match_s;\n    int match_res = 0;\n    int ver_rev = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(input_buf, 0, sizeof(input_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&text_s, 0, sizeof(text_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memcpy(input_buf, sample_text, (size_t)sample_text_len);\n    text_s.data = input_buf;\n    text_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure options\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 4: Create regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Core operations and inspection\n    match_res = cre2_easy_match(pattern, pattern_len, text_s.data, text_s.length, &match_s, nmatch);\n    ver_rev = cre2_version_interface_revision();\n    match_s.length = match_s.length + ((match_res & 0x7) + (ver_rev & 0x3));\n    text_s.length = text_s.length + ((int)match_s.length & 0xF);\n    input_buf[0] = (char)((unsigned char)input_buf[0] + ((unsigned)match_s.length & 0x7));\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)text_s.length & 0x7));\n    (void)match_res;\n    (void)ver_rev;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"item-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"item-7890 trailing-data\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_s;\n    cre2_string_t match_s;\n    const char * compiled_pat = NULL;\n    int match_res = 0;\n    int opt_never_nl_val = 0;\n    int opt_literal_val = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&text_s, 0, sizeof(text_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    text_s.data = text_buf;\n    text_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Create / Configure regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Core operations\n    match_res = cre2_easy_match(pattern, pattern_len, text_s.data, text_s.length, &match_s, nmatch);\n    opt_never_nl_val = cre2_opt_never_nl(opt);\n    opt_literal_val = cre2_opt_literal(opt);\n    compiled_pat = cre2_pattern(re);\n\n    // step 5: Inspect / propagate results\n    {\n        int cp0 = compiled_pat ? (int)compiled_pat[0] : 0;\n        match_s.length = match_s.length + ((match_res & 0x7) + (opt_never_nl_val & 0x1));\n        text_s.length = text_s.length - (((int)opt_literal_val & 0x1) + (cp0 & 0xF));\n        text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)match_s.length & 0x7));\n        match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)text_s.length & 0x7));\n        (void)cp0;\n        (void)match_res;\n        (void)opt_never_nl_val;\n        (void)opt_literal_val;\n        (void)compiled_pat;\n    }\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:36:58.909571 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 06:36:58.909722 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32750, Completion: 24326, Total: 57076
[2025-11-05 06:36:58.909757 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:36:59.138048 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000270/id_000270.cc
[2025-11-05 06:36:59.138112 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:36:59.406413 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:36:59.406497 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:36:59.409401 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:36:59.409446 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:36:59.636532 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000271/id_000271.cc
[2025-11-05 06:36:59.636597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:36:59.992186 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:36:59.992352 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:36:59.995363 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:36:59.995415 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:00.222671 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000272/id_000272.cc
[2025-11-05 06:37:00.222765 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:00.455784 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:00.455903 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:00.459265 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:00.459322 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:00.686054 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000273/id_000273.cc
[2025-11-05 06:37:00.686149 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:00.991222 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:00.991328 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:00.994352 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:00.994468 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:01.222406 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000274/id_000274.cc
[2025-11-05 06:37:01.222507 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:01.454309 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:01.454436 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:01.457174 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:01.457234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:01.682959 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000275/id_000275.cc
[2025-11-05 06:37:01.683061 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:01.911728 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:01.911849 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:01.914482 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:01.914546 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:02.236782 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000276/id_000276.cc
[2025-11-05 06:37:02.236936 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:02.466776 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:02.466903 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:02.469589 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:02.469656 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:02.695260 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000277/id_000277.cc
[2025-11-05 06:37:02.695361 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:02.946176 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:02.946289 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:02.949220 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:02.949308 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:03.175760 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000278/id_000278.cc
[2025-11-05 06:37:03.175864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:03.405395 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:03.405579 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:03.409113 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:03.409183 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:03.634310 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000279/id_000279.cc
[2025-11-05 06:37:03.634411 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:37:03.864821 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:37:03.864946 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:37:03.868248 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:37:03.868290 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:37:03.868346 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:37:03.868371 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 280, succ: 279, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:37:03.868391 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:37:03.868429 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:37:04.306421 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 279 as an example for the next prompt.
[2025-11-05 06:37:04.306490 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 5 new API pairs in this round.
[2025-11-05 06:37:04.306524 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 5
[2025-11-05 06:37:04.306590 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,116.0,22.0,21.0,64.0,14.0,63.0,22.0,30.0,30.0,7.0,19.0,19.0,10.0,18.0,13.0,14.0,37.0,7.0,21.0,44.0,127.0,18.0,224.0,26.0,18.0,8.0,11.0,4.0,16.0,150.0,1.0,1.0,31.0,4.0,10.0,1.0,91.0,1.0,1.0,7.0,1.0,1.0,39.0,1.0,49.0,14.0,6.0,4.0,1.0,22.0,1.0,14.0,1.0,1.0,1.0]
[2025-11-05 06:37:04.306612 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:37:04.306677 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 81
[2025-11-05 06:37:04.306721 +00:00] INFO [src/feedback/schedule.rs:246] Loop 28: Replaced with lowest energy API: cre2_replace (energy: 1), prob: 0.2701
[2025-11-05 06:37:04.306742 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace energy: 1
[2025-11-05 06:37:04.306774 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 7
[2025-11-05 06:37:04.306805 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 49
[2025-11-05 06:37:04.306837 +00:00] INFO [src/feedback/schedule.rs:246] Loop 28: Replaced with lowest energy API: cre2_replace (energy: 1), prob: 0.2701
[2025-11-05 06:37:04.306909 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_age energy: 18
[2025-11-05 06:37:04.306959 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_version_interface_age()
[2025-11-05 06:37:04.307920 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 28, quiet_round: 0, discovered_api_pairs: 666
[2025-11-05 06:37:04.375336 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:37:04.376053 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_version_interface_age()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"item-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"item-7890 trailing-data\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_s;\n    cre2_string_t match_s;\n    const char * compiled_pat = NULL;\n    int match_res = 0;\n    int opt_never_nl_val = 0;\n    int opt_literal_val = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(&text_s, 0, sizeof(text_s));\n    memset(&match_s, 0, sizeof(match_s));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    text_s.data = text_buf;\n    text_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Create / Configure regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Core operations\n    match_res = cre2_easy_match(pattern, pattern_len, text_s.data, text_s.length, &match_s, nmatch);\n    opt_never_nl_val = cre2_opt_never_nl(opt);\n    opt_literal_val = cre2_opt_literal(opt);\n    compiled_pat = cre2_pattern(re);\n\n    // step 5: Inspect / propagate results\n    {\n        int cp0 = compiled_pat ? (int)compiled_pat[0] : 0;\n        match_s.length = match_s.length + ((match_res & 0x7) + (opt_never_nl_val & 0x1));\n        text_s.length = text_s.length - (((int)opt_literal_val & 0x1) + (cp0 & 0xF));\n        text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)match_s.length & 0x7));\n        match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)text_s.length & 0x7));\n        (void)cp0;\n        (void)match_res;\n        (void)opt_never_nl_val;\n        (void)opt_literal_val;\n        (void)compiled_pat;\n    }\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ITEM)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"ITEM-1234 tail\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[128];\n    char match_buf[64];\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_s;\n    cre2_string_t match_s;\n    cre2_string_t rewrite_s;\n    cre2_string_t target_s;\n    int match_res = 0;\n    int extract_res = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    text_s.data = text_buf;\n    text_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    rewrite_s.data = \"\\\\1-REWRITTEN\";\n    rewrite_s.length = (int)(sizeof(\"\\\\1-REWRITTEN\") - 1);\n    target_s.data = target_buf;\n    target_s.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure and create regex\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Perform an easy match\n    match_res = cre2_easy_match(pattern, pattern_len, text_s.data, text_s.length, &match_s, nmatch);\n\n    // step 5: Use compiled regex to extract with a rewrite into target\n    extract_res = cre2_extract_re(re, &text_s, &rewrite_s, &target_s);\n    match_s.length = match_s.length + ((match_res & 0x7) + (extract_res & 0x3));\n    text_s.length = text_s.length - ((int)match_s.length & 0xF);\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)target_s.length & 0x7));\n    target_buf[0] = (char)((unsigned char)target_buf[0] + ((unsigned)text_s.length & 0x7));\n    (void)match_res;\n    (void)extract_res;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:37:57.930836 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 53s
[2025-11-05 06:37:57.930977 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33540, Completion: 25631, Total: 59171
[2025-11-05 06:37:57.931004 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:37:58.158334 +00:00] WARN [src/fuzzer.rs:205] Program 280 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000280/id_000280.cc:54:11: error: no matching function for call to 'cre2_set_new'
   54 |     set = cre2_set_new(opt, (void*)0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: cannot convert argument of incomplete type 'void *' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 06:37:58.207868 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:37:58.208357 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ab)c\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"abc abc abc\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[128];\n    char rewrite_buf[64];\n    char match_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_s;\n    cre2_string_t rewrite_s;\n    cre2_string_t dummy_s;\n    const char * compiled_pat = NULL;\n    int match_array[8];\n    size_t set_match_count = 0;\n    int replace_res = 0;\n    int version_age = 0;\n    const size_t match_array_len = sizeof(match_array) / sizeof(match_array[0]);\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    text_s.data = text_buf;\n    text_s.length = sample_text_len;\n    rewrite_s.data = \"\\\\1-X\";\n    rewrite_s.length = (int)(sizeof(\"\\\\1-X\") - 1);\n    dummy_s.data = match_buf;\n    dummy_s.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Configure / Create\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (void*)0);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Core operations\n    replace_res = cre2_replace(pattern, &text_s, &rewrite_s);\n    set_match_count = cre2_set_match(set, text_s.data, (size_t)text_s.length, match_array, match_array_len);\n    compiled_pat = cre2_pattern(re);\n    version_age = cre2_version_interface_age();\n\n    // step 5: Validate / propagate results\n    dummy_s.length = dummy_s.length + ((replace_res & 0x7) + ((int)set_match_count & 0x3));\n    text_s.length = text_s.length - ((int)dummy_s.length & 0xF);\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)version_age & 0x7));\n    if (compiled_pat) { /* avoid unused variable warning without branching logic */ dummy_s.length = dummy_s.length + (int)compiled_pat[0]; }\n    match_buf[0] = (char)((unsigned char)match_buf[0] + ((unsigned)text_s.length & 0x7));\n    (void)replace_res;\n    (void)set_match_count;\n    (void)compiled_pat;\n    (void)version_age;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000280/id_000280.cc:54:11: error: no matching function for call to 'cre2_set_new'\n   54 |     set = cre2_set_new(opt, (void*)0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: cannot convert argument of incomplete type 'void *' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:38:26.748345 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 06:38:26.748475 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 25560, Completion: 14836, Total: 40396
[2025-11-05 06:38:27.068575 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000280/id_000280.cc
[2025-11-05 06:38:27.068661 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:27.393083 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:27.393193 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:27.396513 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:27.396564 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:27.396615 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 280!
[2025-11-05 06:38:27.726650 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000281/id_000281.cc
[2025-11-05 06:38:27.726746 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:28.034351 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:28.034520 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:28.037919 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:28.037976 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:28.371649 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000282/id_000282.cc
[2025-11-05 06:38:28.371742 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:28.684777 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:28.684905 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:28.688230 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:28.688286 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:29.023461 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000283/id_000283.cc
[2025-11-05 06:38:29.023556 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:29.332528 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:29.332707 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:29.336250 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:29.336290 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:29.631533 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000284/id_000284.cc
[2025-11-05 06:38:29.631628 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:29.958111 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:29.958228 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:29.961438 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:29.961476 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:30.292956 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000285/id_000285.cc
[2025-11-05 06:38:30.293046 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:30.616945 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:30.617079 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:30.620375 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:30.620440 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:30.935210 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000286/id_000286.cc
[2025-11-05 06:38:30.935354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:31.255167 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:31.255285 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:31.258481 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:31.258536 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:31.590184 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000287/id_000287.cc
[2025-11-05 06:38:31.590283 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:31.910924 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:31.911105 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:31.914418 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:31.914481 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:32.228471 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000288/id_000288.cc
[2025-11-05 06:38:32.228564 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:32.556615 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:32.556742 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:32.560216 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:32.560281 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:32.850179 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000289/id_000289.cc
[2025-11-05 06:38:32.850274 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:38:33.154280 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:38:33.154449 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:38:33.157824 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:38:33.157874 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:38:33.157928 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:38:33.157950 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 290, succ: 289, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:38:33.157966 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:38:33.158172 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:38:33.646963 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 289 as an example for the next prompt.
[2025-11-05 06:38:33.647038 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 21 new API pairs in this round.
[2025-11-05 06:38:33.647119 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 21
[2025-11-05 06:38:33.647187 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,21.0,8.0,22.0,5.0,9.0,121.0,22.0,21.0,64.0,14.0,63.0,22.0,30.0,30.0,12.0,19.0,19.0,10.0,18.0,13.0,18.0,37.0,7.0,21.0,44.0,127.0,28.0,227.0,26.0,23.0,8.0,11.0,4.0,16.0,150.0,11.0,1.0,31.0,4.0,10.0,1.0,91.0,1.0,1.0,15.0,1.0,1.0,39.0,1.0,58.0,14.0,6.0,4.0,1.0,22.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:38:33.647223 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:38:33.647287 +00:00] INFO [src/feedback/schedule.rs:246] Loop 29: Replaced with lowest energy API: cre2_opt_log_errors (energy: 1), prob: 0.2673
[2025-11-05 06:38:33.647315 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 1
[2025-11-05 06:38:33.647357 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 22
[2025-11-05 06:38:33.647392 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 227
[2025-11-05 06:38:33.647425 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 91
[2025-11-05 06:38:33.647468 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_log_errors(cre2_options_t * opt),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 06:38:33.648365 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 29, quiet_round: 0, discovered_api_pairs: 687
[2025-11-05 06:38:33.694982 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:38:33.695571 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_log_errors(cre2_options_t * opt),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ITEM)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"ITEM-1234 tail\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[128];\n    char match_buf[64];\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_s;\n    cre2_string_t match_s;\n    cre2_string_t rewrite_s;\n    cre2_string_t target_s;\n    int match_res = 0;\n    int extract_res = 0;\n    const int nmatch = 2;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    text_s.data = text_buf;\n    text_s.length = sample_text_len;\n    match_s.data = match_buf;\n    match_s.length = 0;\n    rewrite_s.data = \"\\\\1-REWRITTEN\";\n    rewrite_s.length = (int)(sizeof(\"\\\\1-REWRITTEN\") - 1);\n    target_s.data = target_buf;\n    target_s.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure and create regex\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Perform an easy match\n    match_res = cre2_easy_match(pattern, pattern_len, text_s.data, text_s.length, &match_s, nmatch);\n\n    // step 5: Use compiled regex to extract with a rewrite into target\n    extract_res = cre2_extract_re(re, &text_s, &rewrite_s, &target_s);\n    match_s.length = match_s.length + ((match_res & 0x7) + (extract_res & 0x3));\n    text_s.length = text_s.length - ((int)match_s.length & 0xF);\n    text_buf[0] = (char)((unsigned char)text_buf[0] + ((unsigned)target_s.length & 0x7));\n    target_buf[0] = (char)((unsigned char)target_buf[0] + ((unsigned)text_s.length & 0x7));\n    (void)match_res;\n    (void)extract_res;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"prefix foo123 suffix foo456\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[128];\n    char rewrite_buf[] = \"BAR$1\";\n    int match_array[8];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_s;\n    const char * compiled_pat = NULL;\n    int replace_res = 0;\n    size_t match_count = 0;\n    int ver_age = 0;\n    int cp0 = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(match_array, 0, sizeof(match_array));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = sample_text_len;\n    rewrite_s.data = rewrite_buf;\n    rewrite_s.length = (int)(sizeof(rewrite_buf) - 1);\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Configure / Create\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pat = cre2_pattern(re);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate / Validate\n    replace_res = cre2_replace(pattern, &text_and_target, &rewrite_s);\n    match_count = cre2_set_match(set, text_and_target.data, (size_t)text_and_target.length, match_array, (size_t)(sizeof(match_array)/sizeof(match_array[0])));\n    ver_age = cre2_version_interface_age();\n    cp0 = compiled_pat ? (int)compiled_pat[0] : 0;\n    text_and_target.length = text_and_target.length + (int)((replace_res & 0x7) + (int)(match_count & 0x7) + (ver_age & 0x3));\n    text_buf[0] = (char)((unsigned char)text_buf[0] + (unsigned)((cp0 & 0xF) + (int)(match_count & 0x3)));\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:39:18.687758 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 06:39:18.687870 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32550, Completion: 23713, Total: 56263
[2025-11-05 06:39:18.687890 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:39:18.911979 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000290/id_000290.cc
[2025-11-05 06:39:18.912041 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:19.142969 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:19.143041 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:19.145960 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:19.145996 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:19.381370 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000291/id_000291.cc
[2025-11-05 06:39:19.381423 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:19.624660 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:19.624749 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:19.627457 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:19.627492 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:19.847410 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000292/id_000292.cc
[2025-11-05 06:39:19.847511 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:20.080209 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:20.080291 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:20.083096 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:20.083131 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:20.318427 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000293/id_000293.cc
[2025-11-05 06:39:20.318489 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:20.552398 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:20.552477 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:20.555042 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:20.555080 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:20.787663 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000294/id_000294.cc
[2025-11-05 06:39:20.787722 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:21.086998 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:21.087113 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:21.089632 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:21.089661 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:21.329662 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000295/id_000295.cc
[2025-11-05 06:39:21.329723 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:21.599504 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:21.599574 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:21.602038 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:21.602068 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:21.838566 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000296/id_000296.cc
[2025-11-05 06:39:21.838631 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:22.087534 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:22.087642 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:22.090328 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:22.090359 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:22.323664 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000297/id_000297.cc
[2025-11-05 06:39:22.323726 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:22.560054 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:22.560133 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:22.562678 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:22.562721 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:22.780545 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000298/id_000298.cc
[2025-11-05 06:39:22.780613 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:23.016789 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:23.016869 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:23.019367 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:23.019409 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:23.253525 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000299/id_000299.cc
[2025-11-05 06:39:23.253633 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:39:23.499488 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:39:23.499569 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:39:23.502367 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:39:23.502409 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:39:23.502464 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:39:23.502487 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 300, succ: 299, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:39:23.502507 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:39:23.502543 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:39:23.817934 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 299 as an example for the next prompt.
[2025-11-05 06:39:23.817992 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 29 new API pairs in this round.
[2025-11-05 06:39:23.818042 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 29
[2025-11-05 06:39:23.818091 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,81.0,28.0,13.0,44.0,24.0,8.0,22.0,5.0,9.0,127.0,25.0,21.0,64.0,14.0,67.0,33.0,36.0,30.0,12.0,19.0,19.0,10.0,18.0,13.0,18.0,37.0,7.0,21.0,44.0,127.0,28.0,243.0,26.0,23.0,8.0,11.0,4.0,16.0,153.0,11.0,15.0,31.0,4.0,10.0,1.0,105.0,1.0,1.0,15.0,1.0,1.0,40.0,1.0,63.0,14.0,6.0,4.0,1.0,22.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:39:23.818119 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:39:23.818173 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 67
[2025-11-05 06:39:23.818204 +00:00] INFO [src/feedback/schedule.rs:246] Loop 30: Replaced with lowest energy API: cre2_opt_one_line (energy: 1), prob: 0.2642
[2025-11-05 06:39:23.818220 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 1
[2025-11-05 06:39:23.818248 +00:00] INFO [src/feedback/schedule.rs:246] Loop 30: Replaced with lowest energy API: cre2_opt_one_line (energy: 1), prob: 0.2642
[2025-11-05 06:39:23.818273 +00:00] INFO [src/feedback/schedule.rs:246] Loop 30: Replaced with lowest energy API: cre2_opt_one_line (energy: 1), prob: 0.2642
[2025-11-05 06:39:23.818298 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 6
[2025-11-05 06:39:23.818324 +00:00] INFO [src/feedback/schedule.rs:246] Loop 30: Replaced with lowest energy API: cre2_opt_one_line (energy: 1), prob: 0.2642
[2025-11-05 06:39:23.818349 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 44
[2025-11-05 06:39:23.818381 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    int cre2_opt_one_line(cre2_options_t * opt),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)
[2025-11-05 06:39:23.819060 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 30, quiet_round: 0, discovered_api_pairs: 716
[2025-11-05 06:39:23.842352 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:39:23.842688 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"prefix foo123 suffix foo456\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[128];\n    char rewrite_buf[] = \"BAR$1\";\n    int match_array[8];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_s;\n    const char * compiled_pat = NULL;\n    int replace_res = 0;\n    size_t match_count = 0;\n    int ver_age = 0;\n    int cp0 = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(match_array, 0, sizeof(match_array));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = sample_text_len;\n    rewrite_s.data = rewrite_buf;\n    rewrite_s.length = (int)(sizeof(rewrite_buf) - 1);\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Configure / Create\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pat = cre2_pattern(re);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate / Validate\n    replace_res = cre2_replace(pattern, &text_and_target, &rewrite_s);\n    match_count = cre2_set_match(set, text_and_target.data, (size_t)text_and_target.length, match_array, (size_t)(sizeof(match_array)/sizeof(match_array[0])));\n    ver_age = cre2_version_interface_age();\n    cp0 = compiled_pat ? (int)compiled_pat[0] : 0;\n    text_and_target.length = text_and_target.length + (int)((replace_res & 0x7) + (int)(match_count & 0x7) + (ver_age & 0x3));\n    text_buf[0] = (char)((unsigned char)text_buf[0] + (unsigned)((cp0 & 0xF) + (int)(match_count & 0x3)));\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"abc.*(def)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"abcXYZdefGHI\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int log_errors_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int enc_code = 0;\n    const char * compiled_pat = NULL;\n    int err_code = 0;\n    int cp0 = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 3: Configure / Create\n    log_errors_flag = cre2_opt_log_errors(opt);\n    enc = cre2_opt_encoding(opt);\n    enc_code = (int)enc;\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate / Validate\n    compiled_pat = cre2_pattern(re);\n    err_code = cre2_error_code(re);\n    cp0 = compiled_pat ? (int)compiled_pat[0] : 0;\n    text_buf[0] = (char)((unsigned char)text_buf[0] + (unsigned)((cp0 & 0x7) + (log_errors_flag & 0x1) + (enc_code & 0x3)));\n    (void)err_code;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:40:08.886090 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 06:40:08.886196 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30280, Completion: 21719, Total: 51999
[2025-11-05 06:40:08.886217 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:40:09.104656 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000300/id_000300.cc
[2025-11-05 06:40:09.104723 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:09.339059 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:09.339161 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:09.341793 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:09.341819 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:09.563282 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000301/id_000301.cc
[2025-11-05 06:40:09.563340 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:09.793571 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:09.793649 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:09.796230 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:09.796303 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:10.015209 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000302/id_000302.cc
[2025-11-05 06:40:10.015294 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:10.244592 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:10.244680 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:10.247296 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:10.247323 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:10.465409 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000303/id_000303.cc
[2025-11-05 06:40:10.465463 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:10.698630 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:10.698697 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:10.701413 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:10.701445 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:10.918274 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000304/id_000304.cc
[2025-11-05 06:40:10.918326 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:11.166166 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:11.166265 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:11.168860 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:11.168892 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:11.390707 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000305/id_000305.cc
[2025-11-05 06:40:11.390760 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:11.621741 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:11.621818 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:11.624466 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:11.624498 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:11.845955 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000306/id_000306.cc
[2025-11-05 06:40:11.846008 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:12.077707 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:12.077791 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:12.080313 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:12.080345 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:12.298951 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000307/id_000307.cc
[2025-11-05 06:40:12.299043 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:12.558748 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:12.558827 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:12.561647 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:12.561691 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:12.837786 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000308/id_000308.cc
[2025-11-05 06:40:12.837837 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:13.147519 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:13.147598 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:13.150279 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:13.150329 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:13.417939 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000309/id_000309.cc
[2025-11-05 06:40:13.418048 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:13.692140 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:13.692227 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:13.695628 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:13.695692 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:13.695757 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:40:13.695784 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 310, succ: 309, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:40:13.695805 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:40:13.695838 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:40:14.051069 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 309 as an example for the next prompt.
[2025-11-05 06:40:14.051128 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 27 new API pairs in this round.
[2025-11-05 06:40:14.051180 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 27
[2025-11-05 06:40:14.051231 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,81.0,28.0,13.0,46.0,24.0,8.0,27.0,5.0,11.0,129.0,28.0,21.0,68.0,14.0,73.0,33.0,39.0,30.0,12.0,19.0,19.0,10.0,18.0,13.0,18.0,37.0,7.0,21.0,53.0,127.0,28.0,249.0,26.0,23.0,8.0,11.0,4.0,16.0,153.0,11.0,15.0,31.0,4.0,10.0,17.0,105.0,1.0,1.0,15.0,1.0,1.0,43.0,1.0,69.0,14.0,17.0,4.0,1.0,22.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:40:14.051247 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:40:14.051304 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 129
[2025-11-05 06:40:14.051363 +00:00] INFO [src/feedback/schedule.rs:246] Loop 31: Replaced with lowest energy API: cre2_error_string (energy: 1), prob: 0.2610
[2025-11-05 06:40:14.051381 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_string energy: 1
[2025-11-05 06:40:14.051412 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 68
[2025-11-05 06:40:14.051440 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 22
[2025-11-05 06:40:14.051466 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 127
[2025-11-05 06:40:14.051501 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    const char *cre2_error_string(const cre2_regexp_t * re),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)
[2025-11-05 06:40:14.052356 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 31, quiet_round: 0, discovered_api_pairs: 743
[2025-11-05 06:40:14.095705 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:40:14.096252 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    const char *cre2_error_string(const cre2_regexp_t * re),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"abc.*(def)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char sample_text[] = \"abcXYZdefGHI\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int log_errors_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int enc_code = 0;\n    const char * compiled_pat = NULL;\n    int err_code = 0;\n    int cp0 = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 3: Configure / Create\n    log_errors_flag = cre2_opt_log_errors(opt);\n    enc = cre2_opt_encoding(opt);\n    enc_code = (int)enc;\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate / Validate\n    compiled_pat = cre2_pattern(re);\n    err_code = cre2_error_code(re);\n    cp0 = compiled_pat ? (int)compiled_pat[0] : 0;\n    text_buf[0] = (char)((unsigned char)text_buf[0] + (unsigned)((cp0 & 0x7) + (log_errors_flag & 0x1) + (enc_code & 0x3)));\n    (void)err_code;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char sample_text[] = \"sample\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[32];\n    cre2_options_t * opt = NULL;\n    int one_line_flag = 0;\n    int wb_flag_set = 1;\n    int perl_flag_set = 1;\n    int wb_flag_read = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n\n    // step 3: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, perl_flag_set);\n    cre2_opt_set_word_boundary(opt, wb_flag_set);\n\n    // step 4: Operate / Validate\n    one_line_flag = cre2_opt_one_line(opt);\n    wb_flag_read = cre2_opt_word_boundary(opt);\n    text_buf[0] = (char)((unsigned char)text_buf[0] + (unsigned char)((one_line_flag & 0x1) + (wb_flag_read & 0x1) + (perl_flag_set & 0x1)));\n\n    // step 5: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:40:52.699332 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 06:40:52.699467 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27610, Completion: 20704, Total: 48314
[2025-11-05 06:40:52.699488 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:40:52.926589 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000310/id_000310.cc
[2025-11-05 06:40:52.926645 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:53.166371 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:53.166436 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:53.169562 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:53.169595 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:53.395057 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000311/id_000311.cc
[2025-11-05 06:40:53.395112 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:53.632812 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:53.632900 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:53.635902 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:53.635937 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:53.861978 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000312/id_000312.cc
[2025-11-05 06:40:53.862073 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:54.098309 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:54.098367 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:54.101326 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:54.101374 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:54.327227 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000313/id_000313.cc
[2025-11-05 06:40:54.327279 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:54.563789 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:54.563880 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:54.566612 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:54.566644 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:54.791599 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000314/id_000314.cc
[2025-11-05 06:40:54.791652 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:55.030346 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:55.030457 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:55.033277 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:55.033309 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:55.259568 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000315/id_000315.cc
[2025-11-05 06:40:55.259625 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:55.494003 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:55.494058 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:55.496976 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:55.497006 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:55.721587 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000316/id_000316.cc
[2025-11-05 06:40:55.721645 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:55.957157 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:55.957359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:55.960594 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:55.960642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:56.184729 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000317/id_000317.cc
[2025-11-05 06:40:56.184818 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:56.418596 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:56.418653 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:56.421709 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:56.421741 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:56.646481 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000318/id_000318.cc
[2025-11-05 06:40:56.646532 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:56.881024 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:56.881082 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:56.883988 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:56.884015 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:57.109000 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000319/id_000319.cc
[2025-11-05 06:40:57.109053 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:40:57.345448 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:40:57.345586 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:40:57.349186 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:40:57.349217 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:40:57.349259 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:40:57.349275 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 320, succ: 319, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:40:57.349290 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:40:57.349316 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:40:57.612093 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 319 as an example for the next prompt.
[2025-11-05 06:40:57.612146 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 06:40:57.612189 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 06:40:57.612234 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,81.0,28.0,13.0,46.0,24.0,8.0,27.0,5.0,11.0,132.0,28.0,21.0,71.0,14.0,74.0,33.0,39.0,30.0,12.0,24.0,19.0,10.0,18.0,13.0,18.0,37.0,7.0,21.0,53.0,128.0,28.0,254.0,35.0,23.0,8.0,14.0,4.0,16.0,153.0,11.0,15.0,31.0,4.0,10.0,20.0,105.0,13.0,1.0,15.0,1.0,1.0,43.0,1.0,73.0,14.0,17.0,4.0,4.0,29.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:40:57.612253 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:40:57.612314 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 43
[2025-11-05 06:40:57.612353 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 81
[2025-11-05 06:40:57.612384 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 37
[2025-11-05 06:40:57.612423 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 53
[2025-11-05 06:40:57.612463 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_delete(cre2_options_t * opt),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)
[2025-11-05 06:40:57.613249 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 32, quiet_round: 0, discovered_api_pairs: 763
[2025-11-05 06:40:57.652742 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:40:57.653098 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_delete(cre2_options_t * opt),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char sample_text[] = \"sample\";\n    const int sample_text_len = (int)(sizeof(sample_text) - 1);\n    char text_buf[32];\n    cre2_options_t * opt = NULL;\n    int one_line_flag = 0;\n    int wb_flag_set = 1;\n    int perl_flag_set = 1;\n    int wb_flag_read = 0;\n\n    // step 2: Setup\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, sample_text, (size_t)sample_text_len);\n\n    // step 3: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, perl_flag_set);\n    cre2_opt_set_word_boundary(opt, wb_flag_set);\n\n    // step 4: Operate / Validate\n    one_line_flag = cre2_opt_one_line(opt);\n    wb_flag_read = cre2_opt_word_boundary(opt);\n    text_buf[0] = (char)((unsigned char)text_buf[0] + (unsigned char)((one_line_flag & 0x1) + (wb_flag_read & 0x1) + (perl_flag_set & 0x1)));\n\n    // step 5: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(abc)(def)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char workbuf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * errstr = NULL;\n    int one_line_flag = 1;\n    int case_flag = 1;\n\n    // step 2: Setup\n    memset(workbuf, 0, sizeof(workbuf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, one_line_flag);\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Validate\n    errstr = cre2_error_string(re);\n    workbuf[0] = errstr ? (char)errstr[0] : 0;\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:41:31.245620 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 06:41:31.245745 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 26650, Completion: 19389, Total: 46039
[2025-11-05 06:41:31.245767 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:41:31.466073 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000320/id_000320.cc
[2025-11-05 06:41:31.466134 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:31.698152 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:31.698219 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:31.700852 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:31.700882 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:31.921922 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000321/id_000321.cc
[2025-11-05 06:41:31.921985 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:32.154453 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:32.154519 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:32.157083 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:32.157112 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:32.376777 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000322/id_000322.cc
[2025-11-05 06:41:32.376868 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:32.608642 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:32.608746 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:32.611104 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:32.611131 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:32.832091 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000323/id_000323.cc
[2025-11-05 06:41:32.832144 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:33.063506 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:33.063563 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:33.066338 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:33.066371 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:33.286963 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000324/id_000324.cc
[2025-11-05 06:41:33.287017 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:33.516631 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:33.516745 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:33.519356 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:33.519382 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:33.741590 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000325/id_000325.cc
[2025-11-05 06:41:33.741895 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:33.974754 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:33.974826 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:33.977655 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:33.977687 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:34.200268 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000326/id_000326.cc
[2025-11-05 06:41:34.200321 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:34.429477 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:34.429552 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:34.432163 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:34.432189 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:34.650404 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000327/id_000327.cc
[2025-11-05 06:41:34.650488 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:34.880205 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:34.880275 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:34.882652 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:34.882686 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:35.102421 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000328/id_000328.cc
[2025-11-05 06:41:35.102477 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:35.331662 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:35.331739 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:35.334541 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:35.334569 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:35.552927 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000329/id_000329.cc
[2025-11-05 06:41:35.552981 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:41:35.782042 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:41:35.782162 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:41:35.784850 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:41:35.784877 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:41:35.784916 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:41:35.784934 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 330, succ: 329, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:41:35.784950 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:41:35.784978 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:41:36.068750 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 329 as an example for the next prompt.
[2025-11-05 06:41:36.068803 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 06:41:36.068836 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 06:41:36.068884 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,88.0,28.0,15.0,46.0,24.0,8.0,27.0,5.0,11.0,132.0,28.0,21.0,71.0,14.0,77.0,33.0,39.0,30.0,12.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,58.0,128.0,28.0,254.0,35.0,23.0,8.0,14.0,4.0,16.0,153.0,11.0,15.0,31.0,4.0,10.0,20.0,107.0,13.0,1.0,15.0,1.0,1.0,47.0,1.0,73.0,14.0,17.0,4.0,4.0,29.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:41:36.068912 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:41:36.068962 +00:00] INFO [src/feedback/schedule.rs:246] Loop 33: Replaced with lowest energy API: cre2_find_and_consume_re (energy: 1), prob: 0.2537
[2025-11-05 06:41:36.068984 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume_re energy: 1
[2025-11-05 06:41:36.069013 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 4
[2025-11-05 06:41:36.069043 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 107
[2025-11-05 06:41:36.069069 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 77
[2025-11-05 06:41:36.069124 +00:00] INFO [src/feedback/schedule.rs:246] Loop 33: Replaced with lowest energy API: cre2_find_and_consume_re (energy: 1), prob: 0.2537
[2025-11-05 06:41:36.069152 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 28
[2025-11-05 06:41:36.069187 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_find_and_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_version_interface_revision(),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_options_t *cre2_opt_new(),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)
[2025-11-05 06:41:36.069986 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 33, quiet_round: 0, discovered_api_pairs: 774
[2025-11-05 06:41:36.119329 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:41:36.119695 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_find_and_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_version_interface_revision(),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(abc)(def)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char workbuf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * errstr = NULL;\n    int one_line_flag = 1;\n    int case_flag = 1;\n\n    // step 2: Setup\n    memset(workbuf, 0, sizeof(workbuf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, one_line_flag);\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Validate\n    errstr = cre2_error_string(re);\n    workbuf[0] = errstr ? (char)errstr[0] : 0;\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char text[] = \"hello world\";\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    cre2_options_t * opt = NULL;\n    int perl_flag = 1;\n    cre2_encoding_t enc_set = CRE2_UTF8;\n    int computed_sum = 0;\n\n    // step 2: Setup\n    memset(ranges, 0, sizeof(ranges));\n    strings[0].data = text;\n    strings[0].length = 5; /* \"hello\" */\n    strings[1].data = text + 6;\n    strings[1].length = 5; /* \"world\" */\n\n    // step 3: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, perl_flag);\n    cre2_opt_set_encoding(opt, enc_set);\n\n    // step 4: Operate\n    cre2_strings_to_ranges(text, ranges, strings, 2);\n\n    // step 5: Validate\n    computed_sum = (int)((long)strings[0].length + ranges[0].start + ranges[0].past + perl_flag + (int)enc_set);\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    (void)computed_sum;\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:42:23.343672 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 47s
[2025-11-05 06:42:23.343784 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27270, Completion: 23839, Total: 51109
[2025-11-05 06:42:23.343804 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:42:23.565727 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000330/id_000330.cc
[2025-11-05 06:42:23.565779 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:23.798090 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:23.798165 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:23.800993 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:23.801024 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:24.023085 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000331/id_000331.cc
[2025-11-05 06:42:24.023136 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:24.253947 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:24.254015 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:24.256715 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:24.256742 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:24.478476 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000332/id_000332.cc
[2025-11-05 06:42:24.478568 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:24.724862 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:24.724974 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:24.727871 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:24.727914 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:24.953082 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000333/id_000333.cc
[2025-11-05 06:42:24.953134 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:25.189815 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:25.189888 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:25.192658 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:25.192690 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:25.416439 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000334/id_000334.cc
[2025-11-05 06:42:25.416492 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:25.647551 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:25.647671 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:25.650660 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:25.650693 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:25.872430 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000335/id_000335.cc
[2025-11-05 06:42:25.872485 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:26.105073 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:26.105143 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:26.107732 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:26.107767 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:26.333013 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000336/id_000336.cc
[2025-11-05 06:42:26.333073 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:26.564302 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:26.564365 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:26.567277 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:26.567308 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:26.789985 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000337/id_000337.cc
[2025-11-05 06:42:26.790073 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:27.023015 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:27.023073 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:27.025812 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:27.025844 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:27.254834 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000338/id_000338.cc
[2025-11-05 06:42:27.254887 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:27.488700 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:27.488768 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:27.491650 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:27.491682 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:27.714280 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000339/id_000339.cc
[2025-11-05 06:42:27.714347 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:42:27.947312 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:42:27.947432 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:42:27.950353 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:42:27.950386 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:42:27.950432 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:42:27.950452 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 340, succ: 339, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:42:27.950472 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:42:27.950505 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:42:28.246354 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 339 as an example for the next prompt.
[2025-11-05 06:42:28.246420 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 06:42:28.246463 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 06:42:28.246519 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,88.0,28.0,15.0,46.0,24.0,8.0,27.0,5.0,11.0,137.0,33.0,21.0,71.0,14.0,80.0,33.0,39.0,30.0,12.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,58.0,128.0,28.0,258.0,35.0,23.0,8.0,14.0,14.0,16.0,153.0,11.0,15.0,31.0,4.0,10.0,20.0,113.0,13.0,9.0,15.0,1.0,1.0,48.0,1.0,75.0,14.0,17.0,4.0,4.0,29.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:42:28.246541 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:42:28.246601 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_posix_syntax energy: 8
[2025-11-05 06:42:28.246637 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 153
[2025-11-05 06:42:28.246671 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 48
[2025-11-05 06:42:28.246704 +00:00] INFO [src/feedback/schedule.rs:246] Loop 34: Replaced with lowest energy API: cre2_opt_max_mem (energy: 1), prob: 0.2496
[2025-11-05 06:42:28.246723 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 1
[2025-11-05 06:42:28.246763 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_delete(cre2_options_t * opt),
    int64_t cre2_opt_max_mem(cre2_options_t * opt)
[2025-11-05 06:42:28.247553 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 34, quiet_round: 0, discovered_api_pairs: 789
[2025-11-05 06:42:28.286135 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:42:28.286494 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_delete(cre2_options_t * opt),\n    int64_t cre2_opt_max_mem(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char text[] = \"hello world\";\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    cre2_options_t * opt = NULL;\n    int perl_flag = 1;\n    cre2_encoding_t enc_set = CRE2_UTF8;\n    int computed_sum = 0;\n\n    // step 2: Setup\n    memset(ranges, 0, sizeof(ranges));\n    strings[0].data = text;\n    strings[0].length = 5; /* \"hello\" */\n    strings[1].data = text + 6;\n    strings[1].length = 5; /* \"world\" */\n\n    // step 3: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, perl_flag);\n    cre2_opt_set_encoding(opt, enc_set);\n\n    // step 4: Operate\n    cre2_strings_to_ranges(text, ranges, strings, 2);\n\n    // step 5: Validate\n    computed_sum = (int)((long)strings[0].length + ranges[0].start + ranges[0].past + perl_flag + (int)enc_set);\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    (void)computed_sum;\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello) (world)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char input_buf[] = \"hello world and more\";\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text;\n    cre2_string_t matches[3];\n    cre2_string_t consume_target;\n    int match_result = 0;\n    int consume_result = 0;\n    int version_rev = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(target_buf, 0, sizeof(target_buf));\n    memset(matches, 0, sizeof(matches));\n    text.data = input_buf;\n    text.length = (int)(sizeof(input_buf) - 1);\n    consume_target.data = target_buf;\n    consume_target.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n    (void)enc;\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    match_result = cre2_match(re, input_buf, (int)(sizeof(input_buf) - 1), 0, text.length, CRE2_UNANCHORED, matches, 3);\n    consume_result = cre2_find_and_consume_re(re, &text, &consume_target, 0);\n\n    // step 5: Validate\n    version_rev = cre2_version_interface_revision();\n    computed_check = match_result + consume_result + version_rev + (int)cre2_opt_encoding(opt) + matches[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:43:02.447785 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 06:43:02.447907 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27840, Completion: 18043, Total: 45883
[2025-11-05 06:43:02.447928 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:43:02.665406 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000340/id_000340.cc
[2025-11-05 06:43:02.665458 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:02.894551 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:02.894622 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:02.897518 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:02.897551 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:03.115019 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000341/id_000341.cc
[2025-11-05 06:43:03.115071 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:03.344387 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:03.344459 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:03.347356 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:03.347387 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:03.565405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000342/id_000342.cc
[2025-11-05 06:43:03.565489 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:03.794389 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:03.794460 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:03.797407 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:03.797439 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:04.014903 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000343/id_000343.cc
[2025-11-05 06:43:04.014955 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:04.245425 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:04.245492 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:04.248176 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:04.248203 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:04.464438 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000344/id_000344.cc
[2025-11-05 06:43:04.464491 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:04.693807 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:04.693915 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:04.696764 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:04.696796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:04.914947 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000345/id_000345.cc
[2025-11-05 06:43:04.915000 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:05.142694 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:05.142772 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:05.145622 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:05.145654 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:05.364142 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000346/id_000346.cc
[2025-11-05 06:43:05.364194 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:05.591996 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:05.592067 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:05.594892 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:05.594924 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:05.812490 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000347/id_000347.cc
[2025-11-05 06:43:05.812573 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:06.041795 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:06.041874 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:06.044673 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:06.044705 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:06.262888 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000348/id_000348.cc
[2025-11-05 06:43:06.262941 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:06.492754 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:06.492822 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:06.495631 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:06.495662 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:06.714125 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000349/id_000349.cc
[2025-11-05 06:43:06.714178 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:06.944352 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:06.944439 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:06.947338 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:06.947370 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:06.947408 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:43:06.947425 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 350, succ: 349, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:43:06.947440 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:43:06.947481 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:43:07.232434 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 349 as an example for the next prompt.
[2025-11-05 06:43:07.232490 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 06:43:07.232534 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 06:43:07.232584 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,88.0,28.0,15.0,46.0,24.0,16.0,27.0,5.0,11.0,137.0,33.0,21.0,71.0,14.0,84.0,33.0,39.0,30.0,12.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,58.0,128.0,28.0,258.0,35.0,23.0,8.0,14.0,14.0,16.0,163.0,11.0,15.0,31.0,4.0,10.0,20.0,113.0,13.0,9.0,15.0,11.0,1.0,51.0,1.0,75.0,14.0,17.0,10.0,4.0,29.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:43:07.232601 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:43:07.232670 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 128
[2025-11-05 06:43:07.232706 +00:00] INFO [src/feedback/schedule.rs:246] Loop 35: Replaced with lowest energy API: cre2_version_interface_current (energy: 1), prob: 0.2453
[2025-11-05 06:43:07.232726 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_current energy: 1
[2025-11-05 06:43:07.232754 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 84
[2025-11-05 06:43:07.232803 +00:00] INFO [src/feedback/schedule.rs:246] Loop 35: Replaced with lowest energy API: cre2_version_interface_current (energy: 1), prob: 0.2453
[2025-11-05 06:43:07.232830 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_quote_meta energy: 21
[2025-11-05 06:43:07.232876 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_version_interface_current(),
    cre2_options_t *cre2_opt_new(),
    int cre2_quote_meta(cre2_string_t * quoted, cre2_string_t * original)
[2025-11-05 06:43:07.233600 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 35, quiet_round: 0, discovered_api_pairs: 804
[2025-11-05 06:43:07.256880 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:43:07.257245 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_version_interface_current(),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_quote_meta(cre2_string_t * quoted, cre2_string_t * original)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello) (world)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char input_buf[] = \"hello world and more\";\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text;\n    cre2_string_t matches[3];\n    cre2_string_t consume_target;\n    int match_result = 0;\n    int consume_result = 0;\n    int version_rev = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(target_buf, 0, sizeof(target_buf));\n    memset(matches, 0, sizeof(matches));\n    text.data = input_buf;\n    text.length = (int)(sizeof(input_buf) - 1);\n    consume_target.data = target_buf;\n    consume_target.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n    (void)enc;\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    match_result = cre2_match(re, input_buf, (int)(sizeof(input_buf) - 1), 0, text.length, CRE2_UNANCHORED, matches, 3);\n    consume_result = cre2_find_and_consume_re(re, &text, &consume_target, 0);\n\n    // step 5: Validate\n    version_rev = cre2_version_interface_revision();\n    computed_check = match_result + consume_result + version_rev + (int)cre2_opt_encoding(opt) + matches[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"hello\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"hello world\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_string_t matches[2];\n    int easy_result = 0;\n    int computed_check = 0;\n    int64_t max_mem = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024); /* set 1MB cap */\n    max_mem = cre2_opt_max_mem(opt);\n\n    // step 4: Operate\n    easy_result = cre2_easy_match(pattern, pattern_len, text, text_len, matches, 2);\n\n    // step 5: Validate\n    computed_check = easy_result + (int)(pattern_len) + (int)(text_len) + (int)(max_mem & 0xFFFF) + matches[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:43:38.309078 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 06:43:38.309204 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27730, Completion: 16732, Total: 44462
[2025-11-05 06:43:38.309227 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:43:38.527919 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000350/id_000350.cc
[2025-11-05 06:43:38.527973 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:38.759921 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:38.759997 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:38.762815 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:38.762846 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:38.981104 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000351/id_000351.cc
[2025-11-05 06:43:38.981161 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:39.211559 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:39.211639 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:39.214314 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:39.214345 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:39.432803 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000352/id_000352.cc
[2025-11-05 06:43:39.432886 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:39.662193 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:39.662267 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:39.665155 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:39.665190 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:39.884797 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000353/id_000353.cc
[2025-11-05 06:43:39.884850 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:40.113497 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:40.113566 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:40.116273 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:40.116303 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:40.336743 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000354/id_000354.cc
[2025-11-05 06:43:40.336796 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:40.566261 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:40.566366 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:40.569132 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:40.569164 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:40.788330 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000355/id_000355.cc
[2025-11-05 06:43:40.788382 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:41.018380 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:41.018450 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:41.021245 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:41.021277 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:41.238319 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000356/id_000356.cc
[2025-11-05 06:43:41.238375 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:41.468760 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:41.468827 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:41.471505 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:41.471560 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:41.690107 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000357/id_000357.cc
[2025-11-05 06:43:41.690188 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:41.918055 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:41.918122 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:41.920920 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:41.920952 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:42.139767 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000358/id_000358.cc
[2025-11-05 06:43:42.139819 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:42.369607 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:42.369675 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:42.372181 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:42.372208 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:42.603912 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000359/id_000359.cc
[2025-11-05 06:43:42.603965 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:43:42.834510 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:43:42.834609 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:43:42.837308 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:43:42.837337 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:43:42.837372 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:43:42.837387 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 360, succ: 359, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:43:42.837401 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:43:42.837426 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:43:43.110130 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 359 as an example for the next prompt.
[2025-11-05 06:43:43.110186 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 7 new API pairs in this round.
[2025-11-05 06:43:43.110216 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 7
[2025-11-05 06:43:43.110263 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,88.0,28.0,15.0,46.0,24.0,16.0,27.0,5.0,11.0,137.0,33.0,27.0,71.0,14.0,86.0,33.0,39.0,30.0,12.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,58.0,132.0,28.0,258.0,35.0,23.0,8.0,14.0,14.0,16.0,163.0,11.0,15.0,31.0,4.0,10.0,20.0,113.0,13.0,9.0,15.0,11.0,6.0,54.0,1.0,75.0,14.0,17.0,10.0,4.0,29.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:43:43.110280 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:43:43.110333 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 75
[2025-11-05 06:43:43.110366 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_nl energy: 16
[2025-11-05 06:43:43.110392 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 31
[2025-11-05 06:43:43.110441 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 33
[2025-11-05 06:43:43.110481 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_opt_never_nl(cre2_options_t * opt),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)
[2025-11-05 06:43:43.111170 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 36, quiet_round: 0, discovered_api_pairs: 811
[2025-11-05 06:43:43.158306 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:43:43.158652 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_opt_never_nl(cre2_options_t * opt),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"hello\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"hello world\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_string_t matches[2];\n    int easy_result = 0;\n    int computed_check = 0;\n    int64_t max_mem = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024); /* set 1MB cap */\n    max_mem = cre2_opt_max_mem(opt);\n\n    // step 4: Operate\n    easy_result = cre2_easy_match(pattern, pattern_len, text, text_len, matches, 2);\n\n    // step 5: Validate\n    computed_check = easy_result + (int)(pattern_len) + (int)(text_len) + (int)(max_mem & 0xFFFF) + matches[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    char original_buf[] = \"a+b?c^d$[](){}|\\\\\";\n    char quoted_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_string_t original;\n    cre2_string_t quoted;\n    int quote_result = 0;\n    int version_current = 0;\n    int case_flag = 1;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(quoted_buf, 0, sizeof(quoted_buf));\n    original.data = original_buf;\n    original.length = (int)(sizeof(original_buf) - 1);\n    quoted.data = quoted_buf;\n    quoted.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 4: Operate\n    quote_result = cre2_quote_meta(&quoted, &original);\n\n    // step 5: Validate\n    version_current = cre2_version_interface_current();\n    computed_check = quote_result + version_current + quoted.length + original.length + case_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:44:24.209135 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 06:44:24.209260 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27040, Completion: 22739, Total: 49779
[2025-11-05 06:44:24.209281 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:44:24.427223 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000360/id_000360.cc
[2025-11-05 06:44:24.427277 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:24.658578 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:24.658649 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:24.661490 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:24.661522 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:24.879400 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000361/id_000361.cc
[2025-11-05 06:44:24.879454 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:25.118882 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:25.118941 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:25.121604 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:25.121638 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:25.340480 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000362/id_000362.cc
[2025-11-05 06:44:25.340565 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:25.571129 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:25.571191 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:25.573890 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:25.573921 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:25.793087 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000363/id_000363.cc
[2025-11-05 06:44:25.793139 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:26.025510 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:26.025577 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:26.028424 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:26.028475 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:26.248975 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000364/id_000364.cc
[2025-11-05 06:44:26.249027 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:26.481796 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:26.481894 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:26.484642 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:26.484675 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:26.706023 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000365/id_000365.cc
[2025-11-05 06:44:26.706076 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:26.935551 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:26.935609 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:26.938373 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:26.938405 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:27.157644 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000366/id_000366.cc
[2025-11-05 06:44:27.157699 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:27.385705 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:27.385765 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:27.388613 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:27.388655 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:27.606877 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000367/id_000367.cc
[2025-11-05 06:44:27.606961 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:27.838841 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:27.838909 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:27.841636 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:27.841669 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:28.060584 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000368/id_000368.cc
[2025-11-05 06:44:28.060656 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:28.293577 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:28.293650 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:28.296424 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:28.296458 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:28.516437 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000369/id_000369.cc
[2025-11-05 06:44:28.516490 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:44:28.745441 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:44:28.745550 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:44:28.748305 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:44:28.748338 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:44:28.748377 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:44:28.748394 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 370, succ: 369, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:44:28.748410 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:44:28.748437 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:44:29.036906 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 369 as an example for the next prompt.
[2025-11-05 06:44:29.036961 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 22 new API pairs in this round.
[2025-11-05 06:44:29.037002 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 22
[2025-11-05 06:44:29.037049 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,88.0,28.0,15.0,46.0,24.0,16.0,27.0,5.0,11.0,140.0,45.0,27.0,71.0,14.0,90.0,33.0,39.0,30.0,12.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,58.0,132.0,28.0,269.0,35.0,23.0,8.0,14.0,14.0,25.0,163.0,11.0,15.0,44.0,4.0,10.0,20.0,113.0,13.0,9.0,15.0,11.0,6.0,54.0,1.0,83.0,18.0,17.0,10.0,4.0,29.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:44:29.037067 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:44:29.037119 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 163
[2025-11-05 06:44:29.037153 +00:00] INFO [src/feedback/schedule.rs:246] Loop 37: Replaced with lowest energy API: cre2_partial_match_re (energy: 1), prob: 0.2358
[2025-11-05 06:44:29.037170 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match_re energy: 1
[2025-11-05 06:44:29.037200 +00:00] INFO [src/feedback/schedule.rs:246] Loop 37: Replaced with lowest energy API: cre2_partial_match_re (energy: 1), prob: 0.2358
[2025-11-05 06:44:29.037225 +00:00] INFO [src/feedback/schedule.rs:246] Loop 37: Replaced with lowest energy API: cre2_partial_match_re (energy: 1), prob: 0.2358
[2025-11-05 06:44:29.037251 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 29
[2025-11-05 06:44:29.037277 +00:00] INFO [src/feedback/schedule.rs:246] Loop 37: Replaced with lowest energy API: cre2_partial_match_re (energy: 1), prob: 0.2358
[2025-11-05 06:44:29.037304 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 33
[2025-11-05 06:44:29.037338 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag)
[2025-11-05 06:44:29.038049 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 37, quiet_round: 0, discovered_api_pairs: 833
[2025-11-05 06:44:29.084751 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:44:29.085111 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    char original_buf[] = \"a+b?c^d$[](){}|\\\\\";\n    char quoted_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_string_t original;\n    cre2_string_t quoted;\n    int quote_result = 0;\n    int version_current = 0;\n    int case_flag = 1;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(quoted_buf, 0, sizeof(quoted_buf));\n    original.data = original_buf;\n    original.length = (int)(sizeof(original_buf) - 1);\n    quoted.data = quoted_buf;\n    quoted.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 4: Operate\n    quote_result = cre2_quote_meta(&quoted, &original);\n\n    // step 5: Validate\n    version_current = cre2_version_interface_current();\n    computed_check = quote_result + version_current + quoted.length + original.length + case_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxabcdyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_sp;\n    cre2_string_t matches[4];\n    cre2_string_t partial_matches[2];\n    int never_nl_flag = 0;\n    int partial_res = 0;\n    int match_res = 0;\n    const char * compiled_pat = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_never_nl(opt, 1);\n    never_nl_flag = cre2_opt_never_nl(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    partial_res = cre2_partial_match(pattern, &text_sp, partial_matches, 2);\n    match_res = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, 4);\n\n    // step 5: Validate\n    compiled_pat = cre2_pattern(re);\n    computed_check = partial_res + match_res + never_nl_flag + matches[0].length + partial_matches[0].length + pattern_len + text_len;\n    (void)computed_check;\n    (void)compiled_pat;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:45:03.258335 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 06:45:03.258437 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27920, Completion: 21793, Total: 49713
[2025-11-05 06:45:03.258457 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:45:03.475935 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000370/id_000370.cc
[2025-11-05 06:45:03.475988 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:03.705299 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:03.705373 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:03.708596 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:03.708642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:03.927013 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000371/id_000371.cc
[2025-11-05 06:45:03.927065 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:04.157250 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:04.157315 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:04.160072 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:04.160103 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:04.377684 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000372/id_000372.cc
[2025-11-05 06:45:04.377767 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:04.607962 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:04.608026 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:04.610895 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:04.610926 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:04.828923 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000373/id_000373.cc
[2025-11-05 06:45:04.828973 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:05.059221 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:05.059277 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:05.062151 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:05.062184 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:05.281178 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000374/id_000374.cc
[2025-11-05 06:45:05.281229 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:05.509976 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:05.510090 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:05.512973 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:05.513006 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:05.730781 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000375/id_000375.cc
[2025-11-05 06:45:05.730841 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:05.960372 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:05.960437 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:05.963195 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:05.963222 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:06.181751 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000376/id_000376.cc
[2025-11-05 06:45:06.181802 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:06.412200 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:06.412256 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:06.415030 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:06.415062 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:06.632558 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000377/id_000377.cc
[2025-11-05 06:45:06.632654 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:06.861601 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:06.861677 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:06.864554 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:06.864585 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:07.083375 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000378/id_000378.cc
[2025-11-05 06:45:07.083426 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:07.312966 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:07.313041 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:07.315697 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:07.315730 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:07.533902 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000379/id_000379.cc
[2025-11-05 06:45:07.533954 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:45:07.763447 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:45:07.763562 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:45:07.766492 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:45:07.766524 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:45:07.766564 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:45:07.766580 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 380, succ: 379, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:45:07.766595 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:45:07.766623 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:45:08.052964 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 379 as an example for the next prompt.
[2025-11-05 06:45:08.053029 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 06:45:08.053076 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 06:45:08.053128 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,88.0,28.0,15.0,46.0,24.0,16.0,34.0,5.0,11.0,143.0,45.0,27.0,71.0,14.0,91.0,35.0,39.0,30.0,12.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,58.0,132.0,28.0,272.0,42.0,23.0,8.0,14.0,14.0,25.0,168.0,11.0,15.0,44.0,4.0,10.0,20.0,113.0,13.0,9.0,15.0,11.0,6.0,54.0,10.0,83.0,18.0,17.0,10.0,4.0,37.0,1.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:45:08.053146 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:45:08.053196 +00:00] INFO [src/feedback/schedule.rs:246] Loop 38: Replaced with lowest energy API: cre2_consume (energy: 1), prob: 0.2306
[2025-11-05 06:45:08.053220 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 1
[2025-11-05 06:45:08.053255 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add energy: 4
[2025-11-05 06:45:08.053317 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 17
[2025-11-05 06:45:08.053353 +00:00] INFO [src/feedback/schedule.rs:246] Loop 38: Replaced with lowest energy API: cre2_consume (energy: 1), prob: 0.2306
[2025-11-05 06:45:08.053384 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 272
[2025-11-05 06:45:08.053415 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 39
[2025-11-05 06:45:08.053456 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_error_code(const cre2_regexp_t * re)
[2025-11-05 06:45:08.054274 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 38, quiet_round: 0, discovered_api_pairs: 848
[2025-11-05 06:45:08.108304 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:45:08.108676 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_error_code(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxabcdyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_sp;\n    cre2_string_t matches[4];\n    cre2_string_t partial_matches[2];\n    int never_nl_flag = 0;\n    int partial_res = 0;\n    int match_res = 0;\n    const char * compiled_pat = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_never_nl(opt, 1);\n    never_nl_flag = cre2_opt_never_nl(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    partial_res = cre2_partial_match(pattern, &text_sp, partial_matches, 2);\n    match_res = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, 4);\n\n    // step 5: Validate\n    compiled_pat = cre2_pattern(re);\n    computed_check = partial_res + match_res + never_nl_flag + matches[0].length + partial_matches[0].length + pattern_len + text_len;\n    (void)computed_check;\n    (void)compiled_pat;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxabcdyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t easy_match[1];\n    cre2_string_t partial_matches[3];\n    cre2_string_t text_sp;\n    int easy_res = 0;\n    int partial_res = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(easy_match, 0, sizeof(easy_match));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_match, 1);\n    partial_res = cre2_partial_match_re(re, &text_sp, partial_matches, 3);\n\n    // step 5: Validate\n    computed_check = easy_res + partial_res + easy_match[0].length + partial_matches[0].length + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:45:42.641155 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 06:45:42.641278 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29310, Completion: 22054, Total: 51364
[2025-11-05 06:45:42.641298 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:45:42.858525 +00:00] WARN [src/fuzzer.rs:205] Program 380 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000380/id_000380.cc:46:11: error: no matching function for call to 'cre2_set_new'
   46 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 06:45:42.912671 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:45:42.913013 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxabcdyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_sp;\n    cre2_string_t matches[4];\n    char errbuf[128];\n    int consume_res = 0;\n    int set_add_res = 0;\n    int errcode = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(errbuf, 0, sizeof(errbuf));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    errcode = cre2_error_code(re);\n    set = cre2_set_new(opt, 0);\n    set_add_res = cre2_set_add(set, pattern, (size_t)pattern_len, errbuf, sizeof(errbuf));\n    consume_res = cre2_consume(pattern, &text_sp, matches, 4);\n\n    // step 5: Validate\n    computed_check = consume_res + set_add_res + errcode + matches[0].length + text_sp.length + pattern_len + (int)errbuf[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000380/id_000380.cc:46:11: error: no matching function for call to 'cre2_set_new'\n   46 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:46:05.088702 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 22s
[2025-11-05 06:46:05.088823 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22390, Completion: 10795, Total: 33185
[2025-11-05 06:46:05.306565 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000380/id_000380.cc
[2025-11-05 06:46:05.306616 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:05.534580 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:05.534656 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:05.537476 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:05.537508 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:05.537565 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 380!
[2025-11-05 06:46:05.755129 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000381/id_000381.cc
[2025-11-05 06:46:05.755181 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:05.985672 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:05.985729 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:05.988577 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:05.988610 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:06.205978 +00:00] WARN [src/fuzzer.rs:205] Program 382 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000382/id_000382.cc:42:11: error: no matching function for call to 'cre2_set_new'
   42 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 06:46:06.260123 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:46:06.260458 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)?baz\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarbazyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_sp;\n    cre2_string_t consumed;\n    char set_errbuf[64];\n    int set_add_res = 0;\n    int consume_res = 0;\n    int err_code = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&consumed, 0, sizeof(consumed));\n    memset(set_errbuf, 0, sizeof(set_errbuf));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    set = cre2_set_new(opt, 0);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    set_add_res = cre2_set_add(set, pattern, (size_t)pattern_len, set_errbuf, sizeof(set_errbuf));\n    consume_res = cre2_consume(pattern, &text_sp, &consumed, 1);\n    err_code = cre2_error_code(re);\n\n    // step 5: Validate\n    computed_check = set_add_res + consume_res + err_code + consumed.length + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000382/id_000382.cc:42:11: error: no matching function for call to 'cre2_set_new'\n   42 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:46:27.998378 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 06:46:27.998499 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22370, Completion: 13857, Total: 36227
[2025-11-05 06:46:28.224294 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000382/id_000382.cc
[2025-11-05 06:46:28.224350 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:28.453705 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:28.453762 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:28.456644 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:28.456678 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:28.456711 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 382!
[2025-11-05 06:46:28.674405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000383/id_000383.cc
[2025-11-05 06:46:28.674457 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:28.902774 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:28.902849 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:28.905673 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:28.905705 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:29.123351 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000384/id_000384.cc
[2025-11-05 06:46:29.123434 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:29.358935 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:29.358993 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:29.361859 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:29.361891 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:29.579795 +00:00] WARN [src/fuzzer.rs:205] Program 385 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000385/id_000385.cc:47:11: error: no matching function for call to 'cre2_set_new'
   47 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 06:46:29.634029 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:46:29.634366 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"\\\\bfox\\\\b\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"the quick brown fox jumps\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_sp;\n    cre2_string_t matches[2];\n    char set_error[64];\n    int set_add_res = 0;\n    int consume_res = 0;\n    int err_code = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(set_error, 0, sizeof(set_error));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 4: Compile\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Operate\n    set = cre2_set_new(opt, 0);\n    set_add_res = cre2_set_add(set, pattern, (size_t)pattern_len, set_error, sizeof(set_error));\n    consume_res = cre2_consume(pattern, &text_sp, matches, 2);\n    err_code = cre2_error_code(re);\n\n    // step 6: Validate and Cleanup\n    computed_check = set_add_res + consume_res + err_code + matches[0].length + matches[1].length + pattern_len + text_len + (int)set_error[0];\n    (void)computed_check;\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000385/id_000385.cc:47:11: error: no matching function for call to 'cre2_set_new'\n   47 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:46:48.056724 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 18s
[2025-11-05 06:46:48.056851 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22460, Completion: 12589, Total: 35049
[2025-11-05 06:46:48.276321 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000385/id_000385.cc
[2025-11-05 06:46:48.276373 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:48.505004 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:48.505071 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:48.507558 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:48.507586 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:48.507617 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 385!
[2025-11-05 06:46:48.725201 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000386/id_000386.cc
[2025-11-05 06:46:48.725253 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:48.955157 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:48.955226 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:48.958060 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:48.958094 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:49.182114 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000387/id_000387.cc
[2025-11-05 06:46:49.182198 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:49.412454 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:49.412525 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:49.415361 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:49.415388 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:49.632431 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000388/id_000388.cc
[2025-11-05 06:46:49.632485 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:49.862664 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:49.862732 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:49.865637 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:49.865670 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:50.084116 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000389/id_000389.cc
[2025-11-05 06:46:50.084168 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:46:50.312808 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:46:50.312909 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:46:50.315413 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:46:50.315447 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:46:50.315486 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:46:50.315502 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 390, succ: 389, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:46:50.315517 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:46:50.315545 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:46:50.602294 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 389 as an example for the next prompt.
[2025-11-05 06:46:50.602349 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 28 new API pairs in this round.
[2025-11-05 06:46:50.602397 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 28
[2025-11-05 06:46:50.602447 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,88.0,28.0,15.0,46.0,24.0,16.0,34.0,5.0,11.0,148.0,45.0,27.0,71.0,14.0,94.0,35.0,50.0,30.0,16.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,58.0,132.0,28.0,286.0,42.0,35.0,8.0,14.0,14.0,25.0,168.0,11.0,15.0,44.0,18.0,10.0,20.0,113.0,13.0,9.0,15.0,11.0,6.0,54.0,10.0,83.0,18.0,28.0,10.0,4.0,37.0,11.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:46:50.602465 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:46:50.602518 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 94
[2025-11-05 06:46:50.602552 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 168
[2025-11-05 06:46:50.602580 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 58
[2025-11-05 06:46:50.602605 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 286
[2025-11-05 06:46:50.602632 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 88
[2025-11-05 06:46:50.602670 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc)
[2025-11-05 06:46:50.603477 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 39, quiet_round: 0, discovered_api_pairs: 876
[2025-11-05 06:46:50.652048 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:46:50.652415 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxabcdyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t easy_match[1];\n    cre2_string_t partial_matches[3];\n    cre2_string_t text_sp;\n    int easy_res = 0;\n    int partial_res = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(easy_match, 0, sizeof(easy_match));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_match, 1);\n    partial_res = cre2_partial_match_re(re, &text_sp, partial_matches, 3);\n\n    // step 5: Validate\n    computed_check = easy_res + partial_res + easy_match[0].length + partial_matches[0].length + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|world\";\n    const size_t set_pattern_len = (size_t)(sizeof(set_pattern) - 1);\n    const char text_buf[] = \"xxabcdyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_sp;\n    cre2_string_t matches[3];\n    char set_err[64];\n    int add_res = 0;\n    int consume_res = 0;\n    int err_code = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(set_err, 0, sizeof(set_err));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    add_res = cre2_set_add(set, set_pattern, set_pattern_len, set_err, sizeof(set_err));\n    consume_res = cre2_consume(pattern, &text_sp, matches, 3);\n\n    // step 5: Validate\n    err_code = cre2_error_code(re);\n    computed_check = add_res + consume_res + err_code + matches[0].length + (int)set_err[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:47:17.035225 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 06:47:17.035345 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29630, Completion: 16641, Total: 46271
[2025-11-05 06:47:17.035366 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:47:17.253620 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000390/id_000390.cc
[2025-11-05 06:47:17.253671 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:17.482792 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:17.482873 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:17.485797 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:17.485829 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:17.703927 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000391/id_000391.cc
[2025-11-05 06:47:17.703979 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:17.932797 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:17.932871 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:17.935652 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:17.935683 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:18.154110 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000392/id_000392.cc
[2025-11-05 06:47:18.154196 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:18.384113 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:18.384192 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:18.387111 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:18.387142 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:18.606788 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000393/id_000393.cc
[2025-11-05 06:47:18.606842 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:18.835476 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:18.835551 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:18.838314 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:18.838348 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:19.056054 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000394/id_000394.cc
[2025-11-05 06:47:19.056108 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:19.283304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:19.283419 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:19.286315 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:19.286345 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:19.503664 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000395/id_000395.cc
[2025-11-05 06:47:19.503717 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:19.732614 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:19.732697 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:19.735417 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:19.735443 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:19.953137 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000396/id_000396.cc
[2025-11-05 06:47:19.953189 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:20.181961 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:20.182033 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:20.184960 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:20.184991 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:20.403603 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000397/id_000397.cc
[2025-11-05 06:47:20.403689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:20.631353 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:20.631426 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:20.634226 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:20.634257 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:20.852556 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000398/id_000398.cc
[2025-11-05 06:47:20.852606 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:21.082938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:21.083010 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:21.085908 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:21.085939 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:21.303465 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000399/id_000399.cc
[2025-11-05 06:47:21.303530 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:47:21.531848 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:47:21.531961 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:47:21.534824 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:47:21.534856 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:47:21.534896 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:47:21.534912 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 400, succ: 399, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:47:21.534926 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:47:21.534951 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:47:21.809917 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 399 as an example for the next prompt.
[2025-11-05 06:47:21.809972 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 06:47:21.810003 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 06:47:21.810050 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,93.0,28.0,15.0,46.0,24.0,16.0,34.0,5.0,11.0,149.0,45.0,27.0,71.0,14.0,94.0,35.0,53.0,30.0,16.0,24.0,19.0,10.0,18.0,13.0,18.0,45.0,7.0,21.0,61.0,132.0,28.0,292.0,42.0,35.0,8.0,14.0,14.0,25.0,174.0,11.0,15.0,44.0,18.0,10.0,20.0,113.0,13.0,9.0,15.0,11.0,6.0,54.0,10.0,83.0,18.0,28.0,10.0,4.0,37.0,11.0,18.0,1.0,1.0,1.0]
[2025-11-05 06:47:21.810069 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:47:21.810122 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 35
[2025-11-05 06:47:21.810152 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 34
[2025-11-05 06:47:21.810179 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 15
[2025-11-05 06:47:21.810209 +00:00] INFO [src/feedback/schedule.rs:246] Loop 40: Replaced with lowest energy API: cre2_opt_dot_nl (energy: 1), prob: 0.2193
[2025-11-05 06:47:21.810224 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_dot_nl energy: 1
[2025-11-05 06:47:21.810250 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 174
[2025-11-05 06:47:21.810290 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    int cre2_opt_dot_nl(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 06:47:21.811087 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 40, quiet_round: 0, discovered_api_pairs: 884
[2025-11-05 06:47:21.864891 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:47:21.865254 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    int cre2_opt_dot_nl(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|world\";\n    const size_t set_pattern_len = (size_t)(sizeof(set_pattern) - 1);\n    const char text_buf[] = \"xxabcdyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_sp;\n    cre2_string_t matches[3];\n    char set_err[64];\n    int add_res = 0;\n    int consume_res = 0;\n    int err_code = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(set_err, 0, sizeof(set_err));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    add_res = cre2_set_add(set, set_pattern, set_pattern_len, set_err, sizeof(set_err));\n    consume_res = cre2_consume(pattern, &text_sp, matches, 3);\n\n    // step 5: Validate\n    err_code = cre2_error_code(re);\n    computed_check = add_res + consume_res + err_code + matches[0].length + (int)set_err[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(h|hello)\\\\s+world\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"hello world from cre2\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t match[2];\n    cre2_string_t text_sp;\n    int easy_res = 0;\n    int err_code = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match, 2);\n\n    // step 5: Validate\n    err_code = cre2_error_code(re);\n    computed_check = easy_res + match[0].length + match[1].length + err_code + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:48:00.603847 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 06:48:00.603969 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28940, Completion: 23156, Total: 52096
[2025-11-05 06:48:00.603989 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:48:00.821689 +00:00] WARN [src/fuzzer.rs:205] Program 400 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000400/id_000400.cc:46:5: error: no matching function for call to 'cre2_opt_dot_nl'
   46 |     cre2_opt_dot_nl(opt, 1);
      |     ^~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 06:48:00.875618 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:48:00.875963 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^foo(bar)?baz\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarbazyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t easy_matches[3];\n    cre2_string_t text_sp;\n    int set_match_indices[4];\n    size_t set_match_count = 0;\n    int num_groups = 0;\n    int compile_res = 0;\n    int easy_res = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(easy_matches, 0, sizeof(easy_matches));\n    memset(set_match_indices, 0, sizeof(set_match_indices));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_dot_nl(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate\n    cre2_set_add_simple(set, \"foo\");\n    cre2_set_add_simple(set, \"qux\");\n    compile_res = cre2_set_compile(set);\n    set_match_count = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, sizeof(set_match_indices) / sizeof(set_match_indices[0]));\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_matches, 3);\n\n    // step 5: Validate\n    computed_check = (int)set_match_count + num_groups + compile_res + easy_res + easy_matches[0].length + easy_matches[1].length + set_match_indices[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000400/id_000400.cc:46:5: error: no matching function for call to 'cre2_opt_dot_nl'\n   46 |     cre2_opt_dot_nl(opt, 1);\n      |     ^~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:48:25.049089 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 24s
[2025-11-05 06:48:25.049206 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23470, Completion: 15135, Total: 38605
[2025-11-05 06:48:25.268514 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000400/id_000400.cc
[2025-11-05 06:48:25.268565 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:25.499770 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:25.499845 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:25.502596 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:25.502627 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:25.502660 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 400!
[2025-11-05 06:48:25.721013 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000401/id_000401.cc
[2025-11-05 06:48:25.721067 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:25.951600 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:25.951659 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:25.954495 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:25.954529 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:26.172682 +00:00] WARN [src/fuzzer.rs:205] Program 402 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000402/id_000402.cc:44:11: error: no matching function for call to 'cre2_set_new'
   44 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 06:48:26.226568 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:48:26.226904 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(bc)?d\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern1[] = \"hello\";\n    const char set_pattern2[] = \"good\";\n    const int text_len = (int)(sizeof(\"xxgoodyy\") - 1);\n    const char text_buf[] = \"xxgoodyy\";\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t easy_matches[3];\n    cre2_string_t text_sp;\n    int set_matches[4];\n    int num_groups = 0;\n    int easy_res = 0;\n    size_t set_match_count = 0;\n    int add1_res = 0;\n    int add2_res = 0;\n    int compile_res = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(easy_matches, 0, sizeof(easy_matches));\n    memset(set_matches, 0, sizeof(set_matches));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, 0);\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_dot_nl(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    add1_res = cre2_set_add_simple(set, set_pattern1);\n    add2_res = cre2_set_add_simple(set, set_pattern2);\n    compile_res = cre2_set_compile(set);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_matches, 3);\n    set_match_count = cre2_set_match(set, text_buf, (size_t)text_len, set_matches, sizeof(set_matches) / sizeof(set_matches[0]));\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    computed_check = easy_res + (int)set_match_count + num_groups + easy_matches[0].length + easy_matches[1].length + add1_res + add2_res + compile_res + set_matches[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000402/id_000402.cc:44:11: error: no matching function for call to 'cre2_set_new'\n   44 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 06:48:40.940124 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 14s
[2025-11-05 06:48:40.940253 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23850, Completion: 11679, Total: 35529
[2025-11-05 06:48:41.158789 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000402/id_000402.cc
[2025-11-05 06:48:41.158843 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:41.387689 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:41.387751 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:41.390592 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:41.390626 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:41.390659 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 402!
[2025-11-05 06:48:41.608297 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000403/id_000403.cc
[2025-11-05 06:48:41.608349 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:41.838348 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:41.838406 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:41.841282 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:41.841314 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:42.061393 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000404/id_000404.cc
[2025-11-05 06:48:42.061480 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:42.290174 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:42.290231 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:42.293111 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:42.293156 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:42.510794 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000405/id_000405.cc
[2025-11-05 06:48:42.510848 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:42.738368 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:42.738426 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:42.741284 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:42.741318 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:42.959247 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000406/id_000406.cc
[2025-11-05 06:48:42.959302 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:43.188362 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:43.188458 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:43.191139 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:43.191170 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:43.409336 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000407/id_000407.cc
[2025-11-05 06:48:43.409390 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:43.638319 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:43.638378 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:43.641275 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:43.641307 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:43.860860 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000408/id_000408.cc
[2025-11-05 06:48:43.860913 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:44.089752 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:44.089811 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:44.092711 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:44.092746 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:44.310061 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000409/id_000409.cc
[2025-11-05 06:48:44.310146 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:48:44.538912 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:48:44.538972 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:48:44.541815 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:48:44.541848 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:48:44.541888 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:48:44.541906 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 410, succ: 409, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:48:44.541921 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:48:44.541962 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:48:44.853522 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 409 as an example for the next prompt.
[2025-11-05 06:48:44.853579 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 44 new API pairs in this round.
[2025-11-05 06:48:44.853643 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 44
[2025-11-05 06:48:44.853692 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,93.0,28.0,15.0,46.0,24.0,16.0,50.0,5.0,11.0,152.0,45.0,27.0,71.0,14.0,97.0,43.0,55.0,30.0,25.0,24.0,19.0,10.0,18.0,13.0,26.0,45.0,7.0,21.0,61.0,132.0,28.0,307.0,42.0,43.0,8.0,14.0,14.0,25.0,188.0,11.0,15.0,44.0,18.0,10.0,20.0,113.0,13.0,9.0,28.0,11.0,6.0,54.0,10.0,83.0,18.0,28.0,10.0,4.0,37.0,11.0,36.0,4.0,13.0,1.0]
[2025-11-05 06:48:44.853710 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:48:44.853764 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 152
[2025-11-05 06:48:44.853805 +00:00] INFO [src/feedback/schedule.rs:246] Loop 41: Replaced with lowest energy API: cre2_opt_longest_match (energy: 1), prob: 0.2133
[2025-11-05 06:48:44.853826 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_longest_match energy: 1
[2025-11-05 06:48:44.853861 +00:00] INFO [src/feedback/schedule.rs:246] Loop 41: Replaced with lowest energy API: cre2_opt_longest_match (energy: 1), prob: 0.2133
[2025-11-05 06:48:44.853903 +00:00] INFO [src/feedback/schedule.rs:246] Loop 41: Replaced with lowest energy API: cre2_opt_longest_match (energy: 1), prob: 0.2133
[2025-11-05 06:48:44.853941 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 83
[2025-11-05 06:48:44.853990 +00:00] INFO [src/feedback/schedule.rs:246] Loop 41: Replaced with lowest energy API: cre2_opt_longest_match (energy: 1), prob: 0.2133
[2025-11-05 06:48:44.854030 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 36
[2025-11-05 06:48:44.854077 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    int cre2_opt_longest_match(cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 06:48:44.854766 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 41, quiet_round: 0, discovered_api_pairs: 928
[2025-11-05 06:48:44.885751 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:48:44.886113 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    int cre2_opt_longest_match(cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(h|hello)\\\\s+world\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"hello world from cre2\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t match[2];\n    cre2_string_t text_sp;\n    int easy_res = 0;\n    int err_code = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match, 2);\n\n    // step 5: Validate\n    err_code = cre2_error_code(re);\n    computed_check = easy_res + match[0].length + match[1].length + err_code + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|foo\";\n    const size_t set_pattern_len = (size_t)(sizeof(set_pattern) - 1);\n    const char text_buf[] = \"xxfoofoobarzzhello\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_sp;\n    int match_indices[4];\n    size_t set_matches = 0;\n    int easy_res = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(match_indices, 0, sizeof(match_indices));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_dot_nl(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    num_groups = cre2_num_capturing_groups(re);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_indices, (size_t)4);\n\n    // step 5: Validate\n    computed_check = easy_res + num_groups + (int)set_matches + matches[0].length + match_indices[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:49:27.456034 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 06:49:27.456159 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28680, Completion: 22736, Total: 51416
[2025-11-05 06:49:27.456180 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:49:27.673404 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000410/id_000410.cc
[2025-11-05 06:49:27.673466 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:27.903537 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:27.903615 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:27.906479 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:27.906512 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:28.123341 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000411/id_000411.cc
[2025-11-05 06:49:28.123395 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:28.352442 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:28.352516 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:28.355210 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:28.355237 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:28.573066 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000412/id_000412.cc
[2025-11-05 06:49:28.573150 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:28.804463 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:28.804535 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:28.807126 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:28.807153 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:29.023888 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000413/id_000413.cc
[2025-11-05 06:49:29.023942 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:29.252293 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:29.252366 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:29.255219 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:29.255251 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:29.472972 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000414/id_000414.cc
[2025-11-05 06:49:29.473023 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:29.701579 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:29.701687 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:29.704279 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:29.704308 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:29.922396 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000415/id_000415.cc
[2025-11-05 06:49:29.922450 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:30.153476 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:30.153550 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:30.156133 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:30.156165 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:30.372966 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000416/id_000416.cc
[2025-11-05 06:49:30.373018 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:30.601298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:30.601371 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:30.604207 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:30.604233 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:30.828992 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000417/id_000417.cc
[2025-11-05 06:49:30.829078 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:31.058949 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:31.059024 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:31.061934 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:31.061968 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:31.279742 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000418/id_000418.cc
[2025-11-05 06:49:31.279796 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:31.508589 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:31.508675 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:31.511303 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:31.511330 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:31.735552 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000419/id_000419.cc
[2025-11-05 06:49:31.735606 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:49:31.965799 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:49:31.965908 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:49:31.968819 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:49:31.968848 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:49:31.968885 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:49:31.968900 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 420, succ: 419, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:49:31.968915 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:49:31.968944 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:49:32.266480 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 419 as an example for the next prompt.
[2025-11-05 06:49:32.266538 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 31 new API pairs in this round.
[2025-11-05 06:49:32.266591 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 31
[2025-11-05 06:49:32.266639 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,19.0,4.0,69.0,93.0,28.0,15.0,46.0,24.0,16.0,56.0,5.0,11.0,153.0,45.0,27.0,71.0,14.0,98.0,43.0,55.0,30.0,31.0,24.0,19.0,16.0,18.0,13.0,30.0,45.0,7.0,21.0,61.0,132.0,28.0,317.0,42.0,46.0,8.0,14.0,14.0,25.0,194.0,11.0,15.0,44.0,18.0,10.0,20.0,113.0,13.0,9.0,35.0,11.0,6.0,54.0,10.0,102.0,18.0,28.0,10.0,4.0,37.0,11.0,48.0,4.0,13.0,13.0]
[2025-11-05 06:49:32.266668 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:49:32.266722 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 48
[2025-11-05 06:49:32.266756 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 30
[2025-11-05 06:49:32.266785 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_full_match energy: 19
[2025-11-05 06:49:32.266812 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 102
[2025-11-05 06:49:32.266847 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_set_compile(cre2_set * set),
    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 06:49:32.267540 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 42, quiet_round: 0, discovered_api_pairs: 959
[2025-11-05 06:49:32.300504 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:49:32.300854 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_set_compile(cre2_set * set),\n    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|foo\";\n    const size_t set_pattern_len = (size_t)(sizeof(set_pattern) - 1);\n    const char text_buf[] = \"xxfoofoobarzzhello\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_sp;\n    int match_indices[4];\n    size_t set_matches = 0;\n    int easy_res = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(match_indices, 0, sizeof(match_indices));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_dot_nl(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    num_groups = cre2_num_capturing_groups(re);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_indices, (size_t)4);\n\n    // step 5: Validate\n    computed_check = easy_res + num_groups + (int)set_matches + matches[0].length + match_indices[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha|beta)(gamma)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"alpha|delta|epsilon\";\n    const char text_buf[] = \"zzalpha gammaddd alpha epsilon\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_sp;\n    int match_indices[4];\n    size_t set_matches = 0;\n    int easy_res = 0;\n    int longest_flag = 0;\n    const char *pat_back = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(match_indices, 0, sizeof(match_indices));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_longest_match(opt, 1);\n    longest_flag = cre2_opt_longest_match(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_indices, (size_t)4);\n    pat_back = cre2_pattern(re);\n\n    // step 5: Validate\n    computed_check = easy_res + longest_flag + (int)set_matches + (int)matches[0].length + match_indices[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:50:03.036191 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 06:50:03.036320 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30200, Completion: 19599, Total: 49799
[2025-11-05 06:50:03.036341 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:50:03.257145 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000420/id_000420.cc
[2025-11-05 06:50:03.257198 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:03.489743 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:03.489820 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:03.492314 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:03.492347 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:03.711600 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000421/id_000421.cc
[2025-11-05 06:50:03.711652 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:03.943199 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:03.943278 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:03.945811 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:03.945843 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:04.164852 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000422/id_000422.cc
[2025-11-05 06:50:04.164938 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:04.394350 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:04.394428 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:04.397290 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:04.397324 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:04.618291 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000423/id_000423.cc
[2025-11-05 06:50:04.618344 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:04.849792 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:04.849870 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:04.852686 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:04.852719 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:05.072744 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000424/id_000424.cc
[2025-11-05 06:50:05.072799 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:05.303263 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:05.303385 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:05.306070 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:05.306103 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:05.527110 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000425/id_000425.cc
[2025-11-05 06:50:05.527163 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:05.758218 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:05.758291 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:05.761062 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:05.761093 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:05.979259 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000426/id_000426.cc
[2025-11-05 06:50:05.979323 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:06.207788 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:06.207870 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:06.210388 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:06.210420 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:06.431666 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000427/id_000427.cc
[2025-11-05 06:50:06.431762 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:06.663831 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:06.663919 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:06.666485 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:06.666516 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:06.885561 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000428/id_000428.cc
[2025-11-05 06:50:06.885613 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:07.116940 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:07.117015 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:07.119533 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:07.119564 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:07.337739 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000429/id_000429.cc
[2025-11-05 06:50:07.337792 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:07.568912 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:07.569020 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:07.571655 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:07.571687 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:07.571724 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:50:07.571740 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 430, succ: 429, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:50:07.571754 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:50:07.571779 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:50:07.856110 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 429 as an example for the next prompt.
[2025-11-05 06:50:07.856165 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 06:50:07.856205 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 06:50:07.856253 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,24.0,4.0,69.0,93.0,28.0,15.0,46.0,24.0,16.0,59.0,5.0,11.0,154.0,45.0,27.0,71.0,14.0,99.0,43.0,55.0,30.0,35.0,24.0,19.0,16.0,18.0,13.0,32.0,45.0,7.0,21.0,63.0,138.0,28.0,322.0,42.0,51.0,8.0,14.0,14.0,25.0,194.0,11.0,15.0,44.0,18.0,10.0,20.0,113.0,13.0,9.0,35.0,11.0,6.0,54.0,10.0,110.0,18.0,28.0,10.0,4.0,37.0,11.0,52.0,4.0,15.0,13.0]
[2025-11-05 06:50:07.856271 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:50:07.856323 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 54
[2025-11-05 06:50:07.856381 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 322
[2025-11-05 06:50:07.856411 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 30
[2025-11-05 06:50:07.856437 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_max_mem energy: 10
[2025-11-05 06:50:07.856463 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 52
[2025-11-05 06:50:07.856501 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_delete(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 06:50:07.857327 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 43, quiet_round: 0, discovered_api_pairs: 976
[2025-11-05 06:50:07.904477 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:50:07.904938 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_delete(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha|beta)(gamma)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"alpha|delta|epsilon\";\n    const char text_buf[] = \"zzalpha gammaddd alpha epsilon\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_sp;\n    int match_indices[4];\n    size_t set_matches = 0;\n    int easy_res = 0;\n    int longest_flag = 0;\n    const char *pat_back = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(match_indices, 0, sizeof(match_indices));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_longest_match(opt, 1);\n    longest_flag = cre2_opt_longest_match(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_indices, (size_t)4);\n    pat_back = cre2_pattern(re);\n\n    // step 5: Validate\n    computed_check = easy_res + longest_flag + (int)set_matches + (int)matches[0].length + match_indices[0] + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|foo|bar\";\n    const char text_buf[] = \"foofoobarhello\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_sp;\n    int full_res = 0;\n    const char *pat_back = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    full_res = cre2_full_match(pattern, &text_sp, matches, 3);\n    pat_back = cre2_pattern(re);\n\n    // step 5: Validate\n    computed_check = full_res + matches[0].length + pattern_len + text_sp.length + (int)(pat_back ? 0 : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:50:44.108242 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 36s
[2025-11-05 06:50:44.108369 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29550, Completion: 23336, Total: 52886
[2025-11-05 06:50:44.108392 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:50:44.330433 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000430/id_000430.cc
[2025-11-05 06:50:44.330485 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:44.561389 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:44.561464 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:44.563955 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:44.563987 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:44.786032 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000431/id_000431.cc
[2025-11-05 06:50:44.786087 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:45.018583 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:45.018654 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:45.021559 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:45.021590 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:45.240514 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000432/id_000432.cc
[2025-11-05 06:50:45.240598 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:45.475798 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:45.475883 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:45.478498 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:45.478531 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:45.696486 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000433/id_000433.cc
[2025-11-05 06:50:45.696541 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:45.925218 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:45.925287 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:45.928062 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:45.928096 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:46.147446 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000434/id_000434.cc
[2025-11-05 06:50:46.147501 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:46.377757 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:46.377861 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:46.380568 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:46.380599 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:46.597261 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000435/id_000435.cc
[2025-11-05 06:50:46.597315 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:46.826471 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:46.826538 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:46.829200 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:46.829234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:47.046005 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000436/id_000436.cc
[2025-11-05 06:50:47.046059 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:47.275026 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:47.275093 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:47.277950 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:47.277981 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:47.496720 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000437/id_000437.cc
[2025-11-05 06:50:47.496807 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:47.726206 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:47.726265 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:47.728963 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:47.728997 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:47.946972 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000438/id_000438.cc
[2025-11-05 06:50:47.947026 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:48.210811 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:48.210900 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:48.213591 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:48.213622 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:48.431412 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000439/id_000439.cc
[2025-11-05 06:50:48.431466 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:50:48.660362 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:50:48.660467 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:50:48.663162 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:50:48.663194 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:50:48.663232 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:50:48.663249 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 440, succ: 439, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:50:48.663264 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:50:48.663306 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:50:48.947225 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 439 as an example for the next prompt.
[2025-11-05 06:50:48.947280 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 25 new API pairs in this round.
[2025-11-05 06:50:48.947336 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 25
[2025-11-05 06:50:48.947385 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,24.0,4.0,69.0,93.0,28.0,15.0,46.0,24.0,16.0,62.0,5.0,11.0,157.0,45.0,27.0,71.0,14.0,103.0,43.0,55.0,40.0,42.0,24.0,19.0,16.0,18.0,13.0,38.0,45.0,7.0,21.0,63.0,138.0,28.0,331.0,42.0,59.0,8.0,14.0,14.0,25.0,194.0,11.0,15.0,44.0,18.0,10.0,20.0,113.0,13.0,9.0,35.0,14.0,6.0,54.0,10.0,110.0,18.0,28.0,21.0,4.0,37.0,11.0,62.0,4.0,15.0,13.0]
[2025-11-05 06:50:48.947403 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:50:48.947457 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 42
[2025-11-05 06:50:48.947487 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 62
[2025-11-05 06:50:48.947517 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 20
[2025-11-05 06:50:48.947542 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 113
[2025-11-05 06:50:48.947576 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_opt_one_line(cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 06:50:48.948313 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 44, quiet_round: 0, discovered_api_pairs: 1001
[2025-11-05 06:50:48.980794 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:50:48.981167 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|foo|bar\";\n    const char text_buf[] = \"foofoobarhello\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_sp;\n    int full_res = 0;\n    const char *pat_back = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    text_sp.data = text_buf;\n    text_sp.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    full_res = cre2_full_match(pattern, &text_sp, matches, 3);\n    pat_back = cre2_pattern(re);\n\n    // step 5: Validate\n    computed_check = full_res + matches[0].length + pattern_len + text_sp.length + (int)(pat_back ? 0 : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar|baz\";\n    const char text_buf[] = \"xxfoo barbar foobar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"X\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_count = 0;\n    int compiled_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    replace_count = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    compiled_flag = (int)cre2_set_add_simple(set, \"unused_pattern\"); /* benign second add */\n\n    // step 5: Validate\n    computed_check = replace_count + pattern_len + text_and_target.length + rewrite.length + compiled_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:51:35.119514 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 06:51:35.119644 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29160, Completion: 23194, Total: 52354
[2025-11-05 06:51:35.119670 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:51:35.340414 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000440/id_000440.cc
[2025-11-05 06:51:35.340471 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:35.570130 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:35.570211 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:35.572975 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:35.573005 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:35.793020 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000441/id_000441.cc
[2025-11-05 06:51:35.793080 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:36.024112 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:36.024195 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:36.027228 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:36.027264 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:36.244865 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000442/id_000442.cc
[2025-11-05 06:51:36.244955 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:36.476634 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:36.476719 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:36.479733 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:36.479770 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:36.701709 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000443/id_000443.cc
[2025-11-05 06:51:36.701772 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:36.931644 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:36.931724 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:36.934926 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:36.934963 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:37.151350 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000444/id_000444.cc
[2025-11-05 06:51:37.151413 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:37.378973 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:37.379106 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:37.382154 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:37.382185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:37.603633 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000445/id_000445.cc
[2025-11-05 06:51:37.603686 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:37.836221 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:37.836288 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:37.839379 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:37.839406 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:38.061225 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000446/id_000446.cc
[2025-11-05 06:51:38.061278 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:38.293567 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:38.293633 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:38.296662 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:38.296688 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:38.518718 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000447/id_000447.cc
[2025-11-05 06:51:38.518803 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:38.748954 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:38.749024 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:38.752107 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:38.752138 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:38.970834 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000448/id_000448.cc
[2025-11-05 06:51:38.970888 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:39.199440 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:39.199522 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:39.202560 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:39.202589 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:39.423842 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000449/id_000449.cc
[2025-11-05 06:51:39.423894 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:51:39.655543 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:51:39.655652 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:51:39.658662 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:51:39.658695 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:51:39.658734 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:51:39.658749 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 450, succ: 449, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:51:39.658787 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:51:39.658817 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:51:39.952289 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 449 as an example for the next prompt.
[2025-11-05 06:51:39.952343 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 66 new API pairs in this round.
[2025-11-05 06:51:39.952429 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 66
[2025-11-05 06:51:39.952480 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,24.0,4.0,69.0,103.0,28.0,15.0,46.0,24.0,16.0,69.0,5.0,11.0,160.0,48.0,27.0,82.0,14.0,106.0,43.0,58.0,40.0,56.0,30.0,19.0,16.0,18.0,13.0,49.0,45.0,7.0,24.0,63.0,138.0,28.0,340.0,56.0,69.0,8.0,14.0,14.0,25.0,194.0,11.0,15.0,44.0,18.0,10.0,40.0,135.0,13.0,9.0,43.0,14.0,6.0,54.0,10.0,116.0,18.0,28.0,21.0,4.0,57.0,11.0,77.0,4.0,15.0,13.0]
[2025-11-05 06:51:39.952498 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:51:39.952551 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 340
[2025-11-05 06:51:39.952581 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_next energy: 30
[2025-11-05 06:51:39.952607 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 48
[2025-11-05 06:51:39.952640 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 44
[2025-11-05 06:51:39.952680 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 06:51:39.953376 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 45, quiet_round: 0, discovered_api_pairs: 1067
[2025-11-05 06:51:40.012377 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:51:40.012748 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar|baz\";\n    const char text_buf[] = \"xxfoo barbar foobar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"X\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_count = 0;\n    int compiled_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    replace_count = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    compiled_flag = (int)cre2_set_add_simple(set, \"unused_pattern\"); /* benign second add */\n\n    // step 5: Validate\n    computed_check = replace_count + pattern_len + text_and_target.length + rewrite.length + compiled_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?(?P<name>baz)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|foo|bar|baz\";\n    const char text_buf[] = \"xxfoo barbar foobaz hello\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *found_name = NULL;\n    int found_index = 0;\n    int matches[8];\n    size_t match_count = 0;\n    int compiled_flag = 0;\n    int opt_oneline_val = 0;\n    cre2_encoding_t enc_val = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_flag = cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    match_count = cre2_set_match(set, text_buf, (size_t)text_len, matches, (size_t)(sizeof(matches) / sizeof(matches[0])));\n\n    // step 5: Validate\n    opt_oneline_val = cre2_opt_one_line(opt);\n    enc_val = cre2_opt_encoding(opt);\n    computed_check = (int)match_count + compiled_flag + opt_oneline_val + (int)enc_val + cre2_num_capturing_groups(re) + (found_name ? (int)found_index : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:52:21.714428 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 06:52:21.714550 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31350, Completion: 22477, Total: 53827
[2025-11-05 06:52:21.714572 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:52:21.932908 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000450/id_000450.cc
[2025-11-05 06:52:21.932958 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:22.165310 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:22.165386 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:22.168409 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:22.168448 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:22.387079 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000451/id_000451.cc
[2025-11-05 06:52:22.387129 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:22.616496 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:22.616563 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:22.619478 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:22.619510 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:22.837215 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000452/id_000452.cc
[2025-11-05 06:52:22.837295 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:23.072387 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:23.072467 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:23.075517 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:23.075544 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:23.293720 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000453/id_000453.cc
[2025-11-05 06:52:23.293772 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:23.525807 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:23.525875 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:23.528687 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:23.528720 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:23.745966 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000454/id_000454.cc
[2025-11-05 06:52:23.746019 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:23.980255 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:23.980359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:23.983469 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:23.983499 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:24.200498 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000455/id_000455.cc
[2025-11-05 06:52:24.200553 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:24.428067 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:24.428139 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:24.430999 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:24.431031 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:24.648824 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000456/id_000456.cc
[2025-11-05 06:52:24.648876 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:24.878412 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:24.878491 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:24.881318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:24.881345 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:25.097950 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000457/id_000457.cc
[2025-11-05 06:52:25.098033 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:25.326774 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:25.326836 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:25.329816 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:25.329842 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:25.546941 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000458/id_000458.cc
[2025-11-05 06:52:25.546999 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:25.776082 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:25.776139 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:25.779112 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:25.779147 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:26.005515 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000459/id_000459.cc
[2025-11-05 06:52:26.005572 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:52:26.235093 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:52:26.235191 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:52:26.238010 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:52:26.238041 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:52:26.238082 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:52:26.238101 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 460, succ: 459, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:52:26.238118 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:52:26.238146 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:52:26.522562 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 459 as an example for the next prompt.
[2025-11-05 06:52:26.522616 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 06:52:26.522658 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 06:52:26.522705 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,24.0,4.0,69.0,103.0,28.0,15.0,46.0,24.0,16.0,72.0,5.0,11.0,161.0,58.0,27.0,84.0,14.0,108.0,43.0,58.0,40.0,56.0,37.0,19.0,16.0,18.0,13.0,49.0,45.0,7.0,24.0,63.0,140.0,28.0,345.0,63.0,69.0,8.0,14.0,14.0,25.0,194.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,43.0,14.0,6.0,54.0,10.0,116.0,18.0,28.0,21.0,4.0,61.0,11.0,77.0,4.0,15.0,13.0]
[2025-11-05 06:52:26.522724 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:52:26.522776 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 194
[2025-11-05 06:52:26.522811 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 43
[2025-11-05 06:52:26.522839 +00:00] INFO [src/feedback/schedule.rs:246] Loop 46: Replaced with lowest energy API: cre2_consume_re (energy: 4), prob: 0.1796
[2025-11-05 06:52:26.522855 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 4
[2025-11-05 06:52:26.522884 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 58
[2025-11-05 06:52:26.522910 +00:00] INFO [src/feedback/schedule.rs:246] Loop 46: Replaced with lowest energy API: cre2_consume_re (energy: 4), prob: 0.1796
[2025-11-05 06:52:26.522936 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 69
[2025-11-05 06:52:26.522975 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_error_code(const cre2_regexp_t * re),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)
[2025-11-05 06:52:26.523782 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 46, quiet_round: 0, discovered_api_pairs: 1086
[2025-11-05 06:52:26.577402 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:52:26.577759 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_error_code(const cre2_regexp_t * re),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?(?P<name>baz)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"hello|foo|bar|baz\";\n    const char text_buf[] = \"xxfoo barbar foobaz hello\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *found_name = NULL;\n    int found_index = 0;\n    int matches[8];\n    size_t match_count = 0;\n    int compiled_flag = 0;\n    int opt_oneline_val = 0;\n    cre2_encoding_t enc_val = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_flag = cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    match_count = cre2_set_match(set, text_buf, (size_t)text_len, matches, (size_t)(sizeof(matches) / sizeof(matches[0])));\n\n    // step 5: Validate\n    opt_oneline_val = cre2_opt_one_line(opt);\n    enc_val = cre2_opt_encoding(opt);\n    computed_check = (int)match_count + compiled_flag + opt_oneline_val + (int)enc_val + cre2_num_capturing_groups(re) + (found_name ? (int)found_index : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(?P<name>bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoo barbar foobar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *found_name = NULL;\n    int found_index = -1;\n    cre2_string_t text_str;\n    cre2_string_t match_arr[4];\n    int match_ret = 0;\n    int partial_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 4);\n    partial_ret = cre2_partial_match(pattern, &text_str, match_arr, 4);\n\n    // step 5: Validate\n    computed_check = match_ret + partial_ret + found_index + cre2_num_capturing_groups(re);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:53:08.375374 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 06:53:08.375523 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30650, Completion: 21777, Total: 52427
[2025-11-05 06:53:08.375544 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:53:08.594272 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000460/id_000460.cc
[2025-11-05 06:53:08.594323 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:08.823017 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:08.823092 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:08.825991 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:08.826022 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:09.044407 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000461/id_000461.cc
[2025-11-05 06:53:09.044459 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:09.274567 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:09.274641 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:09.277413 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:09.277443 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:09.496137 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000462/id_000462.cc
[2025-11-05 06:53:09.496221 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:09.725771 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:09.725843 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:09.728606 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:09.728649 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:09.946967 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000463/id_000463.cc
[2025-11-05 06:53:09.947020 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:10.178292 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:10.178365 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:10.181154 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:10.181185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:10.399131 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000464/id_000464.cc
[2025-11-05 06:53:10.399182 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:10.628387 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:10.628501 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:10.631144 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:10.631171 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:10.850393 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000465/id_000465.cc
[2025-11-05 06:53:10.850445 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:11.078138 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:11.078236 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:11.081152 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:11.081184 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:11.298828 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000466/id_000466.cc
[2025-11-05 06:53:11.298880 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:11.526883 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:11.526956 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:11.529918 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:11.529951 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:11.747292 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000467/id_000467.cc
[2025-11-05 06:53:11.747374 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:11.974841 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:11.974913 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:11.977839 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:11.977870 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:12.194135 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000468/id_000468.cc
[2025-11-05 06:53:12.194188 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:12.422325 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:12.422400 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:12.425176 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:12.425209 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:12.642951 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000469/id_000469.cc
[2025-11-05 06:53:12.643004 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:12.871975 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:12.872085 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:12.874951 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:12.874984 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:12.875021 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:53:12.875038 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 470, succ: 469, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:53:12.875052 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:53:12.875077 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:53:13.164093 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 469 as an example for the next prompt.
[2025-11-05 06:53:13.164147 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 06:53:13.164189 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 06:53:13.164248 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,24.0,13.0,69.0,103.0,28.0,15.0,46.0,24.0,16.0,76.0,5.0,11.0,161.0,58.0,27.0,84.0,14.0,109.0,48.0,66.0,40.0,58.0,37.0,19.0,16.0,18.0,13.0,50.0,45.0,7.0,24.0,63.0,140.0,28.0,351.0,63.0,77.0,8.0,14.0,14.0,25.0,201.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,48.0,14.0,6.0,54.0,10.0,116.0,18.0,28.0,21.0,4.0,61.0,11.0,78.0,4.0,15.0,13.0]
[2025-11-05 06:53:13.164267 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:53:13.164317 +00:00] INFO [src/feedback/schedule.rs:246] Loop 47: Replaced with lowest energy API: cre2_find_named_capturing_groups (energy: 4), prob: 0.1723
[2025-11-05 06:53:13.164338 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_named_capturing_groups energy: 4
[2025-11-05 06:53:13.164369 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 58
[2025-11-05 06:53:13.164396 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 161
[2025-11-05 06:53:13.164422 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 45
[2025-11-05 06:53:13.164448 +00:00] INFO [src/feedback/schedule.rs:246] Loop 47: Replaced with lowest energy API: cre2_find_named_capturing_groups (energy: 4), prob: 0.1723
[2025-11-05 06:53:13.164475 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 78
[2025-11-05 06:53:13.164514 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    void cre2_delete(cre2_regexp_t * re),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 06:53:13.165380 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 47, quiet_round: 0, discovered_api_pairs: 1105
[2025-11-05 06:53:13.221299 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:53:13.221657 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    void cre2_delete(cre2_regexp_t * re),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(?P<name>bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoo barbar foobar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *found_name = NULL;\n    int found_index = -1;\n    cre2_string_t text_str;\n    cre2_string_t match_arr[4];\n    int match_ret = 0;\n    int partial_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 4);\n    partial_ret = cre2_partial_match(pattern, &text_str, match_arr, 4);\n\n    // step 5: Validate\n    computed_check = match_ret + partial_ret + found_index + cre2_num_capturing_groups(re);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar|baz\";\n    const char text_buf[] = \"xxfoobar foobar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t text_str;\n    cre2_string_t match_arr[4];\n    int easy_ret = 0;\n    int consume_ret = 0;\n    int errcode = 0;\n    int compiled_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_flag = cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, 4);\n    consume_ret = cre2_consume_re(re, &text_str, match_arr, 4);\n    errcode = cre2_error_code(re);\n\n    // step 5: Validate\n    computed_check = easy_ret + consume_ret + errcode + compiled_flag + cre2_num_capturing_groups(re);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:53:44.427713 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 06:53:44.427830 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29950, Completion: 19684, Total: 49634
[2025-11-05 06:53:44.427850 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:53:44.645295 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000470/id_000470.cc
[2025-11-05 06:53:44.645357 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:44.874592 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:44.874651 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:44.877800 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:44.877833 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:45.094742 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000471/id_000471.cc
[2025-11-05 06:53:45.094792 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:45.323748 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:45.323815 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:45.327074 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:45.327106 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:45.546005 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000472/id_000472.cc
[2025-11-05 06:53:45.546089 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:45.774881 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:45.774950 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:45.778106 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:45.778137 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:45.996296 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000473/id_000473.cc
[2025-11-05 06:53:45.996348 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:46.226014 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:46.226083 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:46.229115 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:46.229146 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:46.447185 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000474/id_000474.cc
[2025-11-05 06:53:46.447236 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:46.678456 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:46.678541 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:46.681721 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:46.681753 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:46.899248 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000475/id_000475.cc
[2025-11-05 06:53:46.899301 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:47.129292 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:47.129359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:47.132521 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:47.132553 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:47.348863 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000476/id_000476.cc
[2025-11-05 06:53:47.348927 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:47.578774 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:47.578844 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:47.581868 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:47.581901 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:47.799760 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000477/id_000477.cc
[2025-11-05 06:53:47.799846 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:48.030928 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:48.030993 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:48.033976 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:48.034005 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:48.251649 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000478/id_000478.cc
[2025-11-05 06:53:48.251700 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:48.480983 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:48.481052 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:48.484027 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:48.484059 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:48.703692 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000479/id_000479.cc
[2025-11-05 06:53:48.703743 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:53:48.932703 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:53:48.932807 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:53:48.935808 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:53:48.935844 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:53:48.935885 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:53:48.935904 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 480, succ: 479, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:53:48.935921 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:53:48.935952 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:53:49.223342 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 479 as an example for the next prompt.
[2025-11-05 06:53:49.223397 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 24 new API pairs in this round.
[2025-11-05 06:53:49.223441 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 24
[2025-11-05 06:53:49.223490 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,24.0,13.0,69.0,103.0,28.0,15.0,46.0,24.0,16.0,81.0,5.0,11.0,164.0,71.0,27.0,84.0,14.0,109.0,48.0,66.0,40.0,64.0,37.0,19.0,16.0,18.0,13.0,54.0,57.0,7.0,24.0,63.0,140.0,28.0,355.0,63.0,78.0,8.0,14.0,14.0,25.0,201.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,48.0,14.0,6.0,54.0,10.0,116.0,18.0,28.0,21.0,21.0,61.0,11.0,85.0,4.0,15.0,13.0]
[2025-11-05 06:53:49.223519 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:53:49.223573 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 14
[2025-11-05 06:53:49.223605 +00:00] INFO [src/feedback/schedule.rs:246] Loop 48: Replaced with lowest energy API: cre2_opt_dot_nl (energy: 4), prob: 0.1650
[2025-11-05 06:53:49.223621 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_dot_nl energy: 4
[2025-11-05 06:53:49.223648 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 28
[2025-11-05 06:53:49.223704 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 46
[2025-11-05 06:53:49.223732 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 355
[2025-11-05 06:53:49.223766 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_version_interface_revision(),
    int cre2_opt_dot_nl(cre2_options_t * opt),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    int cre2_program_size(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 06:53:49.224579 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 48, quiet_round: 0, discovered_api_pairs: 1129
[2025-11-05 06:53:49.258886 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:53:49.259227 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_version_interface_revision(),\n    int cre2_opt_dot_nl(cre2_options_t * opt),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    int cre2_program_size(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar|baz\";\n    const char text_buf[] = \"xxfoobar foobar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t text_str;\n    cre2_string_t match_arr[4];\n    int easy_ret = 0;\n    int consume_ret = 0;\n    int errcode = 0;\n    int compiled_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_flag = cre2_set_add_simple(set, set_pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, 4);\n    consume_ret = cre2_consume_re(re, &text_str, match_arr, 4);\n    errcode = cre2_error_code(re);\n\n    // step 5: Validate\n    computed_check = easy_ret + consume_ret + errcode + compiled_flag + cre2_num_capturing_groups(re);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<g1>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar\";\n    const char text_buf[] = \"xxfoobar foo bar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t match_arr[4];\n    cre2_string_t text_str;\n    cre2_range_t ranges[4];\n    int nmatch = 4;\n    int add_ret = 0;\n    int compile_ret = 0;\n    int match_ret = 0;\n    int named_idx_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(ranges, 0, sizeof(ranges));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    add_ret = cre2_set_add_simple(set, set_pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Operate\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, nmatch);\n    named_idx_ret = cre2_find_named_capturing_groups(re, \"g1\");\n    cre2_strings_to_ranges(text_buf, ranges, match_arr, nmatch);\n\n    // step 5: Validate\n    computed_check = match_ret + named_idx_ret + add_ret + compile_ret + cre2_num_capturing_groups(re) + (int)ranges[0].start + (int)ranges[0].past + match_arr[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:54:23.591875 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 06:54:23.591999 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29810, Completion: 19075, Total: 48885
[2025-11-05 06:54:23.592020 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:54:23.809602 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000480/id_000480.cc
[2025-11-05 06:54:23.809654 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:24.040356 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:24.040426 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:24.043283 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:24.043315 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:24.261866 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000481/id_000481.cc
[2025-11-05 06:54:24.261917 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:24.489977 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:24.490048 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:24.492815 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:24.492847 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:24.712664 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000482/id_000482.cc
[2025-11-05 06:54:24.712746 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:24.942268 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:24.942337 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:24.945198 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:24.945229 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:25.163327 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000483/id_000483.cc
[2025-11-05 06:54:25.163378 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:25.390368 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:25.390426 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:25.393180 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:25.393215 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:25.610754 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000484/id_000484.cc
[2025-11-05 06:54:25.610807 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:25.840120 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:25.840224 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:25.843064 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:25.843096 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:26.062165 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000485/id_000485.cc
[2025-11-05 06:54:26.062217 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:26.290601 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:26.290658 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:26.293454 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:26.293487 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:26.512650 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000486/id_000486.cc
[2025-11-05 06:54:26.512703 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:26.741714 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:26.741788 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:26.744571 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:26.744603 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:26.961899 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000487/id_000487.cc
[2025-11-05 06:54:26.961992 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:27.193814 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:27.193872 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:27.196525 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:27.196558 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:27.413143 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000488/id_000488.cc
[2025-11-05 06:54:27.413196 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:27.641501 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:27.641558 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:27.644280 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:27.644306 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:27.860810 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000489/id_000489.cc
[2025-11-05 06:54:27.860863 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:54:28.095440 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:54:28.095526 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:54:28.098329 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:54:28.098361 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:54:28.098400 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:54:28.098416 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 490, succ: 489, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:54:28.098431 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:54:28.098457 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:54:28.367301 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 489 as an example for the next prompt.
[2025-11-05 06:54:28.367356 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 36 new API pairs in this round.
[2025-11-05 06:54:28.367414 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 36
[2025-11-05 06:54:28.367462 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,14.0,25.0,24.0,13.0,69.0,103.0,28.0,15.0,64.0,24.0,16.0,86.0,5.0,11.0,171.0,71.0,27.0,84.0,14.0,116.0,48.0,66.0,40.0,64.0,37.0,19.0,16.0,18.0,13.0,54.0,57.0,7.0,24.0,63.0,140.0,28.0,369.0,63.0,78.0,8.0,14.0,30.0,25.0,201.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,48.0,14.0,6.0,55.0,10.0,116.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,22.0,13.0]
[2025-11-05 06:54:28.367480 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:54:28.367532 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_posix_syntax energy: 16
[2025-11-05 06:54:28.367562 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace energy: 14
[2025-11-05 06:54:28.367593 +00:00] INFO [src/feedback/schedule.rs:246] Loop 49: Replaced with lowest energy API: cre2_extract (energy: 5), prob: 0.1575
[2025-11-05 06:54:28.367608 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract energy: 5
[2025-11-05 06:54:28.367637 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 78
[2025-11-05 06:54:28.367675 +00:00] INFO [src/feedback/schedule.rs:246] Loop 49: Replaced with lowest energy API: cre2_extract (energy: 5), prob: 0.1575
[2025-11-05 06:54:28.367702 +00:00] INFO [src/feedback/schedule.rs:246] Loop 49: Replaced with lowest energy API: cre2_extract (energy: 5), prob: 0.1575
[2025-11-05 06:54:28.367727 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 71
[2025-11-05 06:54:28.367767 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),
    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_extract(const char * pattern, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)
[2025-11-05 06:54:28.368569 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 49, quiet_round: 0, discovered_api_pairs: 1165
[2025-11-05 06:54:28.429347 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:54:28.429710 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),\n    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_extract(const char * pattern, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<g1>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar\";\n    const char text_buf[] = \"xxfoobar foo bar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t match_arr[4];\n    cre2_string_t text_str;\n    cre2_range_t ranges[4];\n    int nmatch = 4;\n    int add_ret = 0;\n    int compile_ret = 0;\n    int match_ret = 0;\n    int named_idx_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(ranges, 0, sizeof(ranges));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    add_ret = cre2_set_add_simple(set, set_pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Operate\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, nmatch);\n    named_idx_ret = cre2_find_named_capturing_groups(re, \"g1\");\n    cre2_strings_to_ranges(text_buf, ranges, match_arr, nmatch);\n\n    // step 5: Validate\n    computed_check = match_ret + named_idx_ret + add_ret + compile_ret + cre2_num_capturing_groups(re) + (int)ranges[0].start + (int)ranges[0].past + match_arr[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?:foo).*bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    int revision = 0;\n    int dot_nl_val = 0;\n    int prog_size = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    dot_nl_val = cre2_opt_dot_nl(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    revision = cre2_version_interface_revision();\n\n    // step 5: Validate\n    computed_check = revision + dot_nl_val + prog_size;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:55:09.640335 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 06:55:09.640459 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29140, Completion: 26257, Total: 55397
[2025-11-05 06:55:09.640479 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:55:09.858118 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000490/id_000490.cc
[2025-11-05 06:55:09.858170 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:10.087594 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:10.087671 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:10.090588 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:10.090620 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:10.309606 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000491/id_000491.cc
[2025-11-05 06:55:10.309658 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:10.538596 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:10.538672 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:10.541531 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:10.541563 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:10.759793 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000492/id_000492.cc
[2025-11-05 06:55:10.759886 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:10.988573 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:10.988660 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:10.991409 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:10.991436 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:11.208978 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000493/id_000493.cc
[2025-11-05 06:55:11.209032 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:11.438754 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:11.438833 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:11.441747 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:11.441779 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:11.658810 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000494/id_000494.cc
[2025-11-05 06:55:11.658864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:11.888400 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:11.888515 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:11.891154 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:11.891180 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:12.109789 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000495/id_000495.cc
[2025-11-05 06:55:12.109843 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:12.339619 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:12.339692 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:12.342604 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:12.342637 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:12.560874 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000496/id_000496.cc
[2025-11-05 06:55:12.560929 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:12.789463 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:12.789539 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:12.792289 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:12.792322 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:13.009364 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000497/id_000497.cc
[2025-11-05 06:55:13.009453 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:13.237886 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:13.237964 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:13.240820 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:13.240852 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:13.458107 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000498/id_000498.cc
[2025-11-05 06:55:13.458173 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:13.688089 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:13.688160 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:13.690959 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:13.690990 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:13.909294 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000499/id_000499.cc
[2025-11-05 06:55:13.909349 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:14.145191 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:14.145299 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:14.147835 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:14.147866 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:14.147905 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:55:14.147921 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 500, succ: 499, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:55:14.147936 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:55:14.147960 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:55:14.460863 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 499 as an example for the next prompt.
[2025-11-05 06:55:14.460919 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 24 new API pairs in this round.
[2025-11-05 06:55:14.460964 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 24
[2025-11-05 06:55:14.461011 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,13.0,69.0,103.0,28.0,15.0,64.0,24.0,23.0,88.0,16.0,11.0,174.0,81.0,27.0,84.0,14.0,119.0,48.0,66.0,40.0,71.0,37.0,19.0,16.0,18.0,13.0,55.0,57.0,7.0,24.0,63.0,140.0,28.0,379.0,63.0,85.0,8.0,14.0,30.0,25.0,201.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,48.0,14.0,6.0,55.0,10.0,116.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,22.0,13.0]
[2025-11-05 06:55:14.461028 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:55:14.461082 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_nl energy: 25
[2025-11-05 06:55:14.461114 +00:00] INFO [src/feedback/schedule.rs:246] Loop 50: Replaced with lowest energy API: cre2_version_interface_current (energy: 6), prob: 0.1500
[2025-11-05 06:55:14.461130 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_current energy: 6
[2025-11-05 06:55:14.461159 +00:00] INFO [src/feedback/schedule.rs:246] Loop 50: Replaced with lowest energy API: cre2_version_interface_current (energy: 6), prob: 0.1500
[2025-11-05 06:55:14.461185 +00:00] INFO [src/feedback/schedule.rs:246] Loop 50: Replaced with lowest energy API: cre2_version_interface_current (energy: 6), prob: 0.1500
[2025-11-05 06:55:14.461211 +00:00] INFO [src/feedback/schedule.rs:246] Loop 50: Replaced with lowest energy API: cre2_version_interface_current (energy: 6), prob: 0.1500
[2025-11-05 06:55:14.461238 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 174
[2025-11-05 06:55:14.461264 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 140
[2025-11-05 06:55:14.461290 +00:00] INFO [src/feedback/schedule.rs:246] Loop 50: Replaced with lowest energy API: cre2_version_interface_current (energy: 6), prob: 0.1500
[2025-11-05 06:55:14.461327 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 116
[2025-11-05 06:55:14.461361 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_never_nl(cre2_options_t * opt),
    int cre2_version_interface_current(),
    void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 06:55:14.462165 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 50, quiet_round: 0, discovered_api_pairs: 1189
[2025-11-05 06:55:14.492830 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:55:14.493172 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_never_nl(cre2_options_t * opt),\n    int cre2_version_interface_current(),\n    void cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?:foo).*bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    int revision = 0;\n    int dot_nl_val = 0;\n    int prog_size = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    dot_nl_val = cre2_opt_dot_nl(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    revision = cre2_version_interface_revision();\n\n    // step 5: Validate\n    computed_check = revision + dot_nl_val + prog_size;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char replace_pat[] = \"foo\";\n    const char text_buf[] = \"xxfoobarbaz foo bar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"baz\";\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t match_arr[4];\n    int nmatch = 4;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t text_and_target;\n    int match_ret = 0;\n    int extract_ret = 0;\n    int replace_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = (int)(sizeof(rewrite_buf) - 1);\n    target_str.data = \"\"; // will be populated by cre2_extract if successful\n    target_str.length = 0;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, nmatch);\n    extract_ret = cre2_extract(pattern, &text_str, &rewrite_str, &target_str);\n    replace_ret = cre2_global_replace(replace_pat, &text_and_target, &rewrite_str);\n\n    // step 5: Validate\n    computed_check = match_ret + extract_ret + replace_ret + match_arr[0].length + target_str.length + text_and_target.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:55:57.242705 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 06:55:57.242831 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28260, Completion: 18277, Total: 46537
[2025-11-05 06:55:57.242851 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:55:57.460098 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000500/id_000500.cc
[2025-11-05 06:55:57.460150 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:57.688905 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:57.688976 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:57.691492 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:57.691523 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:57.910154 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000501/id_000501.cc
[2025-11-05 06:55:57.910207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:58.139134 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:58.139201 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:58.141917 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:58.141948 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:58.359633 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000502/id_000502.cc
[2025-11-05 06:55:58.359718 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:58.589015 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:58.589087 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:58.591694 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:58.591728 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:58.808856 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000503/id_000503.cc
[2025-11-05 06:55:58.808909 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:59.037698 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:59.037766 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:59.040382 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:59.040408 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:59.256936 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000504/id_000504.cc
[2025-11-05 06:55:59.256989 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:59.486237 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:59.486334 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:59.489015 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:59.489043 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:55:59.706212 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000505/id_000505.cc
[2025-11-05 06:55:59.706263 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:55:59.933518 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:55:59.933577 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:55:59.936293 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:55:59.936320 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:00.154456 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000506/id_000506.cc
[2025-11-05 06:56:00.154509 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:00.382107 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:00.382165 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:00.384945 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:00.384979 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:00.602054 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000507/id_000507.cc
[2025-11-05 06:56:00.602140 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:00.830058 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:00.830116 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:00.832938 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:00.832971 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:01.051062 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000508/id_000508.cc
[2025-11-05 06:56:01.051115 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:01.280041 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:01.280100 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:01.282903 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:01.282949 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:01.500107 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000509/id_000509.cc
[2025-11-05 06:56:01.500159 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:01.728575 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:01.728695 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:01.731283 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:01.731309 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:01.731345 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:56:01.731361 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 510, succ: 509, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:56:01.731377 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:56:01.731406 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:56:01.998636 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 509 as an example for the next prompt.
[2025-11-05 06:56:01.998691 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 06:56:01.998721 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 06:56:01.998769 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,13.0,69.0,103.0,28.0,15.0,64.0,24.0,23.0,88.0,16.0,11.0,177.0,81.0,27.0,84.0,14.0,120.0,48.0,66.0,40.0,71.0,37.0,19.0,16.0,18.0,13.0,55.0,57.0,7.0,24.0,63.0,142.0,28.0,383.0,63.0,85.0,8.0,14.0,30.0,28.0,201.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,48.0,14.0,12.0,56.0,10.0,120.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,22.0,13.0]
[2025-11-05 06:56:01.998788 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:56:01.998841 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 64
[2025-11-05 06:56:01.998873 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_dot_nl energy: 22
[2025-11-05 06:56:01.998900 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 201
[2025-11-05 06:56:01.998925 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 56
[2025-11-05 06:56:01.998958 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_program_size(const cre2_regexp_t * re),
    void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_delete(cre2_options_t * opt)
[2025-11-05 06:56:01.999666 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 51, quiet_round: 0, discovered_api_pairs: 1197
[2025-11-05 06:56:02.039269 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:56:02.039619 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_program_size(const cre2_regexp_t * re),\n    void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_delete(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char replace_pat[] = \"foo\";\n    const char text_buf[] = \"xxfoobarbaz foo bar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"baz\";\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_string_t match_arr[4];\n    int nmatch = 4;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t text_and_target;\n    int match_ret = 0;\n    int extract_ret = 0;\n    int replace_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = (int)(sizeof(rewrite_buf) - 1);\n    target_str.data = \"\"; // will be populated by cre2_extract if successful\n    target_str.length = 0;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, nmatch);\n    extract_ret = cre2_extract(pattern, &text_str, &rewrite_str, &target_str);\n    replace_ret = cre2_global_replace(replace_pat, &text_and_target, &rewrite_str);\n\n    // step 5: Validate\n    computed_check = match_ret + extract_ret + replace_ret + match_arr[0].length + target_str.length + text_and_target.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?:abc)+def\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    int never_nl_val = 0;\n    int version_curr = 0;\n    const char *re_pattern_str = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    never_nl_val = cre2_opt_never_nl(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pattern_str = cre2_pattern(re);\n    version_curr = cre2_version_interface_current();\n\n    // step 5: Validate\n    computed_check = version_curr + never_nl_val + pattern_len + (int)re_pattern_str[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:56:36.530705 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 06:56:36.530833 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28670, Completion: 17385, Total: 46055
[2025-11-05 06:56:36.530852 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:56:36.748199 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000510/id_000510.cc
[2025-11-05 06:56:36.748252 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:36.976751 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:36.976822 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:36.979688 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:36.979722 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:37.196535 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000511/id_000511.cc
[2025-11-05 06:56:37.196587 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:37.426581 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:37.426648 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:37.429414 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:37.429449 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:37.646620 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000512/id_000512.cc
[2025-11-05 06:56:37.646704 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:37.876318 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:37.876388 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:37.879331 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:37.879364 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:38.103256 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000513/id_000513.cc
[2025-11-05 06:56:38.103309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:38.334351 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:38.334411 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:38.337278 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:38.337310 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:38.555423 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000514/id_000514.cc
[2025-11-05 06:56:38.555476 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:38.785160 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:38.785248 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:38.788069 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:38.788102 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:39.005217 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000515/id_000515.cc
[2025-11-05 06:56:39.005271 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:39.234292 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:39.234360 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:39.237098 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:39.237132 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:39.454591 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000516/id_000516.cc
[2025-11-05 06:56:39.454643 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:39.682461 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:39.682537 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:39.685456 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:39.685490 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:39.902129 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000517/id_000517.cc
[2025-11-05 06:56:39.902213 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:40.132132 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:40.132190 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:40.134933 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:40.134965 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:40.354326 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000518/id_000518.cc
[2025-11-05 06:56:40.354378 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:40.581726 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:40.581802 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:40.584684 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:40.584716 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:40.801111 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000519/id_000519.cc
[2025-11-05 06:56:40.801164 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:56:41.031142 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:56:41.031259 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:56:41.034124 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:56:41.034156 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:56:41.034194 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:56:41.034210 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 520, succ: 519, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:56:41.034225 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:56:41.034251 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:56:41.306889 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 519 as an example for the next prompt.
[2025-11-05 06:56:41.306944 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 06:56:41.306974 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 06:56:41.307022 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,13.0,69.0,103.0,28.0,15.0,68.0,24.0,23.0,88.0,16.0,11.0,180.0,81.0,27.0,84.0,14.0,123.0,48.0,66.0,40.0,71.0,37.0,19.0,16.0,18.0,13.0,55.0,57.0,7.0,24.0,63.0,142.0,28.0,385.0,63.0,85.0,8.0,14.0,30.0,28.0,206.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,48.0,14.0,12.0,56.0,10.0,122.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,26.0,13.0]
[2025-11-05 06:56:41.307042 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:56:41.307096 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 40
[2025-11-05 06:56:41.307127 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match_re energy: 10
[2025-11-05 06:56:41.307156 +00:00] INFO [src/feedback/schedule.rs:246] Loop 52: Replaced with lowest energy API: cre2_error_arg (energy: 7), prob: 0.1350
[2025-11-05 06:56:41.307172 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_arg energy: 7
[2025-11-05 06:56:41.307200 +00:00] INFO [src/feedback/schedule.rs:246] Loop 52: Replaced with lowest energy API: cre2_error_arg (energy: 7), prob: 0.1350
[2025-11-05 06:56:41.307226 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 385
[2025-11-05 06:56:41.307261 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),
    void cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 06:56:41.307965 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 52, quiet_round: 0, discovered_api_pairs: 1205
[2025-11-05 06:56:41.351285 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:56:41.351627 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),\n    void cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?:abc)+def\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    int never_nl_val = 0;\n    int version_curr = 0;\n    const char *re_pattern_str = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    never_nl_val = cre2_opt_never_nl(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pattern_str = cre2_pattern(re);\n    version_curr = cre2_version_interface_current();\n\n    // step 5: Validate\n    computed_check = version_curr + never_nl_val + pattern_len + (int)re_pattern_str[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarbaz foo bar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t match_arr[3];\n    int nmatch = 3;\n    int prog_size = 0;\n    int easy_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_dot_nl(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    prog_size = cre2_program_size(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, nmatch);\n\n    // step 5: Validate\n    computed_check = prog_size + easy_ret + match_arr[0].length + match_arr[1].length + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:57:20.088606 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 06:57:20.088751 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 26760, Completion: 23333, Total: 50093
[2025-11-05 06:57:20.088771 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:57:20.306750 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000520/id_000520.cc
[2025-11-05 06:57:20.306801 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:20.536759 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:20.536825 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:20.539591 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:20.539624 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:20.758030 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000521/id_000521.cc
[2025-11-05 06:57:20.758081 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:20.986444 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:20.986512 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:20.989291 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:20.989322 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:21.206658 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000522/id_000522.cc
[2025-11-05 06:57:21.206744 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:21.437294 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:21.437363 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:21.439923 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:21.439956 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:21.658850 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000523/id_000523.cc
[2025-11-05 06:57:21.658905 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:21.887117 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:21.887181 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:21.890038 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:21.890073 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:22.108254 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000524/id_000524.cc
[2025-11-05 06:57:22.108313 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:22.337325 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:22.337433 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:22.340061 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:22.340094 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:22.558581 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000525/id_000525.cc
[2025-11-05 06:57:22.558633 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:22.788669 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:22.788735 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:22.791391 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:22.791423 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:23.008950 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000526/id_000526.cc
[2025-11-05 06:57:23.009002 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:23.237846 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:23.237912 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:23.240656 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:23.240690 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:23.459822 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000527/id_000527.cc
[2025-11-05 06:57:23.459905 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:23.689426 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:23.689483 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:23.692266 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:23.692292 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:23.910211 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000528/id_000528.cc
[2025-11-05 06:57:23.910263 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:24.141049 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:24.141115 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:24.143798 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:24.143825 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:24.361965 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000529/id_000529.cc
[2025-11-05 06:57:24.362018 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:57:24.591615 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:57:24.591722 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:57:24.594567 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:57:24.594599 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:57:24.594638 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:57:24.594657 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 530, succ: 529, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:57:24.594671 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:57:24.594698 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:57:24.896503 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 529 as an example for the next prompt.
[2025-11-05 06:57:24.896557 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 06:57:24.896590 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 06:57:24.896647 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,13.0,69.0,103.0,28.0,15.0,68.0,24.0,23.0,88.0,16.0,11.0,182.0,81.0,27.0,85.0,14.0,124.0,48.0,66.0,45.0,71.0,37.0,19.0,16.0,18.0,13.0,55.0,57.0,12.0,24.0,64.0,144.0,28.0,392.0,63.0,85.0,8.0,14.0,30.0,28.0,206.0,11.0,15.0,54.0,18.0,10.0,40.0,135.0,13.0,9.0,48.0,14.0,12.0,56.0,19.0,122.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,28.0,13.0]
[2025-11-05 06:57:24.896667 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:57:24.896747 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 135
[2025-11-05 06:57:24.896779 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_possible_match_range energy: 14
[2025-11-05 06:57:24.896804 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 54
[2025-11-05 06:57:24.896832 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 13
[2025-11-05 06:57:24.896868 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int )
[2025-11-05 06:57:24.897579 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 53, quiet_round: 0, discovered_api_pairs: 1217
[2025-11-05 06:57:24.942262 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:57:24.942615 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarbaz foo bar foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t match_arr[3];\n    int nmatch = 3;\n    int prog_size = 0;\n    int easy_ret = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_dot_nl(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    prog_size = cre2_program_size(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, nmatch);\n\n    // step 5: Validate\n    computed_check = prog_size + easy_ret + match_arr[0].length + match_arr[1].length + pattern_len + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char subject_buf[] = \"xxfooYY\";\n    const int subject_len = (int)(sizeof(subject_buf) - 1);\n    char text_and_target_buf[] = \"foo and foo again\";\n    char rewrite_buf[] = \"bar\";\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t matches[3];\n    cre2_string_t errarg;\n    int nmatch = 3;\n    int partial_rc = 0;\n    int replace_rc = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(&errarg, 0, sizeof(errarg));\n    subject.data = subject_buf;\n    subject.length = subject_len;\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = (int)(sizeof(text_and_target_buf) - 1);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n\n    // step 3: Create regexp\n    re = cre2_new(pattern, pattern_len, NULL);\n\n    // step 4: Operate with partial match and global replace, and retrieve error arg\n    partial_rc = cre2_partial_match_re(re, &subject, matches, nmatch);\n    cre2_error_arg(re, &errarg);\n    replace_rc = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate results (combine values to ensure meaningful flow)\n    computed_check = partial_rc + replace_rc + matches[0].length + matches[1].length + text_and_target.length + errarg.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:58:18.124073 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 53s
[2025-11-05 06:58:18.124191 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28730, Completion: 21568, Total: 50298
[2025-11-05 06:58:18.124212 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:58:18.342136 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000530/id_000530.cc
[2025-11-05 06:58:18.342187 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:18.573217 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:18.573292 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:18.576058 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:18.576090 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:18.794539 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000531/id_000531.cc
[2025-11-05 06:58:18.794590 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:19.024773 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:19.024849 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:19.027483 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:19.027517 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:19.250959 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000532/id_000532.cc
[2025-11-05 06:58:19.251043 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:19.481952 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:19.482028 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:19.484833 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:19.484860 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:19.702255 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000533/id_000533.cc
[2025-11-05 06:58:19.702306 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:19.931425 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:19.931501 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:19.934404 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:19.934437 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:20.151874 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000534/id_000534.cc
[2025-11-05 06:58:20.151927 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:20.381247 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:20.381364 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:20.384111 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:20.384141 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:20.603557 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000535/id_000535.cc
[2025-11-05 06:58:20.603609 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:20.833261 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:20.833333 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:20.836100 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:20.836131 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:21.053927 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000536/id_000536.cc
[2025-11-05 06:58:21.053979 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:21.283829 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:21.283905 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:21.286661 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:21.286695 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:21.504807 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000537/id_000537.cc
[2025-11-05 06:58:21.504889 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:21.734094 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:21.734170 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:21.736918 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:21.736951 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:21.954135 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000538/id_000538.cc
[2025-11-05 06:58:21.954187 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:22.185072 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:22.185148 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:22.187911 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:22.187943 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:22.412643 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000539/id_000539.cc
[2025-11-05 06:58:22.412707 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:22.644332 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:22.644447 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:22.647308 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:22.647340 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:22.647377 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:58:22.647393 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 540, succ: 539, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:58:22.647408 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:58:22.647432 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:58:22.954814 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 539 as an example for the next prompt.
[2025-11-05 06:58:22.954869 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 06:58:22.954902 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 06:58:22.954949 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,19.0,69.0,104.0,28.0,15.0,68.0,24.0,23.0,88.0,16.0,11.0,185.0,81.0,27.0,85.0,19.0,125.0,48.0,66.0,45.0,71.0,37.0,19.0,16.0,18.0,13.0,55.0,57.0,12.0,24.0,66.0,146.0,28.0,394.0,63.0,85.0,8.0,14.0,30.0,28.0,206.0,11.0,15.0,58.0,18.0,10.0,40.0,138.0,13.0,9.0,48.0,14.0,12.0,57.0,19.0,122.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,28.0,13.0]
[2025-11-05 06:58:22.954966 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:58:22.955020 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 125
[2025-11-05 06:58:22.955050 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 40
[2025-11-05 06:58:22.955079 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 206
[2025-11-05 06:58:22.955108 +00:00] INFO [src/feedback/schedule.rs:246] Loop 54: Replaced with lowest energy API: cre2_opt_posix_syntax (energy: 8), prob: 0.1204
[2025-11-05 06:58:22.955124 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_posix_syntax energy: 8
[2025-11-05 06:58:22.955157 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    int cre2_opt_one_line(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_posix_syntax(cre2_options_t * opt)
[2025-11-05 06:58:22.955852 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 54, quiet_round: 0, discovered_api_pairs: 1227
[2025-11-05 06:58:22.986475 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:58:22.986813 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_posix_syntax(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char subject_buf[] = \"xxfooYY\";\n    const int subject_len = (int)(sizeof(subject_buf) - 1);\n    char text_and_target_buf[] = \"foo and foo again\";\n    char rewrite_buf[] = \"bar\";\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t matches[3];\n    cre2_string_t errarg;\n    int nmatch = 3;\n    int partial_rc = 0;\n    int replace_rc = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(&errarg, 0, sizeof(errarg));\n    subject.data = subject_buf;\n    subject.length = subject_len;\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = (int)(sizeof(text_and_target_buf) - 1);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n\n    // step 3: Create regexp\n    re = cre2_new(pattern, pattern_len, NULL);\n\n    // step 4: Operate with partial match and global replace, and retrieve error arg\n    partial_rc = cre2_partial_match_re(re, &subject, matches, nmatch);\n    cre2_error_arg(re, &errarg);\n    replace_rc = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate results (combine values to ensure meaningful flow)\n    computed_check = partial_rc + replace_rc + matches[0].length + matches[1].length + text_and_target.length + errarg.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char subject_buf[] = \"xxfoobarbaz foo\";\n    const int subject_len = (int)(sizeof(subject_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t subject;\n    cre2_string_t min_range;\n    cre2_string_t max_range;\n    cre2_string_t matches_partial[3];\n    cre2_string_t matches_consume[3];\n    int nmatch_partial = 3;\n    int nmatch_consume = 3;\n    int rc_partial = 0;\n    int rc_consume = 0;\n    int rc_range = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches_partial, 0, sizeof(matches_partial));\n    memset(matches_consume, 0, sizeof(matches_consume));\n    memset(&min_range, 0, sizeof(min_range));\n    memset(&max_range, 0, sizeof(max_range));\n    subject.data = subject_buf;\n    subject.length = subject_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    rc_partial = cre2_partial_match(pattern, &subject, matches_partial, nmatch_partial);\n    rc_consume = cre2_consume_re(re, &subject, matches_consume, nmatch_consume);\n    rc_range = cre2_possible_match_range(re, &min_range, &max_range, 16);\n\n    // step 5: Validate\n    computed_check = rc_partial + rc_consume + rc_range + subject.length + matches_partial[0].length + matches_consume[0].length + (int)enc + min_range.length + max_range.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:58:54.225687 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 06:58:54.225807 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29730, Completion: 17363, Total: 47093
[2025-11-05 06:58:54.225828 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:58:54.444641 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000540/id_000540.cc
[2025-11-05 06:58:54.444692 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:54.675563 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:54.675648 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:54.678212 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:54.678245 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:54.896096 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000541/id_000541.cc
[2025-11-05 06:58:54.896148 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:55.124827 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:55.124900 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:55.127417 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:55.127448 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:55.346318 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000542/id_000542.cc
[2025-11-05 06:58:55.346402 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:55.575810 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:55.575886 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:55.578549 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:55.578580 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:55.796888 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000543/id_000543.cc
[2025-11-05 06:58:55.796940 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:56.025531 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:56.025605 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:56.028053 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:56.028086 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:56.246089 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000544/id_000544.cc
[2025-11-05 06:58:56.246142 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:56.474510 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:56.474627 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:56.477123 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:56.477156 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:56.696752 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000545/id_000545.cc
[2025-11-05 06:58:56.696804 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:56.925596 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:56.925670 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:56.928194 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:56.928227 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:57.145622 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000546/id_000546.cc
[2025-11-05 06:58:57.145674 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:57.374769 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:57.374845 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:57.377434 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:57.377466 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:57.594561 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000547/id_000547.cc
[2025-11-05 06:58:57.594652 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:57.823075 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:57.823145 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:57.825647 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:57.825680 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:58.044368 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000548/id_000548.cc
[2025-11-05 06:58:58.044420 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:58.272590 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:58.272678 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:58.275261 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:58.275286 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:58.492477 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000549/id_000549.cc
[2025-11-05 06:58:58.492534 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:58:58.720590 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:58:58.720705 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:58:58.723313 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:58:58.723342 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:58:58.723379 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:58:58.723417 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 550, succ: 549, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:58:58.723432 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:58:58.723459 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:58:58.993206 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 549 as an example for the next prompt.
[2025-11-05 06:58:58.993261 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 06:58:58.993290 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 06:58:58.993337 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,19.0,69.0,104.0,28.0,15.0,68.0,24.0,26.0,88.0,16.0,11.0,185.0,81.0,27.0,87.0,19.0,127.0,48.0,66.0,45.0,71.0,37.0,19.0,16.0,18.0,13.0,55.0,57.0,12.0,24.0,66.0,146.0,28.0,394.0,63.0,85.0,12.0,14.0,30.0,28.0,208.0,11.0,15.0,58.0,18.0,10.0,44.0,138.0,13.0,9.0,48.0,14.0,12.0,58.0,19.0,122.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,28.0,13.0]
[2025-11-05 06:58:58.993355 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:58:58.993407 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 122
[2025-11-05 06:58:58.993438 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 394
[2025-11-05 06:58:58.993464 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_posix_syntax energy: 26
[2025-11-05 06:58:58.993489 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 127
[2025-11-05 06:58:58.993514 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_arg energy: 12
[2025-11-05 06:58:58.993548 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),
    cre2_options_t *cre2_opt_new(),
    void cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg)
[2025-11-05 06:58:58.994359 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 55, quiet_round: 0, discovered_api_pairs: 1233
[2025-11-05 06:58:59.032637 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:58:59.032995 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),\n    cre2_options_t *cre2_opt_new(),\n    void cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char subject_buf[] = \"xxfoobarbaz foo\";\n    const int subject_len = (int)(sizeof(subject_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t subject;\n    cre2_string_t min_range;\n    cre2_string_t max_range;\n    cre2_string_t matches_partial[3];\n    cre2_string_t matches_consume[3];\n    int nmatch_partial = 3;\n    int nmatch_consume = 3;\n    int rc_partial = 0;\n    int rc_consume = 0;\n    int rc_range = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches_partial, 0, sizeof(matches_partial));\n    memset(matches_consume, 0, sizeof(matches_consume));\n    memset(&min_range, 0, sizeof(min_range));\n    memset(&max_range, 0, sizeof(max_range));\n    subject.data = subject_buf;\n    subject.length = subject_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    rc_partial = cre2_partial_match(pattern, &subject, matches_partial, nmatch_partial);\n    rc_consume = cre2_consume_re(re, &subject, matches_consume, nmatch_consume);\n    rc_range = cre2_possible_match_range(re, &min_range, &max_range, 16);\n\n    // step 5: Validate\n    computed_check = rc_partial + rc_consume + rc_range + subject.length + matches_partial[0].length + matches_consume[0].length + (int)enc + min_range.length + max_range.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char subject_buf[] = \"xxfooYY\";\n    const int subject_len = (int)(sizeof(subject_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_string_t matches[2];\n    int nmatch = 2;\n    int rc_easy = 0;\n    int one_line_flag = 0;\n    int posix_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    one_line_flag = cre2_opt_one_line(opt);\n    posix_flag = cre2_opt_posix_syntax(opt);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, subject_buf, subject_len, matches, nmatch);\n\n    // step 5: Validate\n    computed_check = rc_easy + one_line_flag + posix_flag + matches[0].length + matches[1].length + subject_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 06:59:29.710048 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 06:59:29.710158 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28520, Completion: 17999, Total: 46519
[2025-11-05 06:59:29.710178 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 06:59:29.928461 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000550/id_000550.cc
[2025-11-05 06:59:29.928513 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:30.156848 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:30.156918 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:30.159704 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:30.159736 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:30.380419 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000551/id_000551.cc
[2025-11-05 06:59:30.380471 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:30.608390 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:30.608448 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:30.611191 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:30.611222 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:30.832447 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000552/id_000552.cc
[2025-11-05 06:59:30.832538 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:31.066039 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:31.066108 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:31.068573 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:31.068607 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:31.289182 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000553/id_000553.cc
[2025-11-05 06:59:31.289235 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:31.520577 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:31.520650 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:31.523058 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:31.523085 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:31.742079 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000554/id_000554.cc
[2025-11-05 06:59:31.742131 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:31.970554 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:31.970650 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:31.973251 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:31.973277 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:32.190250 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000555/id_000555.cc
[2025-11-05 06:59:32.190302 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:32.419513 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:32.419578 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:32.422304 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:32.422337 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:32.642533 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000556/id_000556.cc
[2025-11-05 06:59:32.642596 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:32.871938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:32.872003 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:32.874539 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:32.874571 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:33.093329 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000557/id_000557.cc
[2025-11-05 06:59:33.093413 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:33.320393 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:33.320458 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:33.323146 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:33.323172 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:33.541044 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000558/id_000558.cc
[2025-11-05 06:59:33.541096 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:33.771583 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:33.771657 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:33.774301 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:33.774333 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:33.992804 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000559/id_000559.cc
[2025-11-05 06:59:33.992857 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 06:59:34.223338 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 06:59:34.223435 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 06:59:34.225846 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 06:59:34.225874 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 06:59:34.225912 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:59:34.225927 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 560, succ: 559, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 06:59:34.225943 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 06:59:34.225970 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 06:59:34.489548 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 559 as an example for the next prompt.
[2025-11-05 06:59:34.489610 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 06:59:34.489649 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 06:59:34.489700 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,19.0,69.0,104.0,28.0,15.0,68.0,24.0,29.0,88.0,16.0,11.0,188.0,81.0,27.0,87.0,19.0,128.0,48.0,66.0,45.0,71.0,37.0,19.0,16.0,18.0,13.0,55.0,57.0,16.0,24.0,66.0,146.0,28.0,398.0,63.0,85.0,18.0,14.0,30.0,28.0,208.0,11.0,15.0,58.0,18.0,10.0,44.0,138.0,13.0,9.0,48.0,14.0,12.0,59.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,85.0,22.0,28.0,13.0]
[2025-11-05 06:59:34.489720 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 06:59:34.489788 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_dot_nl energy: 22
[2025-11-05 06:59:34.489821 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 398
[2025-11-05 06:59:34.489850 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 58
[2025-11-05 06:59:34.489875 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 48
[2025-11-05 06:59:34.489912 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_dot_nl(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 06:59:34.490627 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 56, quiet_round: 0, discovered_api_pairs: 1242
[2025-11-05 06:59:34.537689 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 06:59:34.538058 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_dot_nl(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char subject_buf[] = \"xxfooYY\";\n    const int subject_len = (int)(sizeof(subject_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_string_t matches[2];\n    int nmatch = 2;\n    int rc_easy = 0;\n    int one_line_flag = 0;\n    int posix_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    one_line_flag = cre2_opt_one_line(opt);\n    posix_flag = cre2_opt_posix_syntax(opt);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, subject_buf, subject_len, matches, nmatch);\n\n    // step 5: Validate\n    computed_check = rc_easy + one_line_flag + posix_flag + matches[0].length + matches[1].length + subject_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t errarg;\n    const char *pattern_from_re = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&errarg, 0, sizeof(errarg));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    cre2_error_arg(re, &errarg);\n\n    // step 5: Validate\n    computed_check = pattern_len + errarg.length + (int)pattern_from_re[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:00:26.724719 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 52s
[2025-11-05 07:00:26.724840 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 26290, Completion: 26272, Total: 52562
[2025-11-05 07:00:26.724860 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:00:26.945985 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000560/id_000560.cc
[2025-11-05 07:00:26.946037 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:27.174242 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:27.174320 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:27.177262 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:27.177292 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:27.394753 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000561/id_000561.cc
[2025-11-05 07:00:27.394813 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:27.626717 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:27.626793 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:27.629476 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:27.629508 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:27.850739 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000562/id_000562.cc
[2025-11-05 07:00:27.850824 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:28.082123 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:28.082193 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:28.084664 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:28.084702 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:28.302739 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000563/id_000563.cc
[2025-11-05 07:00:28.302799 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:28.532979 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:28.533082 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:28.535590 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:28.535617 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:28.751631 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000564/id_000564.cc
[2025-11-05 07:00:28.751685 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:28.979169 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:28.979280 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:28.981980 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:28.982011 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:29.200022 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000565/id_000565.cc
[2025-11-05 07:00:29.200075 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:29.428795 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:29.428854 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:29.431525 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:29.431557 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:29.649900 +00:00] WARN [src/fuzzer.rs:205] Program 566 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000566/id_000566.cc:52:11: error: no matching function for call to 'cre2_set_new'
   52 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:00:29.697048 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:00:29.697389 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern_simple[] = \"foo\";\n    const char text[] = \"xxfooYY\";\n    const int text_len = (int)(sizeof(text) - 1);\n\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n\n    cre2_string_t subject;\n    cre2_string_t matches[2];\n    int nmatch = 2;\n\n    int match_idx[4];\n    size_t set_rc = 0;\n    int partial_rc = 0;\n    int dot_nl_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&subject, 0, sizeof(subject));\n    memset(matches, 0, sizeof(matches));\n    memset(match_idx, 0, sizeof(match_idx));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    dot_nl_flag = cre2_opt_dot_nl(opt);\n    subject.data = text;\n    subject.length = text_len;\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    partial_rc = cre2_partial_match(pattern, &subject, matches, nmatch);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, set_pattern_simple);\n    cre2_set_compile(set);\n    set_rc = cre2_set_match(set, text, (size_t)text_len, match_idx, (size_t)(sizeof(match_idx)/sizeof(match_idx[0])));\n\n    // step 5: Validate\n    computed_check = partial_rc + (int)set_rc + dot_nl_flag + matches[0].length + matches[1].length + subject.length + match_idx[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000566/id_000566.cc:52:11: error: no matching function for call to 'cre2_set_new'\n   52 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:00:48.089876 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 18s
[2025-11-05 07:00:48.090001 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22820, Completion: 10761, Total: 33581
[2025-11-05 07:00:48.312212 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000566/id_000566.cc
[2025-11-05 07:00:48.312264 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:48.545060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:48.545137 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:48.548038 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:48.548070 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:48.548104 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 566!
[2025-11-05 07:00:48.770126 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000567/id_000567.cc
[2025-11-05 07:00:48.770185 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:48.998734 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:48.998810 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:49.001700 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:49.001732 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:49.218198 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000568/id_000568.cc
[2025-11-05 07:00:49.218281 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:49.449006 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:49.449082 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:49.451876 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:49.451908 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:49.668284 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000569/id_000569.cc
[2025-11-05 07:00:49.668339 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:00:49.897614 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:00:49.897691 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:00:49.900184 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:00:49.900238 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:00:49.900279 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:00:49.900296 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 570, succ: 569, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:00:49.900310 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:00:49.900339 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:00:50.195934 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 569 as an example for the next prompt.
[2025-11-05 07:00:50.195996 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 22 new API pairs in this round.
[2025-11-05 07:00:50.196057 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 22
[2025-11-05 07:00:50.196106 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,19.0,69.0,104.0,28.0,15.0,68.0,24.0,29.0,88.0,16.0,11.0,191.0,81.0,27.0,87.0,19.0,133.0,48.0,66.0,45.0,73.0,37.0,19.0,16.0,18.0,13.0,60.0,57.0,16.0,24.0,66.0,146.0,28.0,406.0,63.0,92.0,18.0,14.0,30.0,28.0,208.0,11.0,15.0,66.0,18.0,10.0,44.0,138.0,13.0,9.0,54.0,14.0,12.0,59.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,91.0,33.0,32.0,13.0]
[2025-11-05 07:00:50.196125 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:00:50.196182 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 19
[2025-11-05 07:00:50.196222 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 208
[2025-11-05 07:00:50.196267 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 66
[2025-11-05 07:00:50.196301 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 406
[2025-11-05 07:00:50.196355 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_error_code(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 07:00:50.197144 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 57, quiet_round: 0, discovered_api_pairs: 1264
[2025-11-05 07:00:50.243726 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:00:50.244119 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_error_code(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t errarg;\n    const char *pattern_from_re = NULL;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&errarg, 0, sizeof(errarg));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    cre2_error_arg(re, &errarg);\n\n    // step 5: Validate\n    computed_check = pattern_len + errarg.length + (int)pattern_from_re[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(fo.o)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoozbarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    int dot_nl_flag = 0;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[3];\n    int nmatch = 3;\n    int rc_pm = 0;\n    cre2_set *set = NULL;\n    int add_rc = 0;\n    size_t setmatch_count = 0;\n    int match_ints[4];\n    size_t match_len = 4;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(match_ints, 0, sizeof(match_ints));\n    subject.data = text_buf;\n    subject.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    dot_nl_flag = cre2_opt_dot_nl(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    rc_pm = cre2_partial_match(pattern, &subject, matches, nmatch);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_rc = cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    setmatch_count = cre2_set_match(set, text_buf, (size_t)text_len, match_ints, match_len);\n\n    // step 5: Validate\n    computed_check = rc_pm + add_rc + (int)setmatch_count + dot_nl_flag + matches[0].length + matches[1].length + matches[2].length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:01:30.404275 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 07:01:30.404396 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28030, Completion: 19604, Total: 47634
[2025-11-05 07:01:30.404416 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:01:30.620617 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000570/id_000570.cc
[2025-11-05 07:01:30.620680 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:30.853070 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:30.853143 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:30.855678 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:30.855709 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:31.077688 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000571/id_000571.cc
[2025-11-05 07:01:31.077742 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:31.308293 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:31.308366 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:31.310875 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:31.310906 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:31.533355 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000572/id_000572.cc
[2025-11-05 07:01:31.533440 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:31.766011 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:31.766084 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:31.768552 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:31.768579 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:31.985035 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000573/id_000573.cc
[2025-11-05 07:01:31.985089 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:32.217663 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:32.217746 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:32.220546 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:32.220571 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:32.438870 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000574/id_000574.cc
[2025-11-05 07:01:32.438927 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:32.667287 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:32.667395 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:32.670268 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:32.670300 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:32.887940 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000575/id_000575.cc
[2025-11-05 07:01:32.887994 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:33.117075 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:33.117148 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:33.119791 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:33.119821 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:33.341199 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000576/id_000576.cc
[2025-11-05 07:01:33.341252 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:33.575273 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:33.575360 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:33.577868 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:33.577901 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:33.799719 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000577/id_000577.cc
[2025-11-05 07:01:33.799805 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:34.031900 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:34.031972 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:34.034449 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:34.034480 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:34.251201 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000578/id_000578.cc
[2025-11-05 07:01:34.251255 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:34.483250 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:34.483326 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:34.485849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:34.485880 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:34.702804 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000579/id_000579.cc
[2025-11-05 07:01:34.702864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:01:34.934060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:01:34.934155 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:01:34.936586 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:01:34.936618 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:01:34.936663 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:01:34.936678 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 580, succ: 579, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:01:34.936693 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:01:34.936718 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:01:35.213317 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 579 as an example for the next prompt.
[2025-11-05 07:01:35.213372 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 07:01:35.213401 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 07:01:35.213448 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,24.0,69.0,104.0,28.0,15.0,68.0,24.0,29.0,88.0,16.0,11.0,193.0,81.0,27.0,87.0,19.0,134.0,48.0,70.0,45.0,73.0,37.0,19.0,16.0,18.0,13.0,60.0,57.0,16.0,24.0,66.0,147.0,28.0,409.0,63.0,92.0,18.0,14.0,30.0,28.0,210.0,11.0,15.0,66.0,18.0,10.0,44.0,138.0,13.0,9.0,54.0,14.0,12.0,59.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,91.0,33.0,32.0,13.0]
[2025-11-05 07:01:35.213466 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:01:35.213529 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 138
[2025-11-05 07:01:35.213564 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 409
[2025-11-05 07:01:35.213590 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 73
[2025-11-05 07:01:35.213629 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 70
[2025-11-05 07:01:35.213663 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_set_delete(cre2_set * set),
    int cre2_error_code(const cre2_regexp_t * re)
[2025-11-05 07:01:35.214363 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 58, quiet_round: 0, discovered_api_pairs: 1270
[2025-11-05 07:01:35.249891 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:01:35.250243 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_set_delete(cre2_set * set),\n    int cre2_error_code(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(fo.o)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoozbarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    int dot_nl_flag = 0;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[3];\n    int nmatch = 3;\n    int rc_pm = 0;\n    cre2_set *set = NULL;\n    int add_rc = 0;\n    size_t setmatch_count = 0;\n    int match_ints[4];\n    size_t match_len = 4;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(match_ints, 0, sizeof(match_ints));\n    subject.data = text_buf;\n    subject.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    dot_nl_flag = cre2_opt_dot_nl(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    rc_pm = cre2_partial_match(pattern, &subject, matches, nmatch);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_rc = cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    setmatch_count = cre2_set_match(set, text_buf, (size_t)text_len, match_ints, match_len);\n\n    // step 5: Validate\n    computed_check = rc_pm + add_rc + (int)setmatch_count + dot_nl_flag + matches[0].length + matches[1].length + matches[2].length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[3];\n    int nmatch = 3;\n    int rc_consume = 0;\n    int rc_easy = 0;\n    int errcode = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    subject.data = text_buf;\n    subject.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, nmatch);\n    rc_consume = cre2_consume_re(re, &subject, matches, nmatch);\n    errcode = cre2_error_code(re);\n\n    // step 5: Validate\n    computed_check = rc_easy + rc_consume + errcode + matches[0].length + matches[1].length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:02:13.824582 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 07:02:13.824710 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28940, Completion: 21997, Total: 50937
[2025-11-05 07:02:13.824730 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:02:14.043343 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000580/id_000580.cc
[2025-11-05 07:02:14.043394 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:14.273498 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:14.273574 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:14.276145 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:14.276176 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:14.494622 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000581/id_000581.cc
[2025-11-05 07:02:14.494675 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:14.723634 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:14.723702 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:14.726303 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:14.726334 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:14.944774 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000582/id_000582.cc
[2025-11-05 07:02:14.944857 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:15.173151 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:15.173252 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:15.175869 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:15.175897 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:15.393420 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000583/id_000583.cc
[2025-11-05 07:02:15.393480 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:15.620889 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:15.620965 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:15.623686 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:15.623718 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:15.841838 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000584/id_000584.cc
[2025-11-05 07:02:15.841891 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:16.073877 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:16.073977 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:16.076454 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:16.076486 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:16.296841 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000585/id_000585.cc
[2025-11-05 07:02:16.296893 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:16.525162 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:16.525233 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:16.527919 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:16.527950 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:16.746775 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000586/id_000586.cc
[2025-11-05 07:02:16.746827 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:16.975040 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:16.975113 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:16.977668 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:16.977699 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:17.195616 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000587/id_000587.cc
[2025-11-05 07:02:17.195705 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:17.422385 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:17.422458 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:17.425105 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:17.425137 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:17.642405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000588/id_000588.cc
[2025-11-05 07:02:17.642459 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:17.873758 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:17.873831 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:17.876653 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:17.876685 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:18.093184 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000589/id_000589.cc
[2025-11-05 07:02:18.093238 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:18.323686 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:18.323796 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:18.326489 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:18.326521 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:18.326560 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:02:18.326576 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 590, succ: 589, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:02:18.326590 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:02:18.326614 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:02:18.607306 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 589 as an example for the next prompt.
[2025-11-05 07:02:18.607360 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 07:02:18.607400 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 07:02:18.607448 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,24.0,69.0,104.0,28.0,15.0,68.0,24.0,29.0,88.0,16.0,11.0,199.0,81.0,27.0,87.0,19.0,136.0,48.0,76.0,45.0,75.0,37.0,19.0,16.0,18.0,13.0,65.0,57.0,16.0,24.0,68.0,152.0,28.0,414.0,63.0,96.0,18.0,14.0,30.0,28.0,212.0,11.0,15.0,66.0,18.0,10.0,44.0,144.0,13.0,9.0,57.0,14.0,12.0,59.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,94.0,33.0,32.0,13.0]
[2025-11-05 07:02:18.607466 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:02:18.607548 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 152
[2025-11-05 07:02:18.607581 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 44
[2025-11-05 07:02:18.607608 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 76
[2025-11-05 07:02:18.607634 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 66
[2025-11-05 07:02:18.607667 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_opt_one_line(cre2_options_t * opt),
    int cre2_error_code(const cre2_regexp_t * re),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:02:18.608369 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 59, quiet_round: 0, discovered_api_pairs: 1287
[2025-11-05 07:02:18.644489 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:02:18.644842 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    int cre2_error_code(const cre2_regexp_t * re),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[3];\n    int nmatch = 3;\n    int rc_consume = 0;\n    int rc_easy = 0;\n    int errcode = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    subject.data = text_buf;\n    subject.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, nmatch);\n    rc_consume = cre2_consume_re(re, &subject, matches, nmatch);\n    errcode = cre2_error_code(re);\n\n    // step 5: Validate\n    computed_check = rc_easy + rc_consume + errcode + matches[0].length + matches[1].length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int errcode = 0;\n    int add_rc = 0;\n    int compile_rc = 0;\n    char scratch[32];\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_rc = cre2_set_add_simple(set, pattern);\n    compile_rc = cre2_set_compile(set);\n\n    // step 5: Validate\n    errcode = cre2_error_code(re);\n    computed_check = pattern_len + (int)enc + errcode + add_rc + compile_rc + (int)scratch[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:02:44.817680 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 07:02:44.817811 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27470, Completion: 16269, Total: 43739
[2025-11-05 07:02:44.817832 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:02:45.037113 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000590/id_000590.cc
[2025-11-05 07:02:45.037172 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:45.267335 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:45.267396 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:45.270238 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:45.270267 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:45.487812 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000591/id_000591.cc
[2025-11-05 07:02:45.487869 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:45.718730 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:45.718800 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:45.721594 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:45.721622 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:45.938691 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000592/id_000592.cc
[2025-11-05 07:02:45.938776 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:46.170600 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:46.170664 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:46.173485 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:46.173515 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:46.391563 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000593/id_000593.cc
[2025-11-05 07:02:46.391616 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:46.620617 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:46.620710 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:46.623294 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:46.623324 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:46.841363 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000594/id_000594.cc
[2025-11-05 07:02:46.841424 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:47.069655 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:47.069763 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:47.072139 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:47.072171 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:47.292576 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000595/id_000595.cc
[2025-11-05 07:02:47.292672 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:47.524643 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:47.524717 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:47.527211 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:47.527242 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:47.748365 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000596/id_000596.cc
[2025-11-05 07:02:47.748418 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:47.979213 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:47.979284 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:47.982140 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:47.982171 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:48.199612 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000597/id_000597.cc
[2025-11-05 07:02:48.199697 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:48.431193 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:48.431271 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:48.433913 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:48.433946 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:48.655057 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000598/id_000598.cc
[2025-11-05 07:02:48.655109 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:48.884210 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:48.884279 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:48.886864 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:48.886896 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:49.107406 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000599/id_000599.cc
[2025-11-05 07:02:49.107458 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:02:49.334918 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:02:49.335023 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:02:49.337861 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:02:49.337891 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:02:49.337930 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:02:49.337945 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 600, succ: 599, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:02:49.337959 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:02:49.337983 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:02:49.617504 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 599 as an example for the next prompt.
[2025-11-05 07:02:49.617566 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 07:02:49.617600 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 07:02:49.617647 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,24.0,69.0,104.0,28.0,15.0,68.0,24.0,29.0,88.0,16.0,11.0,203.0,81.0,27.0,87.0,19.0,137.0,48.0,82.0,45.0,75.0,37.0,19.0,16.0,18.0,13.0,65.0,57.0,16.0,24.0,68.0,154.0,28.0,418.0,63.0,96.0,18.0,14.0,30.0,28.0,212.0,11.0,15.0,72.0,18.0,10.0,53.0,144.0,13.0,9.0,57.0,14.0,12.0,60.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,94.0,33.0,32.0,13.0]
[2025-11-05 07:02:49.617667 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:02:49.617720 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_current energy: 12
[2025-11-05 07:02:49.617750 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 88
[2025-11-05 07:02:49.617778 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 48
[2025-11-05 07:02:49.617804 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 15
[2025-11-05 07:02:49.617831 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 418
[2025-11-05 07:02:49.617867 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_version_interface_current(),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_opt_perl_classes(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 07:02:49.618666 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 60, quiet_round: 0, discovered_api_pairs: 1298
[2025-11-05 07:02:49.653052 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:02:49.653386 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_version_interface_current(),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_opt_perl_classes(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test)(ing)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int errcode = 0;\n    int add_rc = 0;\n    int compile_rc = 0;\n    char scratch[32];\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_rc = cre2_set_add_simple(set, pattern);\n    compile_rc = cre2_set_compile(set);\n\n    // step 5: Validate\n    errcode = cre2_error_code(re);\n    computed_check = pattern_len + (int)enc + errcode + add_rc + compile_rc + (int)scratch[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[3];\n    int nmatch = 3;\n    int rc_partial = 0;\n    int one_line_flag = 0;\n    int errcode = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    subject.data = text_buf;\n    subject.length = text_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    one_line_flag = cre2_opt_one_line(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    rc_partial = cre2_partial_match(pattern, &subject, matches, nmatch);\n    errcode = cre2_error_code(re);\n\n    // step 5: Validate\n    computed_check = rc_partial + one_line_flag + errcode + matches[0].length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:03:22.774872 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 07:03:22.774997 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27250, Completion: 16702, Total: 43952
[2025-11-05 07:03:22.775018 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:03:22.992903 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000600/id_000600.cc
[2025-11-05 07:03:22.992958 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:23.220971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:23.221030 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:23.223627 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:23.223660 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:23.442269 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000601/id_000601.cc
[2025-11-05 07:03:23.442323 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:23.671476 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:23.671554 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:23.674368 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:23.674422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:23.891231 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000602/id_000602.cc
[2025-11-05 07:03:23.891314 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:24.120369 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:24.120427 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:24.123204 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:24.123231 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:24.341268 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000603/id_000603.cc
[2025-11-05 07:03:24.341323 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:24.569974 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:24.570050 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:24.572718 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:24.572745 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:24.790271 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000604/id_000604.cc
[2025-11-05 07:03:24.790325 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:25.018211 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:25.018326 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:25.021119 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:25.021151 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:25.238646 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000605/id_000605.cc
[2025-11-05 07:03:25.238701 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:25.466142 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:25.466219 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:25.469040 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:25.469068 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:25.686890 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000606/id_000606.cc
[2025-11-05 07:03:25.686944 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:25.917255 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:25.917330 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:25.919942 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:25.919968 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:26.138149 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000607/id_000607.cc
[2025-11-05 07:03:26.138235 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:26.367759 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:26.367836 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:26.370692 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:26.370725 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:26.587949 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000608/id_000608.cc
[2025-11-05 07:03:26.588004 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:26.816062 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:26.816127 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:26.818934 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:26.818961 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:27.035948 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000609/id_000609.cc
[2025-11-05 07:03:27.036003 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:27.265093 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:27.265182 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:27.267937 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:27.267969 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:27.268008 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:03:27.268025 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 610, succ: 609, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:03:27.268041 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:03:27.268068 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:03:27.544612 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 609 as an example for the next prompt.
[2025-11-05 07:03:27.544679 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 21 new API pairs in this round.
[2025-11-05 07:03:27.544732 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 21
[2025-11-05 07:03:27.544789 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,99.0,16.0,11.0,207.0,82.0,27.0,87.0,19.0,141.0,54.0,84.0,45.0,75.0,37.0,19.0,16.0,18.0,13.0,65.0,57.0,16.0,24.0,68.0,154.0,28.0,428.0,63.0,96.0,18.0,14.0,30.0,28.0,212.0,11.0,15.0,72.0,18.0,10.0,53.0,144.0,13.0,9.0,57.0,14.0,26.0,60.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,94.0,33.0,32.0,13.0]
[2025-11-05 07:03:27.544812 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:03:27.544877 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 154
[2025-11-05 07:03:27.544928 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 141
[2025-11-05 07:03:27.544964 +00:00] INFO [src/feedback/schedule.rs:246] Loop 61: Replaced with lowest energy API: cre2_find_and_consume_re (energy: 9), prob: 0.0749
[2025-11-05 07:03:27.544983 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume_re energy: 9
[2025-11-05 07:03:27.545016 +00:00] INFO [src/feedback/schedule.rs:246] Loop 61: Replaced with lowest energy API: cre2_find_and_consume_re (energy: 9), prob: 0.0749
[2025-11-05 07:03:27.545047 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 99
[2025-11-05 07:03:27.545078 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 212
[2025-11-05 07:03:27.545132 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    cre2_options_t *cre2_opt_new(),
    int cre2_find_and_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 07:03:27.545952 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 61, quiet_round: 0, discovered_api_pairs: 1319
[2025-11-05 07:03:27.592505 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:03:27.592886 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_find_and_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[3];\n    int nmatch = 3;\n    int rc_partial = 0;\n    int one_line_flag = 0;\n    int errcode = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    subject.data = text_buf;\n    subject.length = text_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    one_line_flag = cre2_opt_one_line(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    rc_partial = cre2_partial_match(pattern, &subject, matches, nmatch);\n    errcode = cre2_error_code(re);\n\n    // step 5: Validate\n    computed_check = rc_partial + one_line_flag + errcode + matches[0].length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha)(beta)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int interface_ver = 0;\n    int perl_classes_flag = 0;\n    int literal_flag = 1;\n    int n_capturing = 0;\n    int errcode = 0;\n    char scratch[32];\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, literal_flag);\n\n    // step 3: Configure\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n    interface_ver = cre2_version_interface_current();\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Validate\n    n_capturing = cre2_num_capturing_groups(re);\n    errcode = cre2_error_code(re);\n    computed_check = interface_ver + perl_classes_flag + literal_flag + n_capturing + errcode + pattern_len + (int)scratch[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:03:57.876482 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 07:03:57.876616 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27510, Completion: 17466, Total: 44976
[2025-11-05 07:03:57.876653 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:03:58.094360 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000610/id_000610.cc
[2025-11-05 07:03:58.094413 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:58.321738 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:58.321795 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:58.324634 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:58.324662 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:58.543879 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000611/id_000611.cc
[2025-11-05 07:03:58.543932 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:58.771311 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:58.771378 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:58.774213 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:58.774240 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:58.991721 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000612/id_000612.cc
[2025-11-05 07:03:58.991810 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:59.221337 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:59.221396 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:59.223984 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:59.224011 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:59.441716 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000613/id_000613.cc
[2025-11-05 07:03:59.441769 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:03:59.669478 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:03:59.669575 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:03:59.672429 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:03:59.672457 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:03:59.890851 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000614/id_000614.cc
[2025-11-05 07:03:59.890905 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:00.118699 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:00.118785 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:00.121661 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:00.121691 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:00.338401 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000615/id_000615.cc
[2025-11-05 07:04:00.338454 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:00.566223 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:00.566281 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:00.569113 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:00.569141 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:00.785591 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000616/id_000616.cc
[2025-11-05 07:04:00.785645 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:01.015584 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:01.015639 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:01.018395 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:01.018422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:01.234924 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000617/id_000617.cc
[2025-11-05 07:04:01.235011 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:01.464500 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:01.464570 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:01.467238 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:01.467266 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:01.685031 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000618/id_000618.cc
[2025-11-05 07:04:01.685085 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:01.914381 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:01.914447 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:01.917274 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:01.917299 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:02.135867 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000619/id_000619.cc
[2025-11-05 07:04:02.135920 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:02.365245 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:02.365358 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:02.368180 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:02.368208 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:02.368248 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:04:02.368267 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 620, succ: 619, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:04:02.368284 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:04:02.368320 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:04:02.652349 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 619 as an example for the next prompt.
[2025-11-05 07:04:02.652405 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 07:04:02.652435 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 07:04:02.652483 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,105.0,16.0,11.0,210.0,82.0,27.0,87.0,19.0,141.0,54.0,84.0,45.0,75.0,37.0,19.0,16.0,18.0,13.0,65.0,57.0,16.0,24.0,68.0,155.0,28.0,430.0,63.0,96.0,18.0,14.0,30.0,28.0,217.0,11.0,15.0,72.0,18.0,10.0,53.0,144.0,13.0,16.0,57.0,14.0,26.0,60.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,94.0,33.0,32.0,13.0]
[2025-11-05 07:04:02.652503 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:04:02.652555 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 14
[2025-11-05 07:04:02.652586 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 57
[2025-11-05 07:04:02.652612 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 144
[2025-11-05 07:04:02.652649 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 54
[2025-11-05 07:04:02.652684 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_case_sensitive(cre2_options_t * opt),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag)
[2025-11-05 07:04:02.653386 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 62, quiet_round: 0, discovered_api_pairs: 1327
[2025-11-05 07:04:02.689099 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:04:02.689447 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_case_sensitive(cre2_options_t * opt),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha)(beta)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int interface_ver = 0;\n    int perl_classes_flag = 0;\n    int literal_flag = 1;\n    int n_capturing = 0;\n    int errcode = 0;\n    char scratch[32];\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, literal_flag);\n\n    // step 3: Configure\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n    interface_ver = cre2_version_interface_current();\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Validate\n    n_capturing = cre2_num_capturing_groups(re);\n    errcode = cre2_error_code(re);\n    computed_check = interface_ver + perl_classes_flag + literal_flag + n_capturing + errcode + pattern_len + (int)scratch[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t consumed;\n    cre2_string_t easy_matches[2];\n    int nmatch_easy = 2;\n    int rc_easy = 0;\n    int rc_consume = 0;\n    int n_capturing = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(easy_matches, 0, sizeof(easy_matches));\n    subject.data = text_buf;\n    subject.length = text_len;\n    consumed.data = NULL;\n    consumed.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    n_capturing = cre2_num_capturing_groups(re);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_matches, nmatch_easy);\n    rc_consume = cre2_find_and_consume_re(re, &subject, &consumed, 0);\n\n    // step 5: Validate\n    computed_check = rc_easy + rc_consume + n_capturing + easy_matches[0].length + consumed.length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:04:34.527207 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 07:04:34.527333 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28050, Completion: 20161, Total: 48211
[2025-11-05 07:04:34.527354 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:04:34.745206 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000620/id_000620.cc
[2025-11-05 07:04:34.745260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:34.973926 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:34.973992 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:34.976600 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:34.976637 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:35.193175 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000621/id_000621.cc
[2025-11-05 07:04:35.193228 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:35.422887 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:35.422955 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:35.425699 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:35.425731 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:35.643872 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000622/id_000622.cc
[2025-11-05 07:04:35.643957 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:35.872794 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:35.872872 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:35.875523 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:35.875556 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:36.092700 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000623/id_000623.cc
[2025-11-05 07:04:36.092752 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:36.321695 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:36.321762 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:36.324378 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:36.324404 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:36.541059 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000624/id_000624.cc
[2025-11-05 07:04:36.541114 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:36.770843 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:36.770941 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:36.773575 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:36.773607 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:36.992578 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000625/id_000625.cc
[2025-11-05 07:04:36.992685 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:37.221954 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:37.222012 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:37.224736 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:37.224781 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:37.443238 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000626/id_000626.cc
[2025-11-05 07:04:37.443292 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:37.671427 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:37.671501 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:37.674317 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:37.674350 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:37.893914 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000627/id_000627.cc
[2025-11-05 07:04:37.893999 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:38.123018 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:38.123093 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:38.125780 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:38.125812 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:38.344689 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000628/id_000628.cc
[2025-11-05 07:04:38.344742 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:38.575082 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:38.575151 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:38.577931 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:38.577965 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:38.794575 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000629/id_000629.cc
[2025-11-05 07:04:38.794628 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:04:39.025694 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:04:39.025798 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:04:39.028224 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:04:39.028257 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:04:39.028296 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:04:39.028313 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 630, succ: 629, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:04:39.028329 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:04:39.028355 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:04:39.320493 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 629 as an example for the next prompt.
[2025-11-05 07:04:39.320548 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 07:04:39.320590 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 07:04:39.320644 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,108.0,16.0,11.0,210.0,82.0,27.0,87.0,19.0,143.0,62.0,84.0,45.0,75.0,37.0,19.0,16.0,18.0,13.0,65.0,66.0,16.0,24.0,68.0,161.0,28.0,433.0,63.0,96.0,18.0,25.0,30.0,28.0,219.0,11.0,15.0,72.0,18.0,10.0,53.0,154.0,13.0,16.0,57.0,14.0,26.0,63.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,94.0,33.0,32.0,13.0]
[2025-11-05 07:04:39.320674 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:04:39.320735 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 30
[2025-11-05 07:04:39.320772 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 433
[2025-11-05 07:04:39.320801 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 63
[2025-11-05 07:04:39.320833 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 45
[2025-11-05 07:04:39.320870 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 57
[2025-11-05 07:04:39.320914 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_version_interface_revision(),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_delete(cre2_options_t * opt),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 07:04:39.321771 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 63, quiet_round: 0, discovered_api_pairs: 1346
[2025-11-05 07:04:39.370233 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:04:39.370609 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_version_interface_revision(),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_delete(cre2_options_t * opt),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text_buf[] = \"xxfoobarYY\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t subject;\n    cre2_string_t consumed;\n    cre2_string_t easy_matches[2];\n    int nmatch_easy = 2;\n    int rc_easy = 0;\n    int rc_consume = 0;\n    int n_capturing = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(easy_matches, 0, sizeof(easy_matches));\n    subject.data = text_buf;\n    subject.length = text_len;\n    consumed.data = NULL;\n    consumed.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    n_capturing = cre2_num_capturing_groups(re);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_matches, nmatch_easy);\n    rc_consume = cre2_find_and_consume_re(re, &subject, &consumed, 0);\n\n    // step 5: Validate\n    computed_check = rc_easy + rc_consume + n_capturing + easy_matches[0].length + consumed.length + subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char text_buf[] = \"one-two-three\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_string_t strings[3];\n    cre2_range_t ranges[3];\n    int cs_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int len0 = 0;\n    int len1 = 0;\n    int len2 = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    strings[0].data = text_buf;\n    strings[0].length = 3;\n    strings[1].data = text_buf + 4;\n    strings[1].length = 3;\n    strings[2].data = text_buf + 8;\n    strings[2].length = 5;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    cs_flag = cre2_opt_case_sensitive(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    cre2_strings_to_ranges(text_buf, ranges, strings, nmatch);\n\n    // step 5: Validate\n    len0 = (int)(ranges[0].past - ranges[0].start);\n    len1 = (int)(ranges[1].past - ranges[1].start);\n    len2 = (int)(ranges[2].past - ranges[2].start);\n    computed_check = cs_flag + (int)enc + len0 + len1 + len2 + strings[0].length + strings[1].length + strings[2].length + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:05:12.589412 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 07:05:12.589540 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29370, Completion: 23925, Total: 53295
[2025-11-05 07:05:12.589560 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:05:12.809230 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000630/id_000630.cc
[2025-11-05 07:05:12.809285 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:13.038655 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:13.038733 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:13.041638 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:13.041671 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:13.259963 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000631/id_000631.cc
[2025-11-05 07:05:13.260018 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:13.489886 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:13.489983 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:13.492876 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:13.492904 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:13.710718 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000632/id_000632.cc
[2025-11-05 07:05:13.710803 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:13.939635 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:13.939701 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:13.942578 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:13.942610 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:14.159648 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000633/id_000633.cc
[2025-11-05 07:05:14.159703 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:14.389235 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:14.389306 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:14.391941 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:14.391969 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:14.608204 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000634/id_000634.cc
[2025-11-05 07:05:14.608260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:14.838145 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:14.838248 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:14.840974 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:14.841000 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:15.060249 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000635/id_000635.cc
[2025-11-05 07:05:15.060303 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:15.290164 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:15.290235 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:15.293166 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:15.293200 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:15.510554 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000636/id_000636.cc
[2025-11-05 07:05:15.510610 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:15.741677 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:15.741745 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:15.744463 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:15.744490 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:15.962261 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000637/id_000637.cc
[2025-11-05 07:05:15.962348 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:16.193439 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:16.193516 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:16.196319 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:16.196351 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:16.414977 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000638/id_000638.cc
[2025-11-05 07:05:16.415033 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:16.644706 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:16.644776 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:16.647513 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:16.647541 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:16.865724 +00:00] WARN [src/fuzzer.rs:205] Program 639 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000639/id_000639.cc:48:11: error: no matching function for call to 'cre2_set_new'
   48 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:05:16.914237 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:05:16.914572 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo and foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"bar\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int match_arr[4];\n    size_t match_len = 4;\n    size_t match_count = 0;\n    int rc_replace = 0;\n    int rc_compile = 0;\n    int version_rev = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n    version_rev = cre2_version_interface_revision();\n\n    // step 4: Operate\n    rc_replace = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    match_count = cre2_set_match(set, text_and_target.data, (size_t)text_and_target.length, match_arr, match_len);\n\n    // step 5: Validate\n    computed_check = rc_replace + rc_compile + (int)match_count + match_arr[0] + match_arr[1] + version_rev + text_and_target.length + rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000639/id_000639.cc:48:11: error: no matching function for call to 'cre2_set_new'\n   48 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:05:41.953644 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 25s
[2025-11-05 07:05:41.953770 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23110, Completion: 13137, Total: 36247
[2025-11-05 07:05:42.173048 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000639/id_000639.cc
[2025-11-05 07:05:42.173101 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:05:42.403506 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:05:42.403570 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:05:42.406234 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:05:42.406265 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:05:42.406298 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 639!
[2025-11-05 07:05:42.406336 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:05:42.406356 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 640, succ: 639, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:05:42.406370 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:05:42.406394 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:05:42.697329 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 639 as an example for the next prompt.
[2025-11-05 07:05:42.697384 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 25 new API pairs in this round.
[2025-11-05 07:05:42.697431 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 25
[2025-11-05 07:05:42.697479 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [27.0,25.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,108.0,16.0,11.0,214.0,82.0,27.0,87.0,19.0,148.0,62.0,84.0,59.0,77.0,37.0,19.0,16.0,18.0,13.0,70.0,66.0,16.0,24.0,68.0,166.0,28.0,438.0,63.0,100.0,18.0,25.0,45.0,28.0,219.0,11.0,15.0,72.0,18.0,10.0,53.0,154.0,13.0,16.0,66.0,14.0,26.0,63.0,19.0,127.0,18.0,42.0,21.0,21.0,61.0,11.0,99.0,33.0,32.0,13.0]
[2025-11-05 07:05:42.697496 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:05:42.697549 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 154
[2025-11-05 07:05:42.697608 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 127
[2025-11-05 07:05:42.697639 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 27
[2025-11-05 07:05:42.697665 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace energy: 25
[2025-11-05 07:05:42.697692 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 61
[2025-11-05 07:05:42.697727 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)
[2025-11-05 07:05:42.698552 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 64, quiet_round: 0, discovered_api_pairs: 1371
[2025-11-05 07:05:42.741776 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:05:42.742133 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char text_buf[] = \"one-two-three\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const int nmatch = 3;\n    cre2_options_t * opt = NULL;\n    cre2_string_t strings[3];\n    cre2_range_t ranges[3];\n    int cs_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int len0 = 0;\n    int len1 = 0;\n    int len2 = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    strings[0].data = text_buf;\n    strings[0].length = 3;\n    strings[1].data = text_buf + 4;\n    strings[1].length = 3;\n    strings[2].data = text_buf + 8;\n    strings[2].length = 5;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    cs_flag = cre2_opt_case_sensitive(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    cre2_strings_to_ranges(text_buf, ranges, strings, nmatch);\n\n    // step 5: Validate\n    len0 = (int)(ranges[0].past - ranges[0].start);\n    len1 = (int)(ranges[1].past - ranges[1].start);\n    len2 = (int)(ranges[2].past - ranges[2].start);\n    computed_check = cs_flag + (int)enc + len0 + len1 + len2 + strings[0].length + strings[1].length + strings[2].length + text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo and foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"bar\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int match_arr[4];\n    size_t match_len = 4;\n    size_t match_count = 0;\n    int rc_replace = 0;\n    int rc_compile = 0;\n    int version_rev = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    /* cre2_set_new expects a cre2_anchor_t for the second parameter;\n       cast 0 to cre2_anchor_t to avoid an int -> enum mismatch. */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n    version_rev = cre2_version_interface_revision();\n\n    // step 4: Operate\n    rc_replace = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    match_count = cre2_set_match(set, text_and_target.data, (size_t)text_and_target.length, match_arr, match_len);\n\n    // step 5: Validate\n    computed_check = rc_replace + rc_compile + (int)match_count + match_arr[0] + match_arr[1] + version_rev + text_and_target.length + rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:06:31.660965 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 48s
[2025-11-05 07:06:31.661092 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30850, Completion: 24192, Total: 55042
[2025-11-05 07:06:31.661112 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:06:31.878887 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000640/id_000640.cc
[2025-11-05 07:06:31.878938 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:32.108365 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:32.108436 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:32.111279 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:32.111311 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:32.329211 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000641/id_000641.cc
[2025-11-05 07:06:32.329262 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:32.560150 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:32.560216 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:32.562942 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:32.562974 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:32.780448 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000642/id_000642.cc
[2025-11-05 07:06:32.780532 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:33.010185 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:33.010243 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:33.013028 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:33.013059 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:33.230143 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000643/id_000643.cc
[2025-11-05 07:06:33.230195 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:33.460382 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:33.460448 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:33.463176 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:33.463208 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:33.681764 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000644/id_000644.cc
[2025-11-05 07:06:33.681816 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:33.910997 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:33.911085 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:33.913982 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:33.914014 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:34.133055 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000645/id_000645.cc
[2025-11-05 07:06:34.133109 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:34.362512 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:34.362571 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:34.365266 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:34.365298 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:34.583687 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000646/id_000646.cc
[2025-11-05 07:06:34.583740 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:34.814373 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:34.814449 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:34.817318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:34.817350 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:35.035355 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000647/id_000647.cc
[2025-11-05 07:06:35.035439 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:35.265486 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:35.265544 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:35.268250 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:35.268282 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:35.486520 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000648/id_000648.cc
[2025-11-05 07:06:35.486584 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:35.716638 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:35.716706 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:35.719531 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:35.719563 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:35.938806 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000649/id_000649.cc
[2025-11-05 07:06:35.938860 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:06:36.167677 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:06:36.167787 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:06:36.170654 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:06:36.170687 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:06:36.170725 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:06:36.170742 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 650, succ: 649, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:06:36.170757 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:06:36.170783 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:06:36.479443 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 649 as an example for the next prompt.
[2025-11-05 07:06:36.479498 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 27 new API pairs in this round.
[2025-11-05 07:06:36.479549 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 27
[2025-11-05 07:06:36.479598 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [41.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,108.0,16.0,11.0,217.0,82.0,27.0,87.0,19.0,149.0,62.0,84.0,59.0,77.0,37.0,19.0,16.0,18.0,13.0,70.0,66.0,16.0,24.0,68.0,166.0,28.0,444.0,76.0,100.0,18.0,25.0,45.0,28.0,219.0,11.0,15.0,72.0,18.0,10.0,53.0,164.0,13.0,16.0,66.0,14.0,26.0,63.0,19.0,141.0,18.0,42.0,21.0,21.0,68.0,11.0,99.0,33.0,32.0,13.0]
[2025-11-05 07:06:36.479616 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:06:36.479668 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 87
[2025-11-05 07:06:36.479700 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 219
[2025-11-05 07:06:36.479738 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 53
[2025-11-05 07:06:36.479765 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 99
[2025-11-05 07:06:36.479803 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 164
[2025-11-05 07:06:36.479840 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_one_line(cre2_options_t * opt),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 07:06:36.480653 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 65, quiet_round: 0, discovered_api_pairs: 1398
[2025-11-05 07:06:36.525418 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:06:36.525767 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo and foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"bar\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int match_arr[4];\n    size_t match_len = 4;\n    size_t match_count = 0;\n    int rc_replace = 0;\n    int rc_compile = 0;\n    int version_rev = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    /* cre2_set_new expects a cre2_anchor_t for the second parameter;\n       cast 0 to cre2_anchor_t to avoid an int -> enum mismatch. */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n    version_rev = cre2_version_interface_revision();\n\n    // step 4: Operate\n    rc_replace = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    match_count = cre2_set_match(set, text_and_target.data, (size_t)text_and_target.length, match_arr, match_len);\n\n    // step 5: Validate\n    computed_check = rc_replace + rc_compile + (int)match_count + match_arr[0] + match_arr[1] + version_rev + text_and_target.length + rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo and foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"bar\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char errmsg_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char * pat_ptr = NULL;\n    int rc_replace = 0;\n    int rc_check = 0;\n    int computed_check = 0;\n    int first_char = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    pat_ptr = cre2_pattern(re);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    rc_replace = cre2_global_replace(pattern, &text_and_target, &rewrite);\n    rc_check = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    first_char = (int)pat_ptr[0];\n    computed_check = rc_replace + rc_check + text_and_target.length + rewrite.length + (int)enc + first_char;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:07:08.143863 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 07:07:08.143989 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31550, Completion: 17297, Total: 48847
[2025-11-05 07:07:08.144010 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:07:08.361566 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000650/id_000650.cc
[2025-11-05 07:07:08.361618 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:08.590745 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:08.590812 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:08.593559 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:08.593592 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:08.811434 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000651/id_000651.cc
[2025-11-05 07:07:08.811486 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:09.040526 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:09.040597 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:09.043205 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:09.043232 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:09.262151 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000652/id_000652.cc
[2025-11-05 07:07:09.262233 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:09.491536 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:09.491641 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:09.494514 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:09.494546 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:09.711731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000653/id_000653.cc
[2025-11-05 07:07:09.711783 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:09.940285 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:09.940352 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:09.943179 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:09.943212 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:10.161377 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000654/id_000654.cc
[2025-11-05 07:07:10.161429 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:10.389317 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:10.389413 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:10.392308 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:10.392335 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:10.610545 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000655/id_000655.cc
[2025-11-05 07:07:10.610596 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:10.840420 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:10.840495 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:10.843151 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:10.843177 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:11.060522 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000656/id_000656.cc
[2025-11-05 07:07:11.060576 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:11.288977 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:11.289053 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:11.291666 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:11.291698 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:11.508721 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000657/id_000657.cc
[2025-11-05 07:07:11.508804 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:11.738292 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:11.738362 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:11.741156 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:11.741188 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:11.958845 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000658/id_000658.cc
[2025-11-05 07:07:11.958898 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:12.187588 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:12.187659 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:12.190493 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:12.190525 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:12.408328 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000659/id_000659.cc
[2025-11-05 07:07:12.408381 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:12.636509 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:12.636615 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:12.639257 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:12.639284 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:12.639322 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:07:12.639338 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 660, succ: 659, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:07:12.639353 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:07:12.639382 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:07:12.916892 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 659 as an example for the next prompt.
[2025-11-05 07:07:12.916947 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 24 new API pairs in this round.
[2025-11-05 07:07:12.916993 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 24
[2025-11-05 07:07:12.917043 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [41.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,108.0,16.0,11.0,217.0,82.0,27.0,95.0,19.0,151.0,62.0,84.0,59.0,82.0,37.0,19.0,16.0,18.0,13.0,70.0,66.0,16.0,24.0,68.0,166.0,28.0,444.0,76.0,109.0,18.0,25.0,45.0,28.0,229.0,11.0,15.0,72.0,18.0,10.0,64.0,175.0,13.0,16.0,68.0,14.0,26.0,66.0,19.0,141.0,18.0,42.0,21.0,21.0,68.0,11.0,110.0,33.0,32.0,13.0]
[2025-11-05 07:07:12.917061 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:07:12.917114 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 229
[2025-11-05 07:07:12.917145 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 76
[2025-11-05 07:07:12.917185 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 166
[2025-11-05 07:07:12.917233 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 108
[2025-11-05 07:07:12.917261 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 66
[2025-11-05 07:07:12.917298 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch)
[2025-11-05 07:07:12.918114 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 66, quiet_round: 0, discovered_api_pairs: 1422
[2025-11-05 07:07:12.970341 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:07:12.970697 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo and foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"bar\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char errmsg_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char * pat_ptr = NULL;\n    int rc_replace = 0;\n    int rc_check = 0;\n    int computed_check = 0;\n    int first_char = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    pat_ptr = cre2_pattern(re);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Operate\n    rc_replace = cre2_global_replace(pattern, &text_and_target, &rewrite);\n    rc_check = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    first_char = (int)pat_ptr[0];\n    computed_check = rc_replace + rc_check + text_and_target.length + rewrite.length + (int)enc + first_char;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t match;\n    int match_arr[4];\n    size_t match_len = 4;\n    size_t match_count = 0;\n    int rc_easy = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int one_line_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n    one_line_flag = cre2_opt_one_line(opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n    match_count = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate\n    computed_check = rc_easy + (int)enc + one_line_flag + (int)match_count + match.length + match_arr[0] + match_arr[1];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:07:47.569042 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 07:07:47.569166 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30580, Completion: 19388, Total: 49968
[2025-11-05 07:07:47.569185 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:07:47.787145 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000660/id_000660.cc
[2025-11-05 07:07:47.787197 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:48.017254 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:48.017325 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:48.020111 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:48.020144 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:48.237922 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000661/id_000661.cc
[2025-11-05 07:07:48.237974 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:48.467285 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:48.467359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:48.470194 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:48.470227 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:48.687853 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000662/id_000662.cc
[2025-11-05 07:07:48.687935 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:48.917279 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:48.917349 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:48.919998 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:48.920033 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:49.137386 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000663/id_000663.cc
[2025-11-05 07:07:49.137446 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:49.366605 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:49.366671 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:49.369574 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:49.369606 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:49.587255 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000664/id_000664.cc
[2025-11-05 07:07:49.587307 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:49.815418 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:49.815527 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:49.818210 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:49.818242 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:50.036090 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000665/id_000665.cc
[2025-11-05 07:07:50.036141 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:50.266595 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:50.266664 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:50.269431 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:50.269462 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:50.488142 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000666/id_000666.cc
[2025-11-05 07:07:50.488194 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:50.718485 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:50.718556 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:50.721462 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:50.721495 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:50.940384 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000667/id_000667.cc
[2025-11-05 07:07:50.940467 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:51.169893 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:51.169963 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:51.172827 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:51.172859 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:51.388878 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000668/id_000668.cc
[2025-11-05 07:07:51.388931 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:51.617412 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:51.617483 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:51.620257 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:51.620289 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:51.838254 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000669/id_000669.cc
[2025-11-05 07:07:51.838306 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:07:52.067391 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:07:52.067503 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:07:52.070456 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:07:52.070488 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:07:52.070526 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:07:52.070542 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 670, succ: 669, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:07:52.070556 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:07:52.070580 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:07:52.355878 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 669 as an example for the next prompt.
[2025-11-05 07:07:52.355933 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 07:07:52.355967 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 07:07:52.356015 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [41.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,116.0,16.0,11.0,218.0,82.0,27.0,95.0,19.0,151.0,62.0,84.0,59.0,82.0,37.0,19.0,16.0,18.0,13.0,70.0,74.0,16.0,24.0,68.0,166.0,28.0,445.0,80.0,109.0,18.0,25.0,45.0,28.0,236.0,11.0,15.0,72.0,18.0,10.0,64.0,175.0,13.0,16.0,68.0,14.0,26.0,66.0,19.0,141.0,18.0,42.0,21.0,21.0,72.0,11.0,110.0,33.0,32.0,13.0]
[2025-11-05 07:07:52.356035 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:07:52.356088 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 62
[2025-11-05 07:07:52.356118 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_dot_nl energy: 32
[2025-11-05 07:07:52.356145 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 141
[2025-11-05 07:07:52.356171 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 41
[2025-11-05 07:07:52.356204 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg)
[2025-11-05 07:07:52.356912 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 67, quiet_round: 0, discovered_api_pairs: 1433
[2025-11-05 07:07:52.392860 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:07:52.393202 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t match;\n    int match_arr[4];\n    size_t match_len = 4;\n    size_t match_count = 0;\n    int rc_easy = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int one_line_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n    one_line_flag = cre2_opt_one_line(opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n    match_count = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate\n    computed_check = rc_easy + (int)enc + one_line_flag + (int)match_count + match.length + match_arr[0] + match_arr[1];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[5];\n    cre2_range_t ranges[5];\n    int rc_easy = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 5);\n    cre2_strings_to_ranges(text_buf, ranges, matches, 5);\n\n    // step 5: Validate\n    computed_check = rc_easy + num_groups + matches[0].length + (int)ranges[0].start + (int)ranges[0].past;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:08:27.253861 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 07:08:27.253986 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28520, Completion: 20037, Total: 48557
[2025-11-05 07:08:27.254008 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:08:27.473155 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000670/id_000670.cc
[2025-11-05 07:08:27.473207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:27.702122 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:27.702189 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:27.705048 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:27.705081 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:27.923917 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000671/id_000671.cc
[2025-11-05 07:08:27.923971 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:28.153434 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:28.153510 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:28.156021 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:28.156054 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:28.373759 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000672/id_000672.cc
[2025-11-05 07:08:28.373840 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:28.602701 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:28.602779 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:28.605645 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:28.605677 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:28.823996 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000673/id_000673.cc
[2025-11-05 07:08:28.824050 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:29.053117 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:29.053186 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:29.055643 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:29.055676 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:29.274819 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000674/id_000674.cc
[2025-11-05 07:08:29.274872 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:29.504844 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:29.504946 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:29.507799 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:29.507832 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:29.725833 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000675/id_000675.cc
[2025-11-05 07:08:29.725895 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:29.954087 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:29.954162 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:29.956916 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:29.956949 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:30.174908 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000676/id_000676.cc
[2025-11-05 07:08:30.174962 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:30.403962 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:30.404028 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:30.406820 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:30.406852 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:30.624107 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000677/id_000677.cc
[2025-11-05 07:08:30.624190 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:30.852758 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:30.852827 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:30.855468 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:30.855502 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:31.072678 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000678/id_000678.cc
[2025-11-05 07:08:31.072732 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:31.303667 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:31.303734 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:31.306467 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:31.306500 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:31.524400 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000679/id_000679.cc
[2025-11-05 07:08:31.524455 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:31.755385 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:31.755498 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:31.758235 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:31.758264 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:31.758301 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:08:31.758317 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 680, succ: 679, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:08:31.758333 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:08:31.758359 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:08:32.040638 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 679 as an example for the next prompt.
[2025-11-05 07:08:32.040704 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 07:08:32.040737 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 07:08:32.040798 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,118.0,16.0,11.0,222.0,82.0,27.0,95.0,19.0,151.0,62.0,84.0,59.0,82.0,37.0,19.0,16.0,18.0,13.0,70.0,74.0,16.0,24.0,68.0,166.0,28.0,449.0,80.0,109.0,18.0,25.0,45.0,28.0,236.0,11.0,15.0,72.0,18.0,10.0,64.0,175.0,13.0,16.0,68.0,14.0,26.0,66.0,19.0,148.0,18.0,42.0,21.0,21.0,72.0,11.0,110.0,35.0,34.0,13.0]
[2025-11-05 07:08:32.040821 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:08:32.040883 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 110
[2025-11-05 07:08:32.040927 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 148
[2025-11-05 07:08:32.040964 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 80
[2025-11-05 07:08:32.040995 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_never_nl energy: 18
[2025-11-05 07:08:32.041039 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_add_simple(cre2_set * set, const char * pattern),
    const char *cre2_pattern(const cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag)
[2025-11-05 07:08:32.041757 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 68, quiet_round: 0, discovered_api_pairs: 1443
[2025-11-05 07:08:32.076340 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:08:32.076710 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_add_simple(cre2_set * set, const char * pattern),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[5];\n    cre2_range_t ranges[5];\n    int rc_easy = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    memset(ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate\n    rc_easy = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 5);\n    cre2_strings_to_ranges(text_buf, ranges, matches, 5);\n\n    // step 5: Validate\n    computed_check = rc_easy + num_groups + matches[0].length + (int)ranges[0].start + (int)ranges[0].past;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char rewrite_buf[] = \"\\\\1-\\\\2\";\n    char errmsg_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    const char * got_pattern = NULL;\n    int rc_check = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    errmsg.data = errmsg_buf;\n    errmsg.length = (int)sizeof(errmsg_buf);\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_dot_nl(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    rc_check = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    computed_check = rc_check + rewrite.length + errmsg.length + pattern_len + (int)(got_pattern ? got_pattern[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:08:59.065528 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 07:08:59.065649 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28150, Completion: 21198, Total: 49348
[2025-11-05 07:08:59.065669 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:08:59.284786 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000680/id_000680.cc
[2025-11-05 07:08:59.284838 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:59.514088 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:59.514146 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:59.516895 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:59.516927 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:08:59.732897 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000681/id_000681.cc
[2025-11-05 07:08:59.732948 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:08:59.962042 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:08:59.962114 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:08:59.964832 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:08:59.964866 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:00.182839 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000682/id_000682.cc
[2025-11-05 07:09:00.182923 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:00.411156 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:00.411214 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:00.414068 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:00.414102 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:00.631293 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000683/id_000683.cc
[2025-11-05 07:09:00.631346 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:00.859355 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:00.859413 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:00.862058 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:00.862091 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:01.079670 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000684/id_000684.cc
[2025-11-05 07:09:01.079723 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:01.309062 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:01.309168 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:01.311651 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:01.311682 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:01.530237 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000685/id_000685.cc
[2025-11-05 07:09:01.530291 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:01.759485 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:01.759543 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:01.762182 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:01.762216 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:01.980001 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000686/id_000686.cc
[2025-11-05 07:09:01.980056 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:02.209605 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:02.209676 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:02.212544 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:02.212578 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:02.433036 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000687/id_000687.cc
[2025-11-05 07:09:02.433123 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:02.662276 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:02.662377 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:02.665103 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:02.665134 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:02.883485 +00:00] WARN [src/fuzzer.rs:205] Program 688 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000688/id_000688.cc:34:11: error: no matching function for call to 'cre2_set_new'
   34 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:09:02.918138 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:09:02.918462 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * got_pattern = NULL;\n    int rc_add = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, 0);\n    rc_add = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    got_pattern = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate\n    num_groups = cre2_num_capturing_groups(re);\n    computed_check = rc_add + num_groups + (int)(got_pattern ? got_pattern[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000688/id_000688.cc:34:11: error: no matching function for call to 'cre2_set_new'\n   34 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:09:28.191622 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 25s
[2025-11-05 07:09:28.191751 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21420, Completion: 8559, Total: 29979
[2025-11-05 07:09:28.409574 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000688/id_000688.cc
[2025-11-05 07:09:28.409634 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:28.638516 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:28.638584 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:28.641455 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:28.641484 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:28.641520 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 688!
[2025-11-05 07:09:28.861453 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000689/id_000689.cc
[2025-11-05 07:09:28.861517 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:09:29.095454 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:09:29.095526 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:09:29.098208 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:09:29.098234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:09:29.098271 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:09:29.098290 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 690, succ: 689, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:09:29.098304 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:09:29.098331 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:09:29.382108 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 689 as an example for the next prompt.
[2025-11-05 07:09:29.382191 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 36 new API pairs in this round.
[2025-11-05 07:09:29.382248 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 36
[2025-11-05 07:09:29.382296 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,126.0,16.0,11.0,224.0,82.0,27.0,95.0,19.0,153.0,62.0,84.0,59.0,84.0,37.0,19.0,16.0,18.0,13.0,78.0,74.0,16.0,24.0,68.0,166.0,28.0,460.0,92.0,119.0,18.0,25.0,45.0,28.0,237.0,11.0,15.0,72.0,18.0,10.0,64.0,175.0,13.0,16.0,78.0,14.0,26.0,66.0,19.0,167.0,25.0,42.0,21.0,21.0,78.0,11.0,120.0,35.0,34.0,13.0]
[2025-11-05 07:09:29.382315 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:09:29.382396 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 153
[2025-11-05 07:09:29.382429 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 126
[2025-11-05 07:09:29.382455 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 167
[2025-11-05 07:09:29.382482 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 224
[2025-11-05 07:09:29.382516 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 07:09:29.383220 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 69, quiet_round: 0, discovered_api_pairs: 1479
[2025-11-05 07:09:29.408848 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:09:29.409186 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char rewrite_buf[] = \"\\\\1-\\\\2\";\n    char errmsg_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    const char * got_pattern = NULL;\n    int rc_check = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    errmsg.data = errmsg_buf;\n    errmsg.length = (int)sizeof(errmsg_buf);\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_dot_nl(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    rc_check = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    computed_check = rc_check + rewrite.length + errmsg.length + pattern_len + (int)(got_pattern ? got_pattern[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_set * set = NULL;\n    int matches[8];\n    const char * got_pattern = NULL;\n    int rc_add = 0;\n    int rc_compile = 0;\n    size_t set_matches = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, matches, (size_t)(sizeof(matches)/sizeof(matches[0])));\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    computed_check = (int)set_matches + rc_add + rc_compile + num_groups + (int)(got_pattern ? got_pattern[0] : 0) + matches[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:09:59.617641 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 07:09:59.617768 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28500, Completion: 16092, Total: 44592
[2025-11-05 07:09:59.617790 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:09:59.838927 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000690/id_000690.cc
[2025-11-05 07:09:59.838981 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:00.067666 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:00.067742 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:00.070556 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:00.070588 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:00.289052 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000691/id_000691.cc
[2025-11-05 07:10:00.289113 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:00.517620 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:00.517696 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:00.520123 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:00.520149 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:00.741712 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000692/id_000692.cc
[2025-11-05 07:10:00.741796 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:00.969543 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:00.969614 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:00.972408 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:00.972441 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:01.189424 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000693/id_000693.cc
[2025-11-05 07:10:01.189477 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:01.420724 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:01.420789 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:01.423442 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:01.423467 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:01.645395 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000694/id_000694.cc
[2025-11-05 07:10:01.645450 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:01.877248 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:01.877357 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:01.879795 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:01.879840 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:02.100656 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000695/id_000695.cc
[2025-11-05 07:10:02.100714 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:02.331304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:02.331374 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:02.333945 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:02.333973 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:02.550466 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000696/id_000696.cc
[2025-11-05 07:10:02.550520 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:02.778687 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:02.778745 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:02.781358 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:02.781391 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:02.998273 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000697/id_000697.cc
[2025-11-05 07:10:02.998357 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:03.226239 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:03.226305 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:03.228798 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:03.228827 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:03.446065 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000698/id_000698.cc
[2025-11-05 07:10:03.446119 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:03.675068 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:03.675124 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:03.677713 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:03.677744 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:03.895458 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000699/id_000699.cc
[2025-11-05 07:10:03.895512 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:04.122915 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:04.123009 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:04.125621 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:04.125652 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:04.125690 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:10:04.125707 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 700, succ: 699, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:10:04.125727 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:10:04.125783 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:10:04.392483 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 699 as an example for the next prompt.
[2025-11-05 07:10:04.392537 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 07:10:04.392569 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 07:10:04.392638 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,129.0,16.0,11.0,227.0,82.0,27.0,95.0,19.0,156.0,64.0,84.0,59.0,84.0,37.0,19.0,16.0,18.0,13.0,78.0,74.0,16.0,24.0,69.0,168.0,28.0,464.0,92.0,119.0,18.0,28.0,45.0,28.0,237.0,11.0,15.0,72.0,18.0,10.0,64.0,175.0,13.0,16.0,78.0,14.0,26.0,67.0,19.0,171.0,25.0,42.0,21.0,21.0,78.0,11.0,120.0,35.0,38.0,13.0]
[2025-11-05 07:10:04.392658 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:10:04.392717 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 120
[2025-11-05 07:10:04.392754 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 227
[2025-11-05 07:10:04.392785 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 95
[2025-11-05 07:10:04.392812 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 156
[2025-11-05 07:10:04.392845 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    cre2_options_t *cre2_opt_new()
[2025-11-05 07:10:04.393563 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 70, quiet_round: 0, discovered_api_pairs: 1489
[2025-11-05 07:10:04.424023 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:10:04.424378 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_add_simple(cre2_set * set, const char * pattern),\n    void cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    cre2_options_t *cre2_opt_new()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_set * set = NULL;\n    int matches[8];\n    const char * got_pattern = NULL;\n    int rc_add = 0;\n    int rc_compile = 0;\n    size_t set_matches = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, matches, (size_t)(sizeof(matches)/sizeof(matches[0])));\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    computed_check = (int)set_matches + rc_add + rc_compile + num_groups + (int)(got_pattern ? got_pattern[0] : 0) + matches[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * got_pattern = NULL;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    computed_check = num_groups + pattern_len + (int)(got_pattern ? got_pattern[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:10:33.938722 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 07:10:33.938843 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27090, Completion: 16294, Total: 43384
[2025-11-05 07:10:33.938867 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:10:34.160790 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000700/id_000700.cc
[2025-11-05 07:10:34.160844 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:34.390146 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:34.390213 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:34.392975 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:34.393002 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:34.611055 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000701/id_000701.cc
[2025-11-05 07:10:34.611108 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:34.839096 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:34.839170 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:34.842174 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:34.842231 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:35.064655 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000702/id_000702.cc
[2025-11-05 07:10:35.064738 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:35.296946 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:35.297022 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:35.299677 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:35.299709 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:35.521112 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000703/id_000703.cc
[2025-11-05 07:10:35.521166 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:35.753728 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:35.753787 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:35.756610 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:35.756650 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:35.979974 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000704/id_000704.cc
[2025-11-05 07:10:35.980032 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:36.212764 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:36.212865 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:36.215325 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:36.215358 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:36.436822 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000705/id_000705.cc
[2025-11-05 07:10:36.436886 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:36.666390 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:36.666459 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:36.668951 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:36.668982 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:36.889700 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000706/id_000706.cc
[2025-11-05 07:10:36.889760 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:37.122469 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:37.122548 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:37.125093 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:37.125120 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:37.342588 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000707/id_000707.cc
[2025-11-05 07:10:37.342673 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:37.573667 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:37.573725 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:37.576466 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:37.576511 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:37.796647 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000708/id_000708.cc
[2025-11-05 07:10:37.796702 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:38.029584 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:38.029648 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:38.032350 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:38.032377 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:38.250008 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000709/id_000709.cc
[2025-11-05 07:10:38.250061 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:10:38.484898 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:10:38.485001 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:10:38.487509 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:10:38.487541 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:10:38.487578 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:10:38.487593 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 710, succ: 709, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:10:38.487607 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:10:38.487631 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:10:38.770919 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 709 as an example for the next prompt.
[2025-11-05 07:10:38.770976 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 07:10:38.771006 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 07:10:38.771054 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,136.0,16.0,11.0,230.0,82.0,27.0,96.0,19.0,156.0,64.0,84.0,59.0,85.0,37.0,19.0,16.0,18.0,13.0,81.0,74.0,16.0,24.0,69.0,168.0,28.0,465.0,92.0,120.0,18.0,28.0,45.0,28.0,237.0,11.0,15.0,72.0,18.0,10.0,64.0,175.0,13.0,16.0,81.0,14.0,26.0,67.0,19.0,173.0,25.0,42.0,21.0,21.0,78.0,11.0,122.0,35.0,38.0,13.0]
[2025-11-05 07:10:38.771073 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:10:38.771126 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 168
[2025-11-05 07:10:38.771156 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 237
[2025-11-05 07:10:38.771182 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 173
[2025-11-05 07:10:38.771209 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 230
[2025-11-05 07:10:38.771242 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 07:10:38.771944 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 71, quiet_round: 0, discovered_api_pairs: 1497
[2025-11-05 07:10:38.811893 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:10:38.812242 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * got_pattern = NULL;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    computed_check = num_groups + pattern_len + (int)(got_pattern ? got_pattern[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int matches[8];\n    const char * got_pattern = NULL;\n    int rc_add = 0;\n    int rc_compile = 0;\n    size_t set_matches = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    rc_compile = cre2_set_compile(set);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, matches, (size_t)(sizeof(matches)/sizeof(matches[0])));\n    got_pattern = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    computed_check = rc_add + rc_compile + (int)set_matches + num_groups + matches[0] + (int)(got_pattern ? got_pattern[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:12:04.440730 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 85s
[2025-11-05 07:12:04.440851 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27070, Completion: 18396, Total: 45466
[2025-11-05 07:12:04.440872 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:12:04.660984 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000710/id_000710.cc
[2025-11-05 07:12:04.661036 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:04.891847 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:04.891919 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:04.894572 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:04.894598 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:05.112169 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000711/id_000711.cc
[2025-11-05 07:12:05.112223 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:05.343679 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:05.343749 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:05.346492 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:05.346524 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:05.567018 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000712/id_000712.cc
[2025-11-05 07:12:05.567102 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:05.798409 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:05.798467 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:05.801211 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:05.801239 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:06.019027 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000713/id_000713.cc
[2025-11-05 07:12:06.019082 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:06.249832 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:06.249899 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:06.252725 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:06.252751 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:06.473716 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000714/id_000714.cc
[2025-11-05 07:12:06.473768 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:06.704808 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:06.704904 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:06.707455 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:06.707488 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:06.929135 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000715/id_000715.cc
[2025-11-05 07:12:06.929190 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:07.161698 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:07.161768 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:07.164648 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:07.164681 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:07.386218 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000716/id_000716.cc
[2025-11-05 07:12:07.386278 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:07.616872 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:07.616932 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:07.619530 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:07.619556 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:07.838036 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000717/id_000717.cc
[2025-11-05 07:12:07.838122 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:08.069015 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:08.069082 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:08.071846 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:08.071879 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:08.291630 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000718/id_000718.cc
[2025-11-05 07:12:08.291684 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:08.523060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:08.523126 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:08.526009 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:08.526045 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:08.746370 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000719/id_000719.cc
[2025-11-05 07:12:08.746431 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:08.976177 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:08.976275 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:08.979040 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:08.979071 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:08.979109 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:12:08.979124 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 720, succ: 719, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:12:08.979139 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:12:08.979185 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:12:09.257711 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 719 as an example for the next prompt.
[2025-11-05 07:12:09.257765 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 4 new API pairs in this round.
[2025-11-05 07:12:09.257791 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 4
[2025-11-05 07:12:09.257839 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,136.0,16.0,11.0,231.0,82.0,27.0,96.0,19.0,156.0,64.0,84.0,59.0,85.0,37.0,19.0,16.0,18.0,13.0,81.0,74.0,16.0,24.0,69.0,168.0,28.0,466.0,92.0,120.0,18.0,28.0,45.0,28.0,240.0,11.0,15.0,72.0,18.0,10.0,64.0,175.0,13.0,16.0,81.0,14.0,26.0,67.0,19.0,176.0,25.0,42.0,21.0,21.0,78.0,11.0,122.0,35.0,38.0,13.0]
[2025-11-05 07:12:09.257858 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:12:09.257910 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 59
[2025-11-05 07:12:09.257941 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 19
[2025-11-05 07:12:09.257969 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 175
[2025-11-05 07:12:09.257996 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 231
[2025-11-05 07:12:09.258024 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 81
[2025-11-05 07:12:09.258060 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_set_compile(cre2_set * set)
[2025-11-05 07:12:09.258879 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 72, quiet_round: 0, discovered_api_pairs: 1501
[2025-11-05 07:12:09.302613 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:12:09.302968 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_set_compile(cre2_set * set)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int matches[8];\n    const char * got_pattern = NULL;\n    int rc_add = 0;\n    int rc_compile = 0;\n    size_t set_matches = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    rc_compile = cre2_set_compile(set);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, matches, (size_t)(sizeof(matches)/sizeof(matches[0])));\n    got_pattern = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    computed_check = rc_add + rc_compile + (int)set_matches + num_groups + matches[0] + (int)(got_pattern ? got_pattern[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * got_pattern = NULL;\n    cre2_string_t match;\n    int rc_easy = 0;\n    int case_flag = 1;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    match.data = NULL;\n    match.length = 0;\n    rc_easy = cre2_easy_match(got_pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 5: Validate\n    computed_check = rc_easy + pattern_len + (int)(got_pattern ? got_pattern[0] : 0) + match.length + case_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:12:52.012033 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 07:12:52.012154 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28540, Completion: 24802, Total: 53342
[2025-11-05 07:12:52.012173 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:12:52.231873 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000720/id_000720.cc
[2025-11-05 07:12:52.231927 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:52.461784 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:52.461858 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:52.464718 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:52.464770 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:52.684217 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000721/id_000721.cc
[2025-11-05 07:12:52.684270 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:52.913110 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:52.913168 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:52.915773 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:52.915804 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:53.133503 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000722/id_000722.cc
[2025-11-05 07:12:53.133587 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:53.367019 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:53.367093 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:53.369621 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:53.369654 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:53.587549 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000723/id_000723.cc
[2025-11-05 07:12:53.587601 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:53.817594 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:53.817670 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:53.820245 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:53.820278 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:54.036683 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000724/id_000724.cc
[2025-11-05 07:12:54.036737 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:54.266377 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:54.266489 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:54.269288 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:54.269313 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:54.486330 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000725/id_000725.cc
[2025-11-05 07:12:54.486384 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:54.715794 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:54.715867 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:54.718830 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:54.718861 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:54.935505 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000726/id_000726.cc
[2025-11-05 07:12:54.935560 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:55.164565 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:55.164654 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:55.167295 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:55.167326 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:55.384539 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000727/id_000727.cc
[2025-11-05 07:12:55.384628 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:55.613455 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:55.613527 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:55.616467 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:55.616498 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:55.833310 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000728/id_000728.cc
[2025-11-05 07:12:55.833365 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:56.062780 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:56.062849 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:56.065804 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:56.065833 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:56.283379 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000729/id_000729.cc
[2025-11-05 07:12:56.283434 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:12:56.511878 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:12:56.511990 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:12:56.514876 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:12:56.514907 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:12:56.514946 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:12:56.514961 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 730, succ: 729, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:12:56.514976 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:12:56.515000 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:12:56.827890 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 729 as an example for the next prompt.
[2025-11-05 07:12:56.827947 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 07:12:56.827987 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 07:12:56.828034 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,69.0,104.0,28.0,24.0,68.0,24.0,29.0,136.0,16.0,11.0,238.0,82.0,27.0,97.0,19.0,156.0,64.0,84.0,69.0,88.0,37.0,31.0,16.0,18.0,13.0,89.0,74.0,16.0,24.0,69.0,168.0,28.0,469.0,92.0,120.0,18.0,28.0,45.0,28.0,240.0,11.0,15.0,72.0,18.0,10.0,64.0,179.0,13.0,16.0,81.0,14.0,26.0,67.0,19.0,176.0,25.0,42.0,21.0,21.0,78.0,11.0,125.0,35.0,38.0,13.0]
[2025-11-05 07:12:56.828051 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:12:56.828103 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 82
[2025-11-05 07:12:56.828134 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 78
[2025-11-05 07:12:56.828173 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 81
[2025-11-05 07:12:56.828200 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 136
[2025-11-05 07:12:56.828227 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 179
[2025-11-05 07:12:56.828265 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 07:12:56.829099 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 73, quiet_round: 0, discovered_api_pairs: 1521
[2025-11-05 07:12:56.891340 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:12:56.891778 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * got_pattern = NULL;\n    cre2_string_t match;\n    int rc_easy = 0;\n    int case_flag = 1;\n    int computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    got_pattern = cre2_pattern(re);\n    match.data = NULL;\n    match.length = 0;\n    rc_easy = cre2_easy_match(got_pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 5: Validate\n    computed_check = rc_easy + pattern_len + (int)(got_pattern ? got_pattern[0] : 0) + match.length + case_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"REPLACED\";\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    int rc_add = 0;\n    int rc_compile = 0;\n    int rc_extract = 0;\n    int rc_replace = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n\n    // step 4: Operate\n    memcpy(text_and_target_buf, text_buf, (size_t)text_len);\n    text.data = text_buf;\n    text.length = text_len;\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = (int)strlen(text_and_target_buf);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    target.data = target_buf;\n    target.length = 0;\n    rc_extract = cre2_extract_re(re, &text, &rewrite, &target);\n    rc_replace = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate\n    computed_check = rc_add + rc_compile + rc_extract + rc_replace + (int)enc + text.length + rewrite.length + (int)text_and_target.length + (int)target.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:13:38.497038 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 07:13:38.497153 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30640, Completion: 23845, Total: 54485
[2025-11-05 07:13:38.497173 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:13:38.715547 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000730/id_000730.cc
[2025-11-05 07:13:38.715600 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:38.944380 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:38.944446 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:38.947219 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:38.947246 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:39.164316 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000731/id_000731.cc
[2025-11-05 07:13:39.164370 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:39.395017 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:39.395084 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:39.397906 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:39.397939 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:39.617189 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000732/id_000732.cc
[2025-11-05 07:13:39.617272 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:39.847392 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:39.847448 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:39.850348 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:39.850381 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:40.068708 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000733/id_000733.cc
[2025-11-05 07:13:40.068761 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:40.298142 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:40.298211 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:40.301085 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:40.301116 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:40.519482 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000734/id_000734.cc
[2025-11-05 07:13:40.519536 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:40.748703 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:40.748803 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:40.751350 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:40.751384 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:40.969142 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000735/id_000735.cc
[2025-11-05 07:13:40.969196 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:41.198286 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:41.198343 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:41.201263 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:41.201296 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:41.418708 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000736/id_000736.cc
[2025-11-05 07:13:41.418763 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:41.646908 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:41.646965 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:41.649833 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:41.649866 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:41.866633 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000737/id_000737.cc
[2025-11-05 07:13:41.866718 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:42.098464 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:42.098556 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:42.101425 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:42.101457 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:42.319760 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000738/id_000738.cc
[2025-11-05 07:13:42.319812 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:42.548830 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:42.548887 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:42.551490 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:42.551523 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:42.770950 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000739/id_000739.cc
[2025-11-05 07:13:42.771004 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:13:43.002255 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:13:43.002353 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:13:43.005231 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:13:43.005263 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:13:43.005301 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:13:43.005318 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 740, succ: 739, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:13:43.005334 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:13:43.005360 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:13:43.307341 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 739 as an example for the next prompt.
[2025-11-05 07:13:43.307398 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 43 new API pairs in this round.
[2025-11-05 07:13:43.307462 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 43
[2025-11-05 07:13:43.307511 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,69.0,106.0,28.0,24.0,68.0,24.0,29.0,153.0,16.0,11.0,242.0,98.0,27.0,97.0,19.0,157.0,64.0,84.0,69.0,90.0,39.0,31.0,16.0,18.0,13.0,93.0,74.0,16.0,24.0,69.0,168.0,28.0,473.0,104.0,123.0,18.0,28.0,45.0,28.0,240.0,11.0,15.0,72.0,18.0,10.0,64.0,192.0,13.0,16.0,96.0,14.0,26.0,68.0,19.0,176.0,25.0,42.0,21.0,21.0,88.0,11.0,126.0,35.0,38.0,13.0]
[2025-11-05 07:13:43.307529 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:13:43.307581 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 126
[2025-11-05 07:13:43.307614 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 69
[2025-11-05 07:13:43.307643 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 242
[2025-11-05 07:13:43.307671 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 106
[2025-11-05 07:13:43.307697 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 104
[2025-11-05 07:13:43.307735 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)
[2025-11-05 07:13:43.308556 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 74, quiet_round: 0, discovered_api_pairs: 1564
[2025-11-05 07:13:43.353311 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:13:43.353679 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"REPLACED\";\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    int rc_add = 0;\n    int rc_compile = 0;\n    int rc_extract = 0;\n    int rc_replace = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n\n    // step 4: Operate\n    memcpy(text_and_target_buf, text_buf, (size_t)text_len);\n    text.data = text_buf;\n    text.length = text_len;\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = (int)strlen(text_and_target_buf);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    target.data = target_buf;\n    target.length = 0;\n    rc_extract = cre2_extract_re(re, &text, &rewrite, &target);\n    rc_replace = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate\n    computed_check = rc_add + rc_compile + rc_extract + rc_replace + (int)enc + text.length + rewrite.length + (int)text_and_target.length + (int)target.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[8];\n    const int MAX_NMATCH = 8;\n    int rc_match = 0;\n    size_t set_matches = 0;\n    int match_indices[16];\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    matches[0].data = NULL; matches[0].length = 0;\n    matches[1].data = NULL; matches[1].length = 0;\n    matches[2].data = NULL; matches[2].length = 0;\n    matches[3].data = NULL; matches[3].length = 0;\n    matches[4].data = NULL; matches[4].length = 0;\n    matches[5].data = NULL; matches[5].length = 0;\n    matches[6].data = NULL; matches[6].length = 0;\n    matches[7].data = NULL; matches[7].length = 0;\n\n    memset(match_indices, 0, sizeof(match_indices));\n    rc_match = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, MAX_NMATCH);\n\n    // step 4: Validate\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_indices, sizeof(match_indices) / sizeof(match_indices[0]));\n    enc = cre2_opt_encoding(opt);\n    computed_check = rc_match + num_groups + (int)enc + (int)set_matches + matches[0].length + matches[1].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:14:28.492739 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 07:14:28.492847 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33070, Completion: 24603, Total: 57673
[2025-11-05 07:14:28.492867 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:14:28.711291 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000740/id_000740.cc
[2025-11-05 07:14:28.711344 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:28.940769 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:28.940841 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:28.943391 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:28.943423 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:29.161236 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000741/id_000741.cc
[2025-11-05 07:14:29.161290 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:29.390524 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:29.390583 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:29.393446 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:29.393478 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:29.612930 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000742/id_000742.cc
[2025-11-05 07:14:29.613016 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:29.841408 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:29.841481 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:29.844316 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:29.844342 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:30.062134 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000743/id_000743.cc
[2025-11-05 07:14:30.062189 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:30.292191 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:30.292266 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:30.295053 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:30.295086 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:30.513229 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000744/id_000744.cc
[2025-11-05 07:14:30.513282 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:30.744170 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:30.744259 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:30.747112 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:30.747141 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:30.965313 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000745/id_000745.cc
[2025-11-05 07:14:30.965367 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:31.195096 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:31.195163 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:31.197971 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:31.198004 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:31.414962 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000746/id_000746.cc
[2025-11-05 07:14:31.415016 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:31.644395 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:31.644465 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:31.647336 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:31.647369 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:31.865487 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000747/id_000747.cc
[2025-11-05 07:14:31.865581 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:32.094629 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:32.094687 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:32.097529 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:32.097562 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:32.315932 +00:00] WARN [src/fuzzer.rs:205] Program 748 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000748/id_000748.cc:44:11: error: no matching function for call to 'cre2_set_new'
   44 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:14:32.360749 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:14:32.361085 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"REPLACED\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int rc_add = 0;\n    int rc_compile = 0;\n    int rc_replace = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memcpy(text_and_target_buf, text_buf, (size_t)text_len);\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    rc_add = cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n\n    // step 4: Operate\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    rc_replace = cre2_replace_re(re, &text_and_target, &rewrite);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate\n    enc = cre2_opt_encoding(opt);\n    computed_check = rc_add + rc_compile + rc_replace + (int)text_and_target.length + (int)rewrite.length + (int)enc;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000748/id_000748.cc:44:11: error: no matching function for call to 'cre2_set_new'\n   44 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:14:48.966395 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 16s
[2025-11-05 07:14:48.966521 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23560, Completion: 11110, Total: 34670
[2025-11-05 07:14:49.186135 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000748/id_000748.cc
[2025-11-05 07:14:49.186189 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:49.416335 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:49.416405 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:49.419289 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:49.419322 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:49.419355 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 748!
[2025-11-05 07:14:49.637759 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000749/id_000749.cc
[2025-11-05 07:14:49.637810 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:14:49.868612 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:14:49.868852 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:14:49.871589 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:14:49.871623 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:14:49.871666 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:14:49.871684 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 750, succ: 749, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:14:49.871700 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:14:49.871727 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:14:50.173528 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 749 as an example for the next prompt.
[2025-11-05 07:14:50.173618 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 33 new API pairs in this round.
[2025-11-05 07:14:50.173688 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 33
[2025-11-05 07:14:50.173743 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,24.0,90.0,106.0,28.0,24.0,68.0,24.0,29.0,157.0,16.0,11.0,243.0,98.0,27.0,97.0,19.0,157.0,64.0,84.0,69.0,90.0,39.0,31.0,16.0,18.0,13.0,100.0,74.0,16.0,24.0,69.0,168.0,28.0,473.0,120.0,126.0,18.0,28.0,45.0,28.0,240.0,11.0,15.0,72.0,18.0,10.0,64.0,197.0,13.0,16.0,98.0,14.0,26.0,68.0,19.0,176.0,25.0,42.0,21.0,21.0,95.0,11.0,134.0,35.0,38.0,13.0]
[2025-11-05 07:14:50.173766 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:14:50.173856 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 243
[2025-11-05 07:14:50.173896 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 473
[2025-11-05 07:14:50.173932 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 176
[2025-11-05 07:14:50.173964 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 24
[2025-11-05 07:14:50.174017 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:14:50.174739 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 75, quiet_round: 0, discovered_api_pairs: 1597
[2025-11-05 07:14:50.212910 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:14:50.213299 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[8];\n    const int MAX_NMATCH = 8;\n    int rc_match = 0;\n    size_t set_matches = 0;\n    int match_indices[16];\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    matches[0].data = NULL; matches[0].length = 0;\n    matches[1].data = NULL; matches[1].length = 0;\n    matches[2].data = NULL; matches[2].length = 0;\n    matches[3].data = NULL; matches[3].length = 0;\n    matches[4].data = NULL; matches[4].length = 0;\n    matches[5].data = NULL; matches[5].length = 0;\n    matches[6].data = NULL; matches[6].length = 0;\n    matches[7].data = NULL; matches[7].length = 0;\n\n    memset(match_indices, 0, sizeof(match_indices));\n    rc_match = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, MAX_NMATCH);\n\n    // step 4: Validate\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_indices, sizeof(match_indices) / sizeof(match_indices[0]));\n    enc = cre2_opt_encoding(opt);\n    computed_check = rc_match + num_groups + (int)enc + (int)set_matches + matches[0].length + matches[1].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"REPLACED\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int rc_add = 0;\n    int rc_compile = 0;\n    int rc_replace = 0;\n    int num_groups = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memcpy(text_and_target_buf, text_buf, (size_t)text_len);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = (int)strlen(text_and_target_buf);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    rc_replace = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    enc = cre2_opt_encoding(opt);\n    computed_check = rc_add + rc_compile + rc_replace + num_groups + (int)enc + text_and_target.length + rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:15:27.958578 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 07:15:27.958704 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32140, Completion: 20586, Total: 52726
[2025-11-05 07:15:27.958727 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:15:28.174863 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000750/id_000750.cc
[2025-11-05 07:15:28.174917 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:28.402479 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:28.402536 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:28.405361 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:28.405394 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:28.622963 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000751/id_000751.cc
[2025-11-05 07:15:28.623017 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:28.850897 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:28.850955 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:28.853743 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:28.853786 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:29.071370 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000752/id_000752.cc
[2025-11-05 07:15:29.071454 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:29.300702 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:29.300773 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:29.303332 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:29.303365 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:29.522225 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000753/id_000753.cc
[2025-11-05 07:15:29.522278 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:29.751353 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:29.751411 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:29.754268 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:29.754300 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:29.973111 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000754/id_000754.cc
[2025-11-05 07:15:29.973164 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:30.207705 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:30.207811 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:30.210616 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:30.210648 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:30.429263 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000755/id_000755.cc
[2025-11-05 07:15:30.429317 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:30.658616 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:30.658671 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:30.661505 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:30.661539 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:30.879842 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000756/id_000756.cc
[2025-11-05 07:15:30.879896 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:31.108221 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:31.108293 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:31.111166 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:31.111199 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:31.328593 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000757/id_000757.cc
[2025-11-05 07:15:31.328694 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:31.559829 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:31.559902 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:31.562786 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:31.562820 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:31.783188 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000758/id_000758.cc
[2025-11-05 07:15:31.783243 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:32.013954 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:32.014023 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:32.016908 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:32.016940 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:32.234611 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000759/id_000759.cc
[2025-11-05 07:15:32.234666 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:15:32.463240 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:15:32.463353 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:15:32.466191 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:15:32.466222 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:15:32.466261 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:15:32.466277 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 760, succ: 759, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:15:32.466292 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:15:32.466317 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:15:32.740873 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 759 as an example for the next prompt.
[2025-11-05 07:15:32.740930 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 07:15:32.740964 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 07:15:32.741013 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,35.0,90.0,106.0,28.0,24.0,68.0,24.0,29.0,157.0,16.0,11.0,248.0,98.0,27.0,97.0,19.0,157.0,64.0,84.0,69.0,90.0,39.0,31.0,16.0,18.0,13.0,100.0,74.0,16.0,24.0,69.0,168.0,28.0,478.0,120.0,126.0,18.0,28.0,45.0,28.0,240.0,11.0,15.0,72.0,18.0,10.0,64.0,197.0,13.0,16.0,98.0,14.0,26.0,69.0,19.0,184.0,25.0,42.0,21.0,21.0,95.0,11.0,134.0,35.0,38.0,13.0]
[2025-11-05 07:15:32.741031 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:15:32.741084 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 126
[2025-11-05 07:15:32.741117 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 157
[2025-11-05 07:15:32.741146 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 197
[2025-11-05 07:15:32.741195 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 90
[2025-11-05 07:15:32.741222 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 240
[2025-11-05 07:15:32.741260 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 07:15:32.742099 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 76, quiet_round: 0, discovered_api_pairs: 1610
[2025-11-05 07:15:32.792268 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:15:32.792633 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"REPLACED\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int rc_add = 0;\n    int rc_compile = 0;\n    int rc_replace = 0;\n    int num_groups = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memcpy(text_and_target_buf, text_buf, (size_t)text_len);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    rc_add = cre2_set_add_simple(set, pattern);\n    rc_compile = cre2_set_compile(set);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = (int)strlen(text_and_target_buf);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    rc_replace = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    enc = cre2_opt_encoding(opt);\n    computed_check = rc_add + rc_compile + rc_replace + num_groups + (int)enc + text_and_target.length + rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foobar tail\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    cre2_string_t text;\n    const int MAX_NMATCH = 3;\n    cre2_string_t matches[MAX_NMATCH];\n    int rc_consume = 0;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    text.data = text_buf;\n    text.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    rc_consume = cre2_consume_re(re, &text, matches, MAX_NMATCH);\n\n    // step 4: Validate\n    computed_check = rc_consume + pattern_len + matches[0].length + matches[1].length + matches[2].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:16:06.838705 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 07:16:06.838835 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30180, Completion: 21862, Total: 52042
[2025-11-05 07:16:06.838855 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:16:07.057617 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000760/id_000760.cc
[2025-11-05 07:16:07.057673 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:07.287541 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:07.287619 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:07.290426 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:07.290462 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:07.508720 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000761/id_000761.cc
[2025-11-05 07:16:07.508776 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:07.739676 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:07.739753 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:07.742636 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:07.742667 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:07.960694 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000762/id_000762.cc
[2025-11-05 07:16:07.960780 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:08.191567 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:08.191627 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:08.194521 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:08.194564 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:08.412151 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000763/id_000763.cc
[2025-11-05 07:16:08.412207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:08.640639 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:08.640715 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:08.643395 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:08.643423 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:08.862323 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000764/id_000764.cc
[2025-11-05 07:16:08.862377 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:09.091393 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:09.091501 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:09.094387 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:09.094420 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:09.311435 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000765/id_000765.cc
[2025-11-05 07:16:09.311490 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:09.540784 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:09.540859 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:09.543492 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:09.543524 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:09.761156 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000766/id_000766.cc
[2025-11-05 07:16:09.761213 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:09.991575 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:09.991644 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:09.994473 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:09.994501 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:10.212912 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000767/id_000767.cc
[2025-11-05 07:16:10.212999 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:10.442609 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:10.442682 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:10.445590 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:10.445624 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:10.663196 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000768/id_000768.cc
[2025-11-05 07:16:10.663253 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:10.893142 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:10.893215 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:10.895886 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:10.895940 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:11.114939 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000769/id_000769.cc
[2025-11-05 07:16:11.114995 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:11.343231 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:11.343327 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:11.346147 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:11.346179 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:11.346217 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:16:11.346236 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 770, succ: 769, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:16:11.346250 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:16:11.346276 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:16:11.655476 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 769 as an example for the next prompt.
[2025-11-05 07:16:11.655531 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 38 new API pairs in this round.
[2025-11-05 07:16:11.655589 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 38
[2025-11-05 07:16:11.655639 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,25.0,24.0,35.0,107.0,107.0,28.0,24.0,68.0,24.0,29.0,173.0,16.0,11.0,252.0,98.0,27.0,97.0,19.0,158.0,64.0,84.0,69.0,93.0,39.0,31.0,16.0,18.0,13.0,104.0,74.0,16.0,24.0,69.0,168.0,28.0,480.0,120.0,133.0,18.0,28.0,45.0,28.0,257.0,11.0,15.0,72.0,18.0,10.0,64.0,212.0,13.0,16.0,98.0,14.0,26.0,69.0,19.0,184.0,25.0,42.0,21.0,21.0,95.0,11.0,135.0,35.0,38.0,13.0]
[2025-11-05 07:16:11.655655 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:16:11.655708 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 168
[2025-11-05 07:16:11.655740 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 252
[2025-11-05 07:16:11.655766 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 64
[2025-11-05 07:16:11.655806 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 184
[2025-11-05 07:16:11.655838 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 07:16:11.656540 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 77, quiet_round: 0, discovered_api_pairs: 1648
[2025-11-05 07:16:11.687211 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:16:11.687558 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foobar tail\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    cre2_string_t text;\n    const int MAX_NMATCH = 3;\n    cre2_string_t matches[MAX_NMATCH];\n    int rc_consume = 0;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    text.data = text_buf;\n    text.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    rc_consume = cre2_consume_re(re, &text, matches, MAX_NMATCH);\n\n    // step 4: Validate\n    computed_check = rc_consume + pattern_len + matches[0].length + matches[1].length + matches[2].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hi)(there)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx hi there yy hi zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"REPLACED\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t easy_match_res;\n    int rc_easy_match = 0;\n    int rc_replace = 0;\n    int num_groups = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memcpy(text_and_target_buf, text_buf, (size_t)text_len);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 4: Operate\n    easy_match_res.data = NULL;\n    easy_match_res.length = 0;\n    rc_easy_match = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &easy_match_res, 1);\n    num_groups = cre2_num_capturing_groups(re);\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    rc_replace = cre2_replace_re(re, &text_and_target, &rewrite);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate\n    computed_check = rc_easy_match + rc_replace + num_groups + (int)enc + easy_match_res.length + text_and_target.length + rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:16:40.231480 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 07:16:40.231603 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28720, Completion: 19532, Total: 48252
[2025-11-05 07:16:40.231623 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:16:40.452207 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000770/id_000770.cc
[2025-11-05 07:16:40.452260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:40.680866 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:40.680938 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:40.683547 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:40.683580 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:40.902638 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000771/id_000771.cc
[2025-11-05 07:16:40.902689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:41.130453 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:41.130524 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:41.133334 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:41.133367 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:41.351433 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000772/id_000772.cc
[2025-11-05 07:16:41.351516 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:41.579202 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:41.579269 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:41.582090 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:41.582121 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:41.799385 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000773/id_000773.cc
[2025-11-05 07:16:41.799437 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:42.026679 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:42.026751 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:42.029611 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:42.029645 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:42.246092 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000774/id_000774.cc
[2025-11-05 07:16:42.246142 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:42.475035 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:42.475151 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:42.478013 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:42.478046 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:42.695188 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000775/id_000775.cc
[2025-11-05 07:16:42.695241 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:42.922956 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:42.923029 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:42.925880 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:42.925911 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:43.142249 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000776/id_000776.cc
[2025-11-05 07:16:43.142302 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:43.370786 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:43.370845 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:43.373758 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:43.373791 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:43.589970 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000777/id_000777.cc
[2025-11-05 07:16:43.590055 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:43.819449 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:43.819515 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:43.822438 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:43.822470 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:44.040678 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000778/id_000778.cc
[2025-11-05 07:16:44.040730 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:44.269658 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:44.269731 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:44.272548 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:44.272582 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:44.490125 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000779/id_000779.cc
[2025-11-05 07:16:44.490178 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:16:44.720169 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:16:44.720281 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:16:44.723127 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:16:44.723160 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:16:44.723199 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:16:44.723213 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 780, succ: 779, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:16:44.723228 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:16:44.723275 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:16:44.997507 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 779 as an example for the next prompt.
[2025-11-05 07:16:44.997562 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 07:16:44.997592 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 07:16:44.997640 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,27.0,24.0,37.0,107.0,107.0,28.0,24.0,68.0,24.0,29.0,175.0,16.0,11.0,255.0,98.0,27.0,97.0,19.0,158.0,65.0,86.0,69.0,93.0,39.0,31.0,16.0,18.0,13.0,104.0,74.0,16.0,24.0,69.0,169.0,28.0,482.0,120.0,133.0,18.0,31.0,45.0,28.0,257.0,11.0,15.0,72.0,18.0,10.0,64.0,212.0,13.0,16.0,98.0,14.0,26.0,69.0,19.0,187.0,25.0,42.0,21.0,21.0,95.0,11.0,135.0,35.0,38.0,13.0]
[2025-11-05 07:16:44.997657 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:16:44.997711 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 255
[2025-11-05 07:16:44.997741 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 169
[2025-11-05 07:16:44.997767 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 135
[2025-11-05 07:16:44.997795 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 257
[2025-11-05 07:16:44.997829 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 07:16:44.998534 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 78, quiet_round: 0, discovered_api_pairs: 1656
[2025-11-05 07:16:45.041712 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:16:45.042070 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hi)(there)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx hi there yy hi zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"REPLACED\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t easy_match_res;\n    int rc_easy_match = 0;\n    int rc_replace = 0;\n    int num_groups = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memcpy(text_and_target_buf, text_buf, (size_t)text_len);\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 4: Operate\n    easy_match_res.data = NULL;\n    easy_match_res.length = 0;\n    rc_easy_match = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &easy_match_res, 1);\n    num_groups = cre2_num_capturing_groups(re);\n    text_and_target.data = text_and_target_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    rc_replace = cre2_replace_re(re, &text_and_target, &rewrite);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate\n    computed_check = rc_easy_match + rc_replace + num_groups + (int)enc + easy_match_res.length + text_and_target.length + rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"Hello(World)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_literal(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 4: Validate\n    computed_check = pattern_len + (int)pattern[0] + (int)pattern_from_re[0] + cre2_opt_case_sensitive(opt) + cre2_opt_literal(opt);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:17:17.373803 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 07:17:17.373926 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28240, Completion: 20731, Total: 48971
[2025-11-05 07:17:17.373946 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:17:17.590570 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000780/id_000780.cc
[2025-11-05 07:17:17.590624 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:17.818909 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:17.818968 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:17.821789 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:17.821820 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:18.039344 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000781/id_000781.cc
[2025-11-05 07:17:18.039398 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:18.267556 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:18.267614 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:18.270504 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:18.270538 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:18.488884 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000782/id_000782.cc
[2025-11-05 07:17:18.488966 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:18.717727 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:18.717804 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:18.720698 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:18.720735 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:18.938781 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000783/id_000783.cc
[2025-11-05 07:17:18.938835 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:19.167659 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:19.167732 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:19.170650 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:19.170682 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:19.388735 +00:00] WARN [src/fuzzer.rs:205] Program 784 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000784/id_000784.cc:39:11: error: no matching function for call to 'cre2_set_new'
   39 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:17:19.431903 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:17:19.432240 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"ab(c)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char src_text[] = \"xx abc yy ab zz\";\n    const int src_text_len = (int)(sizeof(src_text) - 1);\n    char working_text[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t match;\n    int rc_easy_match = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(working_text, 0, sizeof(working_text));\n    memcpy(working_text, src_text, (size_t)src_text_len);\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, pattern);\n    match.data = NULL;\n    match.length = 0;\n    rc_easy_match = cre2_easy_match(pattern, pattern_len, working_text, src_text_len, &match, 2);\n\n    // step 4: Validate\n    num_groups = cre2_num_capturing_groups(re);\n    computed_check = rc_easy_match + match.length + num_groups + (int)working_text[0] + pattern_len;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000784/id_000784.cc:39:11: error: no matching function for call to 'cre2_set_new'\n   39 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:17:36.154562 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 16s
[2025-11-05 07:17:36.154683 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22040, Completion: 9977, Total: 32017
[2025-11-05 07:17:36.374393 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000784/id_000784.cc
[2025-11-05 07:17:36.374445 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:36.604160 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:36.604238 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:36.606989 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:36.607022 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:36.607054 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 784!
[2025-11-05 07:17:36.826002 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000785/id_000785.cc
[2025-11-05 07:17:36.826056 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:37.055198 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:37.055273 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:37.058152 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:37.058187 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:37.274562 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000786/id_000786.cc
[2025-11-05 07:17:37.274646 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:37.503195 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:37.503268 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:37.506175 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:37.506206 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:37.723499 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000787/id_000787.cc
[2025-11-05 07:17:37.723552 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:37.951945 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:37.952019 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:37.954938 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:37.954983 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:38.172680 +00:00] WARN [src/fuzzer.rs:205] Program 788 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000788/id_000788.cc:34:11: error: no matching function for call to 'cre2_set_new'
   34 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:17:38.215885 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:17:38.216218 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foo bar yy foo zz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t match;\n    int rc_easy_match = 0;\n    int rc_set_add = 0;\n    int computed_check = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    set = cre2_set_new(opt, 0);\n\n    // step 3: Operate\n    rc_set_add = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    match.data = NULL;\n    match.length = 0;\n    rc_easy_match = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 4: Validate\n    computed_check = rc_easy_match + rc_set_add + match.length + cre2_opt_case_sensitive(opt);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000788/id_000788.cc:34:11: error: no matching function for call to 'cre2_set_new'\n   34 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:17:58.606349 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 20s
[2025-11-05 07:17:58.606477 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21630, Completion: 10927, Total: 32557
[2025-11-05 07:17:58.824595 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000788/id_000788.cc
[2025-11-05 07:17:58.824662 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:59.054052 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:59.054125 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:59.056999 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:59.057032 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:59.057066 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 788!
[2025-11-05 07:17:59.274799 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000789/id_000789.cc
[2025-11-05 07:17:59.274854 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:17:59.505404 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:17:59.505474 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:17:59.508051 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:17:59.508084 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:17:59.508124 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:17:59.508140 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 790, succ: 789, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:17:59.508155 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:17:59.508184 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:17:59.788638 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 789 as an example for the next prompt.
[2025-11-05 07:17:59.788719 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 14 new API pairs in this round.
[2025-11-05 07:17:59.788756 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 14
[2025-11-05 07:17:59.788804 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,27.0,24.0,37.0,107.0,107.0,28.0,24.0,68.0,24.0,29.0,180.0,16.0,11.0,260.0,98.0,27.0,97.0,19.0,159.0,65.0,86.0,69.0,94.0,39.0,31.0,16.0,18.0,13.0,104.0,74.0,16.0,24.0,69.0,172.0,28.0,485.0,120.0,135.0,18.0,37.0,45.0,28.0,265.0,11.0,15.0,72.0,18.0,10.0,64.0,212.0,13.0,16.0,98.0,14.0,26.0,69.0,19.0,190.0,25.0,42.0,21.0,21.0,95.0,11.0,140.0,35.0,38.0,13.0]
[2025-11-05 07:17:59.788823 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:17:59.788876 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 212
[2025-11-05 07:17:59.788906 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 260
[2025-11-05 07:17:59.788931 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 27
[2025-11-05 07:17:59.788969 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 98
[2025-11-05 07:17:59.789003 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_opt_literal(cre2_options_t * opt),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 07:17:59.789706 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 79, quiet_round: 0, discovered_api_pairs: 1670
[2025-11-05 07:17:59.828994 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:17:59.829349 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_opt_literal(cre2_options_t * opt),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"Hello(World)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_literal(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 4: Validate\n    computed_check = pattern_len + (int)pattern[0] + (int)pattern_from_re[0] + cre2_opt_case_sensitive(opt) + cre2_opt_literal(opt);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx a b yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t match;\n    int rc_easy_match = 0;\n    int rc_set_add = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup / Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    rc_set_add = cre2_set_add_simple(set, pattern);\n    match.data = NULL;\n    match.length = 0;\n    rc_easy_match = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 2);\n\n    // step 4: Validate\n    num_groups = cre2_num_capturing_groups(re);\n    computed_check = rc_easy_match + rc_set_add + num_groups + match.length + cre2_opt_case_sensitive(opt);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:18:34.039568 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 07:18:34.039691 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 26650, Completion: 20390, Total: 47040
[2025-11-05 07:18:34.039713 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:18:34.256562 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000790/id_000790.cc
[2025-11-05 07:18:34.256615 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:34.485000 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:34.485072 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:34.487675 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:34.487702 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:34.706076 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000791/id_000791.cc
[2025-11-05 07:18:34.706129 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:34.935323 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:34.935390 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:34.938205 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:34.938237 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:35.156829 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000792/id_000792.cc
[2025-11-05 07:18:35.156913 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:35.385255 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:35.385313 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:35.387909 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:35.387941 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:35.608737 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000793/id_000793.cc
[2025-11-05 07:18:35.608790 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:35.837636 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:35.837702 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:35.840153 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:35.840179 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:36.059238 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000794/id_000794.cc
[2025-11-05 07:18:36.059290 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:36.287773 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:36.287867 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:36.290346 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:36.290379 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:36.509057 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000795/id_000795.cc
[2025-11-05 07:18:36.509111 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:36.740935 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:36.740993 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:36.743615 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:36.743659 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:36.963299 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000796/id_000796.cc
[2025-11-05 07:18:36.963354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:37.191414 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:37.191471 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:37.194318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:37.194351 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:37.413762 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000797/id_000797.cc
[2025-11-05 07:18:37.413848 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:37.642845 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:37.642910 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:37.645534 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:37.645566 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:37.863529 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000798/id_000798.cc
[2025-11-05 07:18:37.863584 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:38.093733 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:38.093799 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:38.096535 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:38.096561 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:38.313659 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000799/id_000799.cc
[2025-11-05 07:18:38.313714 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:18:38.543080 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:18:38.543192 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:18:38.546048 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:18:38.546079 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:18:38.546118 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:18:38.546135 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 800, succ: 799, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:18:38.546150 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:18:38.546175 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:18:38.822540 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 799 as an example for the next prompt.
[2025-11-05 07:18:38.822596 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 25 new API pairs in this round.
[2025-11-05 07:18:38.822645 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 25
[2025-11-05 07:18:38.822691 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,37.0,107.0,112.0,28.0,24.0,68.0,24.0,29.0,182.0,16.0,11.0,265.0,98.0,27.0,97.0,19.0,161.0,73.0,86.0,69.0,95.0,39.0,31.0,16.0,18.0,13.0,107.0,74.0,16.0,24.0,71.0,175.0,28.0,490.0,120.0,136.0,18.0,37.0,45.0,28.0,265.0,11.0,15.0,72.0,18.0,10.0,64.0,226.0,13.0,16.0,105.0,14.0,26.0,69.0,19.0,190.0,25.0,42.0,21.0,21.0,95.0,11.0,140.0,35.0,38.0,13.0]
[2025-11-05 07:18:38.822720 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:18:38.822772 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_dot_nl energy: 38
[2025-11-05 07:18:38.822828 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 64
[2025-11-05 07:18:38.822858 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 112
[2025-11-05 07:18:38.822884 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 74
[2025-11-05 07:18:38.822912 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 120
[2025-11-05 07:18:38.822949 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),
    int cre2_opt_one_line(cre2_options_t * opt),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)
[2025-11-05 07:18:38.823772 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 80, quiet_round: 0, discovered_api_pairs: 1695
[2025-11-05 07:18:38.870262 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:18:38.870617 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx a b yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t match;\n    int rc_easy_match = 0;\n    int rc_set_add = 0;\n    int num_groups = 0;\n    int computed_check = 0;\n\n    // step 2: Setup / Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    rc_set_add = cre2_set_add_simple(set, pattern);\n    match.data = NULL;\n    match.length = 0;\n    rc_easy_match = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 2);\n\n    // step 4: Validate\n    num_groups = cre2_num_capturing_groups(re);\n    computed_check = rc_easy_match + rc_set_add + num_groups + match.length + cre2_opt_case_sensitive(opt);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"abc\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx abc yy\";\n    const size_t text_len = (size_t)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int match_results[4] = { -1, -1, -1, -1 };\n    size_t match_count = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int literal_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    literal_flag = cre2_opt_literal(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    match_count = cre2_set_match(set, text_buf, text_len, match_results, (size_t)4);\n\n    // step 4: Validate\n    computed_check = (int)enc + literal_flag + (int)match_count + match_results[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:19:22.054456 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 07:19:22.054579 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28500, Completion: 23276, Total: 51776
[2025-11-05 07:19:22.054599 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:19:22.276863 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000800/id_000800.cc
[2025-11-05 07:19:22.276915 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:22.506100 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:22.506177 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:22.509043 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:22.509076 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:22.727175 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000801/id_000801.cc
[2025-11-05 07:19:22.727229 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:22.957044 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:22.957131 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:22.960105 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:22.960134 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:23.176944 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000802/id_000802.cc
[2025-11-05 07:19:23.177029 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:23.407383 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:23.407460 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:23.410590 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:23.410623 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:23.632047 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000803/id_000803.cc
[2025-11-05 07:19:23.632101 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:23.863363 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:23.863438 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:23.866275 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:23.866307 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:24.084904 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000804/id_000804.cc
[2025-11-05 07:19:24.084958 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:24.316256 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:24.316373 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:24.319220 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:24.319252 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:24.536381 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000805/id_000805.cc
[2025-11-05 07:19:24.536434 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:24.764332 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:24.764403 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:24.767219 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:24.767251 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:24.985174 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000806/id_000806.cc
[2025-11-05 07:19:24.985228 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:25.213837 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:25.213908 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:25.217101 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:25.217133 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:25.434594 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000807/id_000807.cc
[2025-11-05 07:19:25.434679 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:25.665238 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:25.665297 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:25.668208 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:25.668239 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:25.887117 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000808/id_000808.cc
[2025-11-05 07:19:25.887180 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:26.114954 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:26.115028 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:26.118011 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:26.118045 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:26.334839 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000809/id_000809.cc
[2025-11-05 07:19:26.334893 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:19:26.563314 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:19:26.563427 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:19:26.566244 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:19:26.566276 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:19:26.566317 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:19:26.566334 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 810, succ: 809, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:19:26.566349 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:19:26.566375 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:19:26.856478 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 809 as an example for the next prompt.
[2025-11-05 07:19:26.856535 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 29 new API pairs in this round.
[2025-11-05 07:19:26.856586 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 29
[2025-11-05 07:19:26.856642 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,37.0,107.0,118.0,28.0,24.0,68.0,24.0,29.0,186.0,16.0,11.0,270.0,98.0,27.0,99.0,19.0,162.0,73.0,86.0,69.0,95.0,40.0,31.0,16.0,18.0,13.0,107.0,89.0,16.0,24.0,71.0,175.0,28.0,499.0,130.0,136.0,18.0,37.0,45.0,28.0,265.0,11.0,15.0,72.0,18.0,10.0,78.0,226.0,13.0,16.0,105.0,14.0,26.0,69.0,19.0,190.0,25.0,42.0,21.0,21.0,100.0,11.0,140.0,35.0,41.0,13.0]
[2025-11-05 07:19:26.856660 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:19:26.856713 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 190
[2025-11-05 07:19:26.856747 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 175
[2025-11-05 07:19:26.856773 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 162
[2025-11-05 07:19:26.856800 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace energy: 11
[2025-11-05 07:19:26.856827 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 270
[2025-11-05 07:19:26.856859 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    cre2_options_t *cre2_opt_new(),
    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 07:19:26.857681 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 81, quiet_round: 0, discovered_api_pairs: 1724
[2025-11-05 07:19:26.893816 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:19:26.894164 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations (Initialize)\n    const char pattern[] = \"abc\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx abc yy\";\n    const size_t text_len = (size_t)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int match_results[4] = { -1, -1, -1, -1 };\n    size_t match_count = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int literal_flag = 0;\n    int computed_check = 0;\n\n    // step 2: Configure\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    literal_flag = cre2_opt_literal(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    match_count = cre2_set_match(set, text_buf, text_len, match_results, (size_t)4);\n\n    // step 4: Validate\n    computed_check = (int)enc + literal_flag + (int)match_count + match_results[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>ab)c\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxabcyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int one_line_flag = 0;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_dot_nl(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    one_line_flag = cre2_opt_one_line(opt);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    memset(strings, 0, sizeof(strings));\n    strings[0].data = text_buf + 2;\n    strings[0].length = 3;\n    strings[1].data = text_buf + 4;\n    strings[1].length = 1;\n    memset(ranges, 0, sizeof(ranges));\n    cre2_strings_to_ranges(text_buf, ranges, strings, 2);\n\n    // step 4: Validate\n    num_groups = cre2_num_capturing_groups(re);\n    computed_check = (long)one_line_flag + ranges[0].start + ranges[0].past + ranges[1].start + ranges[1].past + (long)num_groups;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:20:04.815416 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 07:20:04.815541 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28580, Completion: 20250, Total: 48830
[2025-11-05 07:20:04.815561 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:20:05.035803 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000810/id_000810.cc
[2025-11-05 07:20:05.035856 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:05.264723 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:05.264799 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:05.267346 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:05.267378 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:05.488702 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000811/id_000811.cc
[2025-11-05 07:20:05.488756 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:05.725232 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:05.725307 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:05.727984 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:05.728016 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:05.949079 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000812/id_000812.cc
[2025-11-05 07:20:05.949162 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:06.181632 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:06.181709 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:06.184196 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:06.184226 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:06.404080 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000813/id_000813.cc
[2025-11-05 07:20:06.404135 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:06.635544 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:06.635618 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:06.638497 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:06.638530 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:06.857012 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000814/id_000814.cc
[2025-11-05 07:20:06.857065 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:07.088930 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:07.089048 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:07.091542 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:07.091575 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:07.310531 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000815/id_000815.cc
[2025-11-05 07:20:07.310584 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:07.538968 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:07.539045 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:07.541695 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:07.541722 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:07.762335 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000816/id_000816.cc
[2025-11-05 07:20:07.762387 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:07.991949 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:07.992026 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:07.994860 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:07.994892 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:08.214917 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000817/id_000817.cc
[2025-11-05 07:20:08.215001 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:08.443407 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:08.443484 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:08.445992 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:08.446024 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:08.664173 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000818/id_000818.cc
[2025-11-05 07:20:08.664233 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:08.891224 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:08.891302 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:08.894202 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:08.894233 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:09.113639 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000819/id_000819.cc
[2025-11-05 07:20:09.113695 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:09.342139 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:09.342247 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:09.345004 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:09.345061 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:09.345103 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:20:09.345122 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 820, succ: 819, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:20:09.345140 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:20:09.345172 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:20:09.623377 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 819 as an example for the next prompt.
[2025-11-05 07:20:09.623433 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 07:20:09.623470 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 07:20:09.623519 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,37.0,107.0,118.0,28.0,24.0,68.0,24.0,29.0,186.0,16.0,11.0,276.0,98.0,27.0,99.0,19.0,162.0,73.0,86.0,69.0,95.0,40.0,31.0,16.0,18.0,13.0,107.0,89.0,16.0,24.0,71.0,175.0,28.0,499.0,130.0,136.0,18.0,39.0,45.0,28.0,265.0,20.0,15.0,72.0,18.0,10.0,78.0,226.0,13.0,16.0,105.0,14.0,26.0,70.0,19.0,198.0,25.0,42.0,21.0,21.0,100.0,11.0,140.0,35.0,41.0,13.0]
[2025-11-05 07:20:09.623539 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:20:09.623595 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 226
[2025-11-05 07:20:09.623632 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 98
[2025-11-05 07:20:09.623659 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 499
[2025-11-05 07:20:09.623684 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 72
[2025-11-05 07:20:09.623721 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:20:09.624425 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 82, quiet_round: 0, discovered_api_pairs: 1735
[2025-11-05 07:20:09.677703 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:20:09.678074 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>ab)c\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxabcyy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int one_line_flag = 0;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_dot_nl(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    one_line_flag = cre2_opt_one_line(opt);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    memset(strings, 0, sizeof(strings));\n    strings[0].data = text_buf + 2;\n    strings[0].length = 3;\n    strings[1].data = text_buf + 4;\n    strings[1].length = 1;\n    memset(ranges, 0, sizeof(ranges));\n    cre2_strings_to_ranges(text_buf, ranges, strings, 2);\n\n    // step 4: Validate\n    num_groups = cre2_num_capturing_groups(re);\n    computed_check = (long)one_line_flag + ranges[0].start + ranges[0].past + ranges[1].start + ranges[1].past + (long)num_groups;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foo yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"bar\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pat_from_re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int case_flag = 1;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pat_from_re = cre2_pattern(re);\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    memset(&rewrite, 0, sizeof(rewrite));\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_res = cre2_replace(pat_from_re, &text_and_target, &rewrite);\n\n    // step 4: Validate\n    computed_check = (long)replace_res + (long)text_and_target.length + (long)(pat_from_re ? pat_from_re[0] : 0) + (long)case_flag;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:20:54.958674 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 07:20:54.958813 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29700, Completion: 19313, Total: 49013
[2025-11-05 07:20:54.958867 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:20:55.178437 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000820/id_000820.cc
[2025-11-05 07:20:55.178493 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:55.411047 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:55.411118 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:55.413975 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:55.414008 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:55.632681 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000821/id_000821.cc
[2025-11-05 07:20:55.632738 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:55.865949 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:55.866032 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:55.869040 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:55.869067 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:56.089374 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000822/id_000822.cc
[2025-11-05 07:20:56.089461 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:56.322009 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:56.322080 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:56.324845 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:56.324878 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:56.546536 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000823/id_000823.cc
[2025-11-05 07:20:56.546590 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:56.779056 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:56.779117 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:56.781892 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:56.781924 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:57.003149 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000824/id_000824.cc
[2025-11-05 07:20:57.003206 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:57.235590 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:57.235678 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:57.238420 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:57.238452 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:57.460458 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000825/id_000825.cc
[2025-11-05 07:20:57.460513 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:57.692896 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:57.692976 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:57.695875 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:57.695910 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:57.917187 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000826/id_000826.cc
[2025-11-05 07:20:57.917242 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:58.148775 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:58.148850 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:58.151692 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:58.151724 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:58.372386 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000827/id_000827.cc
[2025-11-05 07:20:58.372471 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:58.604824 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:58.604894 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:58.607761 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:58.607793 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:58.829784 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000828/id_000828.cc
[2025-11-05 07:20:58.829840 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:59.063699 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:59.063758 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:59.066566 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:59.066598 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:59.285980 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000829/id_000829.cc
[2025-11-05 07:20:59.286043 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:20:59.521085 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:20:59.521192 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:20:59.523825 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:20:59.523853 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:20:59.523894 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:20:59.523919 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 830, succ: 829, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:20:59.523940 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:20:59.523972 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:20:59.814504 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 829 as an example for the next prompt.
[2025-11-05 07:20:59.814559 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 07:20:59.814589 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 07:20:59.814637 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,37.0,107.0,118.0,28.0,24.0,68.0,24.0,29.0,187.0,16.0,11.0,278.0,103.0,27.0,99.0,19.0,162.0,73.0,86.0,69.0,95.0,40.0,31.0,16.0,18.0,13.0,107.0,89.0,16.0,24.0,71.0,175.0,28.0,501.0,130.0,136.0,18.0,39.0,45.0,28.0,265.0,20.0,15.0,77.0,18.0,10.0,78.0,227.0,13.0,16.0,105.0,14.0,26.0,70.0,19.0,198.0,25.0,42.0,21.0,21.0,100.0,11.0,140.0,35.0,41.0,13.0]
[2025-11-05 07:20:59.814668 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:20:59.814721 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 227
[2025-11-05 07:20:59.814753 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 136
[2025-11-05 07:20:59.814785 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 175
[2025-11-05 07:20:59.814810 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 100
[2025-11-05 07:20:59.814842 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)
[2025-11-05 07:20:59.815554 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 83, quiet_round: 0, discovered_api_pairs: 1744
[2025-11-05 07:20:59.848764 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:20:59.849114 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foo yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"bar\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pat_from_re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int case_flag = 1;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    pat_from_re = cre2_pattern(re);\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    memset(&rewrite, 0, sizeof(rewrite));\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_res = cre2_replace(pat_from_re, &text_and_target, &rewrite);\n\n    // step 4: Validate\n    computed_check = (long)replace_res + (long)text_and_target.length + (long)(pat_from_re ? pat_from_re[0] : 0) + (long)case_flag;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(b)c\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxabczz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_string_t match_arr[3];\n    cre2_string_t pm_text;\n    cre2_string_t pm_out[3];\n    int match_res = 0;\n    int pm_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(match_arr, 0, sizeof(match_arr));\n    match_res = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 3);\n\n    // step 4: Additional operations\n    memset(pm_out, 0, sizeof(pm_out));\n    memset(&pm_text, 0, sizeof(pm_text));\n    pm_text.data = text_buf;\n    pm_text.length = text_len;\n    pm_res = cre2_partial_match(pattern, &pm_text, pm_out, 3);\n\n    // step 5: Validate\n    computed_check = (long)match_res + (long)pm_res + (long)enc + (long)(match_arr[0].length) + (long)(pm_out[0].length);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:21:37.679959 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 07:21:37.680086 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29040, Completion: 22148, Total: 51188
[2025-11-05 07:21:37.680106 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:21:37.900600 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000830/id_000830.cc
[2025-11-05 07:21:37.900667 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:38.132180 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:38.132256 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:38.135391 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:38.135422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:38.353168 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000831/id_000831.cc
[2025-11-05 07:21:38.353222 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:38.585429 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:38.585487 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:38.588198 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:38.588232 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:38.808996 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000832/id_000832.cc
[2025-11-05 07:21:38.809081 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:39.039730 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:39.039808 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:39.042983 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:39.043013 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:39.261628 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000833/id_000833.cc
[2025-11-05 07:21:39.261690 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:39.493695 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:39.493773 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:39.496398 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:39.496432 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:39.714394 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000834/id_000834.cc
[2025-11-05 07:21:39.714449 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:39.945853 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:39.945965 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:39.948608 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:39.948653 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:40.170229 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000835/id_000835.cc
[2025-11-05 07:21:40.170283 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:40.402280 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:40.402354 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:40.405502 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:40.405533 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:40.623647 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000836/id_000836.cc
[2025-11-05 07:21:40.623700 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:40.853221 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:40.853301 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:40.855991 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:40.856022 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:41.074241 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000837/id_000837.cc
[2025-11-05 07:21:41.074326 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:41.307509 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:41.307580 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:41.310242 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:41.310299 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:41.529477 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000838/id_000838.cc
[2025-11-05 07:21:41.529537 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:41.757720 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:41.757792 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:41.760332 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:41.760366 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:41.979160 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000839/id_000839.cc
[2025-11-05 07:21:41.979214 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:21:42.209258 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:21:42.209368 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:21:42.211842 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:21:42.211875 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:21:42.211915 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:21:42.211930 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 840, succ: 839, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:21:42.211946 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:21:42.211970 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:21:42.497599 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 839 as an example for the next prompt.
[2025-11-05 07:21:42.497654 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 07:21:42.497696 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 07:21:42.497742 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,37.0,107.0,118.0,28.0,24.0,68.0,24.0,29.0,187.0,16.0,11.0,280.0,105.0,27.0,99.0,19.0,162.0,73.0,86.0,69.0,96.0,40.0,31.0,16.0,18.0,13.0,110.0,89.0,16.0,24.0,71.0,176.0,28.0,506.0,137.0,140.0,18.0,39.0,45.0,28.0,265.0,20.0,15.0,77.0,20.0,10.0,78.0,230.0,13.0,16.0,115.0,14.0,26.0,70.0,19.0,202.0,25.0,42.0,21.0,21.0,107.0,11.0,142.0,35.0,41.0,13.0]
[2025-11-05 07:21:42.497759 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:21:42.497810 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 176
[2025-11-05 07:21:42.497841 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 96
[2025-11-05 07:21:42.497869 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 11
[2025-11-05 07:21:42.497896 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 69
[2025-11-05 07:21:42.497922 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 45
[2025-11-05 07:21:42.497956 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_set_delete(cre2_set * set),
    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_version_interface_revision()
[2025-11-05 07:21:42.498777 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 84, quiet_round: 0, discovered_api_pairs: 1764
[2025-11-05 07:21:42.542609 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:21:42.542968 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_set_delete(cre2_set * set),\n    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_version_interface_revision()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"a(b)c\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxabczz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_string_t match_arr[3];\n    cre2_string_t pm_text;\n    cre2_string_t pm_out[3];\n    int match_res = 0;\n    int pm_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(match_arr, 0, sizeof(match_arr));\n    match_res = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 3);\n\n    // step 4: Additional operations\n    memset(pm_out, 0, sizeof(pm_out));\n    memset(&pm_text, 0, sizeof(pm_text));\n    pm_text.data = text_buf;\n    pm_text.length = text_len;\n    pm_res = cre2_partial_match(pattern, &pm_text, pm_out, 3);\n\n    // step 5: Validate\n    computed_check = (long)match_res + (long)pm_res + (long)enc + (long)(match_arr[0].length) + (long)(pm_out[0].length);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"zz foobar yy\";\n    const size_t text_len = (size_t)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * found_name = NULL;\n    int found_index = -1;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_set * set = NULL;\n    int case_flag = 1;\n    int add_res = 0;\n    int compile_res = 0;\n    int match_arr[4];\n    size_t set_matches = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n    memset(match_arr, 0, sizeof(match_arr));\n    set_matches = cre2_set_match(set, text_buf, text_len, match_arr, (size_t)(sizeof(match_arr) / sizeof(match_arr[0])));\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 4: Validate\n    computed_check = (long)enc + (long)case_flag + (long)add_res + (long)compile_res + (long)set_matches + (long)found_index;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:22:19.033018 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 36s
[2025-11-05 07:22:19.033154 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29590, Completion: 24081, Total: 53671
[2025-11-05 07:22:19.033176 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:22:19.255010 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000840/id_000840.cc
[2025-11-05 07:22:19.255063 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:19.486995 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:19.487054 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:19.489793 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:19.489820 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:19.711700 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000841/id_000841.cc
[2025-11-05 07:22:19.711760 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:19.941218 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:19.941292 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:19.943881 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:19.943914 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:20.164698 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000842/id_000842.cc
[2025-11-05 07:22:20.164784 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:20.395568 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:20.395634 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:20.398536 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:20.398568 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:20.617139 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000843/id_000843.cc
[2025-11-05 07:22:20.617212 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:20.849680 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:20.849754 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:20.852542 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:20.852575 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:21.072095 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000844/id_000844.cc
[2025-11-05 07:22:21.072148 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:21.300957 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:21.301045 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:21.303667 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:21.303699 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:21.521804 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000845/id_000845.cc
[2025-11-05 07:22:21.521859 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:21.754108 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:21.754173 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:21.756594 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:21.756617 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:21.972663 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000846/id_000846.cc
[2025-11-05 07:22:21.972718 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:22.201660 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:22.201733 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:22.204412 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:22.204442 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:22.421855 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000847/id_000847.cc
[2025-11-05 07:22:22.421937 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:22.650710 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:22.650778 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:22.653726 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:22.653768 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:22.871969 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000848/id_000848.cc
[2025-11-05 07:22:22.872029 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:23.100389 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:23.100455 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:23.103158 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:23.103182 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:23.325087 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000849/id_000849.cc
[2025-11-05 07:22:23.325153 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:23.556976 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:23.557083 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:23.559590 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:23.559621 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:23.559660 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:22:23.559676 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 850, succ: 849, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:22:23.559690 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:22:23.559715 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:22:23.874317 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 849 as an example for the next prompt.
[2025-11-05 07:22:23.874374 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 07:22:23.874414 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 07:22:23.874461 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,37.0,107.0,118.0,28.0,24.0,68.0,24.0,29.0,187.0,16.0,11.0,281.0,105.0,27.0,99.0,19.0,162.0,73.0,86.0,75.0,96.0,40.0,31.0,16.0,18.0,13.0,112.0,89.0,16.0,24.0,71.0,177.0,28.0,511.0,137.0,143.0,18.0,39.0,50.0,28.0,265.0,20.0,15.0,77.0,20.0,10.0,78.0,230.0,13.0,16.0,116.0,14.0,26.0,70.0,19.0,202.0,25.0,42.0,21.0,21.0,107.0,21.0,143.0,35.0,41.0,13.0]
[2025-11-05 07:22:23.874478 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:22:23.874531 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 37
[2025-11-05 07:22:23.874564 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 265
[2025-11-05 07:22:23.874590 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 21
[2025-11-05 07:22:23.874616 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 15
[2025-11-05 07:22:23.874652 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_opt_log_errors(cre2_options_t * opt)
[2025-11-05 07:22:23.875363 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 85, quiet_round: 0, discovered_api_pairs: 1783
[2025-11-05 07:22:23.923007 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:22:23.923365 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_opt_log_errors(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"zz foobar yy\";\n    const size_t text_len = (size_t)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * found_name = NULL;\n    int found_index = -1;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_set * set = NULL;\n    int case_flag = 1;\n    int add_res = 0;\n    int compile_res = 0;\n    int match_arr[4];\n    size_t set_matches = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_flag);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n    memset(match_arr, 0, sizeof(match_arr));\n    set_matches = cre2_set_match(set, text_buf, text_len, match_arr, (size_t)(sizeof(match_arr) / sizeof(match_arr[0])));\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 4: Validate\n    computed_check = (long)enc + (long)case_flag + (long)add_res + (long)compile_res + (long)set_matches + (long)found_index;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t consume_in;\n    cre2_string_t consume_out[3];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int match_arr[4];\n    size_t set_matches = 0;\n    int add_res = 0;\n    int compile_res = 0;\n    int consume_res = 0;\n    int replace_res = 0;\n    int rev = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Operate on set and do a match\n    add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n    memset(match_arr, 0, sizeof(match_arr));\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, (size_t)(sizeof(match_arr) / sizeof(match_arr[0])));\n\n    // step 4: Create regexp, consume and do a global replace using the regexp\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(&consume_in, 0, sizeof(consume_in));\n    memset(consume_out, 0, sizeof(consume_out));\n    consume_in.data = text_buf;\n    consume_in.length = text_len;\n    consume_res = cre2_consume(pattern, &consume_in, consume_out, 3);\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = \"X\";\n    rewrite.length = 1;\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute a lightweight checksum using version info and results\n    rev = cre2_version_interface_revision();\n    computed_check = (long)rev + (long)add_res + (long)compile_res + (long)set_matches + (long)consume_res + (long)replace_res + (long)match_arr[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:22:56.467042 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 07:22:56.467158 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31660, Completion: 22363, Total: 54023
[2025-11-05 07:22:56.467180 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:22:56.685355 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000850/id_000850.cc
[2025-11-05 07:22:56.685409 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:56.918201 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:56.918271 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:56.921020 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:56.921053 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:57.142316 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000851/id_000851.cc
[2025-11-05 07:22:57.142369 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:57.377224 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:57.377283 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:57.380091 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:57.380123 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:57.600583 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000852/id_000852.cc
[2025-11-05 07:22:57.600692 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:57.830358 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:57.830438 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:57.833368 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:57.833400 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:58.052149 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000853/id_000853.cc
[2025-11-05 07:22:58.052203 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:58.281108 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:58.281214 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:58.283830 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:58.283862 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:58.503803 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000854/id_000854.cc
[2025-11-05 07:22:58.503857 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:58.735078 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:58.735168 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:58.737841 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:58.737873 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:58.959300 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000855/id_000855.cc
[2025-11-05 07:22:58.959354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:59.191309 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:59.191378 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:59.194239 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:59.194273 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:59.412148 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000856/id_000856.cc
[2025-11-05 07:22:59.412202 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:22:59.644545 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:22:59.644613 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:22:59.647315 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:22:59.647341 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:22:59.868527 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000857/id_000857.cc
[2025-11-05 07:22:59.868611 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:00.099622 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:00.099681 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:00.102568 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:00.102602 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:00.323830 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000858/id_000858.cc
[2025-11-05 07:23:00.323882 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:00.554064 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:00.554132 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:00.557000 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:00.557029 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:00.777908 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000859/id_000859.cc
[2025-11-05 07:23:00.777963 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:01.009208 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:01.009307 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:01.012111 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:01.012138 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:01.012182 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:23:01.012201 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 860, succ: 859, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:23:01.012219 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:23:01.012248 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:23:01.314160 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 859 as an example for the next prompt.
[2025-11-05 07:23:01.314216 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 25 new API pairs in this round.
[2025-11-05 07:23:01.314262 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 25
[2025-11-05 07:23:01.314311 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,107.0,118.0,28.0,24.0,68.0,27.0,29.0,187.0,16.0,11.0,284.0,105.0,27.0,99.0,19.0,166.0,73.0,86.0,75.0,96.0,40.0,31.0,16.0,18.0,13.0,112.0,89.0,16.0,24.0,71.0,179.0,28.0,521.0,137.0,143.0,18.0,39.0,51.0,28.0,274.0,20.0,24.0,77.0,20.0,10.0,78.0,230.0,13.0,16.0,116.0,14.0,26.0,70.0,19.0,202.0,25.0,42.0,21.0,21.0,107.0,33.0,143.0,35.0,41.0,13.0]
[2025-11-05 07:23:01.314330 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:23:01.314412 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 274
[2025-11-05 07:23:01.314446 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 112
[2025-11-05 07:23:01.314473 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 143
[2025-11-05 07:23:01.314501 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 107
[2025-11-05 07:23:01.314526 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 521
[2025-11-05 07:23:01.314565 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_set_compile(cre2_set * set),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 07:23:01.315388 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 86, quiet_round: 0, discovered_api_pairs: 1808
[2025-11-05 07:23:01.367519 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:23:01.367884 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_set_compile(cre2_set * set),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t consume_in;\n    cre2_string_t consume_out[3];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int match_arr[4];\n    size_t set_matches = 0;\n    int add_res = 0;\n    int compile_res = 0;\n    int consume_res = 0;\n    int replace_res = 0;\n    int rev = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Operate on set and do a match\n    add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n    memset(match_arr, 0, sizeof(match_arr));\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, (size_t)(sizeof(match_arr) / sizeof(match_arr[0])));\n\n    // step 4: Create regexp, consume and do a global replace using the regexp\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(&consume_in, 0, sizeof(consume_in));\n    memset(consume_out, 0, sizeof(consume_out));\n    consume_in.data = text_buf;\n    consume_in.length = text_len;\n    consume_res = cre2_consume(pattern, &consume_in, consume_out, 3);\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = \"X\";\n    rewrite.length = 1;\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute a lightweight checksum using version info and results\n    rev = cre2_version_interface_revision();\n    computed_check = (long)rev + (long)add_res + (long)compile_res + (long)set_matches + (long)consume_res + (long)replace_res + (long)match_arr[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t easy_match_out[3];\n    cre2_string_t consume_input;\n    cre2_string_t consume_out[3];\n    cre2_string_t consume_re_input;\n    cre2_string_t consume_re_out[3];\n    int easy_res = 0;\n    int consume_res = 0;\n    int consume_re_res = 0;\n    int log_errors_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    log_errors_flag = cre2_opt_log_errors(opt);\n    memset(easy_match_out, 0, sizeof(easy_match_out));\n    memset(consume_out, 0, sizeof(consume_out));\n    memset(consume_re_out, 0, sizeof(consume_re_out));\n    consume_input.data = text_buf;\n    consume_input.length = text_len;\n    consume_re_input.data = text_buf;\n    consume_re_input.length = text_len;\n\n    // step 3: Core operations\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_match_out, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n    consume_res = cre2_consume(pattern, &consume_input, consume_out, 3);\n    consume_re_res = cre2_consume_re(re, &consume_re_input, consume_re_out, 3);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)easy_res + (long)consume_res + (long)consume_re_res + (long)log_errors_flag + (long)easy_match_out[0].length + (long)consume_out[0].length + (long)consume_re_out[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:23:34.251714 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 07:23:34.251835 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32620, Completion: 20529, Total: 53149
[2025-11-05 07:23:34.251856 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:23:34.468298 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000860/id_000860.cc
[2025-11-05 07:23:34.468353 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:34.696407 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:34.696482 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:34.699135 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:34.699161 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:34.917439 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000861/id_000861.cc
[2025-11-05 07:23:34.917494 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:35.147234 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:35.147310 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:35.150156 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:35.150187 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:35.369512 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000862/id_000862.cc
[2025-11-05 07:23:35.369597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:35.599880 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:35.599957 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:35.602716 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:35.602750 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:35.821636 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000863/id_000863.cc
[2025-11-05 07:23:35.821702 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:36.051363 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:36.051438 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:36.054351 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:36.054383 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:36.271825 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000864/id_000864.cc
[2025-11-05 07:23:36.271879 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:36.505256 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:36.505371 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:36.508134 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:36.508167 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:36.725060 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000865/id_000865.cc
[2025-11-05 07:23:36.725116 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:36.953754 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:36.953830 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:36.956577 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:36.956604 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:37.173300 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000866/id_000866.cc
[2025-11-05 07:23:37.173356 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:37.402817 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:37.402894 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:37.405820 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:37.405852 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:37.624681 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000867/id_000867.cc
[2025-11-05 07:23:37.624767 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:37.853003 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:37.853079 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:37.855741 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:37.855773 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:38.073385 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000868/id_000868.cc
[2025-11-05 07:23:38.073439 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:38.302121 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:38.302194 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:38.305091 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:38.305123 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:38.523690 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000869/id_000869.cc
[2025-11-05 07:23:38.523759 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:23:38.755542 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:23:38.755659 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:23:38.758457 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:23:38.758491 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:23:38.758530 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:23:38.758547 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 870, succ: 869, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:23:38.758563 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:23:38.758591 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:23:39.062504 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 869 as an example for the next prompt.
[2025-11-05 07:23:39.062563 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 24 new API pairs in this round.
[2025-11-05 07:23:39.062613 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 24
[2025-11-05 07:23:39.062665 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,118.0,118.0,28.0,24.0,68.0,27.0,29.0,187.0,16.0,11.0,288.0,105.0,27.0,99.0,19.0,167.0,73.0,87.0,75.0,96.0,40.0,31.0,16.0,18.0,13.0,117.0,89.0,16.0,24.0,71.0,182.0,28.0,530.0,137.0,147.0,18.0,42.0,54.0,28.0,283.0,20.0,24.0,77.0,20.0,10.0,78.0,230.0,13.0,16.0,119.0,14.0,26.0,70.0,19.0,202.0,25.0,42.0,21.0,21.0,107.0,33.0,147.0,35.0,41.0,13.0]
[2025-11-05 07:23:39.062684 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:23:39.062741 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 202
[2025-11-05 07:23:39.062773 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_dot_nl energy: 41
[2025-11-05 07:23:39.062801 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 530
[2025-11-05 07:23:39.062830 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 182
[2025-11-05 07:23:39.062856 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 167
[2025-11-05 07:23:39.062892 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    cre2_options_t *cre2_opt_new()
[2025-11-05 07:23:39.063780 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 87, quiet_round: 0, discovered_api_pairs: 1832
[2025-11-05 07:23:39.100208 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:23:39.100564 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    cre2_options_t *cre2_opt_new()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t easy_match_out[3];\n    cre2_string_t consume_input;\n    cre2_string_t consume_out[3];\n    cre2_string_t consume_re_input;\n    cre2_string_t consume_re_out[3];\n    int easy_res = 0;\n    int consume_res = 0;\n    int consume_re_res = 0;\n    int log_errors_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    log_errors_flag = cre2_opt_log_errors(opt);\n    memset(easy_match_out, 0, sizeof(easy_match_out));\n    memset(consume_out, 0, sizeof(consume_out));\n    memset(consume_re_out, 0, sizeof(consume_re_out));\n    consume_input.data = text_buf;\n    consume_input.length = text_len;\n    consume_re_input.data = text_buf;\n    consume_re_input.length = text_len;\n\n    // step 3: Core operations\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_match_out, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n    consume_res = cre2_consume(pattern, &consume_input, consume_out, 3);\n    consume_re_res = cre2_consume_re(re, &consume_re_input, consume_re_out, 3);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)easy_res + (long)consume_res + (long)consume_re_res + (long)log_errors_flag + (long)easy_match_out[0].length + (long)consume_out[0].length + (long)consume_re_out[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t easy_match_out[3];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int set_add_res = 0;\n    int compile_res = 0;\n    int easy_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    set_add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n\n    // step 3: Operate (easy match and create regexp for replace)\n    memset(easy_match_out, 0, sizeof(easy_match_out));\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_match_out, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = \"X\";\n    rewrite.length = 1;\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Validate / compute lightweight checksum using results\n    computed_check = (long)compile_res + (long)set_add_res + (long)easy_res + (long)replace_res + (long)easy_match_out[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:24:23.276482 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 44s
[2025-11-05 07:24:23.276616 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30250, Completion: 21813, Total: 52063
[2025-11-05 07:24:23.276661 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:24:23.493972 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000870/id_000870.cc
[2025-11-05 07:24:23.494024 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:23.722675 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:23.722755 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:23.725593 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:23.725620 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:23.944197 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000871/id_000871.cc
[2025-11-05 07:24:23.944251 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:24.171969 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:24.172051 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:24.174859 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:24.174886 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:24.393036 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000872/id_000872.cc
[2025-11-05 07:24:24.393128 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:24.623354 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:24.623412 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:24.626258 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:24.626294 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:24.845216 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000873/id_000873.cc
[2025-11-05 07:24:24.845267 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:25.074240 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:25.074320 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:25.077183 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:25.077213 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:25.293664 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000874/id_000874.cc
[2025-11-05 07:24:25.293716 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:25.523446 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:25.523569 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:25.526398 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:25.526425 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:25.743642 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000875/id_000875.cc
[2025-11-05 07:24:25.743694 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:25.972276 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:25.972361 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:25.975070 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:25.975096 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:26.192117 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000876/id_000876.cc
[2025-11-05 07:24:26.192172 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:26.421519 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:26.421593 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:26.424315 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:26.424344 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:26.642238 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000877/id_000877.cc
[2025-11-05 07:24:26.642330 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:26.870941 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:26.871019 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:26.873808 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:26.873835 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:27.091682 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000878/id_000878.cc
[2025-11-05 07:24:27.091735 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:27.320816 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:27.320891 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:27.323648 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:27.323677 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:27.540151 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000879/id_000879.cc
[2025-11-05 07:24:27.540204 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:24:27.769368 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:24:27.769478 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:24:27.772275 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:24:27.772302 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:24:27.772367 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:24:27.772387 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 880, succ: 879, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:24:27.772404 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:24:27.772429 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:24:28.044869 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 879 as an example for the next prompt.
[2025-11-05 07:24:28.044924 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 07:24:28.044961 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 07:24:28.045009 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,118.0,118.0,28.0,24.0,70.0,27.0,29.0,188.0,16.0,11.0,292.0,105.0,27.0,99.0,19.0,167.0,73.0,87.0,75.0,96.0,40.0,31.0,16.0,18.0,13.0,117.0,89.0,16.0,24.0,71.0,185.0,28.0,533.0,137.0,147.0,18.0,48.0,54.0,28.0,284.0,20.0,24.0,77.0,20.0,10.0,78.0,230.0,13.0,16.0,119.0,14.0,26.0,70.0,19.0,207.0,25.0,42.0,21.0,21.0,107.0,33.0,147.0,40.0,44.0,13.0]
[2025-11-05 07:24:28.045030 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:24:28.045083 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 533
[2025-11-05 07:24:28.045125 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume energy: 13
[2025-11-05 07:24:28.045153 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 207
[2025-11-05 07:24:28.045179 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 107
[2025-11-05 07:24:28.045213 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)
[2025-11-05 07:24:28.045927 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 88, quiet_round: 0, discovered_api_pairs: 1845
[2025-11-05 07:24:28.086192 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:24:28.086542 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t easy_match_out[3];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int set_add_res = 0;\n    int compile_res = 0;\n    int easy_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    set_add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n\n    // step 3: Operate (easy match and create regexp for replace)\n    memset(easy_match_out, 0, sizeof(easy_match_out));\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, easy_match_out, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = \"X\";\n    rewrite.length = 1;\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Validate / compute lightweight checksum using results\n    computed_check = (long)compile_res + (long)set_add_res + (long)easy_res + (long)replace_res + (long)easy_match_out[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo).*?(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    int case_sensitive_flag = 1;\n    int dot_nl_flag = 1;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_sensitive_flag);\n    cre2_opt_set_dot_nl(opt, dot_nl_flag);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)case_sensitive_flag + (long)dot_nl_flag + (long)strlen(pattern_from_re);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:25:02.879445 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 07:25:02.879566 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28080, Completion: 21499, Total: 49579
[2025-11-05 07:25:02.879588 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:25:03.097886 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000880/id_000880.cc
[2025-11-05 07:25:03.097939 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:03.325993 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:03.326052 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:03.328909 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:03.328940 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:03.547188 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000881/id_000881.cc
[2025-11-05 07:25:03.547242 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:03.775421 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:03.775492 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:03.778326 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:03.778358 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:03.996520 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000882/id_000882.cc
[2025-11-05 07:25:03.996603 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:04.225775 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:04.225841 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:04.228498 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:04.228526 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:04.446844 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000883/id_000883.cc
[2025-11-05 07:25:04.446898 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:04.676403 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:04.676461 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:04.679156 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:04.679188 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:04.897424 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000884/id_000884.cc
[2025-11-05 07:25:04.897476 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:05.128316 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:05.128435 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:05.131163 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:05.131196 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:05.349558 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000885/id_000885.cc
[2025-11-05 07:25:05.349611 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:05.579599 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:05.579668 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:05.582511 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:05.582545 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:05.799316 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000886/id_000886.cc
[2025-11-05 07:25:05.799385 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:06.027614 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:06.027690 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:06.030523 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:06.030557 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:06.248272 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000887/id_000887.cc
[2025-11-05 07:25:06.248354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:06.476950 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:06.477009 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:06.479796 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:06.479823 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:06.698041 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000888/id_000888.cc
[2025-11-05 07:25:06.698094 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:06.927519 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:06.927590 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:06.930735 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:06.930767 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:07.148250 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000889/id_000889.cc
[2025-11-05 07:25:07.148303 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:25:07.376521 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:25:07.376603 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:25:07.379162 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:25:07.379195 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:25:07.379232 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:25:07.379249 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 890, succ: 889, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:25:07.379264 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:25:07.379289 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:25:07.659844 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 889 as an example for the next prompt.
[2025-11-05 07:25:07.659902 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 27 new API pairs in this round.
[2025-11-05 07:25:07.659949 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 27
[2025-11-05 07:25:07.659998 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,118.0,118.0,28.0,24.0,70.0,27.0,29.0,188.0,16.0,11.0,296.0,105.0,27.0,99.0,19.0,167.0,73.0,87.0,75.0,96.0,40.0,31.0,16.0,18.0,30.0,117.0,89.0,16.0,24.0,71.0,185.0,28.0,534.0,148.0,147.0,18.0,48.0,54.0,28.0,284.0,20.0,24.0,77.0,20.0,10.0,78.0,230.0,13.0,16.0,119.0,14.0,26.0,70.0,19.0,218.0,25.0,42.0,21.0,21.0,118.0,33.0,147.0,40.0,44.0,13.0]
[2025-11-05 07:25:07.660018 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:25:07.660084 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 230
[2025-11-05 07:25:07.660115 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 534
[2025-11-05 07:25:07.660153 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 147
[2025-11-05 07:25:07.660182 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 78
[2025-11-05 07:25:07.660213 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_opt_one_line(cre2_options_t * opt)
[2025-11-05 07:25:07.660921 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 89, quiet_round: 0, discovered_api_pairs: 1872
[2025-11-05 07:25:07.695295 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:25:07.695646 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_opt_one_line(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo).*?(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    int case_sensitive_flag = 1;\n    int dot_nl_flag = 1;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, case_sensitive_flag);\n    cre2_opt_set_dot_nl(opt, dot_nl_flag);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)case_sensitive_flag + (long)dot_nl_flag + (long)strlen(pattern_from_re);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[3];\n    cre2_named_groups_iter_t * iter = NULL;\n    int find_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    pattern_from_re = cre2_pattern(re);\n    memset(&input, 0, sizeof(input));\n    input.data = text_buf;\n    input.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    find_res = cre2_find_and_consume(pattern, &input, matches, 3);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)find_res + (long)pattern_len + (long)input.length + (long)matches[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:25:41.633891 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 07:25:41.634016 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 26810, Completion: 21369, Total: 48179
[2025-11-05 07:25:41.634038 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:25:41.851801 +00:00] WARN [src/fuzzer.rs:205] Program 890 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000890/id_000890.cc:30:5: error: no matching function for call to 'cre2_opt_one_line'
   30 |     cre2_opt_one_line(opt, one_line_flag);
      |     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:25:41.886274 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:25:41.886606 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a|b)+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int one_line_flag = 1;\n    int add_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_one_line(opt, one_line_flag);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)one_line_flag + (long)enc + (long)add_res + (re != NULL);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000890/id_000890.cc:30:5: error: no matching function for call to 'cre2_opt_one_line'\n   30 |     cre2_opt_one_line(opt, one_line_flag);\n      |     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:26:03.347881 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 07:26:03.347999 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21110, Completion: 9971, Total: 31081
[2025-11-05 07:26:03.566138 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000890/id_000890.cc
[2025-11-05 07:26:03.566192 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:26:03.794550 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:26:03.794626 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:26:03.797458 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:26:03.797490 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:26:03.797526 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 890!
[2025-11-05 07:26:04.015873 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000891/id_000891.cc
[2025-11-05 07:26:04.015927 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:26:04.243068 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:26:04.243146 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:26:04.245953 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:26:04.245987 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:26:04.463664 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000892/id_000892.cc
[2025-11-05 07:26:04.463748 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:26:04.691142 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:26:04.691218 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:26:04.694035 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:26:04.694067 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:26:04.911065 +00:00] WARN [src/fuzzer.rs:205] Program 893 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000893/id_000893.cc:29:5: error: no matching function for call to 'cre2_opt_one_line'
   29 |     cre2_opt_one_line(opt, 1);
      |     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:26:04.945543 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:26:04.945870 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(abc|def)+\\\\s+end\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_one_line(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)enc + (long)add_res + (long)(re != NULL) + (long)(set != NULL);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000893/id_000893.cc:29:5: error: no matching function for call to 'cre2_opt_one_line'\n   29 |     cre2_opt_one_line(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:26:25.510836 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 20s
[2025-11-05 07:26:25.510948 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21070, Completion: 10206, Total: 31276
[2025-11-05 07:26:25.732473 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000893/id_000893.cc
[2025-11-05 07:26:25.732525 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:26:25.962185 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:26:25.962244 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:26:25.965067 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:26:25.965098 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:26:25.965130 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 893!
[2025-11-05 07:26:26.183202 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000894/id_000894.cc
[2025-11-05 07:26:26.183254 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:26:26.411487 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:26:26.411552 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:26:26.414318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:26:26.414350 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:26:26.631906 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000895/id_000895.cc
[2025-11-05 07:26:26.631992 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:26:26.861934 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:26:26.862002 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:26:26.864799 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:26:26.864852 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:26:27.082620 +00:00] WARN [src/fuzzer.rs:205] Program 896 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000896/id_000896.cc:29:5: error: no matching function for call to 'cre2_opt_one_line'
   29 |     cre2_opt_one_line(opt, 1);
      |     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:26:27.117132 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:26:27.117460 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(hello)\\\\s+(world)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_one_line(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 3: Core operations\n    add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)enc + (long)add_res + (long)(re != NULL);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000896/id_000896.cc:29:5: error: no matching function for call to 'cre2_opt_one_line'\n   29 |     cre2_opt_one_line(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:26:46.436100 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 19s
[2025-11-05 07:26:46.436223 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 20980, Completion: 9844, Total: 30824
[2025-11-05 07:26:46.654538 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000896/id_000896.cc
[2025-11-05 07:26:46.654591 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:26:46.884249 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:26:46.884308 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:26:46.887006 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:26:46.887039 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:26:46.887071 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 896!
[2025-11-05 07:26:47.104256 +00:00] WARN [src/fuzzer.rs:205] Program 897 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000897/id_000897.cc:32:5: error: no matching function for call to 'cre2_opt_one_line'
   32 |     cre2_opt_one_line(opt, one_line_flag);
      |     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:26:47.138754 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:26:47.139085 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(abc|def)\\\\d+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    int add_res = 0;\n    int compile_res = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int one_line_flag = 1;\n    const char * pattern_from_re = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_one_line(opt, one_line_flag);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)one_line_flag + (long)enc + (long)add_res + (long)compile_res + (long)strlen(pattern_from_re);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000897/id_000897.cc:32:5: error: no matching function for call to 'cre2_opt_one_line'\n   32 |     cre2_opt_one_line(opt, one_line_flag);\n      |     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:27:21.142801 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 07:27:21.142923 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21610, Completion: 13320, Total: 34930
[2025-11-05 07:27:21.361109 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000897/id_000897.cc
[2025-11-05 07:27:21.361163 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:27:21.591137 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:27:21.591203 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:27:21.594069 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:27:21.594101 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:27:21.594135 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 897!
[2025-11-05 07:27:21.810573 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000898/id_000898.cc
[2025-11-05 07:27:21.810636 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:27:22.039441 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:27:22.039520 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:27:22.042371 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:27:22.042404 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:27:22.261124 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000899/id_000899.cc
[2025-11-05 07:27:22.261207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:27:22.490600 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:27:22.490674 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:27:22.493417 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:27:22.493448 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:27:22.493486 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:27:22.493502 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 900, succ: 899, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:27:22.493518 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:27:22.493544 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:27:22.767001 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 899 as an example for the next prompt.
[2025-11-05 07:27:22.767057 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 07:27:22.767093 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 07:27:22.767141 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,118.0,118.0,28.0,24.0,70.0,27.0,29.0,189.0,16.0,11.0,300.0,105.0,27.0,100.0,19.0,167.0,73.0,87.0,75.0,99.0,40.0,31.0,16.0,18.0,30.0,119.0,89.0,16.0,24.0,71.0,185.0,28.0,538.0,148.0,150.0,18.0,48.0,54.0,28.0,284.0,20.0,24.0,77.0,20.0,10.0,82.0,234.0,13.0,16.0,119.0,14.0,26.0,70.0,19.0,222.0,25.0,42.0,21.0,21.0,118.0,33.0,151.0,40.0,44.0,13.0]
[2025-11-05 07:27:22.767160 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:27:22.767213 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 150
[2025-11-05 07:27:22.767246 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 148
[2025-11-05 07:27:22.767278 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_word_boundary energy: 11
[2025-11-05 07:27:22.767305 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 151
[2025-11-05 07:27:22.767337 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_opt_word_boundary(cre2_options_t * opt),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 07:27:22.768032 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 90, quiet_round: 0, discovered_api_pairs: 1885
[2025-11-05 07:27:22.802195 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:27:22.802543 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_opt_word_boundary(cre2_options_t * opt),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xx foobar yy\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[3];\n    cre2_named_groups_iter_t * iter = NULL;\n    int find_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    pattern_from_re = cre2_pattern(re);\n    memset(&input, 0, sizeof(input));\n    input.data = text_buf;\n    input.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    find_res = cre2_find_and_consume(pattern, &input, matches, 3);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)find_res + (long)pattern_len + (long)input.length + (long)matches[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a|b)+c\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar\";\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    int one_line_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_res = cre2_set_add_simple(set, set_pattern);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)one_line_flag + (long)enc + (long)add_res;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:27:59.345259 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 36s
[2025-11-05 07:27:59.345385 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27460, Completion: 21276, Total: 48736
[2025-11-05 07:27:59.345405 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:27:59.563963 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000900/id_000900.cc
[2025-11-05 07:27:59.564017 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:27:59.792931 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:27:59.793002 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:27:59.795502 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:27:59.795533 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:00.013560 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000901/id_000901.cc
[2025-11-05 07:28:00.013613 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:00.242313 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:00.242371 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:00.245240 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:00.245272 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:00.462987 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000902/id_000902.cc
[2025-11-05 07:28:00.463072 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:00.692777 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:00.692850 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:00.695502 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:00.695535 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:00.913318 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000903/id_000903.cc
[2025-11-05 07:28:00.913372 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:01.141722 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:01.141793 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:01.144538 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:01.144572 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:01.362169 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000904/id_000904.cc
[2025-11-05 07:28:01.362223 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:01.592903 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:01.593011 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:01.595911 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:01.595944 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:01.813538 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000905/id_000905.cc
[2025-11-05 07:28:01.813592 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:02.044001 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:02.044070 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:02.046860 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:02.046892 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:02.264958 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000906/id_000906.cc
[2025-11-05 07:28:02.265013 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:02.504606 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:02.504690 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:02.507542 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:02.507573 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:02.725244 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000907/id_000907.cc
[2025-11-05 07:28:02.725330 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:02.955632 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:02.955700 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:02.958537 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:02.958569 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:03.175629 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000908/id_000908.cc
[2025-11-05 07:28:03.175683 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:03.405306 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:03.405380 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:03.407972 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:03.408004 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:03.626129 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000909/id_000909.cc
[2025-11-05 07:28:03.626183 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:03.854698 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:03.854787 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:03.857630 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:03.857663 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:03.857702 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:28:03.857719 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 910, succ: 909, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:28:03.857735 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:28:03.857762 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:28:04.131927 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 909 as an example for the next prompt.
[2025-11-05 07:28:04.131980 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 18 new API pairs in this round.
[2025-11-05 07:28:04.132022 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 18
[2025-11-05 07:28:04.132070 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,118.0,118.0,28.0,24.0,70.0,27.0,29.0,194.0,16.0,18.0,300.0,105.0,27.0,100.0,19.0,168.0,73.0,87.0,75.0,101.0,42.0,31.0,16.0,18.0,30.0,119.0,89.0,16.0,24.0,71.0,185.0,28.0,543.0,155.0,154.0,18.0,48.0,54.0,28.0,284.0,20.0,24.0,77.0,20.0,10.0,82.0,234.0,13.0,16.0,121.0,14.0,26.0,70.0,19.0,222.0,25.0,44.0,21.0,21.0,123.0,33.0,158.0,40.0,44.0,13.0]
[2025-11-05 07:28:04.132089 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:28:04.132144 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 118
[2025-11-05 07:28:04.132176 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 100
[2025-11-05 07:28:04.132202 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 543
[2025-11-05 07:28:04.132256 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 284
[2025-11-05 07:28:04.132284 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 105
[2025-11-05 07:28:04.132323 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)
[2025-11-05 07:28:04.133137 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 91, quiet_round: 0, discovered_api_pairs: 1903
[2025-11-05 07:28:04.197713 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:28:04.198084 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a|b)+c\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo|bar\";\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    int one_line_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_res = cre2_set_add_simple(set, set_pattern);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)one_line_flag + (long)enc + (long)add_res;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"alpha|beta\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int word_boundary_flag = 0;\n    int add_res = 0;\n    char tmpbuf[32];\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, set_pattern);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate on data / small utility\n    memset(tmpbuf, 0, sizeof(tmpbuf));\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)word_boundary_flag + (long)add_res + (long)cre2_num_capturing_groups(re) + (long)tmpbuf[0] + (long)(iter != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:28:43.737604 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 07:28:43.737736 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28550, Completion: 26662, Total: 55212
[2025-11-05 07:28:43.737760 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:28:43.958777 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000910/id_000910.cc
[2025-11-05 07:28:43.958830 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:44.191175 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:44.191233 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:44.194099 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:44.194148 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:44.411321 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000911/id_000911.cc
[2025-11-05 07:28:44.411374 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:44.641557 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:44.641629 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:44.644490 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:44.644517 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:44.864709 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000912/id_000912.cc
[2025-11-05 07:28:44.864793 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:45.094646 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:45.094716 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:45.097598 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:45.097631 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:45.316893 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000913/id_000913.cc
[2025-11-05 07:28:45.316945 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:45.548681 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:45.548748 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:45.551591 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:45.551624 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:45.770229 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000914/id_000914.cc
[2025-11-05 07:28:45.770289 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:45.999498 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:45.999582 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:46.002380 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:46.002412 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:46.222271 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000915/id_000915.cc
[2025-11-05 07:28:46.222324 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:46.454160 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:46.454226 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:46.456804 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:46.456832 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:46.675726 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000916/id_000916.cc
[2025-11-05 07:28:46.675786 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:46.905204 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:46.905278 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:46.907917 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:46.907950 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:47.125790 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000917/id_000917.cc
[2025-11-05 07:28:47.125877 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:47.357093 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:47.357152 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:47.359976 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:47.360008 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:47.582178 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000918/id_000918.cc
[2025-11-05 07:28:47.582231 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:47.812575 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:47.812659 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:47.815179 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:47.815206 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:48.035816 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000919/id_000919.cc
[2025-11-05 07:28:48.035871 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:28:48.263748 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:28:48.263853 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:28:48.266373 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:28:48.266400 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:28:48.266441 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:28:48.266457 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 920, succ: 919, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:28:48.266473 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:28:48.266504 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:28:48.564653 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 919 as an example for the next prompt.
[2025-11-05 07:28:48.564722 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 16 new API pairs in this round.
[2025-11-05 07:28:48.564766 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 16
[2025-11-05 07:28:48.564815 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,124.0,118.0,28.0,24.0,70.0,27.0,29.0,196.0,16.0,18.0,302.0,115.0,27.0,104.0,19.0,169.0,73.0,87.0,75.0,101.0,42.0,31.0,16.0,18.0,30.0,119.0,89.0,16.0,24.0,71.0,185.0,28.0,548.0,155.0,154.0,18.0,48.0,54.0,28.0,290.0,20.0,24.0,77.0,20.0,10.0,82.0,234.0,13.0,16.0,121.0,14.0,26.0,70.0,19.0,222.0,25.0,44.0,21.0,21.0,123.0,33.0,158.0,40.0,44.0,13.0]
[2025-11-05 07:28:48.564833 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:28:48.564885 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 234
[2025-11-05 07:28:48.564917 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 290
[2025-11-05 07:28:48.564963 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 104
[2025-11-05 07:28:48.564988 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 77
[2025-11-05 07:28:48.565015 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 121
[2025-11-05 07:28:48.565056 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 07:28:48.565867 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 92, quiet_round: 0, discovered_api_pairs: 1919
[2025-11-05 07:28:48.624120 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:28:48.624484 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"alpha|beta\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int word_boundary_flag = 0;\n    int add_res = 0;\n    char tmpbuf[32];\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, set_pattern);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate on data / small utility\n    memset(tmpbuf, 0, sizeof(tmpbuf));\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)word_boundary_flag + (long)add_res + (long)cre2_num_capturing_groups(re) + (long)tmpbuf[0] + (long)(iter != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char easy_pattern[] = \"([0-9]+)\";\n    const int easy_pattern_len = (int)(sizeof(easy_pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char text_init[] = \"number 12345 and more 67890\";\n    char text_buf[128] = \"number 12345 and more 67890\";\n    const char rewrite_init[] = \"REPLACED\";\n    char rewrite_buf[128] = \"REPLACED\";\n    const int text_len = (int)(sizeof(text_init) - 1);\n    cre2_string_t match_arr[4];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_res = 0;\n    int match_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(match_arr, 0, sizeof(match_arr));\n    easy_res = cre2_easy_match(easy_pattern, easy_pattern_len, text_buf, text_len, match_arr, 2);\n    match_res = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 3);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_init) - 1);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)easy_res + (long)match_res + (long)match_arr[0].length + (long)match_arr[1].length + (long)replace_res + (long)text_and_target.length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:29:26.880273 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 07:29:26.880402 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30310, Completion: 23980, Total: 54290
[2025-11-05 07:29:26.880422 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:29:27.097346 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000920/id_000920.cc
[2025-11-05 07:29:27.097400 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:27.325103 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:27.325178 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:27.327860 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:27.327893 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:27.545300 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000921/id_000921.cc
[2025-11-05 07:29:27.545355 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:27.773952 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:27.774027 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:27.776846 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:27.776883 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:27.994778 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000922/id_000922.cc
[2025-11-05 07:29:27.994864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:28.222319 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:28.222393 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:28.225123 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:28.225155 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:28.443068 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000923/id_000923.cc
[2025-11-05 07:29:28.443121 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:28.672310 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:28.672368 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:28.675110 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:28.675136 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:28.892699 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000924/id_000924.cc
[2025-11-05 07:29:28.892767 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:29.123222 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:29.123332 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:29.126216 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:29.126248 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:29.343780 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000925/id_000925.cc
[2025-11-05 07:29:29.343837 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:29.573511 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:29.573590 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:29.576297 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:29.576322 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:29.794361 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000926/id_000926.cc
[2025-11-05 07:29:29.794415 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:30.024167 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:30.024243 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:30.026977 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:30.027003 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:30.246667 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000927/id_000927.cc
[2025-11-05 07:29:30.246751 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:30.476072 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:30.476174 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:30.478962 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:30.478993 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:30.696716 +00:00] WARN [src/fuzzer.rs:205] Program 928 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000928/id_000928.cc:42:11: error: no matching function for call to 'cre2_set_new'
   42 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:29:30.754284 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:29:30.754630 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char easy_pattern[] = \"([a-z]+)\";\n    const int easy_pattern_len = (int)(sizeof(easy_pattern) - 1);\n    const char partial_pattern[] = \"(num)([0-9]+)\";\n    const char set_pattern_simple[] = \"alpha|beta|gamma\";\n    char text_buf[] = \"alpha 123 beta 456 gamma 789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_encoding_t encoding = CRE2_UNKNOWN;\n    cre2_string_t easy_matches[2];\n    cre2_string_t partial_matches[3];\n    cre2_string_t input_text;\n    int set_match_indices[8];\n    size_t set_match_count = 0;\n    int easy_res = 0;\n    int partial_res = 0;\n    int add_res = 0;\n    int compile_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n    encoding = cre2_opt_encoding(opt);\n    set = cre2_set_new(opt, 0);\n    add_res = cre2_set_add_simple(set, set_pattern_simple);\n    compile_res = cre2_set_compile(set);\n\n    // step 3: Core operations\n    memset(easy_matches, 0, sizeof(easy_matches));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    memset(set_match_indices, 0, sizeof(set_match_indices));\n    input_text.data = text_buf;\n    input_text.length = text_len;\n    easy_res = cre2_easy_match(easy_pattern, easy_pattern_len, text_buf, text_len, easy_matches, 2);\n    partial_res = cre2_partial_match(partial_pattern, &input_text, partial_matches, 3);\n    set_match_count = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, (size_t)(sizeof(set_match_indices) / sizeof(set_match_indices[0])));\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)easy_res + (long)partial_res + (long)easy_matches[0].length + (long)partial_matches[0].length + (long)encoding + (long)set_match_count + (long)add_res + (long)compile_res;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000928/id_000928.cc:42:11: error: no matching function for call to 'cre2_set_new'\n   42 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:29:51.845693 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 07:29:51.845818 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24180, Completion: 12562, Total: 36742
[2025-11-05 07:29:52.064538 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000928/id_000928.cc
[2025-11-05 07:29:52.064593 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:52.292163 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:52.292240 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:52.295075 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:52.295110 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:52.295143 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 928!
[2025-11-05 07:29:52.513504 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000929/id_000929.cc
[2025-11-05 07:29:52.513559 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:29:52.742046 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:29:52.742122 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:29:52.745054 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:29:52.745089 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:29:52.745130 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:29:52.745147 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 930, succ: 929, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:29:52.745163 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:29:52.745189 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:29:53.052821 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 929 as an example for the next prompt.
[2025-11-05 07:29:53.052901 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 14 new API pairs in this round.
[2025-11-05 07:29:53.052936 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 14
[2025-11-05 07:29:53.052986 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,124.0,118.0,28.0,24.0,70.0,27.0,29.0,196.0,16.0,18.0,302.0,115.0,27.0,106.0,19.0,169.0,73.0,87.0,75.0,103.0,42.0,31.0,16.0,18.0,30.0,119.0,89.0,16.0,24.0,71.0,185.0,28.0,548.0,155.0,157.0,18.0,48.0,54.0,28.0,295.0,20.0,24.0,85.0,20.0,10.0,82.0,237.0,13.0,16.0,125.0,14.0,26.0,70.0,19.0,222.0,25.0,44.0,21.0,21.0,123.0,33.0,162.0,40.0,44.0,13.0]
[2025-11-05 07:29:53.053006 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:29:53.053058 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 103
[2025-11-05 07:29:53.053090 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 237
[2025-11-05 07:29:53.053116 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 185
[2025-11-05 07:29:53.053140 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 85
[2025-11-05 07:29:53.053167 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 302
[2025-11-05 07:29:53.053217 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_set_delete(cre2_set * set),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 07:29:53.054033 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 93, quiet_round: 0, discovered_api_pairs: 1933
[2025-11-05 07:29:53.111653 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:29:53.112025 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_set_delete(cre2_set * set),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char easy_pattern[] = \"([0-9]+)\";\n    const int easy_pattern_len = (int)(sizeof(easy_pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char text_init[] = \"number 12345 and more 67890\";\n    char text_buf[128] = \"number 12345 and more 67890\";\n    const char rewrite_init[] = \"REPLACED\";\n    char rewrite_buf[128] = \"REPLACED\";\n    const int text_len = (int)(sizeof(text_init) - 1);\n    cre2_string_t match_arr[4];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_res = 0;\n    int match_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(match_arr, 0, sizeof(match_arr));\n    easy_res = cre2_easy_match(easy_pattern, easy_pattern_len, text_buf, text_len, match_arr, 2);\n    match_res = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 3);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_init) - 1);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)easy_res + (long)match_res + (long)match_arr[0].length + (long)match_arr[1].length + (long)replace_res + (long)text_and_target.length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char easy_pattern[] = \"([0-9]+)\";\n    const int easy_pattern_len = (int)(sizeof(easy_pattern) - 1);\n    const char text_buf[] = \"prefix 123 middle 456 suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_string_t easy_matches[2];\n    cre2_string_t input;\n    cre2_string_t partial_matches[3];\n    int set_match_indices[4];\n    size_t set_count = 0;\n    int easy_res = 0;\n    int partial_res = 0;\n    int add_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, \"123|456\");\n    memset(easy_matches, 0, sizeof(easy_matches));\n    easy_res = cre2_easy_match(easy_pattern, easy_pattern_len, text_buf, text_len, easy_matches, 2);\n    input.data = text_buf;\n    input.length = text_len;\n    memset(partial_matches, 0, sizeof(partial_matches));\n    partial_res = cre2_partial_match(\"prefix\\\\s*([0-9]+)\", &input, partial_matches, 2);\n    memset(set_match_indices, -1, sizeof(set_match_indices));\n    set_count = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, 4);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)enc + (long)easy_res + (long)partial_res + (long)set_count + (long)easy_matches[0].length + (long)partial_matches[0].length + (long)add_res + (long)set_match_indices[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:30:34.110099 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 07:30:34.110217 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31360, Completion: 22307, Total: 53667
[2025-11-05 07:30:34.110237 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:30:34.329557 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000930/id_000930.cc
[2025-11-05 07:30:34.329610 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:34.558832 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:34.558905 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:34.561802 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:34.561833 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:34.778194 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000931/id_000931.cc
[2025-11-05 07:30:34.778247 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:35.005855 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:35.005924 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:35.008678 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:35.008727 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:35.225482 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000932/id_000932.cc
[2025-11-05 07:30:35.225566 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:35.453336 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:35.453411 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:35.456227 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:35.456259 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:35.673670 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000933/id_000933.cc
[2025-11-05 07:30:35.673724 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:35.902551 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:35.902624 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:35.905483 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:35.905515 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:36.123238 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000934/id_000934.cc
[2025-11-05 07:30:36.123289 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:36.351626 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:36.351734 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:36.354674 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:36.354706 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:36.573040 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000935/id_000935.cc
[2025-11-05 07:30:36.573091 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:36.803847 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:36.803918 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:36.806728 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:36.806754 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:37.026922 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000936/id_000936.cc
[2025-11-05 07:30:37.026975 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:37.256147 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:37.256218 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:37.259172 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:37.259205 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:37.475942 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000937/id_000937.cc
[2025-11-05 07:30:37.476025 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:37.703043 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:37.703113 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:37.706042 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:37.706099 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:37.924139 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000938/id_000938.cc
[2025-11-05 07:30:37.924193 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:38.150963 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:38.151037 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:38.153902 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:38.153934 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:38.371011 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000939/id_000939.cc
[2025-11-05 07:30:38.371062 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:30:38.599584 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:30:38.599697 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:30:38.602584 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:30:38.602614 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:30:38.602657 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:30:38.602677 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 940, succ: 939, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:30:38.602696 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:30:38.602727 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:30:38.897338 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 939 as an example for the next prompt.
[2025-11-05 07:30:38.897395 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 07:30:38.897427 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 07:30:38.897475 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,124.0,118.0,28.0,24.0,73.0,27.0,29.0,197.0,16.0,18.0,306.0,115.0,27.0,106.0,19.0,169.0,73.0,87.0,75.0,107.0,42.0,31.0,16.0,18.0,30.0,120.0,89.0,16.0,24.0,71.0,185.0,28.0,549.0,155.0,157.0,18.0,48.0,54.0,28.0,295.0,20.0,24.0,91.0,20.0,10.0,82.0,237.0,13.0,16.0,129.0,14.0,26.0,70.0,19.0,222.0,25.0,44.0,21.0,21.0,123.0,33.0,162.0,40.0,44.0,13.0]
[2025-11-05 07:30:38.897493 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:30:38.897546 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume energy: 30
[2025-11-05 07:30:38.897579 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 120
[2025-11-05 07:30:38.897606 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 306
[2025-11-05 07:30:38.897630 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_dot_nl energy: 40
[2025-11-05 07:30:38.897663 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_set_compile(cre2_set * set),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_opt_dot_nl(cre2_options_t * opt)
[2025-11-05 07:30:38.898363 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 94, quiet_round: 0, discovered_api_pairs: 1943
[2025-11-05 07:30:38.934124 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:30:38.934497 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_set_compile(cre2_set * set),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_opt_dot_nl(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char easy_pattern[] = \"([0-9]+)\";\n    const int easy_pattern_len = (int)(sizeof(easy_pattern) - 1);\n    const char text_buf[] = \"prefix 123 middle 456 suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_string_t easy_matches[2];\n    cre2_string_t input;\n    cre2_string_t partial_matches[3];\n    int set_match_indices[4];\n    size_t set_count = 0;\n    int easy_res = 0;\n    int partial_res = 0;\n    int add_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, \"123|456\");\n    memset(easy_matches, 0, sizeof(easy_matches));\n    easy_res = cre2_easy_match(easy_pattern, easy_pattern_len, text_buf, text_len, easy_matches, 2);\n    input.data = text_buf;\n    input.length = text_len;\n    memset(partial_matches, 0, sizeof(partial_matches));\n    partial_res = cre2_partial_match(\"prefix\\\\s*([0-9]+)\", &input, partial_matches, 2);\n    memset(set_match_indices, -1, sizeof(set_match_indices));\n    set_count = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, 4);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)enc + (long)easy_res + (long)partial_res + (long)set_count + (long)easy_matches[0].length + (long)partial_matches[0].length + (long)add_res + (long)set_match_indices[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char partial_pat[] = \"prefix\\\\s*([0-9]+)\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char text_buf[] = \"prefix 12345 suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t input;\n    cre2_string_t partial_matches[3];\n    int set_match_indices[4];\n    int add_res = 0;\n    int partial_res = 0;\n    size_t set_count = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, \"12345|67890\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    input.data = text_buf;\n    input.length = text_len;\n    memset(partial_matches, 0, sizeof(partial_matches));\n    partial_res = cre2_partial_match(partial_pat, &input, partial_matches, 2);\n    memset(set_match_indices, -1, sizeof(set_match_indices));\n    set_count = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, 4);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)enc + (long)partial_res + (long)set_count + (long)add_res + (long)partial_matches[0].length + (long)set_match_indices[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:31:13.024042 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 07:31:13.024170 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30550, Completion: 22968, Total: 53518
[2025-11-05 07:31:13.024191 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:31:13.242569 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000940/id_000940.cc
[2025-11-05 07:31:13.242625 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:13.471848 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:13.471905 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:13.474743 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:13.474774 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:13.693536 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000941/id_000941.cc
[2025-11-05 07:31:13.693589 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:13.922964 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:13.923033 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:13.925799 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:13.925831 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:14.145303 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000942/id_000942.cc
[2025-11-05 07:31:14.145386 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:14.374931 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:14.375008 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:14.377824 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:14.377858 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:14.595193 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000943/id_000943.cc
[2025-11-05 07:31:14.595260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:14.823338 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:14.823396 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:14.826085 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:14.826116 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:15.043876 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000944/id_000944.cc
[2025-11-05 07:31:15.043930 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:15.272911 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:15.273016 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:15.275796 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:15.275829 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:15.493818 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000945/id_000945.cc
[2025-11-05 07:31:15.493873 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:15.721938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:15.722003 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:15.724616 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:15.724656 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:15.941061 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000946/id_000946.cc
[2025-11-05 07:31:15.941114 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:16.171003 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:16.171070 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:16.174044 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:16.174076 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:16.392252 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000947/id_000947.cc
[2025-11-05 07:31:16.392338 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:16.622368 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:16.622446 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:16.625310 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:16.625342 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:16.844319 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000948/id_000948.cc
[2025-11-05 07:31:16.844373 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:17.074691 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:17.074763 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:17.077623 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:17.077656 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:17.295689 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000949/id_000949.cc
[2025-11-05 07:31:17.295744 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:31:17.525353 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:31:17.525459 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:31:17.528274 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:31:17.528306 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:31:17.528343 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:31:17.528360 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 950, succ: 949, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:31:17.528379 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:31:17.528404 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:31:17.824699 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 949 as an example for the next prompt.
[2025-11-05 07:31:17.824757 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 07:31:17.824794 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 07:31:17.824843 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,124.0,118.0,28.0,24.0,73.0,27.0,29.0,197.0,16.0,18.0,308.0,115.0,27.0,108.0,19.0,172.0,73.0,87.0,75.0,108.0,42.0,31.0,16.0,18.0,34.0,120.0,89.0,16.0,24.0,71.0,188.0,28.0,549.0,155.0,163.0,18.0,48.0,54.0,28.0,295.0,20.0,24.0,91.0,20.0,10.0,82.0,237.0,13.0,16.0,130.0,14.0,26.0,70.0,19.0,222.0,25.0,44.0,21.0,21.0,123.0,33.0,164.0,52.0,49.0,13.0]
[2025-11-05 07:31:17.824863 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:31:17.824917 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 155
[2025-11-05 07:31:17.824949 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 197
[2025-11-05 07:31:17.824977 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 222
[2025-11-05 07:31:17.825004 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 70
[2025-11-05 07:31:17.825037 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_opt_delete(cre2_options_t * opt)
[2025-11-05 07:31:17.825747 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 95, quiet_round: 0, discovered_api_pairs: 1958
[2025-11-05 07:31:17.855655 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:31:17.856125 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_opt_delete(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char partial_pat[] = \"prefix\\\\s*([0-9]+)\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char text_buf[] = \"prefix 12345 suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t input;\n    cre2_string_t partial_matches[3];\n    int set_match_indices[4];\n    int add_res = 0;\n    int partial_res = 0;\n    size_t set_count = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, \"12345|67890\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    input.data = text_buf;\n    input.length = text_len;\n    memset(partial_matches, 0, sizeof(partial_matches));\n    partial_res = cre2_partial_match(partial_pat, &input, partial_matches, 2);\n    memset(set_match_indices, -1, sizeof(set_match_indices));\n    set_count = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, 4);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)enc + (long)partial_res + (long)set_count + (long)add_res + (long)partial_matches[0].length + (long)set_match_indices[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char set_pattern[] = \"foo|bar\";\n    const char re_pattern[] = \"([a-z]+)([0-9]+)\";\n    const char find_pattern[] = \"prefix\\\\s*([0-9]+)\";\n    const char text_buf[] = \"prefix 777 suffix foo123\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[3];\n    int add_res = 0;\n    int compile_res = 0;\n    int find_res = 0;\n    int dotnl_val = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_dot_nl(opt, 1);\n    dotnl_val = cre2_opt_dot_nl(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, set_pattern);\n    compile_res = cre2_set_compile(set);\n    re = cre2_new(re_pattern, (int)(sizeof(re_pattern) - 1), opt);\n    input.data = text_buf;\n    input.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    find_res = cre2_find_and_consume(find_pattern, &input, matches, 2);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)dotnl_val + (long)add_res + (long)compile_res + (long)find_res + (long)matches[0].length + (long)matches[1].length + (long)input.length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:32:01.394433 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 07:32:01.394564 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29820, Completion: 20721, Total: 50541
[2025-11-05 07:32:01.394588 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:32:01.610956 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000950/id_000950.cc
[2025-11-05 07:32:01.611008 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:01.836560 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:01.836649 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:01.839624 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:01.839655 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:02.056905 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000951/id_000951.cc
[2025-11-05 07:32:02.056960 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:02.283795 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:02.283872 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:02.287040 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:02.287074 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:02.505220 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000952/id_000952.cc
[2025-11-05 07:32:02.505304 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:02.732571 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:02.732653 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:02.735235 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:02.735261 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:02.952450 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000953/id_000953.cc
[2025-11-05 07:32:02.952501 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:03.177062 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:03.177140 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:03.180207 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:03.180240 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:03.398762 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000954/id_000954.cc
[2025-11-05 07:32:03.398818 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:03.626132 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:03.626267 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:03.629233 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:03.629265 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:03.844866 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000955/id_000955.cc
[2025-11-05 07:32:03.844921 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:04.071140 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:04.071214 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:04.074394 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:04.074427 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:04.290850 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000956/id_000956.cc
[2025-11-05 07:32:04.290909 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:04.516457 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:04.516516 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:04.519054 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:04.519082 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:04.735823 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000957/id_000957.cc
[2025-11-05 07:32:04.735909 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:04.964791 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:04.964864 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:04.967798 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:04.967832 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:05.183946 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000958/id_000958.cc
[2025-11-05 07:32:05.184002 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:05.411223 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:05.411298 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:05.414462 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:05.414496 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:05.630594 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000959/id_000959.cc
[2025-11-05 07:32:05.630648 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:05.856027 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:05.856139 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:05.859362 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:05.859391 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:05.859427 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:32:05.859442 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 960, succ: 959, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:32:05.859481 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:32:05.859513 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:32:06.130727 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 959 as an example for the next prompt.
[2025-11-05 07:32:06.130781 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 07:32:06.130821 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 07:32:06.130869 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,124.0,118.0,28.0,24.0,73.0,29.0,29.0,201.0,16.0,18.0,308.0,115.0,27.0,108.0,19.0,173.0,73.0,87.0,75.0,108.0,46.0,31.0,16.0,18.0,34.0,120.0,89.0,16.0,24.0,71.0,189.0,28.0,550.0,160.0,163.0,18.0,48.0,54.0,28.0,295.0,20.0,24.0,91.0,20.0,10.0,82.0,237.0,13.0,16.0,130.0,14.0,26.0,70.0,19.0,224.0,25.0,44.0,21.0,21.0,126.0,33.0,164.0,52.0,49.0,13.0]
[2025-11-05 07:32:06.130887 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:32:06.130940 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 163
[2025-11-05 07:32:06.130973 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 118
[2025-11-05 07:32:06.130998 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 126
[2025-11-05 07:32:06.131024 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 124
[2025-11-05 07:32:06.131051 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 201
[2025-11-05 07:32:06.131087 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_num_capturing_groups(const cre2_regexp_t * re)
[2025-11-05 07:32:06.131944 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 96, quiet_round: 0, discovered_api_pairs: 1967
[2025-11-05 07:32:06.176507 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:32:06.176878 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char set_pattern[] = \"foo|bar\";\n    const char re_pattern[] = \"([a-z]+)([0-9]+)\";\n    const char find_pattern[] = \"prefix\\\\s*([0-9]+)\";\n    const char text_buf[] = \"prefix 777 suffix foo123\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[3];\n    int add_res = 0;\n    int compile_res = 0;\n    int find_res = 0;\n    int dotnl_val = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_dot_nl(opt, 1);\n    dotnl_val = cre2_opt_dot_nl(opt);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, set_pattern);\n    compile_res = cre2_set_compile(set);\n    re = cre2_new(re_pattern, (int)(sizeof(re_pattern) - 1), opt);\n    input.data = text_buf;\n    input.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    find_res = cre2_find_and_consume(find_pattern, &input, matches, 2);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)dotnl_val + (long)add_res + (long)compile_res + (long)find_res + (long)matches[0].length + (long)matches[1].length + (long)input.length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * compiled_pat = NULL;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pat = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)num_groups + (long)pattern_len + (long)compiled_pat[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:32:51.653445 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 07:32:51.653562 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28860, Completion: 23046, Total: 51906
[2025-11-05 07:32:51.653582 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:32:51.875897 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000960/id_000960.cc
[2025-11-05 07:32:51.875949 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:52.109460 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:52.109525 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:52.112651 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:52.112682 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:52.329534 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000961/id_000961.cc
[2025-11-05 07:32:52.329588 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:52.559367 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:52.559434 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:52.562350 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:52.562380 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:52.780160 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000962/id_000962.cc
[2025-11-05 07:32:52.780244 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:53.008778 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:53.008849 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:53.011823 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:53.011848 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:53.230025 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000963/id_000963.cc
[2025-11-05 07:32:53.230078 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:53.458466 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:53.458529 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:53.461275 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:53.461302 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:53.680541 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000964/id_000964.cc
[2025-11-05 07:32:53.680596 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:53.909369 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:53.909469 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:53.912317 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:53.912349 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:54.131113 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000965/id_000965.cc
[2025-11-05 07:32:54.131167 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:54.359475 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:54.359546 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:54.362214 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:54.362251 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:54.580667 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000966/id_000966.cc
[2025-11-05 07:32:54.580732 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:54.807416 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:54.807525 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:54.810404 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:54.810430 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:55.030526 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000967/id_000967.cc
[2025-11-05 07:32:55.030625 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:55.259279 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:55.259346 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:55.262305 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:55.262342 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:55.479752 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000968/id_000968.cc
[2025-11-05 07:32:55.479810 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:55.709423 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:55.709497 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:55.712503 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:55.712540 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:55.931177 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000969/id_000969.cc
[2025-11-05 07:32:55.931235 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:32:56.161689 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:32:56.161801 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:32:56.164815 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:32:56.164846 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:32:56.164894 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:32:56.164914 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 970, succ: 969, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:32:56.164935 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:32:56.164967 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:32:56.463927 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 969 as an example for the next prompt.
[2025-11-05 07:32:56.463984 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 07:32:56.464024 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 07:32:56.464072 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,38.0,41.0,24.0,48.0,134.0,118.0,28.0,24.0,73.0,29.0,29.0,210.0,16.0,18.0,308.0,115.0,27.0,108.0,19.0,173.0,73.0,87.0,75.0,108.0,46.0,31.0,16.0,18.0,34.0,121.0,89.0,16.0,24.0,71.0,189.0,28.0,557.0,170.0,166.0,18.0,48.0,54.0,28.0,295.0,20.0,24.0,91.0,20.0,10.0,82.0,237.0,13.0,16.0,130.0,14.0,26.0,70.0,19.0,224.0,25.0,44.0,21.0,21.0,129.0,33.0,164.0,52.0,49.0,13.0]
[2025-11-05 07:32:56.464089 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:32:56.464142 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace energy: 38
[2025-11-05 07:32:56.464222 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 295
[2025-11-05 07:32:56.464250 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 70
[2025-11-05 07:32:56.464277 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 129
[2025-11-05 07:32:56.464304 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 75
[2025-11-05 07:32:56.464344 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_delete(cre2_options_t * opt),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 07:32:56.465163 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 97, quiet_round: 0, discovered_api_pairs: 1984
[2025-11-05 07:32:56.515494 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:32:56.515854 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_delete(cre2_options_t * opt),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * compiled_pat = NULL;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pat = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)num_groups + (long)pattern_len + (long)compiled_pat[0];\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 alice789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int num_groups = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Operate - create a set and compile regexp\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate - prepare buffers and perform replace using compiled re\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)num_groups + (long)replace_res + (long)text_and_target.length + (long)rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:33:55.144956 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 58s
[2025-11-05 07:33:55.145083 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28410, Completion: 27109, Total: 55519
[2025-11-05 07:33:55.145107 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:33:55.362816 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000970/id_000970.cc
[2025-11-05 07:33:55.362870 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:55.594529 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:55.594603 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:55.597771 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:55.597804 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:55.815432 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000971/id_000971.cc
[2025-11-05 07:33:55.815486 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:56.046543 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:56.046618 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:56.049742 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:56.049773 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:56.268440 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000972/id_000972.cc
[2025-11-05 07:33:56.268538 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:56.498903 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:56.498983 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:56.502287 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:56.502316 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:56.720014 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000973/id_000973.cc
[2025-11-05 07:33:56.720077 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:56.949951 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:56.950033 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:56.952934 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:56.952966 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:57.170617 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000974/id_000974.cc
[2025-11-05 07:33:57.170677 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:57.401085 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:57.401203 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:57.404249 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:57.404286 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:57.621136 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000975/id_000975.cc
[2025-11-05 07:33:57.621198 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:57.851123 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:57.851204 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:57.854418 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:57.854446 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:58.072723 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000976/id_000976.cc
[2025-11-05 07:33:58.072779 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:58.303301 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:58.303377 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:58.306598 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:58.306626 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:58.524731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000977/id_000977.cc
[2025-11-05 07:33:58.524818 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:58.753336 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:58.753412 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:58.756432 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:58.756464 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:58.973636 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000978/id_000978.cc
[2025-11-05 07:33:58.973690 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:59.202067 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:59.202145 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:59.205438 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:59.205468 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:59.423778 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000979/id_000979.cc
[2025-11-05 07:33:59.423833 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:33:59.653854 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:33:59.653975 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:33:59.657085 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:33:59.657113 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:33:59.657155 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:33:59.657174 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 980, succ: 979, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:33:59.657191 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:33:59.657219 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:33:59.974134 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 979 as an example for the next prompt.
[2025-11-05 07:33:59.974190 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 31 new API pairs in this round.
[2025-11-05 07:33:59.974241 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 31
[2025-11-05 07:33:59.974289 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,134.0,118.0,28.0,24.0,73.0,29.0,29.0,211.0,16.0,18.0,309.0,115.0,27.0,108.0,19.0,174.0,73.0,87.0,90.0,108.0,46.0,31.0,16.0,18.0,34.0,121.0,89.0,16.0,24.0,71.0,192.0,28.0,561.0,177.0,166.0,18.0,48.0,54.0,28.0,311.0,20.0,24.0,91.0,20.0,10.0,82.0,237.0,13.0,16.0,130.0,14.0,26.0,70.0,19.0,224.0,25.0,44.0,21.0,21.0,136.0,33.0,164.0,52.0,49.0,13.0]
[2025-11-05 07:33:59.974307 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:33:59.974360 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 309
[2025-11-05 07:33:59.974391 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 118
[2025-11-05 07:33:59.974417 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 224
[2025-11-05 07:33:59.974444 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 192
[2025-11-05 07:33:59.974475 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)
[2025-11-05 07:33:59.975181 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 98, quiet_round: 0, discovered_api_pairs: 2015
[2025-11-05 07:34:00.007559 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:34:00.007908 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 alice789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int num_groups = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Operate - create a set and compile regexp\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate - prepare buffers and perform replace using compiled re\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)num_groups + (long)replace_res + (long)text_and_target.length + (long)rewrite.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 alice789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf1[128];\n    char rewrite_buf2[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite1;\n    cre2_string_t rewrite2;\n    cre2_string_t match;\n    int easy_match_res = 0;\n    int global_replace_res = 0;\n    int global_replace_re_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Core operations\n    memset(rewrite_buf1, 0, sizeof(rewrite_buf1));\n    memset(rewrite_buf2, 0, sizeof(rewrite_buf2));\n    match.data = NULL;\n    match.length = 0;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite1.data = rewrite_buf1;\n    rewrite1.length = 0;\n    rewrite2.data = rewrite_buf2;\n    rewrite2.length = 0;\n    easy_match_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n    global_replace_res = cre2_global_replace(pattern, &text_and_target, &rewrite1);\n    global_replace_re_res = cre2_global_replace_re(re, &text_and_target, &rewrite2);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)easy_match_res + (long)global_replace_res + (long)global_replace_re_res + (long)text_and_target.length + (long)rewrite1.length + (long)rewrite2.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:34:36.996763 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 07:34:36.996887 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30500, Completion: 21583, Total: 52083
[2025-11-05 07:34:36.996908 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:34:37.214542 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000980/id_000980.cc
[2025-11-05 07:34:37.214597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:37.444478 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:37.444554 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:37.447596 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:37.447629 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:37.667311 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000981/id_000981.cc
[2025-11-05 07:34:37.667364 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:37.896509 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:37.896584 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:37.899610 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:37.899642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:38.116841 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000982/id_000982.cc
[2025-11-05 07:34:38.116924 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:38.345730 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:38.345807 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:38.348644 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:38.348677 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:38.567879 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000983/id_000983.cc
[2025-11-05 07:34:38.567946 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:38.795590 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:38.795666 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:38.798856 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:38.798889 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:39.017191 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000984/id_000984.cc
[2025-11-05 07:34:39.017248 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:39.247565 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:39.247681 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:39.250661 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:39.250694 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:39.466875 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000985/id_000985.cc
[2025-11-05 07:34:39.466928 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:39.695578 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:39.695655 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:39.698859 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:39.698892 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:39.916541 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000986/id_000986.cc
[2025-11-05 07:34:39.916594 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:40.145743 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:40.145819 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:40.148573 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:40.148605 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:40.366875 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000987/id_000987.cc
[2025-11-05 07:34:40.366958 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:40.596445 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:40.596522 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:40.599545 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:40.599579 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:40.818110 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000988/id_000988.cc
[2025-11-05 07:34:40.818162 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:41.047177 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:41.047254 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:41.050504 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:41.050537 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:41.267180 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000989/id_000989.cc
[2025-11-05 07:34:41.267236 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:34:41.495843 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:34:41.495961 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:34:41.499171 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:34:41.499204 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:34:41.499242 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:34:41.499257 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 990, succ: 989, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:34:41.499271 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:34:41.499296 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:34:41.794173 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 989 as an example for the next prompt.
[2025-11-05 07:34:41.794229 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 07:34:41.794264 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 07:34:41.794312 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,138.0,119.0,28.0,24.0,73.0,29.0,29.0,218.0,16.0,18.0,310.0,115.0,27.0,108.0,19.0,174.0,73.0,87.0,92.0,108.0,46.0,31.0,16.0,18.0,34.0,121.0,89.0,16.0,24.0,71.0,193.0,28.0,563.0,177.0,166.0,18.0,48.0,54.0,28.0,316.0,20.0,24.0,91.0,20.0,10.0,82.0,237.0,13.0,16.0,130.0,14.0,26.0,70.0,19.0,228.0,25.0,44.0,21.0,21.0,138.0,33.0,164.0,52.0,49.0,13.0]
[2025-11-05 07:34:41.794329 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:34:41.794382 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 563
[2025-11-05 07:34:41.794412 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 164
[2025-11-05 07:34:41.794444 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 237
[2025-11-05 07:34:41.794470 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 177
[2025-11-05 07:34:41.794503 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)
[2025-11-05 07:34:41.795230 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 99, quiet_round: 0, discovered_api_pairs: 2027
[2025-11-05 07:34:41.831618 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:34:41.831971 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 alice789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf1[128];\n    char rewrite_buf2[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite1;\n    cre2_string_t rewrite2;\n    cre2_string_t match;\n    int easy_match_res = 0;\n    int global_replace_res = 0;\n    int global_replace_re_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Core operations\n    memset(rewrite_buf1, 0, sizeof(rewrite_buf1));\n    memset(rewrite_buf2, 0, sizeof(rewrite_buf2));\n    match.data = NULL;\n    match.length = 0;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite1.data = rewrite_buf1;\n    rewrite1.length = 0;\n    rewrite2.data = rewrite_buf2;\n    rewrite2.length = 0;\n    easy_match_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n    global_replace_res = cre2_global_replace(pattern, &text_and_target, &rewrite1);\n    global_replace_re_res = cre2_global_replace_re(re, &text_and_target, &rewrite2);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)easy_match_res + (long)global_replace_res + (long)global_replace_re_res + (long)text_and_target.length + (long)rewrite1.length + (long)rewrite2.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 alice789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_match_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate - compile the regexp and obtain its pattern\n    re = cre2_new(pattern, pattern_len, opt);\n    const char * pat_from_re = cre2_pattern(re);\n\n    // step 4: Operate - perform an easy match and a replace using the compiled regexp\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    match.data = NULL;\n    match.length = 0;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    easy_match_res = cre2_easy_match(pat_from_re, pattern_len, text_buf, text_len, &match, 1);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)easy_match_res + (long)replace_res + (long)text_and_target.length + (long)rewrite.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:35:31.069334 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 49s
[2025-11-05 07:35:31.069457 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30890, Completion: 24955, Total: 55845
[2025-11-05 07:35:31.069477 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:35:31.287431 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000990/id_000990.cc
[2025-11-05 07:35:31.287486 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:31.516970 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:31.517046 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:31.519988 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:31.520021 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:31.738869 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000991/id_000991.cc
[2025-11-05 07:35:31.738922 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:31.968666 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:31.968741 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:31.971787 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:31.971821 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:32.190038 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000992/id_000992.cc
[2025-11-05 07:35:32.190123 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:32.419616 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:32.419693 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:32.422757 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:32.422790 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:32.639042 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000993/id_000993.cc
[2025-11-05 07:35:32.639095 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:32.869555 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:32.869632 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:32.872478 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:32.872509 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:33.090935 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000994/id_000994.cc
[2025-11-05 07:35:33.090988 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:33.319991 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:33.320106 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:33.323380 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:33.323413 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:33.540810 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000995/id_000995.cc
[2025-11-05 07:35:33.540864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:33.770656 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:33.770734 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:33.773973 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:33.774006 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:33.992132 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000996/id_000996.cc
[2025-11-05 07:35:33.992186 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:34.220806 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:34.220882 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:34.223846 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:34.223878 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:34.441121 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000997/id_000997.cc
[2025-11-05 07:35:34.441204 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:34.670738 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:34.670815 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:34.674042 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:34.674074 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:34.891938 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000998/id_000998.cc
[2025-11-05 07:35:34.891994 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:35.129209 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:35.129286 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:35.132174 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:35.132207 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:35.349045 +00:00] WARN [src/fuzzer.rs:205] Program 999 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_000999/id_000999.cc:38:11: error: no matching function for call to 'cre2_set_new'
   38 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:35:35.385520 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:35:35.385859 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    cre2_set *set = NULL;\n    int set_add_res = 0;\n    int num_groups = 0;\n    int prog_size = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Operate - compile regexp, create iterator and a set, add pattern to set\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    set = cre2_set_new(opt, 0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate - query regexp and options for meaningful data flow\n    num_groups = cre2_num_capturing_groups(re);\n    prog_size = cre2_program_size(re);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_add_res + (long)num_groups + (long)prog_size + (long)enc + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_000999/id_000999.cc:38:11: error: no matching function for call to 'cre2_set_new'\n   38 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:35:55.585048 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 20s
[2025-11-05 07:35:55.585176 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22470, Completion: 10034, Total: 32504
[2025-11-05 07:35:55.803184 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_000999/id_000999.cc
[2025-11-05 07:35:55.803239 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:35:56.032310 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:35:56.032368 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:35:56.035368 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:35:56.035400 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:35:56.035432 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 999!
[2025-11-05 07:35:56.035468 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:35:56.035484 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1000, succ: 999, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:35:56.035517 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:35:56.035544 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:35:56.325239 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 999 as an example for the next prompt.
[2025-11-05 07:35:56.325294 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 07:35:56.325330 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 07:35:56.325377 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,120.0,28.0,24.0,76.0,29.0,29.0,223.0,16.0,18.0,310.0,115.0,27.0,108.0,19.0,174.0,73.0,89.0,92.0,110.0,46.0,31.0,16.0,18.0,34.0,122.0,89.0,16.0,24.0,71.0,195.0,28.0,564.0,179.0,167.0,18.0,48.0,54.0,28.0,317.0,20.0,24.0,91.0,20.0,10.0,82.0,242.0,13.0,16.0,132.0,14.0,26.0,70.0,19.0,228.0,25.0,44.0,21.0,21.0,143.0,33.0,167.0,52.0,49.0,13.0]
[2025-11-05 07:35:56.325396 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:35:56.325448 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 564
[2025-11-05 07:35:56.325477 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 310
[2025-11-05 07:35:56.325507 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 92
[2025-11-05 07:35:56.325533 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 195
[2025-11-05 07:35:56.325558 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 167
[2025-11-05 07:35:56.325596 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 07:35:56.326422 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 100, quiet_round: 0, discovered_api_pairs: 2040
[2025-11-05 07:35:56.371475 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:35:56.371830 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 alice789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_match_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Operate - compile the regexp and obtain its pattern\n    re = cre2_new(pattern, pattern_len, opt);\n    const char * pat_from_re = cre2_pattern(re);\n\n    // step 4: Operate - perform an easy match and a replace using the compiled regexp\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    match.data = NULL;\n    match.length = 0;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    easy_match_res = cre2_easy_match(pat_from_re, pattern_len, text_buf, text_len, &match, 1);\n    replace_res = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)easy_match_res + (long)replace_res + (long)text_and_target.length + (long)rewrite.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    cre2_set *set = NULL;\n    int set_add_res = 0;\n    int num_groups = 0;\n    int prog_size = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Operate - compile regexp, create iterator and a set, add pattern to set\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    /* cre2_set_new expects a cre2_anchor_t for the second arg; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate - query regexp and options for meaningful data flow\n    num_groups = cre2_num_capturing_groups(re);\n    prog_size = cre2_program_size(re);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_add_res + (long)num_groups + (long)prog_size + (long)enc + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:36:34.260643 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 07:36:34.260773 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29850, Completion: 19185, Total: 49035
[2025-11-05 07:36:34.260821 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:36:34.480049 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001000/id_001000.cc
[2025-11-05 07:36:34.480105 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:34.708158 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:34.708218 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:34.711259 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:34.711292 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:34.928884 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001001/id_001001.cc
[2025-11-05 07:36:34.928937 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:35.157557 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:35.157628 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:35.160192 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:35.160224 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:35.379053 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001002/id_001002.cc
[2025-11-05 07:36:35.379138 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:35.609807 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:35.609876 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:35.613073 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:35.613106 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:35.830694 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001003/id_001003.cc
[2025-11-05 07:36:35.830748 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:36.057733 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:36.057792 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:36.060969 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:36.061002 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:36.278191 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001004/id_001004.cc
[2025-11-05 07:36:36.278244 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:36.507889 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:36.507973 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:36.510805 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:36.510837 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:36.728717 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001005/id_001005.cc
[2025-11-05 07:36:36.728771 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:36.958843 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:36.958914 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:36.961805 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:36.961837 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:37.179130 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001006/id_001006.cc
[2025-11-05 07:36:37.179183 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:37.409243 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:37.409315 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:37.411908 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:37.411935 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:37.629392 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001007/id_001007.cc
[2025-11-05 07:36:37.629479 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:37.858231 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:37.858299 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:37.860987 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:37.861019 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:38.079457 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001008/id_001008.cc
[2025-11-05 07:36:38.079509 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:38.308828 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:38.308903 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:38.311893 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:38.311925 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:38.529187 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001009/id_001009.cc
[2025-11-05 07:36:38.529239 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:36:38.759979 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:36:38.760078 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:36:38.762964 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:36:38.762997 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:36:38.763033 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:36:38.763049 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1010, succ: 1009, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:36:38.763064 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:36:38.763090 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:36:39.046589 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1009 as an example for the next prompt.
[2025-11-05 07:36:39.046644 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 4 new API pairs in this round.
[2025-11-05 07:36:39.046670 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 4
[2025-11-05 07:36:39.046717 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,120.0,28.0,24.0,76.0,29.0,29.0,223.0,16.0,18.0,310.0,115.0,27.0,108.0,19.0,174.0,73.0,89.0,95.0,111.0,46.0,31.0,16.0,18.0,34.0,122.0,89.0,16.0,24.0,71.0,195.0,28.0,566.0,179.0,167.0,18.0,48.0,54.0,28.0,317.0,20.0,24.0,91.0,20.0,10.0,82.0,242.0,13.0,16.0,132.0,14.0,26.0,70.0,19.0,228.0,25.0,44.0,21.0,21.0,143.0,33.0,169.0,52.0,49.0,13.0]
[2025-11-05 07:36:39.046749 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:36:39.046800 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 44
[2025-11-05 07:36:39.046833 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 566
[2025-11-05 07:36:39.046858 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 317
[2025-11-05 07:36:39.046885 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 242
[2025-11-05 07:36:39.046914 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 95
[2025-11-05 07:36:39.046952 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 07:36:39.047761 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 101, quiet_round: 0, discovered_api_pairs: 2044
[2025-11-05 07:36:39.099859 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:36:39.100219 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    cre2_set *set = NULL;\n    int set_add_res = 0;\n    int num_groups = 0;\n    int prog_size = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 3: Operate - compile regexp, create iterator and a set, add pattern to set\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    /* cre2_set_new expects a cre2_anchor_t for the second arg; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate - query regexp and options for meaningful data flow\n    num_groups = cre2_num_capturing_groups(re);\n    prog_size = cre2_program_size(re);\n    enc = cre2_opt_encoding(opt);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_add_res + (long)num_groups + (long)prog_size + (long)enc + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 carol789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[256];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int set_add_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Core operations - compile regexp and create set\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate - prepare buffers and perform global replace using compiled regexp\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_add_res + (long)replace_res + (long)text_and_target.length + (long)rewrite.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:37:18.052864 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 07:37:18.052985 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29900, Completion: 20816, Total: 50716
[2025-11-05 07:37:18.053005 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:37:18.271216 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001010/id_001010.cc
[2025-11-05 07:37:18.271271 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:18.500331 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:18.500407 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:18.503344 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:18.503378 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:18.721431 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001011/id_001011.cc
[2025-11-05 07:37:18.721487 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:18.948938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:18.949014 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:18.951872 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:18.951906 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:19.169578 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001012/id_001012.cc
[2025-11-05 07:37:19.169663 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:19.399645 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:19.399722 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:19.402600 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:19.402634 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:19.620590 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001013/id_001013.cc
[2025-11-05 07:37:19.620658 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:19.850276 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:19.850353 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:19.853230 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:19.853263 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:20.071589 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001014/id_001014.cc
[2025-11-05 07:37:20.071643 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:20.299690 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:20.299807 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:20.302654 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:20.302688 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:20.520767 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001015/id_001015.cc
[2025-11-05 07:37:20.520820 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:20.750239 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:20.750317 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:20.753250 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:20.753283 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:20.972091 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001016/id_001016.cc
[2025-11-05 07:37:20.972145 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:21.201650 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:21.201751 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:21.204497 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:21.204529 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:21.421791 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001017/id_001017.cc
[2025-11-05 07:37:21.421876 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:21.650217 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:21.650295 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:21.653202 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:21.653235 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:21.870596 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001018/id_001018.cc
[2025-11-05 07:37:21.870651 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:22.099176 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:22.099253 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:22.102162 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:22.102197 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:22.319339 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001019/id_001019.cc
[2025-11-05 07:37:22.319395 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:37:22.548443 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:37:22.548555 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:37:22.551158 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:37:22.551185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:37:22.551222 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:37:22.551238 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1020, succ: 1019, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:37:22.551252 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:37:22.551278 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:37:22.849184 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1019 as an example for the next prompt.
[2025-11-05 07:37:22.849240 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 07:37:22.849274 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 07:37:22.849322 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,124.0,28.0,24.0,76.0,29.0,29.0,223.0,16.0,18.0,312.0,115.0,27.0,108.0,19.0,175.0,73.0,89.0,100.0,111.0,46.0,31.0,16.0,18.0,34.0,122.0,89.0,16.0,24.0,71.0,195.0,28.0,571.0,179.0,167.0,18.0,48.0,54.0,28.0,323.0,20.0,24.0,91.0,20.0,10.0,82.0,248.0,13.0,16.0,132.0,14.0,26.0,70.0,19.0,228.0,25.0,49.0,21.0,21.0,143.0,33.0,169.0,52.0,49.0,13.0]
[2025-11-05 07:37:22.849341 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:37:22.849394 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 175
[2025-11-05 07:37:22.849437 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 91
[2025-11-05 07:37:22.849477 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 195
[2025-11-05 07:37:22.849504 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 33
[2025-11-05 07:37:22.849537 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:37:22.850231 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 102, quiet_round: 0, discovered_api_pairs: 2057
[2025-11-05 07:37:22.886307 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:37:22.886659 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 carol789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[256];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int set_add_res = 0;\n    int replace_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Core operations - compile regexp and create set\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate - prepare buffers and perform global replace using compiled regexp\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_add_res + (long)replace_res + (long)text_and_target.length + (long)rewrite.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"\\\\bfoo\\\\b\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo bar baz fooqux foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char match_buf[64];\n    char rewrite_buf[256];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_res = 0;\n    int replace_res = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 3: Operate - compile regexp and perform a simple easy_match\n    re = cre2_new(pattern, pattern_len, opt);\n    match.data = match_buf;\n    match.length = 0;\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 4: Operate - prepare buffers and perform global replace using compiled regexp\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    enc = cre2_opt_encoding(opt);\n    computed_check = (long)easy_res + (long)replace_res + (long)match.length + (long)text_and_target.length + (long)enc + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:38:00.253223 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 07:38:00.253341 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29260, Completion: 21102, Total: 50362
[2025-11-05 07:38:00.253362 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:38:00.470747 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001020/id_001020.cc
[2025-11-05 07:38:00.470802 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:00.699258 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:00.699330 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:00.702165 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:00.702196 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:00.919580 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001021/id_001021.cc
[2025-11-05 07:38:00.919635 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:01.148376 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:01.148451 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:01.151188 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:01.151215 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:01.368243 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001022/id_001022.cc
[2025-11-05 07:38:01.368344 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:01.598354 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:01.598428 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:01.601155 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:01.601188 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:01.818759 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001023/id_001023.cc
[2025-11-05 07:38:01.818816 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:02.049249 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:02.049323 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:02.052049 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:02.052080 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:02.271205 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001024/id_001024.cc
[2025-11-05 07:38:02.271260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:02.501198 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:02.501309 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:02.503892 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:02.503924 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:02.721204 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001025/id_001025.cc
[2025-11-05 07:38:02.721262 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:02.951730 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:02.951802 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:02.954567 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:02.954600 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:03.173538 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001026/id_001026.cc
[2025-11-05 07:38:03.173597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:03.402557 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:03.402632 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:03.405517 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:03.405550 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:03.625368 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001027/id_001027.cc
[2025-11-05 07:38:03.625455 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:03.853712 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:03.853786 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:03.856508 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:03.856540 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:04.074076 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001028/id_001028.cc
[2025-11-05 07:38:04.074135 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:04.303646 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:04.303721 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:04.306528 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:04.306560 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:04.522597 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001029/id_001029.cc
[2025-11-05 07:38:04.522655 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:04.752795 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:04.752905 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:04.755678 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:04.755712 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:04.755751 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:38:04.755767 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1030, succ: 1029, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:38:04.755781 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:38:04.755807 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:38:05.049369 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1029 as an example for the next prompt.
[2025-11-05 07:38:05.049427 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 7 new API pairs in this round.
[2025-11-05 07:38:05.049456 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 7
[2025-11-05 07:38:05.049504 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,124.0,28.0,24.0,76.0,29.0,29.0,223.0,16.0,18.0,312.0,115.0,27.0,108.0,19.0,175.0,73.0,89.0,100.0,111.0,46.0,31.0,16.0,18.0,34.0,122.0,89.0,16.0,24.0,71.0,196.0,28.0,571.0,179.0,167.0,18.0,48.0,54.0,28.0,323.0,20.0,24.0,97.0,20.0,10.0,82.0,248.0,13.0,16.0,132.0,14.0,26.0,73.0,19.0,228.0,25.0,49.0,21.0,21.0,143.0,39.0,169.0,52.0,49.0,13.0]
[2025-11-05 07:38:05.049522 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:38:05.049606 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 132
[2025-11-05 07:38:05.049637 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 167
[2025-11-05 07:38:05.049666 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_possible_match_range energy: 19
[2025-11-05 07:38:05.049694 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 571
[2025-11-05 07:38:05.049730 +00:00] INFO [src/request/prompt.rs:145] set combination: size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 07:38:05.050438 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 103, quiet_round: 0, discovered_api_pairs: 2064
[2025-11-05 07:38:05.100640 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:38:05.101025 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nsize_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"\\\\bfoo\\\\b\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo bar baz fooqux foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char match_buf[64];\n    char rewrite_buf[256];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_res = 0;\n    int replace_res = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 3: Operate - compile regexp and perform a simple easy_match\n    re = cre2_new(pattern, pattern_len, opt);\n    match.data = match_buf;\n    match.length = 0;\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 4: Operate - prepare buffers and perform global replace using compiled regexp\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = 0;\n    replace_res = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate / compute lightweight checksum\n    enc = cre2_opt_encoding(opt);\n    computed_check = (long)easy_res + (long)replace_res + (long)match.length + (long)text_and_target.length + (long)enc + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 carol789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char match0_buf[64];\n    char match1_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[2];\n    int consume_res = 0;\n    int partial_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup (initialize options and buffers)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    memset(match0_buf, 0, sizeof(match0_buf));\n    memset(match1_buf, 0, sizeof(match1_buf));\n\n    // step 3: Prepare cre2_string_t structures\n    subject.data = text_buf;\n    subject.length = text_len;\n    matches[0].data = match0_buf;\n    matches[0].length = 0;\n    matches[1].data = match1_buf;\n    matches[1].length = 0;\n\n    // step 4: Operate - consume from the start and attempt a partial match\n    consume_res = cre2_consume(pattern, &subject, matches, 2);\n    partial_res = cre2_partial_match(pattern, &subject, matches, 2);\n\n    // step 5: Validate / compute lightweight checksum (use results and lengths meaningfully)\n    computed_check = (long)consume_res + (long)partial_res + (long)matches[0].length + (long)matches[1].length + (long)pattern_len + (long)subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:38:45.341932 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 07:38:45.342051 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30130, Completion: 21017, Total: 51147
[2025-11-05 07:38:45.342072 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:38:45.561797 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001030/id_001030.cc
[2025-11-05 07:38:45.561852 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:45.794345 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:45.794419 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:45.797150 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:45.797182 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:46.015554 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001031/id_001031.cc
[2025-11-05 07:38:46.015612 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:46.244955 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:46.245028 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:46.247923 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:46.247963 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:46.467161 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001032/id_001032.cc
[2025-11-05 07:38:46.467242 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:46.697333 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:46.697405 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:46.700215 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:46.700248 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:46.918093 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001033/id_001033.cc
[2025-11-05 07:38:46.918161 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:47.148436 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:47.148508 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:47.151267 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:47.151296 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:47.368569 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001034/id_001034.cc
[2025-11-05 07:38:47.368631 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:47.599021 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:47.599128 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:47.601726 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:47.601757 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:47.819602 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001035/id_001035.cc
[2025-11-05 07:38:47.819657 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:48.048179 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:48.048250 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:48.051134 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:48.051166 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:48.269250 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001036/id_001036.cc
[2025-11-05 07:38:48.269309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:48.496885 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:48.496957 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:48.499714 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:48.499746 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:48.717753 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001037/id_001037.cc
[2025-11-05 07:38:48.717835 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:48.948017 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:48.948088 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:48.951024 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:48.951055 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:49.168213 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001038/id_001038.cc
[2025-11-05 07:38:49.168265 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:49.397309 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:49.397382 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:49.400234 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:49.400264 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:49.618638 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001039/id_001039.cc
[2025-11-05 07:38:49.618705 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:38:49.850989 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:38:49.851100 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:38:49.853926 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:38:49.853958 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:38:49.853995 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:38:49.854010 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1040, succ: 1039, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:38:49.854025 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:38:49.854053 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:38:50.160528 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1039 as an example for the next prompt.
[2025-11-05 07:38:50.160583 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 14 new API pairs in this round.
[2025-11-05 07:38:50.160618 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 14
[2025-11-05 07:38:50.160671 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,124.0,28.0,24.0,76.0,29.0,29.0,223.0,16.0,18.0,315.0,115.0,27.0,108.0,32.0,175.0,73.0,89.0,100.0,112.0,46.0,31.0,16.0,18.0,34.0,124.0,89.0,16.0,24.0,71.0,196.0,28.0,574.0,179.0,170.0,18.0,48.0,54.0,28.0,323.0,20.0,24.0,97.0,20.0,10.0,82.0,248.0,13.0,16.0,139.0,14.0,26.0,73.0,19.0,228.0,25.0,49.0,21.0,21.0,143.0,39.0,171.0,52.0,49.0,13.0]
[2025-11-05 07:38:50.160688 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:38:50.160741 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 315
[2025-11-05 07:38:50.160771 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 248
[2025-11-05 07:38:50.160797 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 97
[2025-11-05 07:38:50.160823 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 139
[2025-11-05 07:38:50.160855 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 24
[2025-11-05 07:38:50.160902 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    int cre2_opt_log_errors(cre2_options_t * opt)
[2025-11-05 07:38:50.161720 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 104, quiet_round: 0, discovered_api_pairs: 2078
[2025-11-05 07:38:50.211915 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:38:50.212279 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    int cre2_opt_log_errors(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 carol789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char match0_buf[64];\n    char match1_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_string_t subject;\n    cre2_string_t matches[2];\n    int consume_res = 0;\n    int partial_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup (initialize options and buffers)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    memset(match0_buf, 0, sizeof(match0_buf));\n    memset(match1_buf, 0, sizeof(match1_buf));\n\n    // step 3: Prepare cre2_string_t structures\n    subject.data = text_buf;\n    subject.length = text_len;\n    matches[0].data = match0_buf;\n    matches[0].length = 0;\n    matches[1].data = match1_buf;\n    matches[1].length = 0;\n\n    // step 4: Operate - consume from the start and attempt a partial match\n    consume_res = cre2_consume(pattern, &subject, matches, 2);\n    partial_res = cre2_partial_match(pattern, &subject, matches, 2);\n\n    // step 5: Validate / compute lightweight checksum (use results and lengths meaningfully)\n    computed_check = (long)consume_res + (long)partial_res + (long)matches[0].length + (long)matches[1].length + (long)pattern_len + (long)subject.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)[0-9]*\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 bar baz foo bar456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char min_buf[64];\n    char max_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t minstr;\n    cre2_string_t maxstr;\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    size_t set_matches = 0;\n    int pmr_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    memset(min_buf, 0, sizeof(min_buf));\n    memset(max_buf, 0, sizeof(max_buf));\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Core operations - compile single regexp and create/compile a set\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate - get possible match range from compiled regex and run set match\n    minstr.data = min_buf;\n    minstr.length = 0;\n    maxstr.data = max_buf;\n    maxstr.length = 0;\n    pmr_res = cre2_possible_match_range(re, &minstr, &maxstr, (int)sizeof(min_buf));\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pmr_res + (long)set_matches + (long)minstr.length + (long)maxstr.length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:39:37.119210 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 07:39:37.119335 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30660, Completion: 21759, Total: 52419
[2025-11-05 07:39:37.119359 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:39:37.338323 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001040/id_001040.cc
[2025-11-05 07:39:37.338384 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:37.568446 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:37.568521 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:37.571288 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:37.571318 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:37.789370 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001041/id_001041.cc
[2025-11-05 07:39:37.789432 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:38.019161 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:38.019235 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:38.022099 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:38.022128 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:38.241994 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001042/id_001042.cc
[2025-11-05 07:39:38.242086 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:38.472940 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:38.473016 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:38.475584 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:38.475614 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:38.695104 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001043/id_001043.cc
[2025-11-05 07:39:38.695166 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:38.925428 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:38.925503 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:38.928234 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:38.928263 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:39.146147 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001044/id_001044.cc
[2025-11-05 07:39:39.146223 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:39.376764 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:39.376875 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:39.379416 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:39.379448 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:39.597121 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001045/id_001045.cc
[2025-11-05 07:39:39.597182 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:39.829444 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:39.829518 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:39.832291 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:39.832321 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:40.050572 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001046/id_001046.cc
[2025-11-05 07:39:40.050632 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:40.281521 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:40.281595 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:40.284358 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:40.284387 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:40.500806 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001047/id_001047.cc
[2025-11-05 07:39:40.500901 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:40.732510 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:40.732585 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:40.735257 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:40.735287 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:40.955365 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001048/id_001048.cc
[2025-11-05 07:39:40.955428 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:41.186063 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:41.186137 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:41.189030 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:41.189060 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:41.407670 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001049/id_001049.cc
[2025-11-05 07:39:41.407734 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:39:41.638636 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:39:41.638748 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:39:41.641687 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:39:41.641717 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:39:41.641797 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:39:41.641822 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1050, succ: 1049, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:39:41.641843 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:39:41.641876 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:39:41.959250 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1049 as an example for the next prompt.
[2025-11-05 07:39:41.959303 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 21 new API pairs in this round.
[2025-11-05 07:39:41.959347 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 21
[2025-11-05 07:39:41.959394 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,130.0,28.0,24.0,76.0,38.0,29.0,223.0,16.0,18.0,316.0,115.0,27.0,108.0,32.0,178.0,73.0,89.0,100.0,113.0,46.0,31.0,16.0,18.0,34.0,124.0,89.0,16.0,24.0,71.0,200.0,28.0,576.0,179.0,171.0,18.0,48.0,54.0,28.0,323.0,20.0,34.0,98.0,20.0,10.0,82.0,256.0,13.0,16.0,141.0,14.0,26.0,73.0,19.0,228.0,25.0,49.0,21.0,21.0,143.0,39.0,171.0,52.0,49.0,13.0]
[2025-11-05 07:39:41.959412 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:39:41.959466 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 200
[2025-11-05 07:39:41.959499 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_log_errors energy: 38
[2025-11-05 07:39:41.959525 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 228
[2025-11-05 07:39:41.959552 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 14
[2025-11-05 07:39:41.959586 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int64_t cre2_opt_max_mem(cre2_options_t * opt)
[2025-11-05 07:39:41.960287 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 105, quiet_round: 0, discovered_api_pairs: 2099
[2025-11-05 07:39:41.992736 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:39:41.993083 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int64_t cre2_opt_max_mem(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)[0-9]*\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 bar baz foo bar456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char min_buf[64];\n    char max_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t minstr;\n    cre2_string_t maxstr;\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    size_t set_matches = 0;\n    int pmr_res = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    memset(min_buf, 0, sizeof(min_buf));\n    memset(max_buf, 0, sizeof(max_buf));\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Core operations - compile single regexp and create/compile a set\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate - get possible match range from compiled regex and run set match\n    minstr.data = min_buf;\n    minstr.length = 0;\n    maxstr.data = max_buf;\n    maxstr.length = 0;\n    pmr_res = cre2_possible_match_range(re, &minstr, &maxstr, (int)sizeof(min_buf));\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pmr_res + (long)set_matches + (long)minstr.length + (long)maxstr.length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 carol789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char match_buf[128];\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t subject;\n    cre2_string_t single_match;\n    int pm_res = 0;\n    size_t set_matches = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int log_err_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup (initialize options and buffers)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Prepare cre2_string_t structures and compile regex/set\n    subject.data = text_buf;\n    subject.length = text_len;\n    single_match.data = match_buf;\n    single_match.length = 0;\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate - perform partial match and set match\n    pm_res = cre2_partial_match(pattern, &subject, &single_match, 2);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate / compute lightweight checksum using option queries\n    enc = cre2_opt_encoding(opt);\n    log_err_flag = cre2_opt_log_errors(opt);\n    computed_check = (long)pm_res + (long)set_matches + (long)single_match.length + (long)pattern_len + (long)subject.length + (long)enc + (long)log_err_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:40:20.995390 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 07:40:20.995504 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31140, Completion: 23812, Total: 54952
[2025-11-05 07:40:20.995525 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:40:21.213009 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001050/id_001050.cc
[2025-11-05 07:40:21.213062 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:21.442563 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:21.442622 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:21.445306 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:21.445338 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:21.666685 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001051/id_001051.cc
[2025-11-05 07:40:21.666737 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:21.897692 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:21.897760 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:21.900487 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:21.900520 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:22.122275 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001052/id_001052.cc
[2025-11-05 07:40:22.122363 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:22.355264 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:22.355331 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:22.358165 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:22.358199 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:22.579414 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001053/id_001053.cc
[2025-11-05 07:40:22.579466 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:22.810976 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:22.811050 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:22.813857 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:22.813888 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:23.034502 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001054/id_001054.cc
[2025-11-05 07:40:23.034555 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:23.266231 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:23.266347 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:23.269085 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:23.269143 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:23.498186 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001055/id_001055.cc
[2025-11-05 07:40:23.498236 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:23.729420 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:23.729486 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:23.731892 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:23.731925 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:23.949333 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001056/id_001056.cc
[2025-11-05 07:40:23.949386 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:24.182719 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:24.182794 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:24.185468 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:24.185500 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:24.402769 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001057/id_001057.cc
[2025-11-05 07:40:24.402850 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:24.633051 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:24.633127 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:24.635651 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:24.635684 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:24.853162 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001058/id_001058.cc
[2025-11-05 07:40:24.853214 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:25.085097 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:25.085173 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:25.087702 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:25.087734 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:25.304891 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001059/id_001059.cc
[2025-11-05 07:40:25.304944 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:25.532993 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:25.533111 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:25.535582 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:25.535613 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:25.535651 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:40:25.535668 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1060, succ: 1059, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:40:25.535682 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:40:25.535737 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:40:25.826830 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1059 as an example for the next prompt.
[2025-11-05 07:40:25.826887 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 35 new API pairs in this round.
[2025-11-05 07:40:25.826948 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 35
[2025-11-05 07:40:25.826999 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,130.0,28.0,24.0,79.0,42.0,29.0,232.0,16.0,18.0,325.0,120.0,27.0,108.0,33.0,178.0,73.0,89.0,100.0,114.0,46.0,31.0,16.0,18.0,34.0,124.0,89.0,16.0,24.0,71.0,201.0,28.0,584.0,179.0,171.0,18.0,48.0,54.0,28.0,325.0,20.0,38.0,98.0,20.0,10.0,82.0,256.0,13.0,16.0,145.0,35.0,26.0,74.0,22.0,244.0,25.0,49.0,29.0,21.0,143.0,39.0,171.0,52.0,49.0,13.0]
[2025-11-05 07:40:25.827018 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:40:25.827081 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 48
[2025-11-05 07:40:25.827130 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 171
[2025-11-05 07:40:25.827170 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_current energy: 26
[2025-11-05 07:40:25.827200 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 584
[2025-11-05 07:40:25.827233 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_case_sensitive(cre2_options_t * opt),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_version_interface_current(),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 07:40:25.827952 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 106, quiet_round: 0, discovered_api_pairs: 2134
[2025-11-05 07:40:25.860508 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:40:25.860909 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_case_sensitive(cre2_options_t * opt),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_version_interface_current(),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alice123 bob456 carol789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char match_buf[128];\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t subject;\n    cre2_string_t single_match;\n    int pm_res = 0;\n    size_t set_matches = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int log_err_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup (initialize options and buffers)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Prepare cre2_string_t structures and compile regex/set\n    subject.data = text_buf;\n    subject.length = text_len;\n    single_match.data = match_buf;\n    single_match.length = 0;\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate - perform partial match and set match\n    pm_res = cre2_partial_match(pattern, &subject, &single_match, 2);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate / compute lightweight checksum using option queries\n    enc = cre2_opt_encoding(opt);\n    log_err_flag = cre2_opt_log_errors(opt);\n    computed_check = (long)pm_res + (long)set_matches + (long)single_match.length + (long)pattern_len + (long)subject.length + (long)enc + (long)log_err_flag;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)[0-9]*\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 bar baz foo bar456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    size_t set_matches = 0;\n    const char * compiled_pat = NULL;\n    int64_t opt_max_mem = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)(4 * 1024 * 1024));\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n    compiled_pat = cre2_pattern(re);\n    opt_max_mem = cre2_opt_max_mem(opt);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_matches + (long)pattern_len + (long)text_len + (long)opt_max_mem + (long)(compiled_pat ? compiled_pat[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:40:58.667312 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 07:40:58.667429 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30880, Completion: 20037, Total: 50917
[2025-11-05 07:40:58.667472 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:40:58.885473 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001060/id_001060.cc
[2025-11-05 07:40:58.885528 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:59.114782 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:59.114856 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:59.117754 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:59.117786 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:59.335582 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001061/id_001061.cc
[2025-11-05 07:40:59.335640 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:40:59.563322 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:40:59.563390 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:40:59.566311 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:40:59.566342 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:40:59.785702 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001062/id_001062.cc
[2025-11-05 07:40:59.785788 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:00.015805 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:00.015881 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:00.018627 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:00.018654 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:00.236682 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001063/id_001063.cc
[2025-11-05 07:41:00.236736 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:00.466876 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:00.466933 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:00.469678 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:00.469703 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:00.688275 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001064/id_001064.cc
[2025-11-05 07:41:00.688330 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:00.918189 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:00.918300 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:00.921054 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:00.921082 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:01.137312 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001065/id_001065.cc
[2025-11-05 07:41:01.137366 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:01.365902 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:01.365975 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:01.368729 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:01.368762 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:01.586679 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001066/id_001066.cc
[2025-11-05 07:41:01.586733 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:01.817590 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:01.817648 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:01.820363 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:01.820388 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:02.038816 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001067/id_001067.cc
[2025-11-05 07:41:02.038900 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:02.269056 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:02.269129 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:02.271745 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:02.271774 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:02.489522 +00:00] WARN [src/fuzzer.rs:205] Program 1068 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001068/id_001068.cc:33:5: error: no matching function for call to 'cre2_opt_case_sensitive'
   33 |     cre2_opt_case_sensitive(opt, 1);
      |     ^~~~~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:80:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   80 | cre2_decl int cre2_opt_case_sensitive           (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:41:02.522068 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:41:02.522395 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test|demo)[0-9]+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"test123 demo456 other789 test000\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    size_t set_matches = 0;\n    int ver = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_case_sensitive(opt, 1);\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Core operations (compile pattern and prepare set)\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate (match against text and query version)\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n    ver = cre2_version_interface_current();\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_matches + (long)pattern_len + (long)text_len + (long)ver + (long)match_arr[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001068/id_001068.cc:33:5: error: no matching function for call to 'cre2_opt_case_sensitive'\n   33 |     cre2_opt_case_sensitive(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:80:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   80 | cre2_decl int cre2_opt_case_sensitive           (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:41:29.470586 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 07:41:29.470712 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22320, Completion: 12172, Total: 34492
[2025-11-05 07:41:29.687970 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001068/id_001068.cc
[2025-11-05 07:41:29.688023 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:29.917864 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:29.917922 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:29.920627 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:29.920661 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:29.920694 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1068!
[2025-11-05 07:41:30.138988 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001069/id_001069.cc
[2025-11-05 07:41:30.139040 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:41:30.368341 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:41:30.368398 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:41:30.371187 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:41:30.371221 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:41:30.371258 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:41:30.371278 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1070, succ: 1069, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:41:30.371292 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:41:30.371316 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:41:30.659218 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1069 as an example for the next prompt.
[2025-11-05 07:41:30.659298 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 07:41:30.659339 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 07:41:30.659388 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,130.0,28.0,24.0,79.0,42.0,29.0,232.0,16.0,18.0,329.0,120.0,27.0,108.0,33.0,178.0,73.0,89.0,100.0,115.0,46.0,31.0,16.0,18.0,34.0,125.0,89.0,16.0,24.0,71.0,204.0,28.0,588.0,179.0,172.0,18.0,57.0,54.0,28.0,325.0,20.0,38.0,98.0,20.0,10.0,82.0,256.0,13.0,16.0,151.0,35.0,38.0,74.0,22.0,249.0,25.0,49.0,29.0,21.0,143.0,39.0,171.0,52.0,49.0,13.0]
[2025-11-05 07:41:30.659405 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:41:30.659472 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 588
[2025-11-05 07:41:30.659505 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 256
[2025-11-05 07:41:30.659531 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 120
[2025-11-05 07:41:30.659556 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_posix_syntax energy: 18
[2025-11-05 07:41:30.659595 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 143
[2025-11-05 07:41:30.659632 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_opt_posix_syntax(cre2_options_t * opt),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)
[2025-11-05 07:41:30.660451 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 107, quiet_round: 0, discovered_api_pairs: 2151
[2025-11-05 07:41:30.714274 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:41:30.714634 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_opt_posix_syntax(cre2_options_t * opt),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)[0-9]*\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 bar baz foo bar456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    size_t set_matches = 0;\n    const char * compiled_pat = NULL;\n    int64_t opt_max_mem = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)(4 * 1024 * 1024));\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n    compiled_pat = cre2_pattern(re);\n    opt_max_mem = cre2_opt_max_mem(opt);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)set_matches + (long)pattern_len + (long)text_len + (long)opt_max_mem + (long)(compiled_pat ? compiled_pat[0] : 0);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test|demo)[0-9]*\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"test123 demo456 other789 test\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    size_t set_matches = 0;\n    int version_current = 0;\n    int opt_case_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup (initialize options and query version)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    opt_case_flag = cre2_opt_case_sensitive(opt);\n    version_current = cre2_version_interface_current();\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Core operations (compile regex and create/compile set)\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate (match the set against text)\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)version_current + (long)opt_case_flag + (long)set_matches + (long)pattern_len + (long)text_len + (long)match_arr[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:42:21.158901 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 50s
[2025-11-05 07:42:21.159027 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30680, Completion: 21271, Total: 51951
[2025-11-05 07:42:21.159048 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:42:21.377414 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001070/id_001070.cc
[2025-11-05 07:42:21.377468 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:21.607041 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:21.607118 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:21.609988 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:21.610023 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:21.826942 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001071/id_001071.cc
[2025-11-05 07:42:21.827012 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:22.055041 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:22.055120 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:22.057972 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:22.058004 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:22.275627 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001072/id_001072.cc
[2025-11-05 07:42:22.275711 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:22.505692 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:22.505769 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:22.508311 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:22.508344 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:22.727423 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001073/id_001073.cc
[2025-11-05 07:42:22.727478 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:22.957621 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:22.957680 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:22.960464 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:22.960498 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:23.179599 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001074/id_001074.cc
[2025-11-05 07:42:23.179655 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:23.407387 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:23.407505 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:23.410336 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:23.410369 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:23.628753 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001075/id_001075.cc
[2025-11-05 07:42:23.628807 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:23.857926 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:23.857986 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:23.860907 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:23.860940 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:24.079920 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001076/id_001076.cc
[2025-11-05 07:42:24.079974 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:24.310104 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:24.310178 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:24.313019 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:24.313052 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:24.531634 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001077/id_001077.cc
[2025-11-05 07:42:24.531736 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:24.760456 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:24.760533 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:24.763376 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:24.763409 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:24.981813 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001078/id_001078.cc
[2025-11-05 07:42:24.981868 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:25.210707 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:25.210766 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:25.213488 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:25.213521 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:25.431076 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001079/id_001079.cc
[2025-11-05 07:42:25.431132 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:25.661917 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:25.662017 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:25.664859 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:25.664894 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:25.664935 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:42:25.664954 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1080, succ: 1079, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:42:25.664975 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:42:25.665003 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:42:25.949702 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1079 as an example for the next prompt.
[2025-11-05 07:42:25.949760 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 31 new API pairs in this round.
[2025-11-05 07:42:25.949824 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 31
[2025-11-05 07:42:25.949880 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,132.0,28.0,24.0,79.0,46.0,37.0,232.0,16.0,18.0,331.0,128.0,27.0,108.0,33.0,181.0,73.0,89.0,100.0,115.0,48.0,31.0,16.0,18.0,34.0,125.0,89.0,16.0,24.0,74.0,210.0,28.0,594.0,183.0,172.0,35.0,57.0,54.0,28.0,325.0,20.0,38.0,98.0,20.0,10.0,82.0,271.0,13.0,16.0,151.0,35.0,38.0,74.0,22.0,249.0,25.0,49.0,29.0,21.0,150.0,39.0,171.0,52.0,49.0,13.0]
[2025-11-05 07:42:25.949899 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:42:25.949958 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 181
[2025-11-05 07:42:25.949993 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 128
[2025-11-05 07:42:25.950021 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 271
[2025-11-05 07:42:25.950085 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_longest_match energy: 16
[2025-11-05 07:42:25.950128 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_longest_match(cre2_options_t * opt, int flag)
[2025-11-05 07:42:25.950856 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 108, quiet_round: 0, discovered_api_pairs: 2182
[2025-11-05 07:42:25.995482 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:42:25.995876 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_longest_match(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(test|demo)[0-9]*\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"test123 demo456 other789 test\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int match_arr[8];\n    const size_t match_len = sizeof(match_arr) / sizeof(match_arr[0]);\n    size_t set_matches = 0;\n    int version_current = 0;\n    int opt_case_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup (initialize options and query version)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    opt_case_flag = cre2_opt_case_sensitive(opt);\n    version_current = cre2_version_interface_current();\n    memset(match_arr, 0, sizeof(match_arr));\n\n    // step 3: Core operations (compile regex and create/compile set)\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate (match the set against text)\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, match_arr, match_len);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)version_current + (long)opt_case_flag + (long)set_matches + (long)pattern_len + (long)text_len + (long)match_arr[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)([0-9]+)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 baz bar456 foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int posix_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_posix_syntax(opt, 1);\n    posix_flag = cre2_opt_posix_syntax(opt);\n    enc = cre2_opt_encoding(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations (compile regex and create named-group iterator)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate (perform a match)\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)posix_flag + (long)enc + (long)match_ret + (long)pattern_len + (long)text_len + (long)(matches[0].length);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:42:53.185583 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 07:42:53.185704 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30120, Completion: 14654, Total: 44774
[2025-11-05 07:42:53.185724 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:42:53.405306 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001080/id_001080.cc
[2025-11-05 07:42:53.405358 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:53.635846 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:53.635925 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:53.638839 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:53.638872 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:53.856352 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001081/id_001081.cc
[2025-11-05 07:42:53.856413 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:54.086840 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:54.086918 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:54.089362 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:54.089395 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:54.306718 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001082/id_001082.cc
[2025-11-05 07:42:54.306802 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:54.537012 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:54.537090 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:54.539736 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:54.539769 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:54.761186 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001083/id_001083.cc
[2025-11-05 07:42:54.761240 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:54.993801 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:54.993877 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:54.996695 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:54.996728 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:55.213922 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001084/id_001084.cc
[2025-11-05 07:42:55.213975 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:55.446979 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:55.447080 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:55.449737 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:55.449768 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:55.666723 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001085/id_001085.cc
[2025-11-05 07:42:55.666776 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:55.896865 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:55.896941 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:55.899545 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:55.899576 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:56.117415 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001086/id_001086.cc
[2025-11-05 07:42:56.117468 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:56.349423 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:56.349500 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:56.351940 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:56.351973 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:56.572768 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001087/id_001087.cc
[2025-11-05 07:42:56.572853 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:56.802402 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:56.802477 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:56.804960 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:56.804991 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:57.027292 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001088/id_001088.cc
[2025-11-05 07:42:57.027346 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:57.256691 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:57.256796 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:57.259349 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:57.259381 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:57.477491 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001089/id_001089.cc
[2025-11-05 07:42:57.477545 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:42:57.705718 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:42:57.705834 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:42:57.708446 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:42:57.708479 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:42:57.708517 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:42:57.708533 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1090, succ: 1089, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:42:57.708549 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:42:57.708577 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:42:57.985737 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1089 as an example for the next prompt.
[2025-11-05 07:42:57.985791 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 07:42:57.985822 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 07:42:57.985870 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,132.0,28.0,24.0,79.0,46.0,37.0,232.0,16.0,18.0,333.0,130.0,27.0,108.0,33.0,182.0,73.0,89.0,100.0,115.0,48.0,31.0,20.0,18.0,34.0,125.0,89.0,16.0,24.0,74.0,210.0,28.0,597.0,183.0,172.0,35.0,57.0,54.0,28.0,325.0,20.0,38.0,98.0,20.0,10.0,82.0,276.0,13.0,16.0,151.0,35.0,38.0,74.0,22.0,249.0,25.0,49.0,29.0,21.0,150.0,39.0,171.0,52.0,49.0,16.0]
[2025-11-05 07:42:57.985889 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:42:57.985941 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 125
[2025-11-05 07:42:57.985973 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 333
[2025-11-05 07:42:57.986000 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 98
[2025-11-05 07:42:57.986027 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 597
[2025-11-05 07:42:57.986055 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 232
[2025-11-05 07:42:57.986089 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_compile(cre2_set * set),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_num_capturing_groups(const cre2_regexp_t * re)
[2025-11-05 07:42:57.986903 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 109, quiet_round: 0, discovered_api_pairs: 2190
[2025-11-05 07:42:58.030415 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:42:58.030762 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_compile(cre2_set * set),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)([0-9]+)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 baz bar456 foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int posix_flag = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_posix_syntax(opt, 1);\n    posix_flag = cre2_opt_posix_syntax(opt);\n    enc = cre2_opt_encoding(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations (compile regex and create named-group iterator)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate (perform a match)\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)posix_flag + (long)enc + (long)match_ret + (long)pattern_len + (long)text_len + (long)(matches[0].length);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alpha123 beta gamma456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_longest_match(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)enc + (long)match_ret + (long)pattern_len + (long)text_len + (long)(matches[0].length);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:43:35.435952 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 07:43:35.436076 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28700, Completion: 23157, Total: 51857
[2025-11-05 07:43:35.436099 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:43:35.654676 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001090/id_001090.cc
[2025-11-05 07:43:35.654731 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:35.883564 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:35.883623 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:35.886433 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:35.886465 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:36.105041 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001091/id_001091.cc
[2025-11-05 07:43:36.105095 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:36.334008 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:36.334066 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:36.336943 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:36.336975 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:36.554520 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001092/id_001092.cc
[2025-11-05 07:43:36.554605 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:36.782332 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:36.782391 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:36.785162 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:36.785194 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:37.002289 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001093/id_001093.cc
[2025-11-05 07:43:37.002343 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:37.233137 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:37.233208 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:37.235787 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:37.235818 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:37.453705 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001094/id_001094.cc
[2025-11-05 07:43:37.453758 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:37.684884 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:37.685012 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:37.687579 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:37.687611 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:37.904928 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001095/id_001095.cc
[2025-11-05 07:43:37.904983 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:38.135825 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:38.135883 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:38.138703 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:38.138730 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:38.356435 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001096/id_001096.cc
[2025-11-05 07:43:38.356491 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:38.585169 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:38.585244 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:38.587893 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:38.587924 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:38.806178 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001097/id_001097.cc
[2025-11-05 07:43:38.806264 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:43:39.038289 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:43:39.038347 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:43:39.041131 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:43:39.041164 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:43:39.260087 +00:00] WARN [src/fuzzer.rs:205] Program 1098 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001098/id_001098.cc:40:11: error: no matching function for call to 'cre2_set_new'
   40 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:43:39.303723 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:43:39.304052 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([a-z]+)([0-9]*)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"sample123 partialmatch test456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t matches[8];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int pm_ret = 0;\n    int set_compile_ret = 0;\n    int group_count = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_longest_match(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Core operations (create regexp and set, then compile set)\n    re = cre2_new(pattern, pattern_len, opt);\n    group_count = cre2_num_capturing_groups(re);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Operate (prepare match buffers and perform a partial match)\n    memset(matches, 0, sizeof(matches));\n    cre2_string_t text_str;\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    pm_ret = cre2_partial_match(pattern, &text_str, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)group_count + (long)set_compile_ret + (long)pm_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001098/id_001098.cc:40:11: error: no matching function for call to 'cre2_set_new'\n   40 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:44:05.766052 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 07:44:05.766176 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22860, Completion: 13057, Total: 35917
[2025-11-05 07:44:05.984576 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001098/id_001098.cc
[2025-11-05 07:44:05.984639 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:44:06.213770 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:44:06.213847 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:44:06.216731 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:44:06.216764 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:44:06.216797 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1098!
[2025-11-05 07:44:06.434496 +00:00] WARN [src/fuzzer.rs:205] Program 1099 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001099/id_001099.cc:37:11: error: no matching function for call to 'cre2_set_new'
   37 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:44:06.478143 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:44:06.478479 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alpha123 beta gamma456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t text_obj;\n    int nmatch = 0;\n    int match_ret = 0;\n    int compile_ret = 0;\n    int ngroups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    (void)cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 3: Core operations\n    ngroups = cre2_num_capturing_groups(re);\n    memset(matches, 0, sizeof(matches));\n    text_obj.data = text_buf;\n    text_obj.length = text_len;\n    nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n\n    // step 4: Operate\n    match_ret = cre2_partial_match(pattern, &text_obj, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)compile_ret + (long)ngroups + (long)match_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001099/id_001099.cc:37:11: error: no matching function for call to 'cre2_set_new'\n   37 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:44:24.543107 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 18s
[2025-11-05 07:44:24.543236 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22620, Completion: 10844, Total: 33464
[2025-11-05 07:44:24.762039 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001099/id_001099.cc
[2025-11-05 07:44:24.762091 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:44:24.992166 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:44:24.992242 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:44:24.995150 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:44:24.995181 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:44:24.995215 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1099!
[2025-11-05 07:44:24.995252 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:44:24.995267 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1100, succ: 1099, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:44:24.995281 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:44:24.995305 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:44:25.285719 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1099 as an example for the next prompt.
[2025-11-05 07:44:25.285774 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 21 new API pairs in this round.
[2025-11-05 07:44:25.285829 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 21
[2025-11-05 07:44:25.285878 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,132.0,28.0,24.0,79.0,46.0,37.0,237.0,16.0,18.0,334.0,130.0,27.0,108.0,33.0,184.0,73.0,89.0,100.0,115.0,48.0,31.0,27.0,18.0,34.0,130.0,89.0,16.0,24.0,77.0,217.0,28.0,604.0,183.0,179.0,35.0,57.0,54.0,28.0,325.0,20.0,38.0,103.0,20.0,10.0,82.0,276.0,13.0,16.0,151.0,35.0,38.0,74.0,22.0,249.0,25.0,49.0,29.0,21.0,150.0,39.0,175.0,52.0,49.0,16.0]
[2025-11-05 07:44:25.285895 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:44:25.285948 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_word_boundary energy: 18
[2025-11-05 07:44:25.285978 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume energy: 34
[2025-11-05 07:44:25.286006 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 249
[2025-11-05 07:44:25.286033 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 103
[2025-11-05 07:44:25.286065 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_word_boundary(cre2_options_t * opt),
    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:44:25.286766 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 110, quiet_round: 0, discovered_api_pairs: 2211
[2025-11-05 07:44:25.324984 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:44:25.325329 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_word_boundary(cre2_options_t * opt),\n    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alpha123 beta gamma456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_longest_match(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)enc + (long)match_ret + (long)pattern_len + (long)text_len + (long)(matches[0].length);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\n\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alpha123 beta gamma456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t text_obj;\n    int nmatch = 0;\n    int match_ret = 0;\n    int compile_ret = 0;\n    int ngroups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    /* cre2_set_new expects a cre2_anchor_t; cast 0 to that type to keep logic unchanged */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    (void)cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 3: Core operations\n    ngroups = cre2_num_capturing_groups(re);\n    memset(matches, 0, sizeof(matches));\n    text_obj.data = text_buf;\n    text_obj.length = text_len;\n    nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n\n    // step 4: Operate\n    match_ret = cre2_partial_match(pattern, &text_obj, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)compile_ret + (long)ngroups + (long)match_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:45:05.467631 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 07:45:05.467750 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28760, Completion: 22773, Total: 51533
[2025-11-05 07:45:05.467770 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:45:05.685441 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001100/id_001100.cc
[2025-11-05 07:45:05.685494 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:05.914612 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:05.914689 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:05.917530 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:05.917563 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:06.134367 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001101/id_001101.cc
[2025-11-05 07:45:06.134421 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:06.364192 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:06.364269 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:06.367153 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:06.367185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:06.583985 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001102/id_001102.cc
[2025-11-05 07:45:06.584070 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:06.813575 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:06.813650 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:06.816490 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:06.816522 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:07.034796 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001103/id_001103.cc
[2025-11-05 07:45:07.034850 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:07.264072 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:07.264149 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:07.266846 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:07.266878 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:07.485833 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001104/id_001104.cc
[2025-11-05 07:45:07.485887 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:07.715288 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:07.715403 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:07.718126 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:07.718160 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:07.936026 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001105/id_001105.cc
[2025-11-05 07:45:07.936080 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:08.164267 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:08.164343 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:08.167238 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:08.167271 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:08.384546 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001106/id_001106.cc
[2025-11-05 07:45:08.384599 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:08.613549 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:08.613626 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:08.616365 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:08.616397 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:08.835654 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001107/id_001107.cc
[2025-11-05 07:45:08.835738 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:09.064951 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:09.065031 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:09.067777 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:09.067809 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:09.285749 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001108/id_001108.cc
[2025-11-05 07:45:09.285803 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:09.514100 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:09.514174 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:09.517026 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:09.517058 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:09.734454 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001109/id_001109.cc
[2025-11-05 07:45:09.734508 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:09.963365 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:09.963478 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:09.966226 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:09.966258 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:09.966295 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:45:09.966311 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1110, succ: 1109, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:45:09.966326 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:45:09.966351 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:45:10.260893 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1109 as an example for the next prompt.
[2025-11-05 07:45:10.260949 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 07:45:10.260991 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 07:45:10.261039 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,132.0,28.0,24.0,79.0,46.0,37.0,237.0,16.0,27.0,339.0,130.0,27.0,108.0,33.0,185.0,73.0,89.0,100.0,115.0,48.0,31.0,27.0,18.0,42.0,130.0,89.0,16.0,24.0,77.0,219.0,28.0,609.0,183.0,179.0,35.0,57.0,54.0,28.0,325.0,20.0,38.0,110.0,20.0,10.0,82.0,276.0,13.0,16.0,151.0,35.0,38.0,75.0,22.0,258.0,25.0,53.0,29.0,21.0,150.0,39.0,175.0,52.0,49.0,16.0]
[2025-11-05 07:45:10.261058 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:45:10.261110 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 73
[2025-11-05 07:45:10.261143 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 219
[2025-11-05 07:45:10.261167 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 179
[2025-11-05 07:45:10.261195 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 130
[2025-11-05 07:45:10.261231 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)
[2025-11-05 07:45:10.261951 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 111, quiet_round: 0, discovered_api_pairs: 2231
[2025-11-05 07:45:10.311820 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:45:10.312185 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\n\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alpha123 beta gamma456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t matches[4];\n    cre2_string_t text_obj;\n    int nmatch = 0;\n    int match_ret = 0;\n    int compile_ret = 0;\n    int ngroups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    /* cre2_set_new expects a cre2_anchor_t; cast 0 to that type to keep logic unchanged */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    (void)cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 3: Core operations\n    ngroups = cre2_num_capturing_groups(re);\n    memset(matches, 0, sizeof(matches));\n    text_obj.data = text_buf;\n    text_obj.length = text_len;\n    nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n\n    // step 4: Operate\n    match_ret = cre2_partial_match(pattern, &text_obj, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)compile_ret + (long)ngroups + (long)match_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alpha123 beta gamma456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    cre2_string_t text_obj;\n    int wb_flag = 0;\n    int partial_ret = 0;\n    int find_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_word_boundary(opt, 1);\n    wb_flag = cre2_opt_word_boundary(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    const char * compiled_pattern = cre2_pattern(re);\n    text_obj.data = text_buf;\n    text_obj.length = text_len;\n    partial_ret = cre2_partial_match(compiled_pattern, &text_obj, matches, nmatch);\n    find_ret = cre2_find_and_consume(compiled_pattern, &text_obj, matches, nmatch);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)wb_flag + (long)partial_ret + (long)find_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:45:50.228809 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 07:45:50.228927 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30040, Completion: 19224, Total: 49264
[2025-11-05 07:45:50.228948 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:45:50.446757 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001110/id_001110.cc
[2025-11-05 07:45:50.446810 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:50.674430 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:50.674497 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:50.677347 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:50.677379 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:50.893637 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001111/id_001111.cc
[2025-11-05 07:45:50.893691 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:51.123545 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:51.123619 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:51.126369 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:51.126402 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:51.345494 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001112/id_001112.cc
[2025-11-05 07:45:51.345579 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:51.576362 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:51.576419 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:51.579175 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:51.579221 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:51.796917 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001113/id_001113.cc
[2025-11-05 07:45:51.796971 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:52.026015 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:52.026084 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:52.028942 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:52.028974 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:52.246380 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001114/id_001114.cc
[2025-11-05 07:45:52.246436 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:52.473735 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:52.473834 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:52.476606 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:52.476649 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:52.693374 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001115/id_001115.cc
[2025-11-05 07:45:52.693427 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:52.923491 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:52.923557 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:52.926388 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:52.926422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:53.144533 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001116/id_001116.cc
[2025-11-05 07:45:53.144588 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:53.373602 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:53.373673 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:53.376178 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:53.376211 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:53.596295 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001117/id_001117.cc
[2025-11-05 07:45:53.596380 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:53.826298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:53.826369 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:53.829248 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:53.829280 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:54.046776 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001118/id_001118.cc
[2025-11-05 07:45:54.046831 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:54.276538 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:54.276597 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:54.279344 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:54.279372 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:54.497227 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001119/id_001119.cc
[2025-11-05 07:45:54.497281 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:45:54.726729 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:45:54.726849 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:45:54.729743 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:45:54.729776 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:45:54.729815 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:45:54.729832 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1120, succ: 1119, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:45:54.729847 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:45:54.729875 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:45:55.017461 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1119 as an example for the next prompt.
[2025-11-05 07:45:55.017516 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 07:45:55.017545 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 07:45:55.017594 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,132.0,28.0,24.0,79.0,46.0,37.0,238.0,16.0,27.0,340.0,134.0,27.0,108.0,33.0,185.0,75.0,89.0,100.0,118.0,48.0,31.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,77.0,221.0,28.0,610.0,183.0,180.0,35.0,57.0,54.0,28.0,325.0,20.0,38.0,110.0,20.0,10.0,82.0,276.0,13.0,16.0,151.0,35.0,38.0,75.0,22.0,258.0,25.0,53.0,29.0,21.0,150.0,39.0,175.0,52.0,49.0,16.0]
[2025-11-05 07:45:55.017611 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:45:55.017665 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 258
[2025-11-05 07:45:55.017697 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_posix_syntax energy: 35
[2025-11-05 07:45:55.017724 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 610
[2025-11-05 07:45:55.017751 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 185
[2025-11-05 07:45:55.017782 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_opt_posix_syntax(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_options_t *cre2_opt_new()
[2025-11-05 07:45:55.018474 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 112, quiet_round: 0, discovered_api_pairs: 2237
[2025-11-05 07:45:55.045982 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:45:55.046316 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_opt_posix_syntax(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_options_t *cre2_opt_new()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"alpha123 beta gamma456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    cre2_string_t text_obj;\n    int wb_flag = 0;\n    int partial_ret = 0;\n    int find_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_word_boundary(opt, 1);\n    wb_flag = cre2_opt_word_boundary(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    const char * compiled_pattern = cre2_pattern(re);\n    text_obj.data = text_buf;\n    text_obj.length = text_len;\n    partial_ret = cre2_partial_match(compiled_pattern, &text_obj, matches, nmatch);\n    find_ret = cre2_find_and_consume(compiled_pattern, &text_obj, matches, nmatch);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)wb_flag + (long)partial_ret + (long)find_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"abc([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xyz abc123 def\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t matches[3];\n    int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int compile_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup options\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Create and prepare a set\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    (void)cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Compile a regexp object\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Prepare match structures and perform match\n    memset(matches, 0, sizeof(matches));\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n    computed_check = (long)compile_ret + (long)match_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:46:38.105262 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 07:46:38.105385 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28600, Completion: 20077, Total: 48677
[2025-11-05 07:46:38.105405 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:46:38.323585 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001120/id_001120.cc
[2025-11-05 07:46:38.323639 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:38.551943 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:38.552018 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:38.554763 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:38.554796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:38.772132 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001121/id_001121.cc
[2025-11-05 07:46:38.772184 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:39.002087 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:39.002161 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:39.005091 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:39.005123 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:39.222083 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001122/id_001122.cc
[2025-11-05 07:46:39.222164 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:39.450848 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:39.450923 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:39.453636 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:39.453668 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:39.670525 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001123/id_001123.cc
[2025-11-05 07:46:39.670577 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:39.899120 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:39.899197 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:39.901948 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:39.901981 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:40.119785 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001124/id_001124.cc
[2025-11-05 07:46:40.119838 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:40.349553 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:40.349670 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:40.352175 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:40.352232 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:40.572099 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001125/id_001125.cc
[2025-11-05 07:46:40.572151 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:40.801939 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:40.802010 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:40.804877 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:40.804911 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:41.024024 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001126/id_001126.cc
[2025-11-05 07:46:41.024077 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:41.254360 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:41.254434 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:41.257294 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:41.257326 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:41.476525 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001127/id_001127.cc
[2025-11-05 07:46:41.476609 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:41.704931 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:41.705005 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:41.707636 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:41.707669 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:41.926026 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001128/id_001128.cc
[2025-11-05 07:46:41.926079 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:42.154990 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:42.155062 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:42.157867 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:42.157898 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:42.375586 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001129/id_001129.cc
[2025-11-05 07:46:42.375639 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:46:42.605497 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:46:42.605602 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:46:42.608296 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:46:42.608326 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:46:42.608367 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:46:42.608382 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1130, succ: 1129, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:46:42.608397 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:46:42.608446 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:46:42.886866 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1129 as an example for the next prompt.
[2025-11-05 07:46:42.886921 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 07:46:42.886952 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 07:46:42.886999 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,132.0,28.0,24.0,79.0,46.0,38.0,238.0,16.0,27.0,341.0,136.0,27.0,108.0,33.0,187.0,75.0,89.0,100.0,118.0,48.0,31.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,77.0,223.0,28.0,612.0,183.0,180.0,41.0,57.0,54.0,28.0,325.0,20.0,38.0,110.0,20.0,10.0,82.0,276.0,13.0,16.0,151.0,35.0,38.0,75.0,22.0,260.0,25.0,55.0,29.0,21.0,150.0,39.0,175.0,52.0,49.0,16.0]
[2025-11-05 07:46:42.887019 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:46:42.887071 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 187
[2025-11-05 07:46:42.887101 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 39
[2025-11-05 07:46:42.887128 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 223
[2025-11-05 07:46:42.887154 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 260
[2025-11-05 07:46:42.887181 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 110
[2025-11-05 07:46:42.887216 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:46:42.888027 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 113, quiet_round: 0, discovered_api_pairs: 2245
[2025-11-05 07:46:42.931466 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:46:42.931814 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"abc([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xyz abc123 def\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t matches[3];\n    int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int compile_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup options\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Create and prepare a set\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    (void)cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Compile a regexp object\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Prepare match structures and perform match\n    memset(matches, 0, sizeof(matches));\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n    computed_check = (long)compile_ret + (long)match_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^([A-Za-z]+)-([0-9]+)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Token-123 Extra\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[3];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int posix_flag = 0;\n    int match_ret = 0;\n    const char * compiled_pattern = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_posix_syntax(opt, 1);\n    posix_flag = cre2_opt_posix_syntax(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pattern = cre2_pattern(re);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)posix_flag + (long)match_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:47:25.942858 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 07:47:25.942983 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28520, Completion: 23076, Total: 51596
[2025-11-05 07:47:25.943003 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:47:26.161205 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001130/id_001130.cc
[2025-11-05 07:47:26.161258 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:26.391258 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:26.391326 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:26.394133 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:26.394189 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:26.613733 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001131/id_001131.cc
[2025-11-05 07:47:26.613788 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:26.842735 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:26.842794 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:26.845587 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:26.845619 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:27.064493 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001132/id_001132.cc
[2025-11-05 07:47:27.064577 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:27.294351 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:27.294424 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:27.297227 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:27.297259 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:27.515511 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001133/id_001133.cc
[2025-11-05 07:47:27.515565 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:27.742533 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:27.742593 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:27.745462 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:27.745494 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:27.962907 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001134/id_001134.cc
[2025-11-05 07:47:27.962961 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:28.190377 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:28.190468 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:28.193308 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:28.193341 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:28.411210 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001135/id_001135.cc
[2025-11-05 07:47:28.411266 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:28.638207 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:28.638266 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:28.641087 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:28.641120 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:28.858543 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001136/id_001136.cc
[2025-11-05 07:47:28.858597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:29.086828 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:29.086901 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:29.089752 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:29.089785 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:29.306737 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001137/id_001137.cc
[2025-11-05 07:47:29.306823 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:29.534193 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:29.534262 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:29.536963 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:29.536995 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:29.753889 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001138/id_001138.cc
[2025-11-05 07:47:29.753943 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:29.983687 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:29.983754 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:29.986462 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:29.986496 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:30.203583 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001139/id_001139.cc
[2025-11-05 07:47:30.203638 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:47:30.431248 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:47:30.431365 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:47:30.434022 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:47:30.434056 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:47:30.434093 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:47:30.434108 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1140, succ: 1139, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:47:30.434124 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:47:30.434151 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:47:30.725927 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1139 as an example for the next prompt.
[2025-11-05 07:47:30.725983 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 07:47:30.726012 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 07:47:30.726060 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,132.0,28.0,24.0,79.0,46.0,38.0,238.0,16.0,27.0,345.0,136.0,27.0,108.0,33.0,187.0,75.0,89.0,100.0,118.0,48.0,31.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,77.0,223.0,28.0,612.0,183.0,180.0,41.0,57.0,54.0,28.0,325.0,20.0,38.0,116.0,20.0,10.0,82.0,276.0,13.0,16.0,151.0,35.0,38.0,76.0,22.0,266.0,25.0,55.0,29.0,21.0,150.0,46.0,175.0,52.0,49.0,16.0]
[2025-11-05 07:47:30.726079 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:47:30.726131 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 612
[2025-11-05 07:47:30.726163 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 132
[2025-11-05 07:47:30.726206 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 38
[2025-11-05 07:47:30.726262 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 77
[2025-11-05 07:47:30.726290 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 79
[2025-11-05 07:47:30.726325 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    int cre2_opt_log_errors(cre2_options_t * opt),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    int cre2_program_size(const cre2_regexp_t * re)
[2025-11-05 07:47:30.727140 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 114, quiet_round: 0, discovered_api_pairs: 2254
[2025-11-05 07:47:30.766746 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:47:30.767094 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    int cre2_opt_log_errors(cre2_options_t * opt),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    int cre2_program_size(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^([A-Za-z]+)-([0-9]+)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Token-123 Extra\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t matches[3];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int posix_flag = 0;\n    int match_ret = 0;\n    const char * compiled_pattern = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_posix_syntax(opt, 1);\n    posix_flag = cre2_opt_posix_syntax(opt);\n    memset(matches, 0, sizeof(matches));\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pattern = cre2_pattern(re);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)posix_flag + (long)match_ret + (long)matches[0].length + (long)pattern_len + (long)text_len;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo([0-9]+)bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123bar suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int ret_consume = 0;\n    int ret_partial = 0;\n    const char * compiled_pattern = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Compile and inspect pattern\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pattern = cre2_pattern(re);\n\n    // step 4: Prepare input and output, perform consume\n    input.data = text_buf;\n    input.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    ret_consume = cre2_consume(pattern, &input, matches, nmatch);\n\n    // step 5: Perform partial match using same inputs and buffers\n    ret_partial = cre2_partial_match(pattern, &input, matches, nmatch);\n\n    // step 6: Validate / Cleanup\n    computed_check = (long)ret_consume + (long)ret_partial + (long)matches[0].length + (long)input.length + (long)pattern_len + (long)(unsigned char)compiled_pattern[0];\n    (void)computed_check;\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:48:03.570426 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 07:48:03.570552 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28610, Completion: 19643, Total: 48253
[2025-11-05 07:48:03.570573 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:48:03.789446 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001140/id_001140.cc
[2025-11-05 07:48:03.789499 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:04.018833 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:04.018894 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:04.021609 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:04.021642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:04.239971 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001141/id_001141.cc
[2025-11-05 07:48:04.240024 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:04.467003 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:04.467080 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:04.469919 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:04.469952 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:04.686467 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001142/id_001142.cc
[2025-11-05 07:48:04.686552 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:04.914258 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:04.914317 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:04.917095 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:04.917129 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:05.134462 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001143/id_001143.cc
[2025-11-05 07:48:05.134517 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:05.362396 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:05.362455 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:05.365224 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:05.365257 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:05.582127 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001144/id_001144.cc
[2025-11-05 07:48:05.582180 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:05.810331 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:05.810420 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:05.813147 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:05.813180 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:06.030024 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001145/id_001145.cc
[2025-11-05 07:48:06.030077 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:06.258554 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:06.258631 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:06.261540 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:06.261574 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:06.478697 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001146/id_001146.cc
[2025-11-05 07:48:06.478751 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:06.708281 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:06.708356 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:06.711123 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:06.711155 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:06.928584 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001147/id_001147.cc
[2025-11-05 07:48:06.928689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:07.157938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:07.158009 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:07.160799 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:07.160832 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:07.379347 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001148/id_001148.cc
[2025-11-05 07:48:07.379401 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:07.608233 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:07.608340 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:07.611194 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:07.611226 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:07.829522 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001149/id_001149.cc
[2025-11-05 07:48:07.829576 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:08.058637 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:08.058739 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:08.061540 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:08.061573 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:08.061609 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:48:08.061626 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1150, succ: 1149, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:48:08.061642 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:48:08.061671 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:48:08.337453 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1149 as an example for the next prompt.
[2025-11-05 07:48:08.337510 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 22 new API pairs in this round.
[2025-11-05 07:48:08.337554 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 22
[2025-11-05 07:48:08.337604 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,138.0,28.0,24.0,86.0,53.0,38.0,238.0,16.0,27.0,349.0,136.0,27.0,108.0,33.0,188.0,75.0,89.0,100.0,118.0,48.0,31.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,86.0,223.0,28.0,622.0,183.0,180.0,41.0,57.0,54.0,28.0,325.0,20.0,51.0,116.0,20.0,10.0,82.0,276.0,13.0,16.0,151.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,150.0,46.0,175.0,52.0,49.0,16.0]
[2025-11-05 07:48:08.337622 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:48:08.337674 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 100
[2025-11-05 07:48:08.337705 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 175
[2025-11-05 07:48:08.337746 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 349
[2025-11-05 07:48:08.337773 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 89
[2025-11-05 07:48:08.337810 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 136
[2025-11-05 07:48:08.337851 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_error_code(const cre2_regexp_t * re),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)
[2025-11-05 07:48:08.338674 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 115, quiet_round: 0, discovered_api_pairs: 2276
[2025-11-05 07:48:08.388961 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:48:08.389313 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_error_code(const cre2_regexp_t * re),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo([0-9]+)bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123bar suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int ret_consume = 0;\n    int ret_partial = 0;\n    const char * compiled_pattern = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Compile and inspect pattern\n    re = cre2_new(pattern, pattern_len, opt);\n    compiled_pattern = cre2_pattern(re);\n\n    // step 4: Prepare input and output, perform consume\n    input.data = text_buf;\n    input.length = text_len;\n    memset(matches, 0, sizeof(matches));\n    ret_consume = cre2_consume(pattern, &input, matches, nmatch);\n\n    // step 5: Perform partial match using same inputs and buffers\n    ret_partial = cre2_partial_match(pattern, &input, matches, nmatch);\n\n    // step 6: Validate / Cleanup\n    computed_check = (long)ret_consume + (long)ret_partial + (long)matches[0].length + (long)input.length + (long)pattern_len + (long)(unsigned char)compiled_pattern[0];\n    (void)computed_check;\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(\\\\w+)=(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int log_errors_flag = 0;\n    int program_size = 0;\n    long computed_check = 0;\n    char scratch[32];\n    (void)scratch;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    log_errors_flag = cre2_opt_log_errors(opt);\n\n    // step 3: Core operations\n    memset(scratch, 0, sizeof(scratch));\n    re = cre2_new(pattern, pattern_len, opt);\n    program_size = cre2_program_size(re);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)log_errors_flag + (long)program_size + (long)sizeof(scratch);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:48:57.112533 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 48s
[2025-11-05 07:48:57.112675 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28370, Completion: 22903, Total: 51273
[2025-11-05 07:48:57.112696 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:48:57.330201 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001150/id_001150.cc
[2025-11-05 07:48:57.330252 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:57.561114 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:57.561188 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:57.563857 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:57.563884 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:57.781425 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001151/id_001151.cc
[2025-11-05 07:48:57.781479 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:58.009677 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:58.009749 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:58.012277 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:58.012309 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:58.228895 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001152/id_001152.cc
[2025-11-05 07:48:58.228981 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:58.457396 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:58.457469 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:58.460334 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:48:58.460365 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:48:58.678086 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001153/id_001153.cc
[2025-11-05 07:48:58.678139 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:48:58.910075 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:48:58.910133 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:48:58.915350 +00:00] ERROR [src/execution/sanitize.rs:336] cre2 execution failed: stderr=, stdout=
[2025-11-05 07:48:58.915400 +00:00] WARN [src/fuzzer.rs:205] Program 1153 failed validation. Attempting to repair. Error: Execution Error: cre2 execution failed: stderr=, stdout=
[2025-11-05 07:48:58.965790 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:48:58.966132 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo([0-9]+)bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123bar suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"X$1Y\";\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int rc_set_add = 0;\n    int rc_match = 0;\n    int rc_replace = 0;\n    int rc_error = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    set = cre2_set_new(NULL, CRE2_UNANCHORED);\n    rc_set_add = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, NULL);\n\n    // step 3: Operate\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    memset(matches, 0, sizeof(matches));\n    rc_match = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n    rc_replace = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 4: Validate\n    rc_error = cre2_error_code(re);\n    computed_check = (long)rc_set_add + (long)rc_match + (long)rc_replace + (long)rc_error + (long)matches[0].length + (long)text_and_target.length + (long)rewrite.length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Execution Error\nError Details:cre2 execution failed: stderr=, stdout=\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:49:44.550712 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 07:49:44.550844 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21760, Completion: 20717, Total: 42477
[2025-11-05 07:49:44.769440 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001153/id_001153.cc
[2025-11-05 07:49:44.769493 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:49:45.001994 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:49:45.002067 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:49:45.004837 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:49:45.004870 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:49:45.004904 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1153!
[2025-11-05 07:49:45.222120 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001154/id_001154.cc
[2025-11-05 07:49:45.222175 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:49:45.452515 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:49:45.452590 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:49:45.455260 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:49:45.455287 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:49:45.673700 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001155/id_001155.cc
[2025-11-05 07:49:45.673786 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:49:45.902467 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:49:45.902543 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:49:45.905457 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:49:45.905490 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:49:46.131643 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001156/id_001156.cc
[2025-11-05 07:49:46.131696 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:49:46.360856 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:49:46.360926 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:49:46.363762 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:49:46.363796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:49:46.589441 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001157/id_001157.cc
[2025-11-05 07:49:46.589496 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:49:46.825205 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:49:46.825304 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:49:46.828249 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:49:46.828282 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:49:47.055107 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001158/id_001158.cc
[2025-11-05 07:49:47.055161 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:49:47.293147 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:49:47.293218 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:49:47.295891 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:49:47.295923 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:49:47.512528 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001159/id_001159.cc
[2025-11-05 07:49:47.512580 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:49:47.751491 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:49:47.751567 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:49:47.754509 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:49:47.754541 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:49:47.754579 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:49:47.754596 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1160, succ: 1159, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:49:47.754610 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:49:47.754636 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:49:48.067149 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1159 as an example for the next prompt.
[2025-11-05 07:49:48.067231 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 07:49:48.067287 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 07:49:48.067337 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,138.0,28.0,24.0,86.0,56.0,38.0,238.0,16.0,27.0,351.0,145.0,27.0,108.0,33.0,190.0,75.0,97.0,110.0,119.0,48.0,31.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,87.0,223.0,28.0,625.0,183.0,185.0,41.0,57.0,54.0,28.0,325.0,20.0,51.0,116.0,20.0,10.0,82.0,276.0,13.0,16.0,153.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,150.0,46.0,182.0,52.0,49.0,16.0]
[2025-11-05 07:49:48.067354 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:49:48.067407 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 75
[2025-11-05 07:49:48.067438 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 351
[2025-11-05 07:49:48.067465 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 276
[2025-11-05 07:49:48.067491 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 31
[2025-11-05 07:49:48.067524 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    void cre2_delete(cre2_regexp_t * re),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)
[2025-11-05 07:49:48.068232 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 116, quiet_round: 0, discovered_api_pairs: 2296
[2025-11-05 07:49:48.103777 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:49:48.104130 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    void cre2_delete(cre2_regexp_t * re),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(\\\\w+)=(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int log_errors_flag = 0;\n    int program_size = 0;\n    long computed_check = 0;\n    char scratch[32];\n    (void)scratch;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    log_errors_flag = cre2_opt_log_errors(opt);\n\n    // step 3: Core operations\n    memset(scratch, 0, sizeof(scratch));\n    re = cre2_new(pattern, pattern_len, opt);\n    program_size = cre2_program_size(re);\n\n    // step 4: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)log_errors_flag + (long)program_size + (long)sizeof(scratch);\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123 suffix foo45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"[$1:$2]\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t matches[3];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int replace_ret = 0;\n    int add_ret = 0;\n    int err_code = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Compile and prepare buffers\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    memset(matches, 0, sizeof(matches));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n\n    // step 4: Operate (match, add to set, and perform global replace)\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n    add_ret = cre2_set_add_simple(set, pattern);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    err_code = cre2_error_code(re);\n    computed_check = (long)match_ret + (long)replace_ret + (long)add_ret + (long)err_code\n                     + (long)matches[0].length + (long)text_and_target.length + (long)rewrite_str.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:50:33.613802 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 07:50:33.613931 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29420, Completion: 22164, Total: 51584
[2025-11-05 07:50:33.613955 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:50:33.831695 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001160/id_001160.cc
[2025-11-05 07:50:33.831749 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:34.062792 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:34.062860 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:34.065654 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:34.065686 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:34.284611 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001161/id_001161.cc
[2025-11-05 07:50:34.284697 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:34.514470 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:34.514547 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:34.517432 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:34.517465 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:34.735729 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001162/id_001162.cc
[2025-11-05 07:50:34.735813 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:34.965339 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:34.965399 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:34.968237 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:34.968270 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:35.186500 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001163/id_001163.cc
[2025-11-05 07:50:35.186554 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:35.415154 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:35.415233 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:35.418114 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:35.418147 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:35.635714 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001164/id_001164.cc
[2025-11-05 07:50:35.635768 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:35.866302 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:35.866421 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:35.869215 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:35.869247 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:36.087254 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001165/id_001165.cc
[2025-11-05 07:50:36.087307 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:36.316211 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:36.316271 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:36.319050 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:36.319082 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:36.545034 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001166/id_001166.cc
[2025-11-05 07:50:36.545086 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:36.775948 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:36.776007 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:36.778856 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:36.778890 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:36.996211 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001167/id_001167.cc
[2025-11-05 07:50:36.996296 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:37.225215 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:37.225289 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:37.228075 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:37.228107 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:37.444229 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001168/id_001168.cc
[2025-11-05 07:50:37.444282 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:37.673449 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:37.673507 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:37.676360 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:37.676395 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:37.894686 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001169/id_001169.cc
[2025-11-05 07:50:37.894739 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:50:38.123455 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:50:38.123551 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:50:38.126349 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:50:38.126381 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:50:38.126420 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:50:38.126437 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1170, succ: 1169, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:50:38.126451 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:50:38.126477 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:50:38.416342 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1169 as an example for the next prompt.
[2025-11-05 07:50:38.416397 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 07:50:38.416428 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 07:50:38.416474 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,140.0,141.0,28.0,24.0,86.0,56.0,38.0,238.0,16.0,27.0,353.0,145.0,27.0,108.0,33.0,192.0,78.0,99.0,110.0,119.0,48.0,36.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,87.0,223.0,28.0,628.0,183.0,185.0,41.0,57.0,54.0,28.0,325.0,20.0,51.0,116.0,20.0,10.0,82.0,279.0,13.0,16.0,153.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,150.0,46.0,182.0,52.0,49.0,16.0]
[2025-11-05 07:50:38.416493 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:50:38.416547 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 238
[2025-11-05 07:50:38.416578 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 145
[2025-11-05 07:50:38.416605 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 223
[2025-11-05 07:50:38.416638 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 78
[2025-11-05 07:50:38.416683 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 140
[2025-11-05 07:50:38.416722 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 07:50:38.417532 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 117, quiet_round: 0, discovered_api_pairs: 2305
[2025-11-05 07:50:38.471110 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:50:38.471477 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123 suffix foo45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"[$1:$2]\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t matches[3];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int replace_ret = 0;\n    int add_ret = 0;\n    int err_code = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Compile and prepare buffers\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    memset(matches, 0, sizeof(matches));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n\n    // step 4: Operate (match, add to set, and perform global replace)\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n    add_ret = cre2_set_add_simple(set, pattern);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    err_code = cre2_error_code(re);\n    computed_check = (long)match_ret + (long)replace_ret + (long)add_ret + (long)err_code\n                     + (long)matches[0].length + (long)text_and_target.length + (long)rewrite_str.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123 suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1-$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    int extract_ret = 0;\n    int err_code = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(target_buf, 0, sizeof(target_buf));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    target_str.data = target_buf;\n    target_str.length = 0;\n    extract_ret = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n\n    // step 4: Validate / compute lightweight checksum\n    err_code = cre2_error_code(re);\n    computed_check = (long)pattern_len + (long)text_str.length + (long)rewrite_str.length\n                     + (long)target_str.length + (long)extract_ret + (long)err_code + (long)enc;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:51:30.110353 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 51s
[2025-11-05 07:51:30.110475 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31590, Completion: 22355, Total: 53945
[2025-11-05 07:51:30.110496 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:51:30.328985 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001170/id_001170.cc
[2025-11-05 07:51:30.329039 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:30.558302 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:30.558359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:30.561198 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:30.561230 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:30.779326 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001171/id_001171.cc
[2025-11-05 07:51:30.779380 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:31.008471 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:31.008545 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:31.011154 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:31.011181 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:31.229228 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001172/id_001172.cc
[2025-11-05 07:51:31.229314 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:31.459520 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:31.459581 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:31.462474 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:31.462506 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:31.680318 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001173/id_001173.cc
[2025-11-05 07:51:31.680373 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:31.909199 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:31.909273 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:31.911849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:31.911880 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:32.130489 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001174/id_001174.cc
[2025-11-05 07:51:32.130543 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:32.359521 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:32.359609 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:32.362444 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:32.362476 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:32.580096 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001175/id_001175.cc
[2025-11-05 07:51:32.580151 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:32.807938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:32.808009 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:32.810830 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:32.810862 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:33.029994 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001176/id_001176.cc
[2025-11-05 07:51:33.030048 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:33.260679 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:33.260756 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:33.263514 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:33.263548 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:33.481236 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001177/id_001177.cc
[2025-11-05 07:51:33.481339 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:33.718902 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:33.718980 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:33.721749 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:33.721782 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:33.939466 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001178/id_001178.cc
[2025-11-05 07:51:33.939520 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:34.168614 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:34.168701 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:34.171546 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:34.171578 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:34.389907 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001179/id_001179.cc
[2025-11-05 07:51:34.389964 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:51:34.619568 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:51:34.619665 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:51:34.622442 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:51:34.622474 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:51:34.622514 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:51:34.622530 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1180, succ: 1179, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:51:34.622545 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:51:34.622570 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:51:34.932836 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1179 as an example for the next prompt.
[2025-11-05 07:51:34.932891 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 07:51:34.932922 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 07:51:34.932977 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,145.0,141.0,28.0,24.0,86.0,56.0,38.0,244.0,16.0,27.0,354.0,150.0,27.0,108.0,33.0,192.0,79.0,101.0,110.0,119.0,48.0,36.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,87.0,223.0,28.0,630.0,183.0,185.0,41.0,57.0,54.0,28.0,325.0,20.0,51.0,116.0,20.0,10.0,82.0,279.0,13.0,16.0,153.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,150.0,46.0,182.0,52.0,49.0,16.0]
[2025-11-05 07:51:34.932995 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:51:34.933053 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 630
[2025-11-05 07:51:34.933088 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 192
[2025-11-05 07:51:34.933115 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 354
[2025-11-05 07:51:34.933146 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 325
[2025-11-05 07:51:34.933187 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_options_t *cre2_opt_new(),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 07:51:34.933903 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 118, quiet_round: 0, discovered_api_pairs: 2314
[2025-11-05 07:51:34.973656 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:51:34.974036 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_options_t *cre2_opt_new(),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123 suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1-$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    int extract_ret = 0;\n    int err_code = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(target_buf, 0, sizeof(target_buf));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    target_str.data = target_buf;\n    target_str.length = 0;\n    extract_ret = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n\n    // step 4: Validate / compute lightweight checksum\n    err_code = cre2_error_code(re);\n    computed_check = (long)pattern_len + (long)text_str.length + (long)rewrite_str.length\n                     + (long)target_str.length + (long)extract_ret + (long)err_code + (long)enc;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123 suffix foo45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int replace_ret = 0;\n    int num_groups = 0;\n    int err_code = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Compile and prepare buffers\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(matches, 0, sizeof(matches));\n    memset(target_buf, 0, sizeof(target_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n\n    // step 4: Operate (match, inspect groups, and perform replace)\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n    num_groups = cre2_num_capturing_groups(re);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    err_code = cre2_error_code(re);\n    computed_check = (long)match_ret + (long)replace_ret + (long)num_groups + (long)err_code\n                     + (long)matches[0].length + (long)text_and_target.length + (long)rewrite_str.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:52:11.412850 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 36s
[2025-11-05 07:52:11.412978 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30630, Completion: 18714, Total: 49344
[2025-11-05 07:52:11.412998 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:52:11.629854 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001180/id_001180.cc
[2025-11-05 07:52:11.629906 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:11.862418 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:11.862488 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:11.865209 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:11.865241 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:12.083724 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001181/id_001181.cc
[2025-11-05 07:52:12.083777 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:12.313439 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:12.313512 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:12.316084 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:12.316115 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:12.534672 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001182/id_001182.cc
[2025-11-05 07:52:12.534771 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:12.764110 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:12.764182 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:12.767055 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:12.767081 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:12.983949 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001183/id_001183.cc
[2025-11-05 07:52:12.984003 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:13.223147 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:13.223220 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:13.226137 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:13.226170 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:13.443240 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001184/id_001184.cc
[2025-11-05 07:52:13.443294 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:13.679922 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:13.680032 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:13.682828 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:13.682860 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:13.903470 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001185/id_001185.cc
[2025-11-05 07:52:13.903524 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:14.133074 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:14.133147 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:14.135655 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:14.135687 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:14.354038 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001186/id_001186.cc
[2025-11-05 07:52:14.354092 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:14.581476 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:14.581537 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:14.584361 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:14.584394 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:14.802849 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001187/id_001187.cc
[2025-11-05 07:52:14.802933 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:15.029838 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:15.029910 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:15.032792 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:15.032825 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:15.250299 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001188/id_001188.cc
[2025-11-05 07:52:15.250354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:15.485304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:15.485376 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:15.488011 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:15.488044 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:15.712849 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001189/id_001189.cc
[2025-11-05 07:52:15.712903 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:52:15.941132 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:52:15.941237 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:52:15.943793 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:52:15.943825 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:52:15.943863 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:52:15.943878 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1190, succ: 1189, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:52:15.943894 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:52:15.943920 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:52:16.222057 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1189 as an example for the next prompt.
[2025-11-05 07:52:16.222113 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 5 new API pairs in this round.
[2025-11-05 07:52:16.222140 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 5
[2025-11-05 07:52:16.222188 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,145.0,141.0,28.0,24.0,86.0,56.0,38.0,246.0,16.0,27.0,354.0,150.0,27.0,108.0,33.0,193.0,79.0,104.0,110.0,119.0,48.0,36.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,88.0,224.0,28.0,631.0,183.0,185.0,41.0,57.0,54.0,28.0,328.0,20.0,51.0,116.0,20.0,10.0,82.0,279.0,13.0,16.0,153.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,150.0,46.0,182.0,52.0,49.0,16.0]
[2025-11-05 07:52:16.222207 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:52:16.222262 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 46
[2025-11-05 07:52:16.222298 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 145
[2025-11-05 07:52:16.222351 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 631
[2025-11-05 07:52:16.222390 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 110
[2025-11-05 07:52:16.222472 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 116
[2025-11-05 07:52:16.222515 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:52:16.223372 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 119, quiet_round: 0, discovered_api_pairs: 2319
[2025-11-05 07:52:16.275711 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:52:16.276081 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo123 suffix foo45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t matches[4];\n    const int nmatch = (int)(sizeof(matches) / sizeof(matches[0]));\n    int match_ret = 0;\n    int replace_ret = 0;\n    int num_groups = 0;\n    int err_code = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Compile and prepare buffers\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(matches, 0, sizeof(matches));\n    memset(target_buf, 0, sizeof(target_buf));\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n\n    // step 4: Operate (match, inspect groups, and perform replace)\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, nmatch);\n    num_groups = cre2_num_capturing_groups(re);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    err_code = cre2_error_code(re);\n    computed_check = (long)match_ret + (long)replace_ret + (long)num_groups + (long)err_code\n                     + (long)matches[0].length + (long)text_and_target.length + (long)rewrite_str.length + (long)pattern_len;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)-([0-9]{1,4})$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo-123\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    int easy_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&match, 0, sizeof(match));\n\n    // step 3: Compile\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)easy_ret + (long)match.length + (long)(re != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:53:01.368508 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 07:53:01.368660 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29530, Completion: 27303, Total: 56833
[2025-11-05 07:53:01.368681 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:53:01.586352 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001190/id_001190.cc
[2025-11-05 07:53:01.586406 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:01.822368 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:01.822443 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:01.825350 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:01.825382 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:02.043549 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001191/id_001191.cc
[2025-11-05 07:53:02.043601 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:02.279173 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:02.279239 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:02.282250 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:02.282283 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:02.507249 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001192/id_001192.cc
[2025-11-05 07:53:02.507334 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:02.746745 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:02.746814 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:02.749768 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:02.749800 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:02.976809 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001193/id_001193.cc
[2025-11-05 07:53:02.976873 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:03.212564 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:03.212655 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:03.215330 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:03.215357 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:03.441169 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001194/id_001194.cc
[2025-11-05 07:53:03.441221 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:03.680023 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:03.680112 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:03.683090 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:03.683123 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:03.909998 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001195/id_001195.cc
[2025-11-05 07:53:03.910052 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:04.149687 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:04.149754 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:04.152297 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:04.152330 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:04.378998 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001196/id_001196.cc
[2025-11-05 07:53:04.379050 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:04.617040 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:04.617113 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:04.619769 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:04.619802 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:04.845195 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001197/id_001197.cc
[2025-11-05 07:53:04.845278 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:05.083692 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:05.083770 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:05.086673 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:05.086706 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:05.314576 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001198/id_001198.cc
[2025-11-05 07:53:05.314629 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:05.551736 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:05.551796 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:05.554662 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:05.554694 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:05.781623 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001199/id_001199.cc
[2025-11-05 07:53:05.781689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:06.021570 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:06.021657 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:06.024373 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:06.024400 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:06.024438 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:53:06.024453 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1200, succ: 1199, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:53:06.024468 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:53:06.024495 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:53:06.342841 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1199 as an example for the next prompt.
[2025-11-05 07:53:06.342896 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 07:53:06.342934 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 07:53:06.342983 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,151.0,141.0,28.0,24.0,86.0,56.0,38.0,246.0,16.0,27.0,355.0,150.0,27.0,108.0,33.0,193.0,83.0,105.0,114.0,119.0,48.0,36.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,88.0,225.0,28.0,637.0,183.0,185.0,41.0,57.0,54.0,28.0,328.0,20.0,51.0,122.0,20.0,10.0,82.0,279.0,13.0,16.0,153.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,150.0,52.0,182.0,52.0,49.0,16.0]
[2025-11-05 07:53:06.343000 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:53:06.343053 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 279
[2025-11-05 07:53:06.343085 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 150
[2025-11-05 07:53:06.343110 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 77
[2025-11-05 07:53:06.343135 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 122
[2025-11-05 07:53:06.343161 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 36
[2025-11-05 07:53:06.343200 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    void cre2_opt_delete(cre2_options_t * opt),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)
[2025-11-05 07:53:06.344026 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 120, quiet_round: 0, discovered_api_pairs: 2334
[2025-11-05 07:53:06.390581 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:53:06.390936 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    void cre2_opt_delete(cre2_options_t * opt),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)-([0-9]{1,4})$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo-123\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    int easy_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&match, 0, sizeof(match));\n\n    // step 3: Compile\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)easy_ret + (long)match.length + (long)(re != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char consume_pattern[] = \"^(foo)([0-9]+)\";\n    const int consume_pattern_len = (int)(sizeof(consume_pattern) - 1);\n    const char partial_pattern[] = \"foo([0-9]+)\";\n    const int partial_pattern_len = (int)(sizeof(partial_pattern) - 1);\n    char text_buf[] = \"foo123 and foo45 foo999 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input_str;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t partial_matches[4];\n    cre2_string_t consume_matches[4];\n    int partial_ret = 0;\n    int consume_ret = 0;\n    int replace_ret = 0;\n    int greplace_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&input_str, 0, sizeof(input_str));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    memset(consume_matches, 0, sizeof(consume_matches));\n    input_str.data = text_buf;\n    input_str.length = text_len;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    re = cre2_new(pattern, pattern_len, NULL);\n\n    // step 3: Core operations - partial match and consume\n    partial_ret = cre2_partial_match(partial_pattern, &input_str, partial_matches, 2);\n    consume_ret = cre2_consume(consume_pattern, &input_str, consume_matches, 2);\n\n    // step 4: Core operations - replacements using compiled regexp\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite_str);\n    greplace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)partial_ret + (long)consume_ret + (long)replace_ret + (long)greplace_ret\n                     + (long)input_str.length + (long)text_and_target.length + (long)rewrite_str.length\n                     + (long)partial_matches[0].length + (long)consume_matches[0].length + (long)(re != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:53:47.466424 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 07:53:47.466544 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30670, Completion: 23524, Total: 54194
[2025-11-05 07:53:47.466565 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:53:47.684320 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001200/id_001200.cc
[2025-11-05 07:53:47.684373 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:47.921708 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:47.921768 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:47.924658 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:47.924692 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:48.150800 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001201/id_001201.cc
[2025-11-05 07:53:48.150853 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:48.382930 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:48.383008 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:48.385892 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:48.385924 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:48.607166 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001202/id_001202.cc
[2025-11-05 07:53:48.607250 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:48.837273 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:48.837350 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:48.840064 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:48.840096 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:49.058390 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001203/id_001203.cc
[2025-11-05 07:53:49.058444 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:49.287261 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:49.287338 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:49.290177 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:49.290234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:49.516473 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001204/id_001204.cc
[2025-11-05 07:53:49.516526 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:49.746719 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:49.746809 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:49.749659 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:49.749692 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:49.975436 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001205/id_001205.cc
[2025-11-05 07:53:49.975490 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:50.205755 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:50.205831 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:50.208581 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:50.208615 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:50.435018 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001206/id_001206.cc
[2025-11-05 07:53:50.435072 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:50.664430 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:50.664508 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:50.667246 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:50.667272 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:50.893452 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001207/id_001207.cc
[2025-11-05 07:53:50.893538 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:51.124312 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:51.124390 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:51.127504 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:51.127536 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:51.352898 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001208/id_001208.cc
[2025-11-05 07:53:51.352950 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:51.583702 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:51.583777 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:51.586761 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:51.586794 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:51.812734 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001209/id_001209.cc
[2025-11-05 07:53:51.812789 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:53:52.043189 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:53:52.043298 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:53:52.046198 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:53:52.046232 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:53:52.046270 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:53:52.046287 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1210, succ: 1209, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:53:52.046303 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:53:52.046329 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:53:52.356707 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1209 as an example for the next prompt.
[2025-11-05 07:53:52.356765 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 14 new API pairs in this round.
[2025-11-05 07:53:52.356801 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 14
[2025-11-05 07:53:52.356849 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,48.0,151.0,141.0,28.0,24.0,86.0,56.0,38.0,246.0,16.0,27.0,356.0,150.0,27.0,108.0,33.0,194.0,83.0,105.0,114.0,119.0,48.0,43.0,27.0,18.0,42.0,131.0,89.0,16.0,24.0,88.0,225.0,28.0,642.0,190.0,185.0,41.0,57.0,54.0,28.0,328.0,20.0,51.0,130.0,20.0,10.0,82.0,286.0,13.0,16.0,153.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,153.0,52.0,182.0,52.0,49.0,16.0]
[2025-11-05 07:53:52.356867 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:53:52.356920 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 48
[2025-11-05 07:53:52.356952 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 151
[2025-11-05 07:53:52.356978 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 88
[2025-11-05 07:53:52.357009 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 185
[2025-11-05 07:53:52.357037 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 642
[2025-11-05 07:53:52.357076 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 07:53:52.357900 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 121, quiet_round: 0, discovered_api_pairs: 2348
[2025-11-05 07:53:52.409668 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:53:52.410026 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char consume_pattern[] = \"^(foo)([0-9]+)\";\n    const int consume_pattern_len = (int)(sizeof(consume_pattern) - 1);\n    const char partial_pattern[] = \"foo([0-9]+)\";\n    const int partial_pattern_len = (int)(sizeof(partial_pattern) - 1);\n    char text_buf[] = \"foo123 and foo45 foo999 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input_str;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t partial_matches[4];\n    cre2_string_t consume_matches[4];\n    int partial_ret = 0;\n    int consume_ret = 0;\n    int replace_ret = 0;\n    int greplace_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&input_str, 0, sizeof(input_str));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    memset(consume_matches, 0, sizeof(consume_matches));\n    input_str.data = text_buf;\n    input_str.length = text_len;\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    re = cre2_new(pattern, pattern_len, NULL);\n\n    // step 3: Core operations - partial match and consume\n    partial_ret = cre2_partial_match(partial_pattern, &input_str, partial_matches, 2);\n    consume_ret = cre2_consume(consume_pattern, &input_str, consume_matches, 2);\n\n    // step 4: Core operations - replacements using compiled regexp\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite_str);\n    greplace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)partial_ret + (long)consume_ret + (long)replace_ret + (long)greplace_ret\n                     + (long)input_str.length + (long)text_and_target.length + (long)rewrite_str.length\n                     + (long)partial_matches[0].length + (long)consume_matches[0].length + (long)(re != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char partial_pattern[] = \"foo([0-9]+)\";\n    const int partial_pattern_len = (int)(sizeof(partial_pattern) - 1);\n    char text_buf[] = \"foo123 and bar45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t input;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t partial_matches[4];\n    int partial_ret = 0;\n    int extract_ret = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(&target_str, 0, sizeof(target_str));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    input.data = text_buf;\n    input.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Core operations\n    partial_ret = cre2_partial_match(partial_pattern, &input, partial_matches, 2);\n    extract_ret = cre2_extract_re(re, &input, &rewrite_str, &target_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)partial_pattern_len + (long)text_len\n                     + (long)partial_ret + (long)extract_ret + (long)rewrite_str.length\n                     + (long)target_str.length + (long)partial_matches[0].length\n                     + (long)(re != NULL) + (long)enc;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:54:36.865318 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 44s
[2025-11-05 07:54:36.865434 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33670, Completion: 21708, Total: 55378
[2025-11-05 07:54:36.865455 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:54:37.084480 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001210/id_001210.cc
[2025-11-05 07:54:37.084532 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:37.314053 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:37.314128 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:37.316966 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:37.316998 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:37.533152 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001211/id_001211.cc
[2025-11-05 07:54:37.533205 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:37.763295 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:37.763366 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:37.766282 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:37.766314 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:37.983775 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001212/id_001212.cc
[2025-11-05 07:54:37.983857 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:38.212611 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:38.212684 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:38.215332 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:38.215380 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:38.433899 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001213/id_001213.cc
[2025-11-05 07:54:38.433952 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:38.664011 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:38.664085 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:38.666849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:38.666880 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:38.884359 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001214/id_001214.cc
[2025-11-05 07:54:38.884412 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:39.113783 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:39.113882 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:39.116719 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:39.116753 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:39.334950 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001215/id_001215.cc
[2025-11-05 07:54:39.335001 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:39.565565 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:39.565623 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:39.568339 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:39.568372 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:39.786513 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001216/id_001216.cc
[2025-11-05 07:54:39.786567 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:40.017315 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:40.017374 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:40.020137 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:40.020169 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:40.239077 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001217/id_001217.cc
[2025-11-05 07:54:40.239161 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:40.469324 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:40.469396 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:40.472013 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:40.472045 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:40.698726 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001218/id_001218.cc
[2025-11-05 07:54:40.698779 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:40.927292 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:40.927369 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:40.930052 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:40.930084 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:41.154640 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001219/id_001219.cc
[2025-11-05 07:54:41.154692 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:54:41.384680 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:54:41.384795 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:54:41.387436 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:54:41.387470 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:54:41.387509 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:54:41.387528 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1220, succ: 1219, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:54:41.387543 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:54:41.387569 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:54:41.696566 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1219 as an example for the next prompt.
[2025-11-05 07:54:41.696626 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 07:54:41.696670 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 07:54:41.696718 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,28.0,24.0,86.0,56.0,38.0,246.0,16.0,27.0,358.0,150.0,27.0,108.0,33.0,195.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,42.0,135.0,89.0,16.0,24.0,92.0,225.0,28.0,651.0,190.0,191.0,41.0,57.0,54.0,28.0,328.0,20.0,51.0,130.0,20.0,10.0,82.0,286.0,13.0,16.0,158.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,153.0,52.0,183.0,52.0,49.0,16.0]
[2025-11-05 07:54:41.696736 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:54:41.696788 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 130
[2025-11-05 07:54:41.696822 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 190
[2025-11-05 07:54:41.696851 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 135
[2025-11-05 07:54:41.696877 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 651
[2025-11-05 07:54:41.696903 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 328
[2025-11-05 07:54:41.696941 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_set_compile(cre2_set * set),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 07:54:41.697764 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 122, quiet_round: 0, discovered_api_pairs: 2368
[2025-11-05 07:54:41.750398 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:54:41.750770 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_set_compile(cre2_set * set),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char partial_pattern[] = \"foo([0-9]+)\";\n    const int partial_pattern_len = (int)(sizeof(partial_pattern) - 1);\n    char text_buf[] = \"foo123 and bar45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t input;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t partial_matches[4];\n    int partial_ret = 0;\n    int extract_ret = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(&target_str, 0, sizeof(target_str));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    input.data = text_buf;\n    input.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Core operations\n    partial_ret = cre2_partial_match(partial_pattern, &input, partial_matches, 2);\n    extract_ret = cre2_extract_re(re, &input, &rewrite_str, &target_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)partial_pattern_len + (long)text_len\n                     + (long)partial_ret + (long)extract_ret + (long)rewrite_str.length\n                     + (long)target_str.length + (long)partial_matches[0].length\n                     + (long)(re != NULL) + (long)enc;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char input_buf[] = \"foo123 and foo45 end\";\n    const int input_len = (int)(sizeof(input_buf) - 1);\n    char replace_buf[] = \"$1:$2\";\n    const int replace_len = (int)(sizeof(replace_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t consume_matches[4];\n    int consume_ret = 0;\n    int replace_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(consume_matches, 0, sizeof(consume_matches));\n    input.data = input_buf;\n    input.length = input_len;\n    text_and_target.data = input_buf;\n    text_and_target.length = input_len;\n    rewrite_str.data = replace_buf;\n    rewrite_str.length = replace_len;\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Core operations\n    consume_ret = cre2_consume_re(re, &input, consume_matches, 4);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)input.length + (long)rewrite_str.length\n                     + (long)consume_ret + (long)replace_ret\n                     + (long)consume_matches[0].length + (long)(re != NULL)\n                     + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:55:19.888259 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 07:55:19.888380 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32270, Completion: 21900, Total: 54170
[2025-11-05 07:55:19.888400 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:55:20.106164 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001220/id_001220.cc
[2025-11-05 07:55:20.106216 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:20.336269 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:20.336339 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:20.339210 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:20.339236 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:20.556289 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001221/id_001221.cc
[2025-11-05 07:55:20.556342 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:20.791872 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:20.791941 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:20.794847 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:20.794878 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:21.013496 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001222/id_001222.cc
[2025-11-05 07:55:21.013596 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:21.248917 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:21.248990 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:21.251748 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:21.251779 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:21.469210 +00:00] WARN [src/fuzzer.rs:205] Program 1223 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001223/id_001223.cc:45:11: error: no matching function for call to 'cre2_set_new'
   45 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:55:21.522444 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:55:21.522847 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char partial_pattern[] = \"foo([0-9]+)\";\n    const int partial_pattern_len = (int)(sizeof(partial_pattern) - 1);\n    char text_buf[] = \"foo123 and bar45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t input;\n    cre2_string_t easy_match_results[4];\n    cre2_string_t partial_matches[4];\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int compile_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(easy_match_results, 0, sizeof(easy_match_results));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    input.data = text_buf;\n    input.length = text_len;\n\n    // step 3: Configure\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, partial_pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    easy_ret = cre2_easy_match(partial_pattern, partial_pattern_len, text_buf, text_len, easy_match_results, 4);\n    partial_ret = cre2_partial_match(partial_pattern, &input, partial_matches, 4);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)partial_pattern_len + (long)text_len\n                     + (long)easy_ret + (long)partial_ret + (long)compile_ret\n                     + (long)easy_match_results[0].length + (long)partial_matches[0].length\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001223/id_001223.cc:45:11: error: no matching function for call to 'cre2_set_new'\n   45 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:55:54.360005 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 07:55:54.360140 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24000, Completion: 13241, Total: 37241
[2025-11-05 07:55:54.587250 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001223/id_001223.cc
[2025-11-05 07:55:54.587304 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:54.823201 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:54.823274 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:54.825977 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:54.826010 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:54.826043 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1223!
[2025-11-05 07:55:55.045220 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001224/id_001224.cc
[2025-11-05 07:55:55.045274 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:55.281384 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:55.281457 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:55.284267 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:55.284301 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:55.509464 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001225/id_001225.cc
[2025-11-05 07:55:55.509548 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:55.737650 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:55.737721 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:55.740615 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:55.740658 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:55.965995 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001226/id_001226.cc
[2025-11-05 07:55:55.966048 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:56.196877 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:56.196952 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:56.200078 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:56.200111 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:56.426312 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001227/id_001227.cc
[2025-11-05 07:55:56.426366 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:56.656125 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:56.656231 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:56.659025 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:56.659082 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:56.885116 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001228/id_001228.cc
[2025-11-05 07:55:56.885170 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:57.115350 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:57.115424 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:57.118293 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:57.118324 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:57.343771 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001229/id_001229.cc
[2025-11-05 07:55:57.343823 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:55:57.584588 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:55:57.584676 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:55:57.587311 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:55:57.587337 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:55:57.587374 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:55:57.587388 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1230, succ: 1229, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:55:57.587403 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:55:57.587434 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:55:57.891401 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1229 as an example for the next prompt.
[2025-11-05 07:55:57.891482 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 07:55:57.891528 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 07:55:57.891576 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,28.0,24.0,86.0,56.0,38.0,246.0,16.0,27.0,359.0,150.0,27.0,108.0,33.0,195.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,42.0,147.0,89.0,16.0,24.0,97.0,227.0,28.0,655.0,196.0,192.0,41.0,57.0,54.0,28.0,338.0,20.0,51.0,138.0,20.0,10.0,82.0,286.0,13.0,16.0,158.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,157.0,52.0,186.0,52.0,49.0,16.0]
[2025-11-05 07:55:57.891597 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:55:57.891650 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 655
[2025-11-05 07:55:57.891681 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 196
[2025-11-05 07:55:57.891710 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 338
[2025-11-05 07:55:57.891736 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 150
[2025-11-05 07:55:57.891785 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 186
[2025-11-05 07:55:57.891829 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 07:55:57.892691 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 123, quiet_round: 0, discovered_api_pairs: 2388
[2025-11-05 07:55:57.955950 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:55:57.956329 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char input_buf[] = \"foo123 and foo45 end\";\n    const int input_len = (int)(sizeof(input_buf) - 1);\n    char replace_buf[] = \"$1:$2\";\n    const int replace_len = (int)(sizeof(replace_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t consume_matches[4];\n    int consume_ret = 0;\n    int replace_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(consume_matches, 0, sizeof(consume_matches));\n    input.data = input_buf;\n    input.length = input_len;\n    text_and_target.data = input_buf;\n    text_and_target.length = input_len;\n    rewrite_str.data = replace_buf;\n    rewrite_str.length = replace_len;\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Core operations\n    consume_ret = cre2_consume_re(re, &input, consume_matches, 4);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)input.length + (long)rewrite_str.length\n                     + (long)consume_ret + (long)replace_ret\n                     + (long)consume_matches[0].length + (long)(re != NULL)\n                     + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char partial_pattern[] = \"foo([0-9]+)\";\n    const int partial_pattern_len = (int)(sizeof(partial_pattern) - 1);\n    char text_buf[] = \"foo123 and bar45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t input;\n    cre2_string_t easy_match;\n    cre2_string_t partial_matches[4];\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int set_compile_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    input.data = text_buf;\n    input.length = text_len;\n    easy_match.data = NULL;\n    easy_match.length = 0;\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, \"foo[0-9]+\");\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    set_compile_ret = cre2_set_compile(set);\n    easy_ret = cre2_easy_match(partial_pattern, partial_pattern_len, text_buf, text_len, &easy_match, 2);\n    partial_ret = cre2_partial_match(partial_pattern, &input, partial_matches, 2);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)partial_pattern_len + (long)text_len\n                     + (long)set_compile_ret + (long)easy_ret + (long)partial_ret\n                     + (long)easy_match.length + (long)partial_matches[0].length\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:56:46.931510 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 49s
[2025-11-05 07:56:46.931631 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33150, Completion: 20120, Total: 53270
[2025-11-05 07:56:46.931654 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:56:47.150477 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001230/id_001230.cc
[2025-11-05 07:56:47.150528 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:47.388177 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:47.388232 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:47.391082 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:47.391114 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:47.619143 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001231/id_001231.cc
[2025-11-05 07:56:47.619207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:47.849414 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:47.849471 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:47.852275 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:47.852300 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:48.080015 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001232/id_001232.cc
[2025-11-05 07:56:48.080101 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:48.311479 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:48.311549 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:48.314795 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:48.314827 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:48.539933 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001233/id_001233.cc
[2025-11-05 07:56:48.539984 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:48.771238 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:48.771304 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:48.774135 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:48.774168 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:49.000812 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001234/id_001234.cc
[2025-11-05 07:56:49.000864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:49.230647 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:49.230764 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:49.233652 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:49.233685 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:49.460595 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001235/id_001235.cc
[2025-11-05 07:56:49.460657 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:49.689692 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:49.689767 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:49.692591 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:49.692636 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:49.918189 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001236/id_001236.cc
[2025-11-05 07:56:49.918240 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:50.149268 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:50.149326 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:50.152068 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:50.152100 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:50.381620 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001237/id_001237.cc
[2025-11-05 07:56:50.381704 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:50.611403 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:50.611479 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:50.614723 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:50.614754 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:50.844090 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001238/id_001238.cc
[2025-11-05 07:56:50.844141 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:51.075111 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:51.075176 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:51.078004 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:51.078038 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:51.305255 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001239/id_001239.cc
[2025-11-05 07:56:51.305306 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:56:51.540528 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:56:51.540630 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:56:51.543268 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:56:51.543301 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:56:51.543340 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:56:51.543357 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1240, succ: 1239, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:56:51.543371 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:56:51.543398 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:56:51.843297 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1239 as an example for the next prompt.
[2025-11-05 07:56:51.843353 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 07:56:51.843383 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 07:56:51.843430 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,28.0,24.0,86.0,56.0,38.0,246.0,16.0,27.0,359.0,153.0,27.0,108.0,33.0,195.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,42.0,147.0,89.0,16.0,24.0,102.0,227.0,28.0,657.0,197.0,194.0,41.0,57.0,54.0,28.0,342.0,20.0,51.0,138.0,20.0,10.0,82.0,286.0,13.0,16.0,158.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,158.0,52.0,192.0,52.0,49.0,16.0]
[2025-11-05 07:56:51.843448 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:56:51.843500 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 657
[2025-11-05 07:56:51.843531 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_string energy: 28
[2025-11-05 07:56:51.843558 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 359
[2025-11-05 07:56:51.843624 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume energy: 42
[2025-11-05 07:56:51.843672 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    const char *cre2_version_string(),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int )
[2025-11-05 07:56:51.844383 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 124, quiet_round: 0, discovered_api_pairs: 2397
[2025-11-05 07:56:51.880676 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:56:51.881024 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    const char *cre2_version_string(),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char partial_pattern[] = \"foo([0-9]+)\";\n    const int partial_pattern_len = (int)(sizeof(partial_pattern) - 1);\n    char text_buf[] = \"foo123 and bar45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t input;\n    cre2_string_t easy_match;\n    cre2_string_t partial_matches[4];\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int set_compile_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    input.data = text_buf;\n    input.length = text_len;\n    easy_match.data = NULL;\n    easy_match.length = 0;\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, \"foo[0-9]+\");\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    set_compile_ret = cre2_set_compile(set);\n    easy_ret = cre2_easy_match(partial_pattern, partial_pattern_len, text_buf, text_len, &easy_match, 2);\n    partial_ret = cre2_partial_match(partial_pattern, &input, partial_matches, 2);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)partial_pattern_len + (long)text_len\n                     + (long)set_compile_ret + (long)easy_ret + (long)partial_ret\n                     + (long)easy_match.length + (long)partial_matches[0].length\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char easy_pattern[] = \"foo([0-9]+)\";\n    const int easy_pattern_len = (int)(sizeof(easy_pattern) - 1);\n    char text_buf[] = \"foo123 and foo45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t easy_match;\n    cre2_string_t matches[4];\n    int easy_ret = 0;\n    int match_ret = 0;\n    int set_add_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(matches, 0, sizeof(matches));\n    easy_match.data = NULL;\n    easy_match.length = 0;\n    matches[0].data = NULL;\n    matches[0].length = 0;\n\n    // step 3: Configure / create regex\n    set_add_ret = cre2_set_add_simple(set, \"foo[0-9]+\");\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Core operations\n    easy_ret = cre2_easy_match(easy_pattern, easy_pattern_len, text_buf, text_len, &easy_match, 2);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, 4);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)easy_pattern_len + (long)text_len\n                     + (long)easy_ret + (long)match_ret + (long)set_add_ret\n                     + (long)easy_match.length + (long)matches[0].length\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL)\n                     + (long)(iter != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:57:37.498850 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 07:57:37.498976 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32340, Completion: 21374, Total: 53714
[2025-11-05 07:57:37.498996 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:57:37.716052 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001240/id_001240.cc
[2025-11-05 07:57:37.716104 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:37.951376 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:37.951436 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:37.954281 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:37.954314 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:38.172285 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001241/id_001241.cc
[2025-11-05 07:57:38.172350 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:38.407724 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:38.407792 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:38.410730 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:38.410763 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:38.628050 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001242/id_001242.cc
[2025-11-05 07:57:38.628136 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:38.866343 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:38.866403 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:38.869255 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:38.869286 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:39.096738 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001243/id_001243.cc
[2025-11-05 07:57:39.096792 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:39.334022 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:39.334093 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:39.336956 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:39.336989 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:39.565232 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001244/id_001244.cc
[2025-11-05 07:57:39.565285 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:39.801337 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:39.801426 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:39.804209 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:39.804241 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:40.030956 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001245/id_001245.cc
[2025-11-05 07:57:40.031010 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:40.268405 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:40.268477 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:40.271318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:40.271350 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:40.497434 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001246/id_001246.cc
[2025-11-05 07:57:40.497486 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:40.734646 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:40.734705 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:40.737566 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:40.737599 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:40.965100 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001247/id_001247.cc
[2025-11-05 07:57:40.965199 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:41.195683 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:41.195740 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:41.198499 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:41.198531 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:41.426609 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001248/id_001248.cc
[2025-11-05 07:57:41.426662 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:41.657762 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:41.657834 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:41.660619 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:41.660677 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:41.887441 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001249/id_001249.cc
[2025-11-05 07:57:41.887495 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:57:42.120019 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:57:42.120108 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:57:42.122998 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:57:42.123031 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:57:42.123069 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:57:42.123085 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1250, succ: 1249, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:57:42.123100 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:57:42.123125 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:57:42.400392 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1249 as an example for the next prompt.
[2025-11-05 07:57:42.400447 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 18 new API pairs in this round.
[2025-11-05 07:57:42.400487 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 18
[2025-11-05 07:57:42.400536 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,24.0,86.0,56.0,38.0,246.0,16.0,27.0,361.0,153.0,27.0,108.0,33.0,196.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,49.0,147.0,89.0,16.0,24.0,111.0,227.0,28.0,666.0,197.0,194.0,41.0,57.0,54.0,28.0,342.0,20.0,51.0,138.0,20.0,10.0,82.0,286.0,13.0,16.0,158.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,158.0,52.0,192.0,52.0,49.0,16.0]
[2025-11-05 07:57:42.400554 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:57:42.400605 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 227
[2025-11-05 07:57:42.400644 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 666
[2025-11-05 07:57:42.400673 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 122
[2025-11-05 07:57:42.400705 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 86
[2025-11-05 07:57:42.400738 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_set_delete(cre2_set * set),
    int cre2_program_size(const cre2_regexp_t * re)
[2025-11-05 07:57:42.401453 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 125, quiet_round: 0, discovered_api_pairs: 2415
[2025-11-05 07:57:42.435729 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:57:42.436082 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_set_delete(cre2_set * set),\n    int cre2_program_size(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char easy_pattern[] = \"foo([0-9]+)\";\n    const int easy_pattern_len = (int)(sizeof(easy_pattern) - 1);\n    char text_buf[] = \"foo123 and foo45 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t easy_match;\n    cre2_string_t matches[4];\n    int easy_ret = 0;\n    int match_ret = 0;\n    int set_add_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    memset(&easy_match, 0, sizeof(easy_match));\n    memset(matches, 0, sizeof(matches));\n    easy_match.data = NULL;\n    easy_match.length = 0;\n    matches[0].data = NULL;\n    matches[0].length = 0;\n\n    // step 3: Configure / create regex\n    set_add_ret = cre2_set_add_simple(set, \"foo[0-9]+\");\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Core operations\n    easy_ret = cre2_easy_match(easy_pattern, easy_pattern_len, text_buf, text_len, &easy_match, 2);\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, 4);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)easy_pattern_len + (long)text_len\n                     + (long)easy_ret + (long)match_ret + (long)set_add_ret\n                     + (long)easy_match.length + (long)matches[0].length\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL)\n                     + (long)(iter != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 and then foo456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t match;\n    const char * ver = NULL;\n    int find_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&match, 0, sizeof(match));\n    input.data = text_buf;\n    input.length = text_len;\n    match.data = NULL;\n    match.length = 0;\n    ver = cre2_version_string();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    find_ret = cre2_find_and_consume(pattern, &input, &match, 1);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)find_ret\n                     + (long)match.length + (long)(re != NULL) + (long)(opt != NULL)\n                     + (long)(ver != NULL) + (long)input.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 07:58:17.910569 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 35s
[2025-11-05 07:58:17.910697 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30080, Completion: 19388, Total: 49468
[2025-11-05 07:58:17.910717 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 07:58:18.127907 +00:00] WARN [src/fuzzer.rs:205] Program 1250 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001250/id_001250.cc:32:11: error: no matching function for call to 'cre2_set_new'
   32 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:58:18.162325 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:58:18.162651 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(test)([0-9]+)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    int set_add_ret = 0;\n    int prog_size = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    set = cre2_set_new(opt, 0);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)set_add_ret + (long)prog_size\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001250/id_001250.cc:32:11: error: no matching function for call to 'cre2_set_new'\n   32 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:58:36.725318 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 18s
[2025-11-05 07:58:36.725445 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21120, Completion: 8602, Total: 29722
[2025-11-05 07:58:36.944256 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001250/id_001250.cc
[2025-11-05 07:58:36.944309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:58:37.173024 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:58:37.173095 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:58:37.175804 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:58:37.175836 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:58:37.175868 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1250!
[2025-11-05 07:58:37.393839 +00:00] WARN [src/fuzzer.rs:205] Program 1251 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001251/id_001251.cc:31:11: error: no matching function for call to 'cre2_set_new'
   31 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:58:37.428248 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:58:37.428573 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(abc)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int prog_size = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    set = cre2_set_new(opt, 0);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 3: Configure / create regex\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Core operations\n    prog_size = cre2_program_size(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)prog_size + (long)set_add_ret + (long)set_compile_ret\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001251/id_001251.cc:31:11: error: no matching function for call to 'cre2_set_new'\n   31 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:58:53.212912 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 15s
[2025-11-05 07:58:53.213049 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21390, Completion: 8051, Total: 29441
[2025-11-05 07:58:53.433557 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001251/id_001251.cc
[2025-11-05 07:58:53.433610 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:58:53.672220 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:58:53.672284 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:58:53.675137 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:58:53.675170 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:58:53.675201 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1251!
[2025-11-05 07:58:53.896595 +00:00] WARN [src/fuzzer.rs:205] Program 1252 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001252/id_001252.cc:36:11: error: no matching function for call to 'cre2_set_new'
   36 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:58:53.932207 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:58:53.932540 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char set_pattern[] = \"foo[0-9]+\";\n    const int set_pattern_len = (int)(sizeof(set_pattern) - 1);\n    char text_buf[] = \"foo123 bar456 baz789\";\n    const size_t text_len = (size_t)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    size_t set_match_ret = 0;\n    int prog_size = 0;\n    int matches[4] = {0};\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, 0);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    set_add_ret = cre2_set_add_simple(set, set_pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    set_match_ret = cre2_set_match(set, text_buf, text_len, matches, 4);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)set_pattern_len + (long)text_len\n                     + (long)set_add_ret + (long)set_compile_ret + (long)prog_size\n                     + (long)set_match_ret + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001252/id_001252.cc:36:11: error: no matching function for call to 'cre2_set_new'\n   36 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:59:17.376098 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 23s
[2025-11-05 07:59:17.376225 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22670, Completion: 11342, Total: 34012
[2025-11-05 07:59:17.602847 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001252/id_001252.cc
[2025-11-05 07:59:17.602900 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:17.831494 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:17.831552 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:17.834322 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:17.834355 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:17.834389 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1252!
[2025-11-05 07:59:18.052418 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001253/id_001253.cc
[2025-11-05 07:59:18.052470 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:18.286969 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:18.287038 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:18.289894 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:18.289928 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:18.505838 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001254/id_001254.cc
[2025-11-05 07:59:18.505922 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:18.735546 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:18.735623 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:18.738361 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:18.738393 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:18.965239 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001255/id_001255.cc
[2025-11-05 07:59:18.965291 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:19.194797 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:19.194874 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:19.197641 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:19.197673 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:19.423897 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001256/id_001256.cc
[2025-11-05 07:59:19.423950 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:19.654697 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:19.654796 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:19.657594 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:19.657625 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:19.884085 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001257/id_001257.cc
[2025-11-05 07:59:19.884138 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:20.114376 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:20.114454 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:20.117203 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:20.117234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:20.342991 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001258/id_001258.cc
[2025-11-05 07:59:20.343044 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:20.573647 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:20.573723 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:20.576442 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:20.576474 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:20.793056 +00:00] WARN [src/fuzzer.rs:205] Program 1259 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001259/id_001259.cc:30:11: error: no matching function for call to 'cre2_set_new'
   30 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 07:59:20.827517 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:59:20.827839 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)[0-9]+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int prog_size = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, 0);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)prog_size + (long)set_add_ret + (long)set_compile_ret\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001259/id_001259.cc:30:11: error: no matching function for call to 'cre2_set_new'\n   30 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 07:59:36.066899 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 15s
[2025-11-05 07:59:36.067027 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21370, Completion: 8011, Total: 29381
[2025-11-05 07:59:36.292981 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001259/id_001259.cc
[2025-11-05 07:59:36.293034 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 07:59:36.522749 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 07:59:36.522829 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 07:59:36.525696 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 07:59:36.525729 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 07:59:36.525761 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1259!
[2025-11-05 07:59:36.525799 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:59:36.525814 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1260, succ: 1259, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 07:59:36.525829 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 07:59:36.525856 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 07:59:36.795922 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1259 as an example for the next prompt.
[2025-11-05 07:59:36.795979 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 5 new API pairs in this round.
[2025-11-05 07:59:36.796006 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 5
[2025-11-05 07:59:36.796054 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,24.0,91.0,56.0,38.0,246.0,16.0,27.0,362.0,153.0,27.0,108.0,33.0,196.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,111.0,227.0,28.0,670.0,197.0,195.0,41.0,57.0,54.0,28.0,342.0,20.0,51.0,138.0,20.0,10.0,82.0,286.0,13.0,16.0,160.0,35.0,38.0,77.0,22.0,266.0,25.0,55.0,29.0,21.0,158.0,52.0,193.0,52.0,49.0,16.0]
[2025-11-05 07:59:36.796087 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 07:59:36.796139 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 138
[2025-11-05 07:59:36.796171 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 193
[2025-11-05 07:59:36.796199 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_posix_syntax energy: 38
[2025-11-05 07:59:36.796225 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 670
[2025-11-05 07:59:36.796264 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 266
[2025-11-05 07:59:36.796301 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 07:59:36.797156 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 126, quiet_round: 0, discovered_api_pairs: 2420
[2025-11-05 07:59:36.844581 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 07:59:36.844941 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo123 and then foo456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t match;\n    const char * ver = NULL;\n    int find_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&input, 0, sizeof(input));\n    memset(&match, 0, sizeof(match));\n    input.data = text_buf;\n    input.length = text_len;\n    match.data = NULL;\n    match.length = 0;\n    ver = cre2_version_string();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    find_ret = cre2_find_and_consume(pattern, &input, &match, 1);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)find_ret\n                     + (long)match.length + (long)(re != NULL) + (long)(opt != NULL)\n                     + (long)(ver != NULL) + (long)input.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)[0-9]+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int prog_size = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)prog_size + (long)set_add_ret + (long)set_compile_ret\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:00:17.621964 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 08:00:17.622089 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28070, Completion: 19003, Total: 47073
[2025-11-05 08:00:17.622109 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:00:17.841138 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001260/id_001260.cc
[2025-11-05 08:00:17.841191 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:18.070152 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:18.070225 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:18.073026 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:18.073055 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:18.293124 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001261/id_001261.cc
[2025-11-05 08:00:18.293180 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:18.534723 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:18.534802 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:18.537461 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:18.537494 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:18.758258 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001262/id_001262.cc
[2025-11-05 08:00:18.758358 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:18.997168 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:18.997246 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:18.999772 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:18.999803 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:19.229935 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001263/id_001263.cc
[2025-11-05 08:00:19.229988 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:19.460273 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:19.460352 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:19.463020 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:19.463052 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:19.691438 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001264/id_001264.cc
[2025-11-05 08:00:19.691494 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:19.922676 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:19.922801 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:19.925347 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:19.925381 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:20.154140 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001265/id_001265.cc
[2025-11-05 08:00:20.154194 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:20.383699 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:20.383771 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:20.386499 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:20.386532 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:20.603330 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001266/id_001266.cc
[2025-11-05 08:00:20.603386 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:20.831886 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:20.831959 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:20.834579 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:20.834611 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:21.064134 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001267/id_001267.cc
[2025-11-05 08:00:21.064221 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:21.305494 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:21.305569 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:21.308051 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:21.308083 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:21.534687 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001268/id_001268.cc
[2025-11-05 08:00:21.534741 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:21.765666 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:21.765745 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:21.768230 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:21.768257 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:21.994693 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001269/id_001269.cc
[2025-11-05 08:00:21.994749 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:22.226031 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:22.226146 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:22.228585 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:22.228617 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:22.228669 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:00:22.228686 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1270, succ: 1269, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:00:22.228701 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:00:22.228729 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:00:22.507323 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1269 as an example for the next prompt.
[2025-11-05 08:00:22.507378 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 08:00:22.507418 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 08:00:22.507474 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,24.0,91.0,56.0,43.0,246.0,16.0,27.0,364.0,153.0,27.0,108.0,33.0,196.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,111.0,227.0,28.0,675.0,197.0,195.0,41.0,57.0,54.0,28.0,342.0,20.0,51.0,145.0,20.0,10.0,82.0,286.0,13.0,16.0,160.0,35.0,38.0,77.0,22.0,269.0,25.0,55.0,29.0,21.0,158.0,52.0,200.0,52.0,49.0,16.0]
[2025-11-05 08:00:22.507493 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:00:22.507556 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 91
[2025-11-05 08:00:22.507598 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 675
[2025-11-05 08:00:22.507635 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 342
[2025-11-05 08:00:22.507669 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_named_capturing_groups energy: 21
[2025-11-05 08:00:22.507713 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 82
[2025-11-05 08:00:22.507754 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_program_size(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),
    int cre2_opt_one_line(cre2_options_t * opt)
[2025-11-05 08:00:22.508595 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 127, quiet_round: 0, discovered_api_pairs: 2431
[2025-11-05 08:00:22.554319 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:00:22.554729 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_program_size(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),\n    int cre2_opt_one_line(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)[0-9]+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int prog_size = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)prog_size + (long)set_add_ret + (long)set_compile_ret\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo([0-9]+)bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"start foo42bar end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t input;\n    cre2_string_t match;\n    int set_add_ret = 0;\n    int partial_ret = 0;\n    const char * re_pat = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    memset(&input, 0, sizeof(input));\n    memset(&match, 0, sizeof(match));\n    input.data = text_buf;\n    input.length = text_len;\n    match.data = NULL;\n    match.length = 0;\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    partial_ret = cre2_partial_match(pattern, &input, &match, 1);\n    re_pat = cre2_pattern(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)set_add_ret + (long)partial_ret\n                     + (long)(re != NULL) + (long)(re_pat != NULL) + (long)match.length\n                     + (long)(opt != NULL) + (long)(set != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:00:57.904951 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 35s
[2025-11-05 08:00:57.905057 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28780, Completion: 18917, Total: 47697
[2025-11-05 08:00:57.905081 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:00:58.131147 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001270/id_001270.cc
[2025-11-05 08:00:58.131201 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:58.369672 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:58.369734 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:58.372810 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:58.372839 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:58.591180 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001271/id_001271.cc
[2025-11-05 08:00:58.591235 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:58.827951 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:58.828030 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:58.831311 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:58.831345 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:59.057270 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001272/id_001272.cc
[2025-11-05 08:00:59.057360 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:59.289611 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:59.289683 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:59.292552 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:59.292580 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:59.510419 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001273/id_001273.cc
[2025-11-05 08:00:59.510472 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:00:59.747883 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:00:59.747942 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:00:59.751249 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:00:59.751282 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:00:59.969328 +00:00] WARN [src/fuzzer.rs:205] Program 1274 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001274/id_001274.cc:37:5: error: no matching function for call to 'cre2_opt_one_line'
   37 |     cre2_opt_one_line(opt, 1);
      |     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:01:00.015021 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:01:00.015345 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<num>[0-9]+)abc\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"123abc\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    int easy_ret = 0;\n    int name_index = 0;\n    int prog_size = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&match, 0, sizeof(match));\n    match.data = NULL;\n    match.length = 0;\n\n    // step 3: Configure\n    cre2_opt_one_line(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 2);\n    name_index = cre2_find_named_capturing_groups(re, \"num\");\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)prog_size + (long)easy_ret\n                     + (long)name_index + (long)(re != NULL) + (long)(opt != NULL) + (long)match.length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001274/id_001274.cc:37:5: error: no matching function for call to 'cre2_opt_one_line'\n   37 |     cre2_opt_one_line(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:01:27.709970 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 08:01:27.710090 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21840, Completion: 10417, Total: 32257
[2025-11-05 08:01:27.927881 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001274/id_001274.cc
[2025-11-05 08:01:27.927934 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:01:28.163306 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:01:28.163373 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:01:28.166435 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:01:28.166468 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:01:28.166501 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1274!
[2025-11-05 08:01:28.382698 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001275/id_001275.cc
[2025-11-05 08:01:28.382752 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:01:28.612102 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:01:28.612173 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:01:28.615412 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:01:28.615446 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:01:28.832776 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001276/id_001276.cc
[2025-11-05 08:01:28.832860 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:01:29.063928 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:01:29.063985 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:01:29.066935 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:01:29.066968 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:01:29.293124 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001277/id_001277.cc
[2025-11-05 08:01:29.293177 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:01:29.525082 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:01:29.525152 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:01:29.528051 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:01:29.528083 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:01:29.746583 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001278/id_001278.cc
[2025-11-05 08:01:29.746636 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:01:29.976568 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:01:29.976660 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:01:29.979733 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:01:29.979764 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:01:30.197701 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001279/id_001279.cc
[2025-11-05 08:01:30.197753 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:01:30.428472 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:01:30.428546 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:01:30.431513 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:01:30.431545 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:01:30.431585 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:01:30.431600 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1280, succ: 1279, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:01:30.431639 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:01:30.431666 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:01:30.710204 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1279 as an example for the next prompt.
[2025-11-05 08:01:30.710262 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 08:01:30.710304 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 08:01:30.710352 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,24.0,99.0,56.0,43.0,246.0,16.0,27.0,368.0,153.0,27.0,113.0,33.0,198.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,111.0,227.0,28.0,680.0,197.0,195.0,41.0,57.0,54.0,28.0,351.0,20.0,51.0,145.0,20.0,10.0,88.0,286.0,13.0,16.0,160.0,35.0,38.0,78.0,22.0,269.0,25.0,55.0,29.0,30.0,158.0,52.0,200.0,52.0,49.0,16.0]
[2025-11-05 08:01:30.710371 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:01:30.710425 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 680
[2025-11-05 08:01:30.710455 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 160
[2025-11-05 08:01:30.710484 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 153
[2025-11-05 08:01:30.710511 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 269
[2025-11-05 08:01:30.710548 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 08:01:30.711260 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 128, quiet_round: 0, discovered_api_pairs: 2450
[2025-11-05 08:01:30.767433 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:01:30.767794 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo([0-9]+)bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"start foo42bar end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t input;\n    cre2_string_t match;\n    int set_add_ret = 0;\n    int partial_ret = 0;\n    const char * re_pat = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    memset(&input, 0, sizeof(input));\n    memset(&match, 0, sizeof(match));\n    input.data = text_buf;\n    input.length = text_len;\n    match.data = NULL;\n    match.length = 0;\n\n    // step 3: Configure\n    cre2_opt_set_posix_syntax(opt, 1);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    partial_ret = cre2_partial_match(pattern, &input, &match, 1);\n    re_pat = cre2_pattern(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)set_add_ret + (long)partial_ret\n                     + (long)(re != NULL) + (long)(re_pat != NULL) + (long)match.length\n                     + (long)(opt != NULL) + (long)(set != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<num>[0-9]+)-foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"1234-foo rest\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    int prog_size = 0;\n    int easy_ret = 0;\n    int named_idx = 0;\n    int one_line_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&match, 0, sizeof(match));\n    match.data = NULL;\n    match.length = 0;\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n    named_idx = cre2_find_named_capturing_groups(re, \"num\");\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)prog_size + (long)easy_ret\n                     + (long)named_idx + (long)one_line_flag + (long)(match.length)\n                     + (long)(re != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:02:08.976152 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 08:02:08.976279 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30020, Completion: 18659, Total: 48679
[2025-11-05 08:02:08.976299 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:02:09.194846 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001280/id_001280.cc
[2025-11-05 08:02:09.194901 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:09.426007 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:09.426076 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:09.428849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:09.428882 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:09.646834 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001281/id_001281.cc
[2025-11-05 08:02:09.646889 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:09.875121 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:09.875180 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:09.877986 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:09.878019 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:10.096031 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001282/id_001282.cc
[2025-11-05 08:02:10.096116 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:10.324934 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:10.325009 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:10.327678 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:10.327709 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:10.546357 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001283/id_001283.cc
[2025-11-05 08:02:10.546413 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:10.776208 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:10.776276 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:10.779153 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:10.779185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:10.997250 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001284/id_001284.cc
[2025-11-05 08:02:10.997305 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:11.226624 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:11.226718 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:11.229528 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:11.229562 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:11.448840 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001285/id_001285.cc
[2025-11-05 08:02:11.448897 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:11.678675 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:11.678755 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:11.681664 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:11.681721 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:11.899861 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001286/id_001286.cc
[2025-11-05 08:02:11.899914 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:12.128263 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:12.128339 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:12.131250 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:12.131282 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:12.349057 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001287/id_001287.cc
[2025-11-05 08:02:12.349142 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:12.578585 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:12.578645 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:12.581415 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:12.581447 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:12.799643 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001288/id_001288.cc
[2025-11-05 08:02:12.799697 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:13.027484 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:13.027560 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:13.030492 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:13.030527 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:13.248859 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001289/id_001289.cc
[2025-11-05 08:02:13.248914 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:02:13.478035 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:02:13.478126 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:02:13.480993 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:02:13.481026 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:02:13.481065 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:02:13.481081 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1290, succ: 1289, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:02:13.481096 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:02:13.481121 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:02:13.778467 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1289 as an example for the next prompt.
[2025-11-05 08:02:13.778525 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 08:02:13.778557 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 08:02:13.778605 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,24.0,99.0,56.0,43.0,246.0,16.0,27.0,371.0,158.0,27.0,115.0,33.0,198.0,83.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,111.0,228.0,28.0,681.0,197.0,195.0,41.0,57.0,54.0,28.0,351.0,20.0,51.0,145.0,20.0,10.0,88.0,286.0,13.0,16.0,167.0,35.0,38.0,78.0,22.0,274.0,25.0,55.0,29.0,30.0,158.0,52.0,202.0,52.0,49.0,16.0]
[2025-11-05 08:02:13.778636 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:02:13.778689 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 83
[2025-11-05 08:02:13.778721 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 681
[2025-11-05 08:02:13.778749 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 371
[2025-11-05 08:02:13.778775 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 24
[2025-11-05 08:02:13.778800 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 35
[2025-11-05 08:02:13.778834 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_opt_perl_classes(cre2_options_t * opt),
    int64_t cre2_opt_max_mem(cre2_options_t * opt)
[2025-11-05 08:02:13.779655 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 129, quiet_round: 0, discovered_api_pairs: 2460
[2025-11-05 08:02:13.817280 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:02:13.817636 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_opt_perl_classes(cre2_options_t * opt),\n    int64_t cre2_opt_max_mem(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<num>[0-9]+)-foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"1234-foo rest\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    int prog_size = 0;\n    int easy_ret = 0;\n    int named_idx = 0;\n    int one_line_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    memset(&match, 0, sizeof(match));\n    match.data = NULL;\n    match.length = 0;\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n    named_idx = cre2_find_named_capturing_groups(re, \"num\");\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)prog_size + (long)easy_ret\n                     + (long)named_idx + (long)one_line_flag + (long)(match.length)\n                     + (long)(re != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)([0-9]{1,3})\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo42 suffix bar7 done\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t input;\n    cre2_string_t match_arr[4];\n    int set_match_indices[8];\n    size_t set_matches = 0;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int re_match_ret = 0;\n    const char * re_pat = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    memset(&input, 0, sizeof(input));\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(set_match_indices, 0, sizeof(set_match_indices));\n    input.data = text_buf;\n    input.length = text_len;\n    match_arr[0].data = NULL;\n    match_arr[0].length = 0;\n    match_arr[1].data = NULL;\n    match_arr[1].length = 0;\n    match_arr[2].data = NULL;\n    match_arr[2].length = 0;\n    match_arr[3].data = NULL;\n    match_arr[3].length = 0;\n\n    // step 3: Configure\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 4);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, (size_t)(sizeof(set_match_indices)/sizeof(set_match_indices[0])));\n    re_pat = cre2_pattern(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)set_add_ret + (long)set_compile_ret\n                     + (long)re_match_ret + (long)set_matches + (long)(re != NULL)\n                     + (long)(re_pat != NULL) + (long)match_arr[0].length + (long)(opt != NULL)\n                     + (long)(set != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:03:09.904809 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 56s
[2025-11-05 08:03:09.904934 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31060, Completion: 22600, Total: 53660
[2025-11-05 08:03:09.904954 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:03:10.123491 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001290/id_001290.cc
[2025-11-05 08:03:10.123550 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:10.353804 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:10.353878 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:10.356589 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:10.356616 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:10.574772 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001291/id_001291.cc
[2025-11-05 08:03:10.574831 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:10.805030 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:10.805099 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:10.807691 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:10.807717 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:11.027025 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001292/id_001292.cc
[2025-11-05 08:03:11.027117 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:11.256021 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:11.256094 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:11.258907 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:11.258932 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:11.476998 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001293/id_001293.cc
[2025-11-05 08:03:11.477056 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:11.705688 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:11.705759 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:11.708338 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:11.708366 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:11.926208 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001294/id_001294.cc
[2025-11-05 08:03:11.926272 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:12.155577 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:12.155687 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:12.158372 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:12.158398 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:12.375385 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001295/id_001295.cc
[2025-11-05 08:03:12.375446 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:12.604785 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:12.604853 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:12.607423 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:12.607449 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:12.824454 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001296/id_001296.cc
[2025-11-05 08:03:12.824519 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:13.054072 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:13.054167 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:13.056959 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:13.056987 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:13.274764 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001297/id_001297.cc
[2025-11-05 08:03:13.274855 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:13.503247 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:13.503307 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:13.506026 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:13.506054 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:13.725000 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001298/id_001298.cc
[2025-11-05 08:03:13.725058 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:13.952978 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:13.953045 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:13.955770 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:13.955798 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:14.171214 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001299/id_001299.cc
[2025-11-05 08:03:14.171273 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:14.400788 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:14.400892 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:14.403439 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:14.403465 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:14.403501 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:03:14.403516 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1300, succ: 1299, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:03:14.403530 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:03:14.403555 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:03:14.671583 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1299 as an example for the next prompt.
[2025-11-05 08:03:14.671639 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 34 new API pairs in this round.
[2025-11-05 08:03:14.671695 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 34
[2025-11-05 08:03:14.671744 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,38.0,104.0,56.0,43.0,248.0,16.0,27.0,378.0,160.0,27.0,115.0,33.0,202.0,96.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,118.0,228.0,28.0,691.0,197.0,195.0,41.0,57.0,54.0,28.0,353.0,20.0,51.0,145.0,20.0,10.0,88.0,286.0,16.0,16.0,167.0,46.0,38.0,80.0,22.0,278.0,25.0,55.0,42.0,30.0,158.0,52.0,202.0,52.0,49.0,16.0]
[2025-11-05 08:03:14.671763 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:03:14.671844 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 378
[2025-11-05 08:03:14.671889 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 278
[2025-11-05 08:03:14.671939 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 353
[2025-11-05 08:03:14.671968 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_nl energy: 28
[2025-11-05 08:03:14.672001 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_never_nl(cre2_options_t * opt)
[2025-11-05 08:03:14.672705 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 130, quiet_round: 0, discovered_api_pairs: 2494
[2025-11-05 08:03:14.710813 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:03:14.711163 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_never_nl(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)([0-9]{1,3})\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo42 suffix bar7 done\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t input;\n    cre2_string_t match_arr[4];\n    int set_match_indices[8];\n    size_t set_matches = 0;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int re_match_ret = 0;\n    const char * re_pat = NULL;\n    long computed_check = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    memset(&input, 0, sizeof(input));\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(set_match_indices, 0, sizeof(set_match_indices));\n    input.data = text_buf;\n    input.length = text_len;\n    match_arr[0].data = NULL;\n    match_arr[0].length = 0;\n    match_arr[1].data = NULL;\n    match_arr[1].length = 0;\n    match_arr[2].data = NULL;\n    match_arr[2].length = 0;\n    match_arr[3].data = NULL;\n    match_arr[3].length = 0;\n\n    // step 3: Configure\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, match_arr, 4);\n    set_matches = cre2_set_match(set, text_buf, (size_t)text_len, set_match_indices, (size_t)(sizeof(set_match_indices)/sizeof(set_match_indices[0])));\n    re_pat = cre2_pattern(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)set_add_ret + (long)set_compile_ret\n                     + (long)re_match_ret + (long)set_matches + (long)(re != NULL)\n                     + (long)(re_pat != NULL) + (long)match_arr[0].length + (long)(opt != NULL)\n                     + (long)(set != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"abc.*def\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    char scratch[32];\n    long computed_check = 0;\n    int perl_classes_flag = 0;\n    int64_t max_mem_val = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)4 * 1024 * 1024);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Validate / compute lightweight checksum\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n    max_mem_val = cre2_opt_max_mem(opt);\n    computed_check = (long)pattern_len + (long)(re != NULL) + (long)perl_classes_flag + (long)max_mem_val + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:03:48.517778 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 08:03:48.517907 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30070, Completion: 18405, Total: 48475
[2025-11-05 08:03:48.517928 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:03:48.736155 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001300/id_001300.cc
[2025-11-05 08:03:48.736209 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:48.966454 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:48.966511 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:48.969390 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:48.969422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:49.186306 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001301/id_001301.cc
[2025-11-05 08:03:49.186359 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:49.414487 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:49.414545 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:49.417365 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:49.417397 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:49.635511 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001302/id_001302.cc
[2025-11-05 08:03:49.635595 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:49.863971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:49.864030 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:49.866895 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:49.866926 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:50.084474 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001303/id_001303.cc
[2025-11-05 08:03:50.084526 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:50.312967 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:50.313038 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:50.315873 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:50.315905 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:50.533862 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001304/id_001304.cc
[2025-11-05 08:03:50.533915 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:50.762577 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:50.762665 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:50.765527 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:50.765559 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:50.982933 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001305/id_001305.cc
[2025-11-05 08:03:50.982986 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:51.213057 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:51.213125 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:51.215880 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:51.215905 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:51.432113 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001306/id_001306.cc
[2025-11-05 08:03:51.432168 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:51.661781 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:51.661853 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:51.664708 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:51.664741 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:51.884225 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001307/id_001307.cc
[2025-11-05 08:03:51.884310 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:52.113532 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:52.113591 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:52.116222 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:52.116269 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:52.334202 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001308/id_001308.cc
[2025-11-05 08:03:52.334256 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:52.562296 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:52.562357 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:52.565211 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:52.565245 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:52.782587 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001309/id_001309.cc
[2025-11-05 08:03:52.782640 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:03:53.011864 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:03:53.011963 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:03:53.014816 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:03:53.014850 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:03:53.014889 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:03:53.014906 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1310, succ: 1309, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:03:53.014921 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:03:53.014947 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:03:53.289470 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1309 as an example for the next prompt.
[2025-11-05 08:03:53.289527 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 08:03:53.289562 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 08:03:53.289612 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,38.0,104.0,56.0,43.0,248.0,16.0,27.0,381.0,160.0,27.0,115.0,33.0,204.0,96.0,105.0,114.0,122.0,48.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,118.0,228.0,28.0,697.0,197.0,195.0,41.0,57.0,54.0,38.0,361.0,20.0,51.0,145.0,20.0,10.0,88.0,286.0,16.0,16.0,167.0,46.0,38.0,81.0,22.0,282.0,28.0,55.0,42.0,30.0,158.0,52.0,202.0,52.0,49.0,16.0]
[2025-11-05 08:03:53.289630 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:03:53.289682 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 282
[2025-11-05 08:03:53.289712 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 381
[2025-11-05 08:03:53.289739 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 197
[2025-11-05 08:03:53.289767 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 54
[2025-11-05 08:03:53.289798 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_delete(cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_version_interface_revision()
[2025-11-05 08:03:53.290494 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 131, quiet_round: 0, discovered_api_pairs: 2507
[2025-11-05 08:03:53.314321 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:03:53.314655 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_delete(cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_version_interface_revision()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"abc.*def\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    char scratch[32];\n    long computed_check = 0;\n    int perl_classes_flag = 0;\n    int64_t max_mem_val = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)4 * 1024 * 1024);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 5: Validate / compute lightweight checksum\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n    max_mem_val = cre2_opt_max_mem(opt);\n    computed_check = (long)pattern_len + (long)(re != NULL) + (long)perl_classes_flag + (long)max_mem_val + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello|world)\\\\s+(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"greeting: hello 12345 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match_arr[2];\n    const char * re_pat = NULL;\n    int easy_ret = 0;\n    int never_nl_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, 2);\n\n    // step 4: Validate / compute lightweight checksum\n    never_nl_flag = cre2_opt_never_nl(opt);\n    computed_check = (long)pattern_len + (long)text_len + (long)easy_ret + (long)(re != NULL)\n                     + (long)(re_pat != NULL) + (long)never_nl_flag + (long)match_arr[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:04:44.170968 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 50s
[2025-11-05 08:04:44.171095 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27010, Completion: 18222, Total: 45232
[2025-11-05 08:04:44.171115 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:04:44.388041 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001310/id_001310.cc
[2025-11-05 08:04:44.388095 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:44.617906 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:44.617974 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:44.621010 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:44.621042 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:44.838575 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001311/id_001311.cc
[2025-11-05 08:04:44.838631 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:45.069580 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:45.069652 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:45.072769 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:45.072802 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:45.290782 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001312/id_001312.cc
[2025-11-05 08:04:45.290869 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:45.518852 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:45.518911 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:45.521752 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:45.521785 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:45.739871 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001313/id_001313.cc
[2025-11-05 08:04:45.739925 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:45.969043 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:45.969119 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:45.972301 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:45.972333 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:46.190586 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001314/id_001314.cc
[2025-11-05 08:04:46.190643 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:46.418440 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:46.418532 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:46.421664 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:46.421697 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:46.639988 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001315/id_001315.cc
[2025-11-05 08:04:46.640043 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:46.870375 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:46.870448 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:46.873642 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:46.873675 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:47.092536 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001316/id_001316.cc
[2025-11-05 08:04:47.092590 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:47.321593 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:47.321653 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:47.324854 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:47.324885 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:47.543224 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001317/id_001317.cc
[2025-11-05 08:04:47.543310 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:47.772181 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:47.772259 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:47.775522 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:47.775555 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:47.993181 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001318/id_001318.cc
[2025-11-05 08:04:47.993236 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:48.222251 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:48.222319 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:48.225470 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:48.225503 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:48.442225 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001319/id_001319.cc
[2025-11-05 08:04:48.442282 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:04:48.672185 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:04:48.672291 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:04:48.675457 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:04:48.675491 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:04:48.675529 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:04:48.675548 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1320, succ: 1319, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:04:48.675562 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:04:48.675588 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:04:48.947522 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1319 as an example for the next prompt.
[2025-11-05 08:04:48.947582 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 08:04:48.947630 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 08:04:48.947683 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,38.0,104.0,56.0,43.0,251.0,16.0,27.0,383.0,160.0,27.0,116.0,33.0,204.0,96.0,105.0,114.0,122.0,52.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,121.0,232.0,28.0,699.0,206.0,195.0,41.0,59.0,67.0,38.0,361.0,20.0,51.0,145.0,20.0,10.0,88.0,286.0,16.0,16.0,167.0,49.0,38.0,81.0,22.0,286.0,28.0,55.0,45.0,30.0,165.0,52.0,202.0,52.0,49.0,16.0]
[2025-11-05 08:04:48.947705 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:04:48.947761 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 251
[2025-11-05 08:04:48.947795 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 55
[2025-11-05 08:04:48.947825 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 361
[2025-11-05 08:04:48.947855 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 145
[2025-11-05 08:04:48.947893 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_num_capturing_groups(const cre2_regexp_t * re),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )
[2025-11-05 08:04:48.948617 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 132, quiet_round: 0, discovered_api_pairs: 2527
[2025-11-05 08:04:48.993810 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:04:48.994166 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_num_capturing_groups(const cre2_regexp_t * re),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello|world)\\\\s+(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"greeting: hello 12345 end\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match_arr[2];\n    const char * re_pat = NULL;\n    int easy_ret = 0;\n    int never_nl_flag = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, 2);\n\n    // step 4: Validate / compute lightweight checksum\n    never_nl_flag = cre2_opt_never_nl(opt);\n    computed_check = (long)pattern_len + (long)text_len + (long)easy_ret + (long)(re != NULL)\n                     + (long)(re_pat != NULL) + (long)never_nl_flag + (long)match_arr[0].length;\n    (void)computed_check;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *re_pat = NULL;\n    int rev = 0;\n    char scratch[32];\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 0);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    rev = cre2_version_interface_revision();\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)(re != NULL) + (long)(re_pat != NULL)\n                     + (long)(iter != NULL) + (long)rev + (long)(opt != NULL) + (long)scratch[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:05:32.025312 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 08:05:32.025440 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27930, Completion: 18496, Total: 46426
[2025-11-05 08:05:32.025464 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:05:32.244095 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001320/id_001320.cc
[2025-11-05 08:05:32.244152 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:32.473448 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:32.473525 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:32.476065 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:32.476094 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:32.693834 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001321/id_001321.cc
[2025-11-05 08:05:32.693892 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:32.922717 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:32.922794 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:32.925727 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:32.925763 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:33.143851 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001322/id_001322.cc
[2025-11-05 08:05:33.143940 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:33.375412 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:33.375488 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:33.378334 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:33.378363 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:33.595758 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001323/id_001323.cc
[2025-11-05 08:05:33.595814 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:33.825001 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:33.825074 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:33.827699 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:33.827726 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:34.044873 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001324/id_001324.cc
[2025-11-05 08:05:34.044929 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:34.277273 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:34.277391 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:34.280065 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:34.280094 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:34.497629 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001325/id_001325.cc
[2025-11-05 08:05:34.497685 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:34.726141 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:34.726216 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:34.729067 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:34.729097 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:34.947991 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001326/id_001326.cc
[2025-11-05 08:05:34.948049 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:35.178193 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:35.178272 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:35.181174 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:35.181204 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:35.399555 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001327/id_001327.cc
[2025-11-05 08:05:35.399662 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:35.627349 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:35.627424 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:35.630298 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:35.630327 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:35.848764 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001328/id_001328.cc
[2025-11-05 08:05:35.848822 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:36.078561 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:36.078637 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:36.081536 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:36.081566 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:36.299439 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001329/id_001329.cc
[2025-11-05 08:05:36.299492 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:05:36.529630 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:05:36.529736 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:05:36.532617 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:05:36.532658 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:05:36.532695 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:05:36.532711 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1330, succ: 1329, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:05:36.532726 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:05:36.532751 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:05:36.816236 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1329 as an example for the next prompt.
[2025-11-05 08:05:36.816293 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 08:05:36.816324 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 08:05:36.816372 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,38.0,104.0,56.0,43.0,254.0,16.0,27.0,384.0,160.0,27.0,116.0,33.0,205.0,96.0,105.0,114.0,122.0,52.0,43.0,27.0,18.0,49.0,148.0,89.0,16.0,24.0,121.0,232.0,28.0,703.0,206.0,195.0,41.0,59.0,67.0,38.0,364.0,20.0,51.0,147.0,20.0,10.0,88.0,286.0,16.0,16.0,167.0,49.0,38.0,81.0,22.0,288.0,28.0,59.0,45.0,30.0,165.0,52.0,202.0,52.0,49.0,16.0]
[2025-11-05 08:05:36.816389 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:05:36.816442 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 703
[2025-11-05 08:05:36.816471 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 89
[2025-11-05 08:05:36.816496 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 384
[2025-11-05 08:05:36.816521 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_possible_match_range energy: 33
[2025-11-05 08:05:36.816558 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen)
[2025-11-05 08:05:36.817294 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 133, quiet_round: 0, discovered_api_pairs: 2536
[2025-11-05 08:05:36.862159 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:05:36.862539 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_possible_match_range(cre2_regexp_t * rex, cre2_string_t * min_, cre2_string_t * max_, int maxlen)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *re_pat = NULL;\n    int rev = 0;\n    char scratch[32];\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(scratch, 0, sizeof(scratch));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 0);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    rev = cre2_version_interface_revision();\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)(re != NULL) + (long)(re_pat != NULL)\n                     + (long)(iter != NULL) + (long)rev + (long)(opt != NULL) + (long)scratch[0];\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\\\\b(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo bar suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match_arr[3];\n    cre2_string_t partial_matches[3];\n    cre2_string_t text_str;\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, 3);\n    partial_ret = cre2_partial_match(pattern, &text_str, partial_matches, 3);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)easy_ret + (long)partial_ret\n                     + (long)num_groups + (long)(re != NULL) + (long)match_arr[0].length + (long)partial_matches[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:06:22.546389 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 45s
[2025-11-05 08:06:22.546514 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28710, Completion: 24361, Total: 53071
[2025-11-05 08:06:22.546534 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:06:22.765029 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001330/id_001330.cc
[2025-11-05 08:06:22.765083 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:22.994218 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:22.994294 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:22.997051 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:22.997083 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:23.215848 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001331/id_001331.cc
[2025-11-05 08:06:23.215902 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:23.446064 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:23.446143 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:23.449012 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:23.449044 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:23.667445 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001332/id_001332.cc
[2025-11-05 08:06:23.667530 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:23.896885 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:23.896960 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:23.899542 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:23.899575 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:24.116404 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001333/id_001333.cc
[2025-11-05 08:06:24.116472 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:24.345406 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:24.345484 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:24.348353 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:24.348387 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:24.565708 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001334/id_001334.cc
[2025-11-05 08:06:24.565762 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:24.794323 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:24.794436 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:24.797313 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:24.797345 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:25.014803 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001335/id_001335.cc
[2025-11-05 08:06:25.014857 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:25.243453 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:25.243526 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:25.246354 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:25.246388 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:25.465182 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001336/id_001336.cc
[2025-11-05 08:06:25.465236 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:25.693971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:25.694031 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:25.696697 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:25.696730 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:25.915436 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001337/id_001337.cc
[2025-11-05 08:06:25.915522 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:26.144534 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:26.144611 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:26.147250 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:26.147277 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:26.363794 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001338/id_001338.cc
[2025-11-05 08:06:26.363847 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:26.591628 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:26.591704 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:26.594557 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:26.594590 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:26.811588 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001339/id_001339.cc
[2025-11-05 08:06:26.811658 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:06:27.039525 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:06:27.039644 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:06:27.042499 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:06:27.042532 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:06:27.042570 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:06:27.042586 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1340, succ: 1339, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:06:27.042601 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:06:27.042626 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:06:27.338108 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1339 as an example for the next prompt.
[2025-11-05 08:06:27.338165 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 08:06:27.338197 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 08:06:27.338245 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,38.0,104.0,56.0,43.0,254.0,16.0,27.0,387.0,160.0,27.0,119.0,38.0,205.0,96.0,105.0,114.0,122.0,52.0,43.0,27.0,18.0,49.0,148.0,96.0,16.0,24.0,124.0,233.0,28.0,709.0,206.0,195.0,41.0,59.0,67.0,38.0,364.0,20.0,51.0,147.0,20.0,10.0,88.0,286.0,16.0,16.0,167.0,49.0,38.0,82.0,22.0,288.0,28.0,59.0,45.0,30.0,165.0,52.0,202.0,52.0,49.0,16.0]
[2025-11-05 08:06:27.338263 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:06:27.338316 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 206
[2025-11-05 08:06:27.338348 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 105
[2025-11-05 08:06:27.338376 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 43
[2025-11-05 08:06:27.338405 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 124
[2025-11-05 08:06:27.338433 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 288
[2025-11-05 08:06:27.338469 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_error_code(const cre2_regexp_t * re),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 08:06:27.339282 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 134, quiet_round: 0, discovered_api_pairs: 2546
[2025-11-05 08:06:27.380979 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:06:27.381335 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_error_code(const cre2_regexp_t * re),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\\\\b(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo bar suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match_arr[3];\n    cre2_string_t partial_matches[3];\n    cre2_string_t text_str;\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, match_arr, 3);\n    partial_ret = cre2_partial_match(pattern, &text_str, partial_matches, 3);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)easy_ret + (long)partial_ret\n                     + (long)num_groups + (long)(re != NULL) + (long)match_arr[0].length + (long)partial_matches[0].length;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?:foo|bar)(baz)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxfoobazyybarbazzz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t min_str;\n    cre2_string_t max_str;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int pmr_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&min_str, 0, sizeof(min_str));\n    memset(&max_str, 0, sizeof(max_str));\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pmr_ret = cre2_possible_match_range(re, &min_str, &max_str, 64);\n    strings[0] = min_str;\n    strings[1] = max_str;\n    cre2_strings_to_ranges(text_buf, ranges, strings, 2);\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)text_len + (long)pmr_ret\n                     + (long)(ranges[0].start) + (long)(ranges[0].past)\n                     + (long)(ranges[1].start) + (long)(ranges[1].past)\n                     + (long)(re != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:07:08.082405 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 08:07:08.082543 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29920, Completion: 21434, Total: 51354
[2025-11-05 08:07:08.082569 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:07:08.299752 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001340/id_001340.cc
[2025-11-05 08:07:08.299815 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:08.530324 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:08.530412 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:08.533502 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:08.533535 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:08.751412 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001341/id_001341.cc
[2025-11-05 08:07:08.751476 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:08.983060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:08.983166 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:08.986398 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:08.986436 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:09.203544 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001342/id_001342.cc
[2025-11-05 08:07:09.203641 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:09.431692 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:09.431779 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:09.434951 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:09.434983 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:09.654050 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001343/id_001343.cc
[2025-11-05 08:07:09.654128 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:09.885107 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:09.885196 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:09.888363 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:09.888395 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:10.107413 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001344/id_001344.cc
[2025-11-05 08:07:10.107476 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:10.336865 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:10.336998 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:10.339962 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:10.339993 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:10.559700 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001345/id_001345.cc
[2025-11-05 08:07:10.559763 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:10.791072 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:10.791163 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:10.794426 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:10.794464 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:11.014796 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001346/id_001346.cc
[2025-11-05 08:07:11.014860 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:11.244155 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:11.244244 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:11.247521 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:11.247552 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:11.467927 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001347/id_001347.cc
[2025-11-05 08:07:11.468024 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:11.697581 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:11.697669 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:11.700580 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:11.700611 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:11.917149 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001348/id_001348.cc
[2025-11-05 08:07:11.917214 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:12.146681 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:12.146769 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:12.149625 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:12.149657 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:12.367294 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001349/id_001349.cc
[2025-11-05 08:07:12.367358 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:12.596765 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:12.596915 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:12.599845 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:12.599885 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:12.599930 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:07:12.599998 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1350, succ: 1349, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:07:12.600025 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:07:12.600058 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:07:12.903052 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1349 as an example for the next prompt.
[2025-11-05 08:07:12.903108 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 23 new API pairs in this round.
[2025-11-05 08:07:12.903153 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 23
[2025-11-05 08:07:12.903202 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,38.0,104.0,56.0,43.0,254.0,16.0,27.0,389.0,160.0,27.0,119.0,38.0,205.0,96.0,122.0,114.0,122.0,52.0,58.0,27.0,18.0,49.0,148.0,96.0,16.0,24.0,125.0,233.0,28.0,713.0,220.0,195.0,41.0,59.0,67.0,38.0,364.0,20.0,51.0,147.0,20.0,10.0,88.0,286.0,16.0,16.0,167.0,49.0,38.0,82.0,22.0,299.0,28.0,59.0,45.0,30.0,170.0,52.0,202.0,52.0,49.0,16.0]
[2025-11-05 08:07:12.903221 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:07:12.903275 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 59
[2025-11-05 08:07:12.903306 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 299
[2025-11-05 08:07:12.903333 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 220
[2025-11-05 08:07:12.903399 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 195
[2025-11-05 08:07:12.903428 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 51
[2025-11-05 08:07:12.903461 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_case_sensitive(cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_opt_log_errors(cre2_options_t * opt)
[2025-11-05 08:07:12.904297 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 135, quiet_round: 0, discovered_api_pairs: 2569
[2025-11-05 08:07:12.940489 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:07:12.940844 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_case_sensitive(cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_opt_log_errors(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?:foo|bar)(baz)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxfoobazyybarbazzz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t min_str;\n    cre2_string_t max_str;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int pmr_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&min_str, 0, sizeof(min_str));\n    memset(&max_str, 0, sizeof(max_str));\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pmr_ret = cre2_possible_match_range(re, &min_str, &max_str, 64);\n    strings[0] = min_str;\n    strings[1] = max_str;\n    cre2_strings_to_ranges(text_buf, ranges, strings, 2);\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)text_len + (long)pmr_ret\n                     + (long)(ranges[0].start) + (long)(ranges[0].past)\n                     + (long)(ranges[1].start) + (long)(ranges[1].past)\n                     + (long)(re != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"zzzfoobarsomething\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"${first}\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    const char * pattern_from_re = NULL;\n    int extract_ret = 0;\n    int err_code = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(&target_str, 0, sizeof(target_str));\n    memset(target_buf, 0, sizeof(target_buf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    err_code = cre2_error_code(re);\n    pattern_from_re = cre2_pattern(re);\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    target_str.data = target_buf;\n    target_str.length = (int)sizeof(target_buf);\n    extract_ret = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)rewrite_len + (long)extract_ret\n                     + (long)err_code + (long)(re != NULL) + (long)(iter != NULL)\n                     + (long)target_str.length;\n    (void)computed_check;\n    (void)pattern_from_re;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:07:51.959932 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 08:07:51.960052 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31140, Completion: 23121, Total: 54261
[2025-11-05 08:07:51.960073 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:07:52.177232 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001350/id_001350.cc
[2025-11-05 08:07:52.177286 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:52.406122 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:52.406200 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:52.409351 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:52.409383 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:52.626765 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001351/id_001351.cc
[2025-11-05 08:07:52.626819 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:52.853647 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:52.853725 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:52.856908 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:52.856940 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:53.074879 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001352/id_001352.cc
[2025-11-05 08:07:53.074966 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:53.302522 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:53.302598 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:53.305931 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:53.305963 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:53.523654 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001353/id_001353.cc
[2025-11-05 08:07:53.523708 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:53.753797 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:53.753873 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:53.756929 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:53.756961 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:53.974772 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001354/id_001354.cc
[2025-11-05 08:07:53.974826 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:54.203295 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:54.203412 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:54.206638 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:54.206669 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:54.423352 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001355/id_001355.cc
[2025-11-05 08:07:54.423405 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:54.654690 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:54.654767 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:54.657856 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:54.657889 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:54.876786 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001356/id_001356.cc
[2025-11-05 08:07:54.876839 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:55.106765 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:55.106842 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:55.110048 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:55.110082 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:55.327345 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001357/id_001357.cc
[2025-11-05 08:07:55.327430 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:55.558544 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:55.558621 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:55.561855 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:55.561888 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:55.780089 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001358/id_001358.cc
[2025-11-05 08:07:55.780143 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:56.010300 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:56.010379 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:56.013665 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:56.013699 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:56.230744 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001359/id_001359.cc
[2025-11-05 08:07:56.230798 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:07:56.459103 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:07:56.459218 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:07:56.462401 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:07:56.462433 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:07:56.462472 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:07:56.462488 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1360, succ: 1359, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:07:56.462503 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:07:56.462528 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:07:56.747248 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1359 as an example for the next prompt.
[2025-11-05 08:07:56.747305 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 08:07:56.747346 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 08:07:56.747395 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,160.0,141.0,40.0,38.0,104.0,58.0,43.0,254.0,16.0,27.0,389.0,160.0,27.0,119.0,38.0,205.0,96.0,123.0,114.0,127.0,52.0,58.0,27.0,18.0,49.0,151.0,96.0,16.0,24.0,125.0,234.0,28.0,718.0,225.0,201.0,41.0,63.0,67.0,38.0,364.0,20.0,58.0,147.0,20.0,10.0,88.0,286.0,16.0,16.0,170.0,49.0,38.0,82.0,22.0,307.0,28.0,59.0,45.0,30.0,175.0,52.0,204.0,52.0,49.0,16.0]
[2025-11-05 08:07:56.747414 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:07:56.747468 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 96
[2025-11-05 08:07:56.747506 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 204
[2025-11-05 08:07:56.747544 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 104
[2025-11-05 08:07:56.747584 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 114
[2025-11-05 08:07:56.747618 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 160
[2025-11-05 08:07:56.747659 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_program_size(const cre2_regexp_t * re),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 08:07:56.748502 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 136, quiet_round: 0, discovered_api_pairs: 2588
[2025-11-05 08:07:56.795279 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:07:56.795660 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_program_size(const cre2_regexp_t * re),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"zzzfoobarsomething\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"${first}\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    const char * pattern_from_re = NULL;\n    int extract_ret = 0;\n    int err_code = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(&target_str, 0, sizeof(target_str));\n    memset(target_buf, 0, sizeof(target_buf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    err_code = cre2_error_code(re);\n    pattern_from_re = cre2_pattern(re);\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    target_str.data = target_buf;\n    target_str.length = (int)sizeof(target_buf);\n    extract_ret = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)rewrite_len + (long)extract_ret\n                     + (long)err_code + (long)(re != NULL) + (long)(iter != NULL)\n                     + (long)target_str.length;\n    (void)computed_check;\n    (void)pattern_from_re;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxfooyybarzz\";\n    const size_t text_len = (size_t)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * pattern_from_re = NULL;\n    int case_sensitive_flag = 0;\n    int log_errors_flag = 0;\n    int match_arr[4];\n    size_t match_count = 0;\n    int compile_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    case_sensitive_flag = cre2_opt_case_sensitive(opt);\n    log_errors_flag = cre2_opt_log_errors(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n    match_count = cre2_set_match(set, text_buf, text_len, match_arr, (size_t)4);\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)text_len + (long)compile_ret\n                     + (long)match_count + (long)case_sensitive_flag + (long)log_errors_flag\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(iter != NULL)\n                     + (long)(pattern_from_re != NULL);\n    (void)computed_check;\n    (void)pattern_from_re;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:08:45.966337 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 49s
[2025-11-05 08:08:45.966462 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31830, Completion: 26617, Total: 58447
[2025-11-05 08:08:45.966483 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:08:46.185667 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001360/id_001360.cc
[2025-11-05 08:08:46.185721 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:08:46.416579 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:08:46.416670 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:08:46.419580 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:08:46.419613 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:08:46.639820 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001361/id_001361.cc
[2025-11-05 08:08:46.639880 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:08:46.868881 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:08:46.868956 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:08:46.871612 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:08:46.871644 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:08:47.092778 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001362/id_001362.cc
[2025-11-05 08:08:47.092864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:08:47.321563 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:08:47.321636 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:08:47.324177 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:08:47.324210 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:08:47.542464 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001363/id_001363.cc
[2025-11-05 08:08:47.542524 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:08:47.772298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:08:47.772372 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:08:47.774879 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:08:47.774904 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:08:47.992275 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001364/id_001364.cc
[2025-11-05 08:08:47.992327 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:08:48.220900 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:08:48.221016 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:08:48.223876 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:08:48.223935 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:08:48.442452 +00:00] WARN [src/fuzzer.rs:205] Program 1365 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001365/id_001365.cc:42:11: error: no matching function for call to 'cre2_set_new'
   42 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:08:48.489871 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:08:48.490243 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"aaa foo bbb foo ccc\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"X\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite_str;\n    cre2_string_t strings[4];\n    cre2_range_t ranges[4];\n    int add_ret = 0;\n    int compile_ret = 0;\n    int replace_ret = 0;\n    int global_replace_ret = 0;\n    int prog_size = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, 0);\n\n    // step 3: Configure\n    add_ret = cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite_str);\n    global_replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite_str);\n    strings[0].data = text_buf + 4;\n    strings[0].length = 3;\n    strings[1].data = text_buf + 12;\n    strings[1].length = 3;\n    cre2_strings_to_ranges(text_buf, ranges, strings, 2);\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)text_len + (long)rewrite_len\n                     + (long)add_ret + (long)compile_ret + (long)replace_ret + (long)global_replace_ret\n                     + (long)prog_size + (long)ranges[0].start + (long)ranges[1].start;\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001365/id_001365.cc:42:11: error: no matching function for call to 'cre2_set_new'\n   42 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:09:06.742293 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 18s
[2025-11-05 08:09:06.742409 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24210, Completion: 10740, Total: 34950
[2025-11-05 08:09:06.961754 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001365/id_001365.cc
[2025-11-05 08:09:06.961808 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:07.191582 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:07.191640 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:07.194330 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:07.194357 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:07.194391 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1365!
[2025-11-05 08:09:07.412122 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001366/id_001366.cc
[2025-11-05 08:09:07.412175 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:07.642647 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:07.642718 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:07.645600 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:07.645633 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:07.863783 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001367/id_001367.cc
[2025-11-05 08:09:07.863868 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:08.093457 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:08.093531 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:08.096106 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:08.096134 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:08.314059 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001368/id_001368.cc
[2025-11-05 08:09:08.314114 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:08.543855 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:08.543930 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:08.546707 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:08.546733 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:08.766097 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001369/id_001369.cc
[2025-11-05 08:09:08.766149 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:08.996632 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:08.996737 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:08.999754 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:08.999787 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:08.999825 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:09:08.999841 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1370, succ: 1369, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:09:08.999875 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:09:08.999905 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:09:09.328155 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1369 as an example for the next prompt.
[2025-11-05 08:09:09.328213 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 08:09:09.328246 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 08:09:09.328295 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,41.0,24.0,61.0,164.0,141.0,40.0,38.0,107.0,58.0,43.0,254.0,16.0,27.0,391.0,160.0,27.0,119.0,38.0,207.0,96.0,123.0,118.0,128.0,52.0,58.0,27.0,18.0,49.0,151.0,102.0,16.0,24.0,129.0,236.0,28.0,719.0,225.0,204.0,41.0,63.0,67.0,38.0,364.0,20.0,58.0,147.0,20.0,10.0,88.0,286.0,16.0,16.0,170.0,49.0,38.0,82.0,22.0,307.0,28.0,59.0,45.0,30.0,175.0,52.0,205.0,52.0,49.0,16.0]
[2025-11-05 08:09:09.328313 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:09:09.328364 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 49
[2025-11-05 08:09:09.328397 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 41
[2025-11-05 08:09:09.328425 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 175
[2025-11-05 08:09:09.328453 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 225
[2025-11-05 08:09:09.328480 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_current energy: 38
[2025-11-05 08:09:09.328512 +00:00] INFO [src/request/prompt.rs:145] set combination: int64_t cre2_opt_max_mem(cre2_options_t * opt),
    int cre2_opt_literal(cre2_options_t * opt),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_version_interface_current()
[2025-11-05 08:09:09.329347 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 137, quiet_round: 0, discovered_api_pairs: 2599
[2025-11-05 08:09:09.359841 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:09:09.360192 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint64_t cre2_opt_max_mem(cre2_options_t * opt),\n    int cre2_opt_literal(cre2_options_t * opt),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_version_interface_current()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxfooyybarzz\";\n    const size_t text_len = (size_t)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * pattern_from_re = NULL;\n    int case_sensitive_flag = 0;\n    int log_errors_flag = 0;\n    int match_arr[4];\n    size_t match_count = 0;\n    int compile_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(match_arr, 0, sizeof(match_arr));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    case_sensitive_flag = cre2_opt_case_sensitive(opt);\n    log_errors_flag = cre2_opt_log_errors(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n    match_count = cre2_set_match(set, text_buf, text_len, match_arr, (size_t)4);\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)text_len + (long)compile_ret\n                     + (long)match_count + (long)case_sensitive_flag + (long)log_errors_flag\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(iter != NULL)\n                     + (long)(pattern_from_re != NULL);\n    (void)computed_check;\n    (void)pattern_from_re;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<g>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxfooYYbarzz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"${g}_X\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t strings_arr[2];\n    cre2_range_t ranges_arr[2];\n    int add_ret = 0;\n    int compile_ret = 0;\n    int prog_size = 0;\n    int replace_ret = 0;\n    int global_replace_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(&target_str, 0, sizeof(target_str));\n    memset(strings_arr, 0, sizeof(strings_arr));\n    memset(ranges_arr, 0, sizeof(ranges_arr));\n    memset(target_buf, 0, sizeof(target_buf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_ret = cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    target_str.data = target_buf;\n    target_str.length = (int)sizeof(target_buf);\n    replace_ret = cre2_replace_re(re, &text_str, &rewrite_str);\n    global_replace_ret = cre2_global_replace_re(re, &text_str, &rewrite_str);\n    strings_arr[0].data = \"foo\";\n    strings_arr[0].length = 3;\n    strings_arr[1].data = \"bar\";\n    strings_arr[1].length = 3;\n    cre2_strings_to_ranges(text_buf, ranges_arr, strings_arr, 2);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)rewrite_len\n                     + (long)add_ret + (long)compile_ret + (long)prog_size\n                     + (long)replace_ret + (long)global_replace_ret\n                     + (long)ranges_arr[0].start + (long)ranges_arr[0].past\n                     + (long)ranges_arr[1].start + (long)ranges_arr[1].past\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:09:48.374683 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 08:09:48.374810 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33400, Completion: 18812, Total: 52212
[2025-11-05 08:09:48.374829 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:09:48.593541 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001370/id_001370.cc
[2025-11-05 08:09:48.593596 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:48.824181 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:48.824242 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:48.827037 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:48.827068 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:49.043816 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001371/id_001371.cc
[2025-11-05 08:09:49.043871 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:49.271577 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:49.271646 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:49.274491 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:49.274524 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:49.492081 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001372/id_001372.cc
[2025-11-05 08:09:49.492166 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:49.720476 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:49.720548 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:49.723214 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:49.723246 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:49.942765 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001373/id_001373.cc
[2025-11-05 08:09:49.942819 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:50.170555 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:50.170624 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:50.173430 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:50.173465 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:50.391274 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001374/id_001374.cc
[2025-11-05 08:09:50.391326 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:50.620681 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:50.620801 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:50.623514 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:50.623547 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:50.840241 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001375/id_001375.cc
[2025-11-05 08:09:50.840295 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:51.068391 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:51.068471 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:51.071058 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:51.071083 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:51.289213 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001376/id_001376.cc
[2025-11-05 08:09:51.289267 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:51.518156 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:51.518217 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:51.521129 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:51.521162 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:51.738536 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001377/id_001377.cc
[2025-11-05 08:09:51.738622 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:51.968777 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:51.968838 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:51.971513 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:51.971546 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:52.189341 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001378/id_001378.cc
[2025-11-05 08:09:52.189395 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:52.418216 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:52.418289 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:52.421035 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:52.421068 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:52.639008 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001379/id_001379.cc
[2025-11-05 08:09:52.639062 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:09:52.868213 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:09:52.868318 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:09:52.871003 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:09:52.871034 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:09:52.871073 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:09:52.871089 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1380, succ: 1379, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:09:52.871104 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:09:52.871130 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:09:53.145951 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1379 as an example for the next prompt.
[2025-11-05 08:09:53.146008 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 30 new API pairs in this round.
[2025-11-05 08:09:53.146058 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 30
[2025-11-05 08:09:53.146107 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,51.0,24.0,61.0,164.0,141.0,40.0,38.0,110.0,60.0,43.0,260.0,16.0,27.0,393.0,161.0,27.0,119.0,38.0,207.0,104.0,123.0,118.0,128.0,52.0,58.0,27.0,18.0,49.0,151.0,102.0,16.0,24.0,129.0,237.0,28.0,726.0,235.0,204.0,41.0,63.0,67.0,38.0,364.0,20.0,58.0,147.0,20.0,10.0,88.0,286.0,16.0,16.0,170.0,60.0,52.0,82.0,22.0,309.0,28.0,59.0,52.0,30.0,181.0,52.0,205.0,52.0,49.0,16.0]
[2025-11-05 08:09:53.146125 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:09:53.146177 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 726
[2025-11-05 08:09:53.146208 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 286
[2025-11-05 08:09:53.146236 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 204
[2025-11-05 08:09:53.146263 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 51
[2025-11-05 08:09:53.146290 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_next energy: 52
[2025-11-05 08:09:53.146325 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_opt_literal(cre2_options_t * opt),
    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index)
[2025-11-05 08:09:53.147147 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 138, quiet_round: 0, discovered_api_pairs: 2629
[2025-11-05 08:09:53.193766 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:09:53.194133 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_opt_literal(cre2_options_t * opt),\n    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<g>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"xxfooYYbarzz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"${g}_X\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    char target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t strings_arr[2];\n    cre2_range_t ranges_arr[2];\n    int add_ret = 0;\n    int compile_ret = 0;\n    int prog_size = 0;\n    int replace_ret = 0;\n    int global_replace_ret = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&text_str, 0, sizeof(text_str));\n    memset(&rewrite_str, 0, sizeof(rewrite_str));\n    memset(&target_str, 0, sizeof(target_str));\n    memset(strings_arr, 0, sizeof(strings_arr));\n    memset(ranges_arr, 0, sizeof(ranges_arr));\n    memset(target_buf, 0, sizeof(target_buf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_ret = cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n    text_str.data = text_buf;\n    text_str.length = text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = rewrite_len;\n    target_str.data = target_buf;\n    target_str.length = (int)sizeof(target_buf);\n    replace_ret = cre2_replace_re(re, &text_str, &rewrite_str);\n    global_replace_ret = cre2_global_replace_re(re, &text_str, &rewrite_str);\n    strings_arr[0].data = \"foo\";\n    strings_arr[0].length = 3;\n    strings_arr[1].data = \"bar\";\n    strings_arr[1].length = 3;\n    cre2_strings_to_ranges(text_buf, ranges_arr, strings_arr, 2);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)text_len + (long)rewrite_len\n                     + (long)add_ret + (long)compile_ret + (long)prog_size\n                     + (long)replace_ret + (long)global_replace_ret\n                     + (long)ranges_arr[0].start + (long)ranges_arr[0].past\n                     + (long)ranges_arr[1].start + (long)ranges_arr[1].past\n                     + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * pattern_from_re = NULL;\n    int num_groups = 0;\n    int literal_flag = 0;\n    int ver_cur = 0;\n    int64_t max_mem = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&computed_check, 0, sizeof(computed_check));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)1048576);\n    max_mem = cre2_opt_max_mem(opt);\n    literal_flag = cre2_opt_literal(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n    ver_cur = cre2_version_interface_current();\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)max_mem + (long)literal_flag\n                     + (long)ver_cur + (long)num_groups\n                     + (long)(re != NULL) + (long)(iter != NULL)\n                     + (long)(pattern_from_re != NULL);\n    (void)computed_check;\n    (void)pattern_from_re;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:10:30.363095 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 08:10:30.363214 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33460, Completion: 22267, Total: 55727
[2025-11-05 08:10:30.363234 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:10:30.580392 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001380/id_001380.cc
[2025-11-05 08:10:30.580445 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:30.809820 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:30.809894 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:30.812806 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:30.812833 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:31.030420 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001381/id_001381.cc
[2025-11-05 08:10:31.030473 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:31.260783 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:31.260859 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:31.263599 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:31.263631 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:31.481948 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001382/id_001382.cc
[2025-11-05 08:10:31.482032 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:31.710255 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:31.710329 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:31.713173 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:31.713200 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:31.930769 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001383/id_001383.cc
[2025-11-05 08:10:31.930822 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:32.159377 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:32.159453 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:32.162174 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:32.162207 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:32.379241 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001384/id_001384.cc
[2025-11-05 08:10:32.379295 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:32.608837 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:32.608951 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:32.611618 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:32.611646 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:32.828810 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001385/id_001385.cc
[2025-11-05 08:10:32.828864 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:33.057378 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:33.057453 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:33.060192 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:33.060224 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:33.278462 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001386/id_001386.cc
[2025-11-05 08:10:33.278516 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:33.507368 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:33.507443 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:33.510301 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:33.510333 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:33.728610 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001387/id_001387.cc
[2025-11-05 08:10:33.728705 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:33.958917 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:33.958993 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:33.961830 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:33.961863 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:34.179362 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001388/id_001388.cc
[2025-11-05 08:10:34.179415 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:34.406794 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:34.406869 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:34.410110 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:34.410167 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:34.627213 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001389/id_001389.cc
[2025-11-05 08:10:34.627265 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:10:34.855728 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:10:34.855843 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:10:34.858583 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:10:34.858615 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:10:34.858656 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:10:34.858673 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1390, succ: 1389, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:10:34.858688 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:10:34.858714 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:10:35.146480 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1389 as an example for the next prompt.
[2025-11-05 08:10:35.146536 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 25 new API pairs in this round.
[2025-11-05 08:10:35.146584 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 25
[2025-11-05 08:10:35.146634 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,63.0,24.0,61.0,164.0,146.0,40.0,38.0,110.0,63.0,43.0,264.0,16.0,27.0,394.0,161.0,27.0,119.0,38.0,207.0,112.0,123.0,118.0,128.0,59.0,58.0,27.0,18.0,49.0,152.0,102.0,16.0,24.0,131.0,238.0,28.0,729.0,239.0,211.0,41.0,63.0,67.0,38.0,364.0,20.0,58.0,147.0,20.0,10.0,88.0,296.0,16.0,16.0,170.0,60.0,52.0,82.0,22.0,310.0,28.0,59.0,52.0,30.0,185.0,52.0,207.0,52.0,49.0,16.0]
[2025-11-05 08:10:35.146656 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:10:35.146709 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 264
[2025-11-05 08:10:35.146747 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace energy: 20
[2025-11-05 08:10:35.146780 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add energy: 20
[2025-11-05 08:10:35.146812 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 207
[2025-11-05 08:10:35.146844 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 118
[2025-11-05 08:10:35.146887 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),
    cre2_options_t *cre2_opt_new(),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 08:10:35.147704 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 139, quiet_round: 0, discovered_api_pairs: 2654
[2025-11-05 08:10:35.194422 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:10:35.194796 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * pattern_from_re = NULL;\n    int num_groups = 0;\n    int literal_flag = 0;\n    int ver_cur = 0;\n    int64_t max_mem = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&computed_check, 0, sizeof(computed_check));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_literal(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)1048576);\n    max_mem = cre2_opt_max_mem(opt);\n    literal_flag = cre2_opt_literal(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n    ver_cur = cre2_version_interface_current();\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)max_mem + (long)literal_flag\n                     + (long)ver_cur + (long)num_groups\n                     + (long)(re != NULL) + (long)(iter != NULL)\n                     + (long)(pattern_from_re != NULL);\n    (void)computed_check;\n    (void)pattern_from_re;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = -1;\n    bool next_ret = false;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int literal_flag = 0;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&computed_check, 0, sizeof(computed_check));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    literal_flag = cre2_opt_literal(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    next_ret = cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)enc + (long)literal_flag\n                     + (long)next_ret + (long)group_index + (long)num_groups\n                     + (long)(group_name != NULL) + (long)(re != NULL)\n                     + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n    (void)group_name;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:11:17.856451 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 08:11:17.856591 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29880, Completion: 25373, Total: 55253
[2025-11-05 08:11:17.856618 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:11:18.076107 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001390/id_001390.cc
[2025-11-05 08:11:18.076169 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:18.306522 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:18.306598 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:18.309316 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:18.309342 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:18.526744 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001391/id_001391.cc
[2025-11-05 08:11:18.526798 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:18.756157 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:18.756231 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:18.759000 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:18.759033 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:18.977915 +00:00] WARN [src/fuzzer.rs:205] Program 1392 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001392/id_001392.cc:38:11: error: no matching function for call to 'cre2_set_new'
   38 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:11:19.024748 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:11:19.025085 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    char set_error[128];\n    int set_add_rc = 0;\n    int num_groups = 0;\n    cre2_string_t text_and_target;\n    char textbuf[] = \"foo bar foo\";\n    cre2_string_t rewrite;\n    char rewritebuf[] = \"X-$1\";\n    int replace_rc = 0;\n    int global_replace_rc = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(set_error, 0, sizeof(set_error));\n    memset(&computed_check, 0, sizeof(computed_check));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, 0);\n\n    // step 3: Configure\n    text_and_target.data = textbuf;\n    text_and_target.length = (int)(sizeof(textbuf) - 1);\n    rewrite.data = rewritebuf;\n    rewrite.length = (int)(sizeof(rewritebuf) - 1);\n\n    // step 4: Core operations\n    set_add_rc = cre2_set_add(set, pattern, (size_t)pattern_len, set_error, sizeof(set_error));\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    replace_rc = cre2_replace(\"foo\", &text_and_target, &rewrite);\n    global_replace_rc = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    computed_check = (long)pattern_len + (long)num_groups + (long)set_add_rc\n                     + (long)replace_rc + (long)global_replace_rc\n                     + (long)(text_and_target.length) + (long)(rewrite.length)\n                     + (long)(set != NULL) + (long)(re != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001392/id_001392.cc:38:11: error: no matching function for call to 'cre2_set_new'\n   38 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:11:42.619859 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 23s
[2025-11-05 08:11:42.619988 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23290, Completion: 11706, Total: 34996
[2025-11-05 08:11:42.838755 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001392/id_001392.cc
[2025-11-05 08:11:42.838811 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:43.068660 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:43.068728 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:43.071317 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:43.071349 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:43.071384 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1392!
[2025-11-05 08:11:43.289135 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001393/id_001393.cc
[2025-11-05 08:11:43.289191 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:43.519612 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:43.519688 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:43.522592 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:43.522624 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:43.738557 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001394/id_001394.cc
[2025-11-05 08:11:43.738644 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:43.971866 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:43.971935 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:43.974786 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:43.974812 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:44.191618 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001395/id_001395.cc
[2025-11-05 08:11:44.191674 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:44.420304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:44.420377 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:44.423302 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:44.423336 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:44.641936 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001396/id_001396.cc
[2025-11-05 08:11:44.641991 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:44.870704 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:44.870792 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:44.873728 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:44.873760 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:45.091978 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001397/id_001397.cc
[2025-11-05 08:11:45.092036 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:45.321891 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:45.321951 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:45.324751 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:45.324782 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:45.542842 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001398/id_001398.cc
[2025-11-05 08:11:45.542900 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:45.770615 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:45.770686 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:45.773602 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:45.773634 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:45.992128 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001399/id_001399.cc
[2025-11-05 08:11:45.992218 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:11:46.220334 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:11:46.220411 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:11:46.223193 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:11:46.223252 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:11:46.223297 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:11:46.223318 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1400, succ: 1399, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:11:46.223341 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:11:46.223374 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:11:46.527346 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1399 as an example for the next prompt.
[2025-11-05 08:11:46.527403 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 26 new API pairs in this round.
[2025-11-05 08:11:46.527451 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 26
[2025-11-05 08:11:46.527500 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,63.0,24.0,61.0,164.0,146.0,40.0,38.0,110.0,68.0,43.0,274.0,16.0,27.0,396.0,161.0,27.0,119.0,38.0,208.0,112.0,123.0,127.0,130.0,59.0,58.0,27.0,18.0,49.0,152.0,102.0,16.0,24.0,131.0,242.0,28.0,737.0,239.0,216.0,41.0,63.0,67.0,38.0,364.0,32.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,170.0,60.0,52.0,82.0,22.0,310.0,28.0,59.0,52.0,30.0,185.0,52.0,207.0,52.0,49.0,16.0]
[2025-11-05 08:11:46.527518 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:11:46.527572 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 130
[2025-11-05 08:11:46.527605 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 207
[2025-11-05 08:11:46.527635 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 396
[2025-11-05 08:11:46.527662 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 364
[2025-11-05 08:11:46.527696 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_set_delete(cre2_set * set),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 08:11:46.528408 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 140, quiet_round: 0, discovered_api_pairs: 2680
[2025-11-05 08:11:46.566246 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:11:46.566599 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_set_delete(cre2_set * set),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|bar\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = -1;\n    bool next_ret = false;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int literal_flag = 0;\n    int num_groups = 0;\n    long computed_check = 0;\n\n    // step 2: Setup\n    memset(&computed_check, 0, sizeof(computed_check));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_literal(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    literal_flag = cre2_opt_literal(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    next_ret = cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate / compute lightweight checksum\n    computed_check = (long)pattern_len + (long)enc + (long)literal_flag\n                     + (long)next_ret + (long)group_index + (long)num_groups\n                     + (long)(group_name != NULL) + (long)(re != NULL)\n                     + (long)(set != NULL) + (long)(opt != NULL);\n    (void)computed_check;\n    (void)group_name;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char add_pattern[] = \"foo\";\n    const size_t add_pattern_len = (size_t)(sizeof(add_pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    char errorbuf[128];\n    int num_groups = 0;\n    int ret_replace = 0;\n    int ret_global_replace_re = 0;\n    int ret_set_add = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(errorbuf, 0, sizeof(errorbuf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    ret_set_add = cre2_set_add(set, add_pattern, add_pattern_len, errorbuf, sizeof(errorbuf));\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    text_and_target.data = \"foo bar baz foo\";\n    text_and_target.length = (int)(sizeof(\"foo bar baz foo\") - 1);\n    rewrite.data = \"qux\";\n    rewrite.length = (int)(sizeof(\"qux\") - 1);\n    ret_replace = cre2_replace(add_pattern, &text_and_target, &rewrite);\n    ret_global_replace_re = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)num_groups + (long)ret_replace + (long)ret_global_replace_re + (long)ret_set_add + (long)text_and_target.length;\n    (void)checksum;\n    (void)errorbuf;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:12:22.722189 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 36s
[2025-11-05 08:12:22.722319 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30280, Completion: 19347, Total: 49627
[2025-11-05 08:12:22.722340 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:12:22.940911 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001400/id_001400.cc
[2025-11-05 08:12:22.940965 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:23.169390 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:23.169460 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:23.172317 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:23.172348 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:23.389561 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001401/id_001401.cc
[2025-11-05 08:12:23.389615 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:23.617524 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:23.617596 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:23.620487 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:23.620520 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:23.838948 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001402/id_001402.cc
[2025-11-05 08:12:23.839033 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:24.068032 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:24.068110 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:24.070861 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:24.070893 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:24.288208 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001403/id_001403.cc
[2025-11-05 08:12:24.288261 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:24.517906 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:24.517978 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:24.520821 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:24.520853 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:24.737941 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001404/id_001404.cc
[2025-11-05 08:12:24.737995 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:24.966961 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:24.967067 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:24.969950 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:24.969982 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:25.187986 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001405/id_001405.cc
[2025-11-05 08:12:25.188039 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:25.418542 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:25.418614 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:25.421490 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:25.421523 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:25.637308 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001406/id_001406.cc
[2025-11-05 08:12:25.637361 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:25.867857 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:25.867914 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:25.870652 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:25.870687 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:26.088465 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001407/id_001407.cc
[2025-11-05 08:12:26.088551 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:26.317971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:26.318043 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:26.320913 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:26.320947 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:26.538177 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001408/id_001408.cc
[2025-11-05 08:12:26.538232 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:26.767390 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:26.767449 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:26.770232 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:26.770265 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:26.987358 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001409/id_001409.cc
[2025-11-05 08:12:26.987412 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:12:27.217804 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:12:27.217911 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:12:27.220793 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:12:27.220826 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:12:27.220866 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:12:27.220882 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1410, succ: 1409, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:12:27.220897 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:12:27.220924 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:12:27.498201 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1409 as an example for the next prompt.
[2025-11-05 08:12:27.498257 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 1 new API pairs in this round.
[2025-11-05 08:12:27.498280 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 1
[2025-11-05 08:12:27.498329 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,63.0,24.0,61.0,164.0,146.0,40.0,38.0,110.0,69.0,43.0,274.0,16.0,27.0,396.0,161.0,27.0,119.0,38.0,208.0,112.0,123.0,127.0,130.0,59.0,58.0,27.0,18.0,49.0,152.0,102.0,16.0,24.0,132.0,242.0,28.0,737.0,239.0,216.0,41.0,63.0,67.0,38.0,364.0,32.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,170.0,60.0,52.0,82.0,22.0,310.0,28.0,59.0,52.0,30.0,185.0,52.0,208.0,52.0,49.0,16.0]
[2025-11-05 08:12:27.498348 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:12:27.498428 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 130
[2025-11-05 08:12:27.498461 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 82
[2025-11-05 08:12:27.498486 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 364
[2025-11-05 08:12:27.498512 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 146
[2025-11-05 08:12:27.498538 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 242
[2025-11-05 08:12:27.498577 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_set_delete(cre2_set * set),
    void cre2_opt_delete(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)
[2025-11-05 08:12:27.499393 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 141, quiet_round: 0, discovered_api_pairs: 2681
[2025-11-05 08:12:27.545166 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:12:27.545521 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_set_delete(cre2_set * set),\n    void cre2_opt_delete(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char add_pattern[] = \"foo\";\n    const size_t add_pattern_len = (size_t)(sizeof(add_pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    char errorbuf[128];\n    int num_groups = 0;\n    int ret_replace = 0;\n    int ret_global_replace_re = 0;\n    int ret_set_add = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(errorbuf, 0, sizeof(errorbuf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    ret_set_add = cre2_set_add(set, add_pattern, add_pattern_len, errorbuf, sizeof(errorbuf));\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    text_and_target.data = \"foo bar baz foo\";\n    text_and_target.length = (int)(sizeof(\"foo bar baz foo\") - 1);\n    rewrite.data = \"qux\";\n    rewrite.length = (int)(sizeof(\"qux\") - 1);\n    ret_replace = cre2_replace(add_pattern, &text_and_target, &rewrite);\n    ret_global_replace_re = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)num_groups + (long)ret_replace + (long)ret_global_replace_re + (long)ret_set_add + (long)text_and_target.length;\n    (void)checksum;\n    (void)errorbuf;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char add_pattern[] = \"foo\";\n    const char text[] = \"foo bar baz\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match[4];\n    const int nmatch = 3;\n    int ret_set_add = 0;\n    int ret_easy = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    ret_set_add = cre2_set_add_simple(set, add_pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    ret_easy = cre2_easy_match(pattern, pattern_len, text, text_len, match, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)ret_set_add + (long)ret_easy\n               + (long)(re != NULL) + (long)(set != NULL) + (long)match[0].length + (long)match[1].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:13:02.830669 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 35s
[2025-11-05 08:13:02.830794 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30440, Completion: 18954, Total: 49394
[2025-11-05 08:13:02.830814 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:13:03.048195 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001410/id_001410.cc
[2025-11-05 08:13:03.048249 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:03.277870 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:03.277941 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:03.280794 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:03.280826 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:03.499804 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001411/id_001411.cc
[2025-11-05 08:13:03.499858 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:03.728443 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:03.728521 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:03.731047 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:03.731074 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:03.948218 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001412/id_001412.cc
[2025-11-05 08:13:03.948302 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:04.175319 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:04.175396 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:04.178310 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:04.178342 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:04.396580 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001413/id_001413.cc
[2025-11-05 08:13:04.396648 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:04.626417 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:04.626491 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:04.629328 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:04.629362 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:04.846892 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001414/id_001414.cc
[2025-11-05 08:13:04.846946 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:05.080904 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:05.081021 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:05.083556 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:05.083588 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:05.300889 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001415/id_001415.cc
[2025-11-05 08:13:05.300942 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:05.530927 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:05.531004 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:05.533762 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:05.533815 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:05.752221 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001416/id_001416.cc
[2025-11-05 08:13:05.752275 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:05.981627 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:05.981685 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:05.984483 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:05.984516 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:06.202154 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001417/id_001417.cc
[2025-11-05 08:13:06.202238 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:06.430442 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:06.430511 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:06.433358 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:06.433391 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:06.651772 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001418/id_001418.cc
[2025-11-05 08:13:06.651826 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:06.879105 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:06.879183 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:06.882102 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:06.882134 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:07.099810 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001419/id_001419.cc
[2025-11-05 08:13:07.099862 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:07.328681 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:07.328797 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:07.331541 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:07.331572 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:07.331610 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:13:07.331627 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1420, succ: 1419, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:13:07.331641 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:13:07.331667 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:13:07.605204 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1419 as an example for the next prompt.
[2025-11-05 08:13:07.605260 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 08:13:07.605287 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 08:13:07.605345 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,63.0,24.0,61.0,164.0,150.0,40.0,38.0,110.0,69.0,43.0,274.0,16.0,27.0,396.0,161.0,27.0,119.0,38.0,208.0,112.0,123.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,153.0,102.0,16.0,24.0,132.0,245.0,28.0,737.0,239.0,216.0,41.0,63.0,67.0,38.0,370.0,32.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,170.0,60.0,52.0,82.0,22.0,310.0,28.0,59.0,52.0,30.0,185.0,52.0,209.0,52.0,49.0,16.0]
[2025-11-05 08:13:07.605378 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:13:07.605443 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 274
[2025-11-05 08:13:07.605483 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 245
[2025-11-05 08:13:07.605535 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 737
[2025-11-05 08:13:07.605582 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_log_errors energy: 69
[2025-11-05 08:13:07.605629 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 170
[2025-11-05 08:13:07.605673 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_num_capturing_groups(const cre2_regexp_t * re),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 08:13:07.606500 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 142, quiet_round: 0, discovered_api_pairs: 2687
[2025-11-05 08:13:07.655015 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:13:07.655371 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_num_capturing_groups(const cre2_regexp_t * re),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char add_pattern[] = \"foo\";\n    const char text[] = \"foo bar baz\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match[4];\n    const int nmatch = 3;\n    int ret_set_add = 0;\n    int ret_easy = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 4: Core operations\n    ret_set_add = cre2_set_add_simple(set, add_pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    ret_easy = cre2_easy_match(pattern, pattern_len, text, text_len, match, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)ret_set_add + (long)ret_easy\n               + (long)(re != NULL) + (long)(set != NULL) + (long)match[0].length + (long)match[1].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"ab abc a\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t match[4];\n    const int nmatch = 3;\n    int ret_set_add = 0;\n    int ret_easy = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    ret_set_add = cre2_set_add_simple(set, \"ab\");\n    ret_easy = cre2_easy_match(pattern, pattern_len, text, text_len, match, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)ret_set_add + (long)ret_easy\n               + (long)match[0].length + (long)match[1].length + (long)(set != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:13:45.283369 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 08:13:45.283503 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28660, Completion: 19483, Total: 48143
[2025-11-05 08:13:45.283531 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:13:45.500971 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001420/id_001420.cc
[2025-11-05 08:13:45.501025 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:45.729615 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:45.729676 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:45.732537 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:45.732571 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:45.949233 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001421/id_001421.cc
[2025-11-05 08:13:45.949287 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:46.179209 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:46.179286 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:46.182166 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:46.182199 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:46.401055 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001422/id_001422.cc
[2025-11-05 08:13:46.401140 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:46.631028 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:46.631111 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:46.633937 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:46.633970 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:46.851293 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001423/id_001423.cc
[2025-11-05 08:13:46.851348 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:47.080513 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:47.080588 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:47.083120 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:47.083148 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:47.301873 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001424/id_001424.cc
[2025-11-05 08:13:47.301927 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:47.530882 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:47.530976 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:47.533818 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:47.533850 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:47.751547 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001425/id_001425.cc
[2025-11-05 08:13:47.751599 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:47.981260 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:47.981333 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:47.984121 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:47.984147 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:48.201536 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001426/id_001426.cc
[2025-11-05 08:13:48.201591 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:48.431969 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:48.432044 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:48.434879 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:48.434912 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:48.652511 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001427/id_001427.cc
[2025-11-05 08:13:48.652599 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:48.881730 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:48.881790 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:48.884611 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:48.884650 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:49.101211 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001428/id_001428.cc
[2025-11-05 08:13:49.101266 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:49.330114 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:49.330190 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:49.333000 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:49.333029 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:49.550635 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001429/id_001429.cc
[2025-11-05 08:13:49.550689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:13:49.780832 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:13:49.780933 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:13:49.783647 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:13:49.783675 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:13:49.783711 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:13:49.783726 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1430, succ: 1429, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:13:49.783745 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:13:49.783777 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:13:50.062982 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1429 as an example for the next prompt.
[2025-11-05 08:13:50.063037 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 08:13:50.063069 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 08:13:50.063123 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,63.0,24.0,61.0,164.0,150.0,40.0,38.0,110.0,73.0,43.0,279.0,16.0,27.0,396.0,161.0,27.0,119.0,38.0,208.0,112.0,123.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,155.0,102.0,16.0,24.0,132.0,246.0,28.0,742.0,239.0,216.0,41.0,63.0,67.0,38.0,370.0,32.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,82.0,22.0,310.0,28.0,59.0,52.0,30.0,185.0,52.0,214.0,52.0,49.0,16.0]
[2025-11-05 08:13:50.063141 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:13:50.063197 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 63
[2025-11-05 08:13:50.063240 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 279
[2025-11-05 08:13:50.063275 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 119
[2025-11-05 08:13:50.063315 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 132
[2025-11-05 08:13:50.063357 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_case_sensitive(cre2_options_t * opt),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)
[2025-11-05 08:13:50.064086 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 143, quiet_round: 0, discovered_api_pairs: 2695
[2025-11-05 08:13:50.092804 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:13:50.093165 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_case_sensitive(cre2_options_t * opt),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"ab abc a\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t match[4];\n    const int nmatch = 3;\n    int ret_set_add = 0;\n    int ret_easy = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    ret_set_add = cre2_set_add_simple(set, \"ab\");\n    ret_easy = cre2_easy_match(pattern, pattern_len, text, text_len, match, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)ret_set_add + (long)ret_easy\n               + (long)match[0].length + (long)match[1].length + (long)(set != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"((foo)bar)?(baz)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"xyz foobar baz qux\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    int set_match_results[8];\n    const size_t set_match_len = sizeof(set_match_results) / sizeof(set_match_results[0]);\n    int ret_add = 0;\n    int ret_compile = 0;\n    size_t matched_count = 0;\n    int num_caps = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(set_match_results, 0, sizeof(set_match_results));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 4: Core operations\n    ret_add = cre2_set_add_simple(set, \"foobar\");\n    ret_compile = cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    num_caps = cre2_num_capturing_groups(re);\n    matched_count = cre2_set_match(set, text, text_len, set_match_results, set_match_len);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)ret_add + (long)ret_compile\n               + (long)matched_count + (long)num_caps + (long)(set != NULL) + (long)(opt != NULL)\n               + (long)set_match_results[0] + (long)set_match_results[1];\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:14:29.173250 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 08:14:29.173372 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28660, Completion: 20043, Total: 48703
[2025-11-05 08:14:29.173393 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:14:29.392935 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001430/id_001430.cc
[2025-11-05 08:14:29.392987 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:29.622902 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:29.622978 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:29.625796 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:29.625827 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:29.843691 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001431/id_001431.cc
[2025-11-05 08:14:29.843745 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:30.072538 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:30.072613 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:30.075297 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:30.075325 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:30.293222 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001432/id_001432.cc
[2025-11-05 08:14:30.293311 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:30.522339 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:30.522396 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:30.525146 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:30.525175 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:30.742507 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001433/id_001433.cc
[2025-11-05 08:14:30.742560 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:30.970786 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:30.970866 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:30.973762 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:30.973796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:31.192365 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001434/id_001434.cc
[2025-11-05 08:14:31.192420 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:31.420634 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:31.420743 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:31.423371 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:31.423399 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:31.640997 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001435/id_001435.cc
[2025-11-05 08:14:31.641051 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:31.871339 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:31.871399 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:31.874261 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:31.874294 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:32.092772 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001436/id_001436.cc
[2025-11-05 08:14:32.092826 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:32.321227 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:32.321303 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:32.323849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:32.323882 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:32.541264 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001437/id_001437.cc
[2025-11-05 08:14:32.541352 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:32.771148 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:32.771210 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:32.774043 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:32.774071 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:32.991886 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001438/id_001438.cc
[2025-11-05 08:14:32.991940 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:33.221041 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:33.221102 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:33.223701 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:33.223728 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:33.440914 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001439/id_001439.cc
[2025-11-05 08:14:33.440968 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:14:33.670445 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:14:33.670591 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:14:33.673434 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:14:33.673467 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:14:33.673505 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:14:33.673525 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1440, succ: 1439, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:14:33.673545 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:14:33.673578 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:14:33.944597 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1439 as an example for the next prompt.
[2025-11-05 08:14:33.944665 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 08:14:33.944701 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 08:14:33.944749 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,63.0,24.0,61.0,164.0,150.0,40.0,38.0,110.0,73.0,43.0,282.0,16.0,27.0,398.0,161.0,27.0,125.0,38.0,210.0,112.0,123.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,155.0,102.0,16.0,24.0,139.0,250.0,28.0,744.0,239.0,216.0,41.0,70.0,67.0,38.0,373.0,32.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,82.0,22.0,310.0,28.0,59.0,52.0,30.0,185.0,52.0,214.0,52.0,49.0,16.0]
[2025-11-05 08:14:33.944768 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:14:33.944821 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 63
[2025-11-05 08:14:33.944852 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 150
[2025-11-05 08:14:33.944879 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 52
[2025-11-05 08:14:33.944907 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 210
[2025-11-05 08:14:33.944934 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 310
[2025-11-05 08:14:33.944968 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_literal(cre2_options_t * opt),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    cre2_options_t *cre2_opt_new(),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 08:14:33.945794 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 144, quiet_round: 0, discovered_api_pairs: 2707
[2025-11-05 08:14:33.985415 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:14:33.985770 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_literal(cre2_options_t * opt),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    cre2_options_t *cre2_opt_new(),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"((foo)bar)?(baz)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"xyz foobar baz qux\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    int set_match_results[8];\n    const size_t set_match_len = sizeof(set_match_results) / sizeof(set_match_results[0]);\n    int ret_add = 0;\n    int ret_compile = 0;\n    size_t matched_count = 0;\n    int num_caps = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(set_match_results, 0, sizeof(set_match_results));\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 4: Core operations\n    ret_add = cre2_set_add_simple(set, \"foobar\");\n    ret_compile = cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    num_caps = cre2_num_capturing_groups(re);\n    matched_count = cre2_set_match(set, text, text_len, set_match_results, set_match_len);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)ret_add + (long)ret_compile\n               + (long)matched_count + (long)num_caps + (long)(set != NULL) + (long)(opt != NULL)\n               + (long)set_match_results[0] + (long)set_match_results[1];\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"((foo)bar)?(baz)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"xyz foobar baz qux\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match[10];\n    const int nmatch = 10;\n    int ret_easy = 0;\n    int cs_flag = 0;\n    int num_caps = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_caps = cre2_num_capturing_groups(re);\n    ret_easy = cre2_easy_match(pattern, pattern_len, text, text_len, match, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)cs_flag + (long)num_caps + (long)ret_easy\n               + (long)match[0].length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:15:17.902010 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 08:15:17.902137 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29490, Completion: 23031, Total: 52521
[2025-11-05 08:15:17.902157 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:15:18.121072 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001440/id_001440.cc
[2025-11-05 08:15:18.121128 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:18.352223 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:18.352295 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:18.355120 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:18.355152 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:18.572987 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001441/id_001441.cc
[2025-11-05 08:15:18.573042 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:18.802782 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:18.802841 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:18.805403 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:18.805436 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:19.023294 +00:00] WARN [src/fuzzer.rs:205] Program 1442 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001442/id_001442.cc:38:5: error: no matching function for call to 'cre2_opt_literal'
   38 |     cre2_opt_literal(opt, 1);
      |     ^~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:76:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   76 | cre2_decl int cre2_opt_literal                  (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:15:19.063035 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:15:19.063364 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)(bar)?(baz)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobarbaz\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    const int nmatch = 6;\n    cre2_string_t match[nmatch];\n    const char * patt_from_re = NULL;\n    int consume_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    input.data = text;\n    input.length = text_len;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_literal(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    patt_from_re = cre2_pattern(re);\n    consume_ret = cre2_consume(patt_from_re, &input, match, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)consume_ret\n               + (long)match[0].length + (long)(patt_from_re != NULL)\n               + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001442/id_001442.cc:38:5: error: no matching function for call to 'cre2_opt_literal'\n   38 |     cre2_opt_literal(opt, 1);\n      |     ^~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:76:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   76 | cre2_decl int cre2_opt_literal                  (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:15:40.628653 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 08:15:40.628776 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22040, Completion: 11799, Total: 33839
[2025-11-05 08:15:40.846328 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001442/id_001442.cc
[2025-11-05 08:15:40.846381 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:41.074792 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:41.074866 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:41.077730 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:41.077764 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:41.077795 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1442!
[2025-11-05 08:15:41.294880 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001443/id_001443.cc
[2025-11-05 08:15:41.294933 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:41.524759 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:41.524816 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:41.527501 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:41.527532 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:41.746405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001444/id_001444.cc
[2025-11-05 08:15:41.746491 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:41.976577 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:41.976665 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:41.979367 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:41.979394 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:42.197333 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001445/id_001445.cc
[2025-11-05 08:15:42.197387 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:42.427015 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:42.427090 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:42.429961 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:42.429992 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:42.648961 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001446/id_001446.cc
[2025-11-05 08:15:42.649025 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:42.878375 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:42.878483 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:42.881378 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:42.881409 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:43.099447 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001447/id_001447.cc
[2025-11-05 08:15:43.099501 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:15:43.328161 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:15:43.328232 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:15:43.331054 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:15:43.331086 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:15:43.550655 +00:00] WARN [src/fuzzer.rs:205] Program 1448 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001448/id_001448.cc:41:5: error: no matching function for call to 'cre2_opt_literal'
   41 |     cre2_opt_literal(opt, 1);
      |     ^~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:76:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   76 | cre2_decl int cre2_opt_literal                  (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:15:43.590407 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:15:43.590742 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"xyz foobar baz\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t match;\n    const char * pat_from_re = NULL;\n    int consume_result = 0;\n    int literal_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&input, 0, sizeof(input));\n    memset(&match, 0, sizeof(match));\n    input.data = text;\n    input.length = text_len;\n    match.data = NULL;\n    match.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_literal(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pat_from_re = cre2_pattern(re);\n    consume_result = cre2_consume(pat_from_re, &input, &match, 10);\n\n    // step 5: Validate\n    literal_flag = cre2_opt_literal(opt);\n    checksum = (long)pattern_len + (long)input.length + (long)match.length + (long)consume_result\n               + (long)literal_flag + (long)(re != NULL) + (long)(pat_from_re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001448/id_001448.cc:41:5: error: no matching function for call to 'cre2_opt_literal'\n   41 |     cre2_opt_literal(opt, 1);\n      |     ^~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:76:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   76 | cre2_decl int cre2_opt_literal                  (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:16:08.090402 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 24s
[2025-11-05 08:16:08.090528 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22260, Completion: 12321, Total: 34581
[2025-11-05 08:16:08.309599 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001448/id_001448.cc
[2025-11-05 08:16:08.309652 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:08.539297 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:08.539358 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:08.542158 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:08.542189 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:08.542219 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1448!
[2025-11-05 08:16:08.761537 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001449/id_001449.cc
[2025-11-05 08:16:08.761590 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:08.990781 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:08.990855 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:08.993647 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:08.993681 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:08.993719 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:16:08.993735 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1450, succ: 1449, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:16:08.993751 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:16:08.993777 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:16:09.270957 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1449 as an example for the next prompt.
[2025-11-05 08:16:09.271036 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 08:16:09.271068 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 08:16:09.271116 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [50.0,57.0,70.0,24.0,61.0,164.0,153.0,40.0,38.0,110.0,73.0,43.0,282.0,16.0,27.0,400.0,161.0,27.0,125.0,38.0,211.0,114.0,123.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,155.0,102.0,16.0,24.0,139.0,250.0,28.0,749.0,239.0,216.0,41.0,70.0,67.0,38.0,373.0,32.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,82.0,22.0,314.0,28.0,59.0,52.0,30.0,185.0,58.0,214.0,52.0,49.0,16.0]
[2025-11-05 08:16:09.271133 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:16:09.271185 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace energy: 32
[2025-11-05 08:16:09.271219 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 50
[2025-11-05 08:16:09.271246 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 153
[2025-11-05 08:16:09.271284 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 282
[2025-11-05 08:16:09.271320 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    int cre2_num_capturing_groups(const cre2_regexp_t * re)
[2025-11-05 08:16:09.272036 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 145, quiet_round: 0, discovered_api_pairs: 2717
[2025-11-05 08:16:09.311557 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:16:09.311904 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"((foo)bar)?(baz)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"xyz foobar baz qux\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match[10];\n    const int nmatch = 10;\n    int ret_easy = 0;\n    int cs_flag = 0;\n    int num_caps = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_caps = cre2_num_capturing_groups(re);\n    ret_easy = cre2_easy_match(pattern, pattern_len, text, text_len, match, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)cs_flag + (long)num_caps + (long)ret_easy\n               + (long)match[0].length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[6];\n    const int nmatch = 6;\n    int literal_flag = 0;\n    int consumed = 0;\n    const char * pat_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_literal(opt, 0);\n    literal_flag = cre2_opt_literal(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pat_from_re = cre2_pattern(re);\n    input.data = text;\n    input.length = text_len;\n    consumed = cre2_consume(pat_from_re, &input, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)consumed + (long)literal_flag\n               + (long)(re != NULL) + (long)(opt != NULL) + (long)matches[0].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:16:47.231130 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 08:16:47.231255 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28730, Completion: 21699, Total: 50429
[2025-11-05 08:16:47.231276 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:16:47.449235 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001450/id_001450.cc
[2025-11-05 08:16:47.449288 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:47.678634 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:47.678711 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:47.681599 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:47.681631 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:47.898247 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001451/id_001451.cc
[2025-11-05 08:16:47.898301 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:48.127333 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:48.127406 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:48.130321 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:48.130353 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:48.346945 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001452/id_001452.cc
[2025-11-05 08:16:48.347028 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:48.575750 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:48.575824 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:48.578609 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:48.578642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:48.797352 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001453/id_001453.cc
[2025-11-05 08:16:48.797413 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:49.027132 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:49.027206 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:49.030138 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:49.030171 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:49.247318 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001454/id_001454.cc
[2025-11-05 08:16:49.247370 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:49.477491 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:49.477602 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:49.480153 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:49.480184 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:49.698351 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001455/id_001455.cc
[2025-11-05 08:16:49.698404 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:49.928719 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:49.928793 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:49.931419 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:49.931451 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:50.148232 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001456/id_001456.cc
[2025-11-05 08:16:50.148285 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:50.379462 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:50.379534 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:50.382424 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:50.382456 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:50.601860 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001457/id_001457.cc
[2025-11-05 08:16:50.601943 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:50.830630 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:50.830704 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:50.833588 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:50.833620 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:51.051411 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001458/id_001458.cc
[2025-11-05 08:16:51.051463 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:51.281067 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:51.281141 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:51.283886 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:51.283917 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:51.502349 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001459/id_001459.cc
[2025-11-05 08:16:51.502403 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:16:51.732037 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:16:51.732144 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:16:51.734893 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:16:51.734926 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:16:51.734964 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:16:51.734980 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1460, succ: 1459, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:16:51.734995 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:16:51.735020 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:16:52.025753 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1459 as an example for the next prompt.
[2025-11-05 08:16:52.025808 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 08:16:52.025837 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 08:16:52.025884 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,164.0,154.0,40.0,38.0,110.0,73.0,43.0,286.0,16.0,27.0,402.0,161.0,27.0,125.0,38.0,211.0,114.0,123.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,155.0,102.0,16.0,24.0,139.0,250.0,28.0,751.0,239.0,216.0,41.0,70.0,67.0,38.0,373.0,36.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,82.0,22.0,314.0,28.0,59.0,52.0,30.0,185.0,58.0,214.0,52.0,49.0,16.0]
[2025-11-05 08:16:52.025905 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:16:52.025957 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 751
[2025-11-05 08:16:52.026014 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 154
[2025-11-05 08:16:52.026042 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 102
[2025-11-05 08:16:52.026083 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_quote_meta energy: 27
[2025-11-05 08:16:52.026121 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    int cre2_quote_meta(cre2_string_t * quoted, cre2_string_t * original)
[2025-11-05 08:16:52.026833 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 146, quiet_round: 0, discovered_api_pairs: 2723
[2025-11-05 08:16:52.071723 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:16:52.072075 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    int cre2_quote_meta(cre2_string_t * quoted, cre2_string_t * original)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t input;\n    cre2_string_t matches[6];\n    const int nmatch = 6;\n    int literal_flag = 0;\n    int consumed = 0;\n    const char * pat_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    cre2_opt_set_literal(opt, 0);\n    literal_flag = cre2_opt_literal(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    pat_from_re = cre2_pattern(re);\n    input.data = text;\n    input.length = text_len;\n    consumed = cre2_consume(pat_from_re, &input, matches, nmatch);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)consumed + (long)literal_flag\n               + (long)(re != NULL) + (long)(opt != NULL) + (long)matches[0].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo and foo suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"bar\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int check_ok = 0;\n    int replace_ret = 0;\n    int num_caps = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_caps = cre2_num_capturing_groups(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    errmsg.data = NULL;\n    errmsg.length = 0;\n    check_ok = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n    replace_ret = cre2_replace(pattern, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)num_caps + (long)check_ok + (long)replace_ret\n               + (long)text_and_target.length + (long)rewrite.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:17:35.478158 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 08:17:35.478285 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29650, Completion: 23791, Total: 53441
[2025-11-05 08:17:35.478306 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:17:35.695715 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001460/id_001460.cc
[2025-11-05 08:17:35.695768 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:35.926289 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:35.926358 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:35.929064 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:35.929096 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:36.146554 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001461/id_001461.cc
[2025-11-05 08:17:36.146608 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:36.376068 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:36.376140 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:36.378921 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:36.378953 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:36.596520 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001462/id_001462.cc
[2025-11-05 08:17:36.596606 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:36.825690 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:36.825749 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:36.828501 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:36.828527 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:37.046572 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001463/id_001463.cc
[2025-11-05 08:17:37.046626 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:37.275093 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:37.275161 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:37.278035 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:37.278063 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:37.496519 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001464/id_001464.cc
[2025-11-05 08:17:37.496571 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:37.726422 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:37.726540 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:37.729347 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:37.729380 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:37.946784 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001465/id_001465.cc
[2025-11-05 08:17:37.946838 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:38.176323 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:38.176382 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:38.179078 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:38.179110 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:38.396952 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001466/id_001466.cc
[2025-11-05 08:17:38.397006 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:38.625097 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:38.625166 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:38.627800 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:38.627828 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:38.844962 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001467/id_001467.cc
[2025-11-05 08:17:38.845049 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:39.073729 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:39.073786 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:39.076436 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:39.076463 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:39.294394 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001468/id_001468.cc
[2025-11-05 08:17:39.294448 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:39.523496 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:39.523577 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:39.526440 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:39.526472 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:39.745203 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001469/id_001469.cc
[2025-11-05 08:17:39.745256 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:17:39.979144 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:17:39.979248 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:17:39.982071 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:17:39.982103 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:17:39.982140 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:17:39.982156 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1470, succ: 1469, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:17:39.982189 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:17:39.982217 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:17:40.285724 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1469 as an example for the next prompt.
[2025-11-05 08:17:40.285781 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 08:17:40.285814 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 08:17:40.285864 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,164.0,158.0,40.0,38.0,110.0,73.0,43.0,287.0,16.0,27.0,406.0,161.0,37.0,125.0,38.0,212.0,114.0,123.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,155.0,110.0,16.0,24.0,139.0,250.0,28.0,758.0,239.0,216.0,41.0,70.0,67.0,38.0,373.0,36.0,58.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,314.0,28.0,59.0,52.0,30.0,185.0,58.0,214.0,52.0,49.0,16.0]
[2025-11-05 08:17:40.285882 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:17:40.285934 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 58
[2025-11-05 08:17:40.285966 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 373
[2025-11-05 08:17:40.285993 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 83
[2025-11-05 08:17:40.286021 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 406
[2025-11-05 08:17:40.286047 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 239
[2025-11-05 08:17:40.286083 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_log_errors(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_delete(cre2_options_t * opt),
    void cre2_delete(cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)
[2025-11-05 08:17:40.286913 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 147, quiet_round: 0, discovered_api_pairs: 2735
[2025-11-05 08:17:40.330085 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:17:40.330438 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_log_errors(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_delete(cre2_options_t * opt),\n    void cre2_delete(cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo and foo suffix\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"bar\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int check_ok = 0;\n    int replace_ret = 0;\n    int num_caps = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&errmsg, 0, sizeof(errmsg));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_caps = cre2_num_capturing_groups(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    errmsg.data = NULL;\n    errmsg.length = 0;\n    check_ok = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n    replace_ret = cre2_replace(pattern, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)num_caps + (long)check_ok + (long)replace_ret\n               + (long)text_and_target.length + (long)rewrite.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo and baz foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t original;\n    cre2_string_t quoted;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int quote_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    original.data = text_buf;\n    original.length = text_len;\n    quoted.data = NULL;\n    quoted.length = 0;\n    quote_ret = cre2_quote_meta(&quoted, &original);\n    strings[0] = original;\n    strings[1] = quoted;\n    cre2_strings_to_ranges(text_buf, ranges, strings, 2);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)quote_ret + (long)(re != NULL)\n               + (long)ranges[0].start + (long)ranges[0].past + (long)ranges[1].start + (long)ranges[1].past;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:18:34.704873 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 54s
[2025-11-05 08:18:34.704996 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29620, Completion: 22134, Total: 51754
[2025-11-05 08:18:34.705016 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:18:34.923245 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001470/id_001470.cc
[2025-11-05 08:18:34.923299 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:35.151789 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:35.151857 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:35.154606 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:35.154633 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:35.373609 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001471/id_001471.cc
[2025-11-05 08:18:35.373673 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:35.601660 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:35.601737 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:35.604821 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:35.604846 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:35.821994 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001472/id_001472.cc
[2025-11-05 08:18:35.822084 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:36.052587 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:36.052674 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:36.055643 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:36.055669 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:36.274114 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001473/id_001473.cc
[2025-11-05 08:18:36.274178 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:36.502070 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:36.502144 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:36.504963 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:36.504990 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:36.722298 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001474/id_001474.cc
[2025-11-05 08:18:36.722362 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:36.951180 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:36.951293 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:36.954216 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:36.954243 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:37.171237 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001475/id_001475.cc
[2025-11-05 08:18:37.171297 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:37.400858 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:37.400933 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:37.403504 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:37.403550 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:37.620892 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001476/id_001476.cc
[2025-11-05 08:18:37.620954 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:37.848376 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:37.848449 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:37.851594 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:37.851623 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:38.069305 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001477/id_001477.cc
[2025-11-05 08:18:38.069391 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:38.298831 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:38.298906 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:38.301726 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:38.301753 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:38.520821 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001478/id_001478.cc
[2025-11-05 08:18:38.520883 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:38.749906 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:38.749981 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:38.753177 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:38.753205 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:38.971423 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001479/id_001479.cc
[2025-11-05 08:18:38.971487 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:18:39.200670 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:18:39.200785 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:18:39.203323 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:18:39.203351 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:18:39.203387 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:18:39.203402 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1480, succ: 1479, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:18:39.203416 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:18:39.203441 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:18:39.481356 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1479 as an example for the next prompt.
[2025-11-05 08:18:39.481411 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 08:18:39.481444 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 08:18:39.481493 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,164.0,158.0,40.0,38.0,110.0,75.0,43.0,288.0,16.0,27.0,408.0,161.0,37.0,125.0,38.0,215.0,114.0,123.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,155.0,110.0,16.0,24.0,139.0,250.0,28.0,759.0,241.0,216.0,41.0,70.0,67.0,38.0,380.0,36.0,62.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,314.0,28.0,59.0,52.0,30.0,188.0,58.0,214.0,52.0,49.0,16.0]
[2025-11-05 08:18:39.481521 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:18:39.481574 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 125
[2025-11-05 08:18:39.481607 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_posix_syntax energy: 41
[2025-11-05 08:18:39.481633 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 58
[2025-11-05 08:18:39.481661 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 314
[2025-11-05 08:18:39.481686 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 123
[2025-11-05 08:18:39.481721 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    int cre2_opt_posix_syntax(cre2_options_t * opt),
    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_error_code(const cre2_regexp_t * re)
[2025-11-05 08:18:39.482527 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 148, quiet_round: 0, discovered_api_pairs: 2744
[2025-11-05 08:18:39.522295 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:18:39.522641 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    int cre2_opt_posix_syntax(cre2_options_t * opt),\n    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_error_code(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"foo and baz foo\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t original;\n    cre2_string_t quoted;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int quote_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    original.data = text_buf;\n    original.length = text_len;\n    quoted.data = NULL;\n    quoted.length = 0;\n    quote_ret = cre2_quote_meta(&quoted, &original);\n    strings[0] = original;\n    strings[1] = quoted;\n    cre2_strings_to_ranges(text_buf, ranges, strings, 2);\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)quote_ret + (long)(re != NULL)\n               + (long)ranges[0].start + (long)ranges[0].past + (long)ranges[1].start + (long)ranges[1].past;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo and baz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t match;\n    int opt_log = 0;\n    int easy_match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    opt_log = cre2_opt_log_errors(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    match.data = NULL;\n    match.length = 0;\n    easy_match_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)opt_log + (long)easy_match_ret\n               + (long)match.length + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:19:08.424638 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 08:19:08.424760 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28380, Completion: 18544, Total: 46924
[2025-11-05 08:19:08.424781 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:19:08.643455 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001480/id_001480.cc
[2025-11-05 08:19:08.643508 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:08.871501 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:08.871568 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:08.874268 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:08.874300 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:09.091483 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001481/id_001481.cc
[2025-11-05 08:19:09.091538 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:09.320713 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:09.320787 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:09.323513 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:09.323566 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:09.541806 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001482/id_001482.cc
[2025-11-05 08:19:09.541891 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:09.770948 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:09.771025 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:09.773849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:09.773881 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:09.992536 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001483/id_001483.cc
[2025-11-05 08:19:09.992590 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:10.221011 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:10.221084 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:10.223595 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:10.223628 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:10.440731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001484/id_001484.cc
[2025-11-05 08:19:10.440785 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:10.669374 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:10.669462 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:10.672176 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:10.672208 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:10.890341 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001485/id_001485.cc
[2025-11-05 08:19:10.890395 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:11.120136 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:11.120204 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:11.122907 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:11.122940 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:11.339544 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001486/id_001486.cc
[2025-11-05 08:19:11.339597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:11.567349 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:11.567417 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:11.570219 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:11.570251 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:11.787678 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001487/id_001487.cc
[2025-11-05 08:19:11.787766 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:12.015741 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:12.015814 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:12.018664 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:12.018718 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:12.236205 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001488/id_001488.cc
[2025-11-05 08:19:12.236261 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:12.465768 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:12.465828 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:12.468633 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:12.468667 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:12.684956 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001489/id_001489.cc
[2025-11-05 08:19:12.685009 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:12.914927 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:12.915028 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:12.917863 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:12.917896 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:12.917933 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:19:12.917950 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1490, succ: 1489, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:19:12.917966 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:19:12.917993 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:19:13.201340 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1489 as an example for the next prompt.
[2025-11-05 08:19:13.201397 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 7 new API pairs in this round.
[2025-11-05 08:19:13.201426 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 7
[2025-11-05 08:19:13.201474 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,164.0,158.0,40.0,38.0,110.0,75.0,43.0,288.0,16.0,27.0,409.0,161.0,37.0,127.0,38.0,216.0,114.0,127.0,127.0,133.0,59.0,58.0,27.0,18.0,49.0,155.0,110.0,16.0,24.0,139.0,250.0,28.0,761.0,241.0,216.0,44.0,70.0,67.0,38.0,380.0,36.0,62.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,317.0,28.0,59.0,52.0,30.0,188.0,63.0,214.0,52.0,49.0,16.0]
[2025-11-05 08:19:13.201493 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:19:13.201545 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 155
[2025-11-05 08:19:13.201581 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 241
[2025-11-05 08:19:13.201608 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_word_boundary energy: 27
[2025-11-05 08:19:13.201636 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 761
[2025-11-05 08:19:13.201668 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_compile(cre2_set * set),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_opt_word_boundary(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 08:19:13.202395 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 149, quiet_round: 0, discovered_api_pairs: 2751
[2025-11-05 08:19:13.235035 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:19:13.235381 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_compile(cre2_set * set),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_opt_word_boundary(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"prefix foo and baz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t match;\n    int opt_log = 0;\n    int easy_match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    opt_log = cre2_opt_log_errors(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    match.data = NULL;\n    match.length = 0;\n    easy_match_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match, 1);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)opt_log + (long)easy_match_ret\n               + (long)match.length + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"abxyz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text;\n    cre2_string_t matches[3];\n    int consume_ret = 0;\n    int opt_posix = 0;\n    const char * re_pat = NULL;\n    int errcode = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    opt_posix = cre2_opt_posix_syntax(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    text.data = text_buf;\n    text.length = text_len;\n    consume_ret = cre2_consume(pattern, &text, matches, 3);\n    re_pat = re ? cre2_pattern(re) : NULL;\n    errcode = re ? cre2_error_code(re) : 0;\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)consume_ret + (long)opt_posix\n               + (long)(matches[0].length) + (long)(matches[1].length) + (long)(re != NULL)\n               + (long)errcode + (long)(re_pat ? (int)strlen(re_pat) : 0);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:19:46.896864 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 08:19:46.896985 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28380, Completion: 21953, Total: 50333
[2025-11-05 08:19:46.897006 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:19:47.114955 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001490/id_001490.cc
[2025-11-05 08:19:47.115007 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:47.345518 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:47.345591 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:47.348437 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:47.348470 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:47.564233 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001491/id_001491.cc
[2025-11-05 08:19:47.564287 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:47.793389 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:47.793460 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:47.795977 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:47.796011 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:48.014364 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001492/id_001492.cc
[2025-11-05 08:19:48.014448 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:48.243617 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:48.243689 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:48.246549 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:48.246581 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:48.465306 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001493/id_001493.cc
[2025-11-05 08:19:48.465360 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:48.695488 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:48.695554 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:48.698599 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:48.698631 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:48.915594 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001494/id_001494.cc
[2025-11-05 08:19:48.915657 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:49.143386 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:49.143474 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:49.146616 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:49.146649 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:49.364188 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001495/id_001495.cc
[2025-11-05 08:19:49.364243 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:49.592147 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:49.592215 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:49.594958 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:49.594990 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:49.813738 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001496/id_001496.cc
[2025-11-05 08:19:49.813792 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:19:50.043509 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:19:50.043587 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:19:50.046442 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:19:50.046474 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:19:50.264273 +00:00] WARN [src/fuzzer.rs:205] Program 1497 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001497/id_001497.cc:46:11: error: no matching function for call to 'cre2_set_new'
   46 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:19:50.297049 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:19:50.297375 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    struct cre2_set * set = NULL;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int word_boundary_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    iter = NULL;\n    re = NULL;\n    set = NULL;\n    set_add_ret = 0;\n    set_compile_ret = 0;\n    word_boundary_flag = 0;\n    checksum = 0;\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    set = cre2_set_new(opt, 0);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)word_boundary_flag + (long)set_add_ret + (long)set_compile_ret\n               + (long)(re != NULL) + (long)(iter != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001497/id_001497.cc:46:11: error: no matching function for call to 'cre2_set_new'\n   46 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:20:09.753004 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 19s
[2025-11-05 08:20:09.753131 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22210, Completion: 12427, Total: 34637
[2025-11-05 08:20:09.970504 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001497/id_001497.cc
[2025-11-05 08:20:09.970557 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:10.198821 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:10.198902 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:10.202089 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:10.202122 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:10.202155 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1497!
[2025-11-05 08:20:10.419936 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001498/id_001498.cc
[2025-11-05 08:20:10.419994 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:10.648520 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:10.648593 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:10.651654 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:10.651686 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:10.868826 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001499/id_001499.cc
[2025-11-05 08:20:10.868909 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:11.098763 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:11.098848 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:11.101347 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:11.101375 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:11.101415 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:20:11.101433 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1500, succ: 1499, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:20:11.101451 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:20:11.101504 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:20:11.372924 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1499 as an example for the next prompt.
[2025-11-05 08:20:11.372981 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 9 new API pairs in this round.
[2025-11-05 08:20:11.373015 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 9
[2025-11-05 08:20:11.373064 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,164.0,158.0,40.0,38.0,110.0,75.0,43.0,288.0,16.0,33.0,409.0,161.0,37.0,127.0,38.0,217.0,114.0,127.0,127.0,135.0,59.0,58.0,27.0,18.0,49.0,156.0,110.0,16.0,24.0,139.0,250.0,28.0,763.0,244.0,217.0,44.0,70.0,67.0,38.0,380.0,36.0,62.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,318.0,28.0,63.0,52.0,30.0,189.0,63.0,217.0,52.0,49.0,16.0]
[2025-11-05 08:20:11.373084 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:20:11.373138 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 318
[2025-11-05 08:20:11.373172 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 763
[2025-11-05 08:20:11.373201 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 217
[2025-11-05 08:20:11.373233 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 217
[2025-11-05 08:20:11.373270 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_options_t *cre2_opt_new(),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 08:20:11.373973 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 150, quiet_round: 0, discovered_api_pairs: 2760
[2025-11-05 08:20:11.405330 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:20:11.405679 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"abxyz\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text;\n    cre2_string_t matches[3];\n    int consume_ret = 0;\n    int opt_posix = 0;\n    const char * re_pat = NULL;\n    int errcode = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    opt_posix = cre2_opt_posix_syntax(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    text.data = text_buf;\n    text.length = text_len;\n    consume_ret = cre2_consume(pattern, &text, matches, 3);\n    re_pat = re ? cre2_pattern(re) : NULL;\n    errcode = re ? cre2_error_code(re) : 0;\n\n    // step 5: Validate / compute lightweight checksum\n    checksum = (long)pattern_len + (long)text_len + (long)consume_ret + (long)opt_posix\n               + (long)(matches[0].length) + (long)(matches[1].length) + (long)(re != NULL)\n               + (long)errcode + (long)(re_pat ? (int)strlen(re_pat) : 0);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t match;\n    int add_ret = 0;\n    int compile_ret = 0;\n    int word_boundary_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_ret = cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)word_boundary_flag + (long)add_ret + (long)compile_ret\n               + (long)(set != NULL) + (long)(re != NULL) + (long)(iter != NULL) + (long)match.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:20:51.576467 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 08:20:51.576592 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28440, Completion: 20920, Total: 49360
[2025-11-05 08:20:51.576617 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:20:51.793347 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001500/id_001500.cc
[2025-11-05 08:20:51.793399 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:52.023449 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:52.023505 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:52.026275 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:52.026309 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:52.243500 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001501/id_001501.cc
[2025-11-05 08:20:52.243552 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:52.472460 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:52.472519 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:52.475182 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:52.475209 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:52.693760 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001502/id_001502.cc
[2025-11-05 08:20:52.693845 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:52.922850 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:52.922908 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:52.925485 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:52.925517 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:53.142847 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001503/id_001503.cc
[2025-11-05 08:20:53.142901 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:53.370350 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:53.370408 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:53.373237 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:53.373264 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:53.591206 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001504/id_001504.cc
[2025-11-05 08:20:53.591260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:53.819644 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:53.819733 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:53.822490 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:53.822521 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:54.042477 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001505/id_001505.cc
[2025-11-05 08:20:54.042531 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:54.272279 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:54.272338 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:54.275198 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:54.275231 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:54.492382 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001506/id_001506.cc
[2025-11-05 08:20:54.492435 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:54.722788 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:54.722864 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:54.725698 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:54.725730 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:54.943668 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001507/id_001507.cc
[2025-11-05 08:20:54.943753 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:55.171755 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:55.171815 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:55.174666 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:55.174700 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:55.392074 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001508/id_001508.cc
[2025-11-05 08:20:55.392128 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:55.620200 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:55.620270 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:55.623068 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:55.623101 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:55.840712 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001509/id_001509.cc
[2025-11-05 08:20:55.840765 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:20:56.069302 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:20:56.069421 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:20:56.071990 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:20:56.072022 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:20:56.072059 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:20:56.072076 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1510, succ: 1509, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:20:56.072091 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:20:56.072117 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:20:56.339615 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1509 as an example for the next prompt.
[2025-11-05 08:20:56.339669 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 1 new API pairs in this round.
[2025-11-05 08:20:56.339692 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 1
[2025-11-05 08:20:56.339739 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,164.0,158.0,40.0,38.0,110.0,75.0,43.0,288.0,16.0,33.0,409.0,161.0,37.0,128.0,38.0,217.0,114.0,127.0,127.0,135.0,59.0,58.0,27.0,18.0,49.0,156.0,110.0,16.0,24.0,139.0,251.0,28.0,763.0,244.0,218.0,44.0,70.0,67.0,38.0,380.0,36.0,62.0,147.0,30.0,10.0,88.0,296.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,318.0,28.0,63.0,52.0,30.0,189.0,63.0,217.0,52.0,49.0,16.0]
[2025-11-05 08:20:56.339756 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:20:56.339810 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 164
[2025-11-05 08:20:56.339841 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume energy: 49
[2025-11-05 08:20:56.339868 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 296
[2025-11-05 08:20:56.339894 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 217
[2025-11-05 08:20:56.339943 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 08:20:56.340667 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 151, quiet_round: 0, discovered_api_pairs: 2761
[2025-11-05 08:20:56.381879 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:20:56.382229 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t match;\n    int add_ret = 0;\n    int compile_ret = 0;\n    int word_boundary_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_word_boundary(opt, 1);\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_ret = cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)word_boundary_flag + (long)add_ret + (long)compile_ret\n               + (long)(set != NULL) + (long)(re != NULL) + (long)(iter != NULL) + (long)match.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)baz$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    const char * re_pat = NULL;\n    int add_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 4: Core operations\n    add_ret = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)add_ret + (long)(set != NULL) + (long)(re != NULL) + (long)(re_pat != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:21:47.442759 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 51s
[2025-11-05 08:21:47.442880 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27670, Completion: 25239, Total: 52909
[2025-11-05 08:21:47.442902 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:21:47.661806 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001510/id_001510.cc
[2025-11-05 08:21:47.661859 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:47.890856 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:47.890915 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:47.893821 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:47.893849 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:48.111142 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001511/id_001511.cc
[2025-11-05 08:21:48.111196 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:48.338958 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:48.339032 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:48.341935 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:48.341968 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:48.560226 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001512/id_001512.cc
[2025-11-05 08:21:48.560314 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:48.788269 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:48.788342 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:48.791138 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:48.791169 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:49.008270 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001513/id_001513.cc
[2025-11-05 08:21:49.008326 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:49.236394 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:49.236468 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:49.238990 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:49.239017 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:49.458186 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001514/id_001514.cc
[2025-11-05 08:21:49.458239 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:49.688037 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:49.688146 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:49.690938 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:49.690970 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:49.910124 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001515/id_001515.cc
[2025-11-05 08:21:49.910178 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:50.138746 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:50.138820 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:50.141722 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:50.141753 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:50.361007 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001516/id_001516.cc
[2025-11-05 08:21:50.361061 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:50.590000 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:50.590075 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:50.593008 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:50.593040 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:50.810942 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001517/id_001517.cc
[2025-11-05 08:21:50.811029 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:51.040722 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:51.040795 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:51.043456 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:51.043489 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:51.260777 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001518/id_001518.cc
[2025-11-05 08:21:51.260830 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:51.490750 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:51.490824 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:51.493777 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:51.493808 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:51.711390 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001519/id_001519.cc
[2025-11-05 08:21:51.711445 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:21:51.941310 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:21:51.941447 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:21:51.944297 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:21:51.944330 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:21:51.944369 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:21:51.944384 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1520, succ: 1519, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:21:51.944399 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:21:51.944426 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:21:52.250582 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1519 as an example for the next prompt.
[2025-11-05 08:21:52.250639 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 16 new API pairs in this round.
[2025-11-05 08:21:52.250676 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 16
[2025-11-05 08:21:52.250725 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,172.0,160.0,40.0,38.0,110.0,75.0,43.0,288.0,16.0,33.0,411.0,161.0,37.0,128.0,38.0,218.0,114.0,127.0,127.0,135.0,59.0,58.0,27.0,18.0,58.0,156.0,110.0,16.0,24.0,139.0,251.0,28.0,772.0,244.0,220.0,44.0,70.0,67.0,38.0,380.0,36.0,62.0,147.0,30.0,10.0,88.0,304.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,318.0,28.0,63.0,52.0,30.0,189.0,63.0,224.0,52.0,49.0,16.0]
[2025-11-05 08:21:52.250741 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:21:52.250820 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 189
[2025-11-05 08:21:52.250852 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_log_errors energy: 75
[2025-11-05 08:21:52.250879 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 772
[2025-11-05 08:21:52.250905 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 147
[2025-11-05 08:21:52.250945 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_named_capturing_groups energy: 30
[2025-11-05 08:21:52.250984 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name)
[2025-11-05 08:21:52.251815 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 152, quiet_round: 0, discovered_api_pairs: 2777
[2025-11-05 08:21:52.298971 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:21:52.299326 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)baz$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    const char * re_pat = NULL;\n    int add_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_one_line(opt, 1);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 4: Core operations\n    add_ret = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)add_ret + (long)(set != NULL) + (long)(re != NULL) + (long)(re_pat != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t match;\n    char textbuf[] = \"prefix foo middle foo suffix\";\n    char rewritebuf[] = \"baz\";\n    int add_ret = 0;\n    int find_ret = 0;\n    int replace_ret = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_ret = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    text_and_target.data = textbuf;\n    text_and_target.length = (int)(sizeof(textbuf) - 1);\n    rewrite.data = rewritebuf;\n    rewrite.length = (int)(sizeof(rewritebuf) - 1);\n    find_ret = cre2_find_and_consume(pattern, &text_and_target, &match, 1);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)add_ret + (long)find_ret + (long)replace_ret + (long)enc\n               + (long)(set != NULL) + (long)(re != NULL) + (long)text_and_target.length + (long)match.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:22:33.604116 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 41s
[2025-11-05 08:22:33.604244 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28990, Completion: 23559, Total: 52549
[2025-11-05 08:22:33.604264 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:22:33.821325 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001520/id_001520.cc
[2025-11-05 08:22:33.821379 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:34.051845 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:34.051921 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:34.055168 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:34.055201 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:34.273975 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001521/id_001521.cc
[2025-11-05 08:22:34.274036 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:34.501503 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:34.501574 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:34.504790 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:34.504820 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:34.723335 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001522/id_001522.cc
[2025-11-05 08:22:34.723416 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:34.952156 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:34.952233 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:34.955582 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:34.955619 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:35.174156 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001523/id_001523.cc
[2025-11-05 08:22:35.174211 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:35.407012 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:35.407085 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:35.410289 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:35.410321 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:35.627401 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001524/id_001524.cc
[2025-11-05 08:22:35.627454 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:35.858113 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:35.858231 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:35.861253 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:35.861285 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:36.079263 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001525/id_001525.cc
[2025-11-05 08:22:36.079326 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:36.306763 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:36.306834 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:36.310021 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:36.310053 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:36.527194 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001526/id_001526.cc
[2025-11-05 08:22:36.527258 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:36.754595 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:36.754668 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:36.757764 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:36.757796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:36.976473 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001527/id_001527.cc
[2025-11-05 08:22:36.976558 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:37.208427 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:37.208510 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:37.211375 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:37.211402 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:37.429692 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001528/id_001528.cc
[2025-11-05 08:22:37.429747 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:37.658170 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:37.658249 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:37.661484 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:37.661517 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:37.879393 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001529/id_001529.cc
[2025-11-05 08:22:37.879445 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:22:38.108230 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:22:38.108338 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:22:38.111381 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:22:38.111412 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:22:38.111449 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:22:38.111466 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1530, succ: 1529, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:22:38.111480 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:22:38.111504 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:22:38.388922 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1529 as an example for the next prompt.
[2025-11-05 08:22:38.388988 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 08:22:38.389029 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 08:22:38.389076 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,172.0,160.0,40.0,38.0,110.0,78.0,43.0,288.0,16.0,33.0,414.0,161.0,37.0,128.0,38.0,219.0,114.0,127.0,127.0,135.0,62.0,58.0,27.0,18.0,58.0,156.0,110.0,16.0,24.0,139.0,251.0,28.0,778.0,252.0,220.0,44.0,70.0,67.0,38.0,380.0,36.0,62.0,157.0,30.0,10.0,88.0,304.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,318.0,28.0,63.0,52.0,42.0,194.0,63.0,224.0,52.0,49.0,16.0]
[2025-11-05 08:22:38.389095 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:22:38.389147 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_dot_nl energy: 52
[2025-11-05 08:22:38.389177 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 58
[2025-11-05 08:22:38.389205 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 161
[2025-11-05 08:22:38.389232 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 224
[2025-11-05 08:22:38.389269 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_dot_nl(cre2_options_t * opt),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 08:22:38.389977 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 153, quiet_round: 0, discovered_api_pairs: 2794
[2025-11-05 08:22:38.440135 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:22:38.440493 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_dot_nl(cre2_options_t * opt),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t match;\n    char textbuf[] = \"prefix foo middle foo suffix\";\n    char rewritebuf[] = \"baz\";\n    int add_ret = 0;\n    int find_ret = 0;\n    int replace_ret = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_ret = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    text_and_target.data = textbuf;\n    text_and_target.length = (int)(sizeof(textbuf) - 1);\n    rewrite.data = rewritebuf;\n    rewrite.length = (int)(sizeof(rewritebuf) - 1);\n    find_ret = cre2_find_and_consume(pattern, &text_and_target, &match, 1);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)add_ret + (long)find_ret + (long)replace_ret + (long)enc\n               + (long)(set != NULL) + (long)(re != NULL) + (long)text_and_target.length + (long)match.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text;\n    cre2_string_t matches[3];\n    char textbuf[] = \"xxfooxx\";\n    int partial_ret = 0;\n    int named_index = -1;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text, 0, sizeof(text));\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    text.data = textbuf;\n    text.length = (int)(sizeof(textbuf) - 1);\n    partial_ret = cre2_partial_match(pattern, &text, matches, 3);\n    named_index = cre2_find_named_capturing_groups(re, \"name\");\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)partial_ret + (long)named_index + (long)(re != NULL)\n               + (long)text.length + (long)matches[0].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:23:28.140541 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 49s
[2025-11-05 08:23:28.140685 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30240, Completion: 24754, Total: 54994
[2025-11-05 08:23:28.140706 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:23:28.358823 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001530/id_001530.cc
[2025-11-05 08:23:28.358876 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:28.589810 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:28.589902 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:28.592744 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:28.592778 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:28.809921 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001531/id_001531.cc
[2025-11-05 08:23:28.809974 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:29.040053 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:29.040125 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:29.042977 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:29.043009 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:29.261425 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001532/id_001532.cc
[2025-11-05 08:23:29.261510 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:29.493468 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:29.493537 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:29.496029 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:29.496061 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:29.714604 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001533/id_001533.cc
[2025-11-05 08:23:29.714658 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:29.943118 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:29.943177 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:29.946006 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:29.946039 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:30.163672 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001534/id_001534.cc
[2025-11-05 08:23:30.163724 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:30.393298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:30.393404 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:30.396019 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:30.396051 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:30.612638 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001535/id_001535.cc
[2025-11-05 08:23:30.612692 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:30.841747 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:30.841807 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:30.844644 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:30.844681 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:31.062054 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001536/id_001536.cc
[2025-11-05 08:23:31.062108 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:31.291435 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:31.291520 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:31.294382 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:31.294414 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:31.511750 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001537/id_001537.cc
[2025-11-05 08:23:31.511836 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:23:31.742216 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:23:31.742287 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:23:31.745117 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:23:31.745149 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:23:31.963028 +00:00] WARN [src/fuzzer.rs:205] Program 1538 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001538/id_001538.cc:45:5: error: no matching function for call to 'cre2_opt_dot_nl'
   45 |     cre2_opt_dot_nl(opt, 1);
      |     ^~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:23:32.013259 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:23:32.013603 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    cre2_string_t matches[4];\n    char textbuf[] = \"xxxfoo123yyy\";\n    char rewritebuf[] = \"$1-$2\";\n    char targetbuf[64];\n    int dotnl_flag = 0;\n    int add_ret = 0;\n    int match_ret = 0;\n    int extract_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text, 0, sizeof(text));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&target, 0, sizeof(target));\n    memset(matches, 0, sizeof(matches));\n    memset(targetbuf, 0, sizeof(targetbuf));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_dot_nl(opt, 1);\n    dotnl_flag = cre2_opt_dot_nl(opt);\n\n    // step 4: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_ret = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    text.data = textbuf;\n    text.length = (int)(sizeof(textbuf) - 1);\n    rewrite.data = rewritebuf;\n    rewrite.length = (int)(sizeof(rewritebuf) - 1);\n    target.data = targetbuf;\n    target.length = 0;\n    match_ret = cre2_match((const cre2_regexp_t *)re, text.data, text.length, 0, text.length, CRE2_UNANCHORED, matches, 4);\n    extract_ret = cre2_extract_re(re, &text, &rewrite, &target);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)add_ret + (long)match_ret + (long)extract_ret + (long)dotnl_flag\n               + (long)(set != NULL) + (long)(re != NULL) + (long)text.length + (long)rewrite.length + (long)target.length + (long)matches[0].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001538/id_001538.cc:45:5: error: no matching function for call to 'cre2_opt_dot_nl'\n   45 |     cre2_opt_dot_nl(opt, 1);\n      |     ^~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:24:00.028586 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 08:24:00.028716 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24290, Completion: 14326, Total: 38616
[2025-11-05 08:24:00.248201 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001538/id_001538.cc
[2025-11-05 08:24:00.248257 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:00.478364 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:00.478424 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:00.481300 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:00.481334 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:00.481367 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1538!
[2025-11-05 08:24:00.700204 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001539/id_001539.cc
[2025-11-05 08:24:00.700258 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:00.929185 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:00.929265 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:00.931989 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:00.932021 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:00.932058 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:24:00.932075 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1540, succ: 1539, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:24:00.932090 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:24:00.932118 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:24:01.243007 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1539 as an example for the next prompt.
[2025-11-05 08:24:01.243088 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 7 new API pairs in this round.
[2025-11-05 08:24:01.243117 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 7
[2025-11-05 08:24:01.243164 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,70.0,24.0,61.0,172.0,160.0,40.0,38.0,110.0,78.0,43.0,288.0,16.0,33.0,415.0,165.0,37.0,128.0,38.0,220.0,114.0,127.0,127.0,135.0,62.0,60.0,27.0,18.0,58.0,156.0,110.0,16.0,24.0,139.0,251.0,28.0,782.0,252.0,222.0,44.0,70.0,67.0,38.0,380.0,36.0,62.0,157.0,30.0,10.0,88.0,304.0,16.0,16.0,172.0,60.0,52.0,83.0,22.0,318.0,28.0,63.0,52.0,42.0,194.0,63.0,227.0,56.0,49.0,16.0]
[2025-11-05 08:24:01.243184 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:24:01.243246 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 194
[2025-11-05 08:24:01.243276 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 70
[2025-11-05 08:24:01.243308 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 62
[2025-11-05 08:24:01.243333 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_log_errors energy: 78
[2025-11-05 08:24:01.243363 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    int cre2_opt_literal(cre2_options_t * opt),
    int cre2_opt_log_errors(cre2_options_t * opt),
    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag)
[2025-11-05 08:24:01.244040 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 154, quiet_round: 0, discovered_api_pairs: 2801
[2025-11-05 08:24:01.269076 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:24:01.269411 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    int cre2_opt_literal(cre2_options_t * opt),\n    int cre2_opt_log_errors(cre2_options_t * opt),\n    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text;\n    cre2_string_t matches[3];\n    char textbuf[] = \"xxfooxx\";\n    int partial_ret = 0;\n    int named_index = -1;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text, 0, sizeof(text));\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_log_errors(opt, 1);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    text.data = textbuf;\n    text.length = (int)(sizeof(textbuf) - 1);\n    partial_ret = cre2_partial_match(pattern, &text, matches, 3);\n    named_index = cre2_find_named_capturing_groups(re, \"name\");\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)partial_ret + (long)named_index + (long)(re != NULL)\n               + (long)text.length + (long)matches[0].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations and initialization\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    cre2_string_t match;\n    char textbuf[] = \"prefix foo middle\";\n    char rewritebuf[] = \"$1_rewritten\";\n    char targetbuf[64];\n    int dotnl_flag = 0;\n    int set_add_ret = 0;\n    int match_ret = 0;\n    int extract_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text, 0, sizeof(text));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&target, 0, sizeof(target));\n    memset(&match, 0, sizeof(match));\n    text.data = textbuf;\n    text.length = (int)(sizeof(textbuf) - 1);\n    rewrite.data = rewritebuf;\n    rewrite.length = (int)(sizeof(rewritebuf) - 1);\n    target.data = targetbuf;\n    target.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_dot_nl(opt, 1);\n    dotnl_flag = cre2_opt_dot_nl(opt);\n\n    // step 4: Operate\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    match_ret = cre2_match(re, text.data, text.length, 0, text.length, CRE2_UNANCHORED, &match, 2);\n    extract_ret = cre2_extract_re(re, &text, &rewrite, &target);\n\n    // step 5: Validate and Cleanup\n    checksum = (long)pattern_len + (long)dotnl_flag + (long)set_add_ret + (long)match_ret + (long)extract_ret\n               + (long)(set != NULL) + (long)(re != NULL) + (long)text.length + (long)rewrite.length\n               + (long)target.length + (long)match.length;\n    (void)checksum;\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:24:34.937053 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 08:24:34.937178 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29620, Completion: 20706, Total: 50326
[2025-11-05 08:24:34.937199 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:24:35.154156 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001540/id_001540.cc
[2025-11-05 08:24:35.154209 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:35.382428 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:35.382485 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:35.385593 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:35.385625 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:35.604362 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001541/id_001541.cc
[2025-11-05 08:24:35.604414 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:35.833584 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:35.833654 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:35.836109 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:35.836135 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:36.055549 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001542/id_001542.cc
[2025-11-05 08:24:36.055633 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:36.284485 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:36.284551 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:36.287573 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:36.287605 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:36.505045 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001543/id_001543.cc
[2025-11-05 08:24:36.505098 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:36.735566 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:36.735624 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:36.738721 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:36.738755 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:36.956556 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001544/id_001544.cc
[2025-11-05 08:24:36.956609 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:37.186005 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:37.186093 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:37.189190 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:37.189223 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:37.407337 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001545/id_001545.cc
[2025-11-05 08:24:37.407390 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:37.636632 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:37.636702 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:37.639664 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:37.639696 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:37.857172 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001546/id_001546.cc
[2025-11-05 08:24:37.857224 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:38.086781 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:38.086857 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:38.090085 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:38.090118 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:38.307819 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001547/id_001547.cc
[2025-11-05 08:24:38.307902 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:38.536527 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:38.536598 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:38.539457 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:38.539505 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:38.758094 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001548/id_001548.cc
[2025-11-05 08:24:38.758147 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:38.987823 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:38.987881 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:38.990990 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:38.991023 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:39.208963 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001549/id_001549.cc
[2025-11-05 08:24:39.209016 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:24:39.437536 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:24:39.437623 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:24:39.440250 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:24:39.440282 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:24:39.440321 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:24:39.440338 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1550, succ: 1549, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:24:39.440353 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:24:39.440381 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:24:39.725472 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1549 as an example for the next prompt.
[2025-11-05 08:24:39.725529 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 26 new API pairs in this round.
[2025-11-05 08:24:39.725578 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 26
[2025-11-05 08:24:39.725626 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,85.0,24.0,61.0,172.0,160.0,40.0,38.0,110.0,86.0,43.0,288.0,16.0,33.0,415.0,168.0,37.0,128.0,38.0,223.0,119.0,127.0,127.0,135.0,62.0,60.0,27.0,18.0,58.0,156.0,110.0,16.0,24.0,139.0,251.0,28.0,793.0,256.0,222.0,44.0,70.0,67.0,38.0,380.0,36.0,76.0,159.0,30.0,10.0,88.0,304.0,16.0,16.0,172.0,60.0,52.0,83.0,25.0,318.0,28.0,63.0,52.0,51.0,195.0,63.0,227.0,56.0,49.0,16.0]
[2025-11-05 08:24:39.725644 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:24:39.725697 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 156
[2025-11-05 08:24:39.725729 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 288
[2025-11-05 08:24:39.725756 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_next energy: 62
[2025-11-05 08:24:39.725783 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 227
[2025-11-05 08:24:39.725812 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 415
[2025-11-05 08:24:39.725846 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_compile(cre2_set * set),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 08:24:39.726673 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 155, quiet_round: 0, discovered_api_pairs: 2827
[2025-11-05 08:24:39.764552 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:24:39.764933 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_compile(cre2_set * set),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations and initialization\n    const char pattern[] = \"(foo)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    cre2_string_t match;\n    char textbuf[] = \"prefix foo middle\";\n    char rewritebuf[] = \"$1_rewritten\";\n    char targetbuf[64];\n    int dotnl_flag = 0;\n    int set_add_ret = 0;\n    int match_ret = 0;\n    int extract_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text, 0, sizeof(text));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&target, 0, sizeof(target));\n    memset(&match, 0, sizeof(match));\n    text.data = textbuf;\n    text.length = (int)(sizeof(textbuf) - 1);\n    rewrite.data = rewritebuf;\n    rewrite.length = (int)(sizeof(rewritebuf) - 1);\n    target.data = targetbuf;\n    target.length = 0;\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    cre2_opt_set_dot_nl(opt, 1);\n    dotnl_flag = cre2_opt_dot_nl(opt);\n\n    // step 4: Operate\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    re = cre2_new(pattern, pattern_len, opt);\n    match_ret = cre2_match(re, text.data, text.length, 0, text.length, CRE2_UNANCHORED, &match, 2);\n    extract_ret = cre2_extract_re(re, &text, &rewrite, &target);\n\n    // step 5: Validate and Cleanup\n    checksum = (long)pattern_len + (long)dotnl_flag + (long)set_add_ret + (long)match_ret + (long)extract_ret\n               + (long)(set != NULL) + (long)(re != NULL) + (long)text.length + (long)rewrite.length\n               + (long)target.length + (long)match.length;\n    (void)checksum;\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    int literal_before = 0;\n    int literal_after = 0;\n    int log_before = 0;\n    int log_after = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    literal_before = cre2_opt_literal(opt);\n    cre2_opt_set_literal(opt, 1);\n    literal_after = cre2_opt_literal(opt);\n    log_before = cre2_opt_log_errors(opt);\n    cre2_opt_set_log_errors(opt, 1);\n    log_after = cre2_opt_log_errors(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n    iter = NULL;\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)literal_before + (long)literal_after + (long)log_before + (long)log_after\n               + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:25:22.382542 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 08:25:22.382663 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29580, Completion: 22462, Total: 52042
[2025-11-05 08:25:22.382683 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:25:22.599301 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001550/id_001550.cc
[2025-11-05 08:25:22.599355 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:22.827429 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:22.827505 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:22.830753 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:22.830786 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:23.049730 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001551/id_001551.cc
[2025-11-05 08:25:23.049783 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:23.281296 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:23.281372 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:23.284459 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:23.284493 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:23.501786 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001552/id_001552.cc
[2025-11-05 08:25:23.501871 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:23.730035 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:23.730113 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:23.733192 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:23.733224 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:23.951885 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001553/id_001553.cc
[2025-11-05 08:25:23.951949 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:24.182059 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:24.182137 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:24.185244 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:24.185276 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:24.402525 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001554/id_001554.cc
[2025-11-05 08:25:24.402578 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:24.631376 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:24.631492 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:24.634708 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:24.634741 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:24.852965 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001555/id_001555.cc
[2025-11-05 08:25:24.853019 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:25.084463 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:25.084541 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:25.087444 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:25.087476 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:25.304975 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001556/id_001556.cc
[2025-11-05 08:25:25.305031 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:25.535698 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:25.535776 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:25.538980 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:25.539013 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:25.757861 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001557/id_001557.cc
[2025-11-05 08:25:25.757947 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:25.986088 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:25.986166 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:25.989408 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:25.989441 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:26.208328 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001558/id_001558.cc
[2025-11-05 08:25:26.208383 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:26.436756 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:26.436835 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:26.439925 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:26.439960 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:26.658133 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001559/id_001559.cc
[2025-11-05 08:25:26.658200 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:25:26.886254 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:25:26.886371 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:25:26.889590 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:25:26.889622 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:25:26.889660 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:25:26.889676 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1560, succ: 1559, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:25:26.889692 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:25:26.889720 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:25:27.165979 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1559 as an example for the next prompt.
[2025-11-05 08:25:27.166035 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 7 new API pairs in this round.
[2025-11-05 08:25:27.166065 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 7
[2025-11-05 08:25:27.166113 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,85.0,24.0,61.0,172.0,160.0,40.0,38.0,110.0,86.0,43.0,289.0,16.0,33.0,415.0,168.0,37.0,128.0,38.0,223.0,119.0,127.0,127.0,135.0,63.0,60.0,27.0,18.0,58.0,159.0,110.0,16.0,24.0,142.0,254.0,28.0,795.0,258.0,225.0,44.0,70.0,67.0,38.0,380.0,36.0,76.0,159.0,30.0,10.0,88.0,304.0,16.0,16.0,172.0,60.0,52.0,83.0,25.0,318.0,28.0,63.0,52.0,51.0,195.0,63.0,230.0,56.0,49.0,16.0]
[2025-11-05 08:25:27.166132 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:25:27.166182 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 110
[2025-11-05 08:25:27.166217 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 304
[2025-11-05 08:25:27.166243 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 795
[2025-11-05 08:25:27.166271 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 135
[2025-11-05 08:25:27.166307 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_set_delete(cre2_set * set)
[2025-11-05 08:25:27.167015 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 156, quiet_round: 0, discovered_api_pairs: 2834
[2025-11-05 08:25:27.210151 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:25:27.210503 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_set_delete(cre2_set * set)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    int literal_before = 0;\n    int literal_after = 0;\n    int log_before = 0;\n    int log_after = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    literal_before = cre2_opt_literal(opt);\n    cre2_opt_set_literal(opt, 1);\n    literal_after = cre2_opt_literal(opt);\n    log_before = cre2_opt_log_errors(opt);\n    cre2_opt_set_log_errors(opt, 1);\n    log_after = cre2_opt_log_errors(opt);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_delete(iter);\n    iter = NULL;\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)literal_before + (long)literal_after + (long)log_before + (long)log_after\n               + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    struct cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = 0;\n    int add_ret = 0;\n    int compile_ret = 0;\n    int num_groups = 0;\n    bool next_ret = false;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    add_ret = cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Operate\n    num_groups = cre2_num_capturing_groups(re);\n    next_ret = cre2_named_groups_iter_next(iter, &group_name, &group_index);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)add_ret + (long)compile_ret + (long)num_groups + (long)group_index + (long)next_ret + (long)(group_name != NULL)\n               + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:26:11.096401 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 43s
[2025-11-05 08:26:11.096524 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28700, Completion: 23905, Total: 52605
[2025-11-05 08:26:11.096545 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:26:11.314334 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001560/id_001560.cc
[2025-11-05 08:26:11.314388 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:11.542136 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:11.542206 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:11.545047 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:11.545080 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:11.765643 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001561/id_001561.cc
[2025-11-05 08:26:11.765696 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:11.995252 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:11.995313 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:11.998134 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:11.998168 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:12.216661 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001562/id_001562.cc
[2025-11-05 08:26:12.216750 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:12.446351 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:12.446411 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:12.449099 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:12.449130 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:12.666857 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001563/id_001563.cc
[2025-11-05 08:26:12.666911 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:12.896087 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:12.896156 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:12.899318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:12.899349 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:13.118020 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001564/id_001564.cc
[2025-11-05 08:26:13.118074 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:13.348458 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:13.348563 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:13.351145 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:13.351171 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:13.569101 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001565/id_001565.cc
[2025-11-05 08:26:13.569160 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:13.798819 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:13.798888 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:13.801694 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:13.801727 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:14.019226 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001566/id_001566.cc
[2025-11-05 08:26:14.019282 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:14.247094 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:14.247154 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:14.250072 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:14.250104 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:14.468232 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001567/id_001567.cc
[2025-11-05 08:26:14.468317 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:14.696061 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:14.696131 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:14.698997 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:14.699028 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:14.916808 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001568/id_001568.cc
[2025-11-05 08:26:14.916862 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:15.146092 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:15.146159 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:15.149260 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:15.149291 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:15.367967 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001569/id_001569.cc
[2025-11-05 08:26:15.368022 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:26:15.598117 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:26:15.598208 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:26:15.600911 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:26:15.600945 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:26:15.600983 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:26:15.600998 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1570, succ: 1569, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:26:15.601012 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:26:15.601041 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:26:15.883428 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1569 as an example for the next prompt.
[2025-11-05 08:26:15.883484 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 08:26:15.883534 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 08:26:15.883583 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,85.0,24.0,61.0,172.0,160.0,40.0,38.0,110.0,86.0,43.0,289.0,16.0,33.0,419.0,168.0,37.0,128.0,38.0,223.0,119.0,127.0,127.0,138.0,63.0,60.0,27.0,18.0,58.0,164.0,123.0,16.0,24.0,142.0,254.0,28.0,799.0,258.0,226.0,44.0,70.0,67.0,38.0,380.0,36.0,76.0,159.0,30.0,10.0,88.0,310.0,16.0,16.0,175.0,60.0,52.0,83.0,25.0,318.0,28.0,63.0,52.0,51.0,195.0,63.0,233.0,56.0,49.0,16.0]
[2025-11-05 08:26:15.883604 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:26:15.883658 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 119
[2025-11-05 08:26:15.883690 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 127
[2025-11-05 08:26:15.883716 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 67
[2025-11-05 08:26:15.883742 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 419
[2025-11-05 08:26:15.883798 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 258
[2025-11-05 08:26:15.883831 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_error_code(const cre2_regexp_t * re),
    int cre2_version_interface_revision(),
    void cre2_delete(cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)
[2025-11-05 08:26:15.884649 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 157, quiet_round: 0, discovered_api_pairs: 2849
[2025-11-05 08:26:15.915295 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:26:15.915632 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_error_code(const cre2_regexp_t * re),\n    int cre2_version_interface_revision(),\n    void cre2_delete(cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    struct cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = 0;\n    int add_ret = 0;\n    int compile_ret = 0;\n    int num_groups = 0;\n    bool next_ret = false;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    add_ret = cre2_set_add_simple(set, pattern);\n    compile_ret = cre2_set_compile(set);\n\n    // step 4: Operate\n    num_groups = cre2_num_capturing_groups(re);\n    next_ret = cre2_named_groups_iter_next(iter, &group_name, &group_index);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)add_ret + (long)compile_ret + (long)num_groups + (long)group_index + (long)next_ret + (long)(group_name != NULL)\n               + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    struct cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char text[] = \"foobar hello\";\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int nmatch = 2;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    strings[0].data = text + 0;\n    strings[0].length = 6;   // \"foobar\"\n    strings[1].data = text + 7;\n    strings[1].length = 5;   // \"hello\"\n    (void)memset(ranges, 0, sizeof(ranges));\n    cre2_strings_to_ranges(text, ranges, strings, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)enc + (long)(re != NULL) + ranges[0].start + ranges[0].past + ranges[1].start + ranges[1].past + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:27:02.672107 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 08:27:02.672235 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28850, Completion: 17603, Total: 46453
[2025-11-05 08:27:02.672254 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:27:02.889452 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001570/id_001570.cc
[2025-11-05 08:27:02.889506 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:03.119457 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:03.119523 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:03.122666 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:03.122699 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:03.340560 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001571/id_001571.cc
[2025-11-05 08:27:03.340640 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:03.568648 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:03.568719 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:03.571318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:03.571351 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:03.788422 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001572/id_001572.cc
[2025-11-05 08:27:03.788507 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:04.018422 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:04.018501 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:04.021430 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:04.021463 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:04.239009 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001573/id_001573.cc
[2025-11-05 08:27:04.239061 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:04.470163 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:04.470232 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:04.473026 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:04.473058 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:04.689880 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001574/id_001574.cc
[2025-11-05 08:27:04.689933 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:04.920582 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:04.920701 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:04.923194 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:04.923220 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:05.142629 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001575/id_001575.cc
[2025-11-05 08:27:05.142681 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:05.371170 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:05.371244 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:05.374090 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:05.374122 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:05.592716 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001576/id_001576.cc
[2025-11-05 08:27:05.592769 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:05.821646 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:05.821706 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:05.824736 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:05.824767 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:06.042731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001577/id_001577.cc
[2025-11-05 08:27:06.042830 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:06.270500 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:06.270569 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:06.273379 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:06.273413 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:06.491337 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001578/id_001578.cc
[2025-11-05 08:27:06.491392 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:06.720036 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:06.720108 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:06.722933 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:06.722965 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:06.941377 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001579/id_001579.cc
[2025-11-05 08:27:06.941430 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:07.171320 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:07.171436 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:07.174686 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:07.174717 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:07.174755 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:27:07.174770 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1580, succ: 1579, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:27:07.174786 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:27:07.174809 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:27:07.444270 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1579 as an example for the next prompt.
[2025-11-05 08:27:07.444325 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 24 new API pairs in this round.
[2025-11-05 08:27:07.444373 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 24
[2025-11-05 08:27:07.444421 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [55.0,57.0,85.0,24.0,61.0,172.0,160.0,40.0,38.0,110.0,86.0,43.0,293.0,16.0,33.0,419.0,168.0,37.0,128.0,38.0,225.0,124.0,144.0,127.0,138.0,70.0,60.0,27.0,18.0,58.0,164.0,123.0,16.0,24.0,142.0,254.0,28.0,806.0,267.0,226.0,44.0,70.0,84.0,38.0,380.0,36.0,76.0,159.0,30.0,10.0,88.0,310.0,16.0,16.0,175.0,60.0,52.0,83.0,25.0,318.0,28.0,63.0,52.0,51.0,199.0,63.0,233.0,56.0,49.0,16.0]
[2025-11-05 08:27:07.444439 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:27:07.444491 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 55
[2025-11-05 08:27:07.444523 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 84
[2025-11-05 08:27:07.444553 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 806
[2025-11-05 08:27:07.444591 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 310
[2025-11-05 08:27:07.444633 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    int cre2_version_interface_revision(),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 08:27:07.445348 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 158, quiet_round: 0, discovered_api_pairs: 2873
[2025-11-05 08:27:07.479454 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:27:07.479806 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    int cre2_version_interface_revision(),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    struct cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char text[] = \"foobar hello\";\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int nmatch = 2;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    strings[0].data = text + 0;\n    strings[0].length = 6;   // \"foobar\"\n    strings[1].data = text + 7;\n    strings[1].length = 5;   // \"hello\"\n    (void)memset(ranges, 0, sizeof(ranges));\n    cre2_strings_to_ranges(text, ranges, strings, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)enc + (long)(re != NULL) + ranges[0].start + ranges[0].past + ranges[1].start + ranges[1].past + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = -1;\n    int err_code = 0;\n    int ver_rev = 0;\n    int num_groups = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    err_code = cre2_error_code(re);\n    ver_rev = cre2_version_interface_revision();\n    num_groups = cre2_num_capturing_groups(re);\n    cre2_named_groups_iter_next(iter, &group_name, &group_index);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)err_code + (long)ver_rev + (long)num_groups + (long)group_index + (long)(group_name != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:27:48.005874 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 40s
[2025-11-05 08:27:48.005997 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28730, Completion: 19435, Total: 48165
[2025-11-05 08:27:48.006017 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:27:48.224719 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001580/id_001580.cc
[2025-11-05 08:27:48.224775 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:48.455058 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:48.455126 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:48.457928 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:48.457959 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:48.675454 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001581/id_001581.cc
[2025-11-05 08:27:48.675510 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:48.903421 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:48.903489 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:48.906328 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:48.906361 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:49.123817 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001582/id_001582.cc
[2025-11-05 08:27:49.123904 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:49.352596 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:49.352682 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:49.355222 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:49.355247 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:49.572015 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001583/id_001583.cc
[2025-11-05 08:27:49.572070 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:49.801334 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:49.801404 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:49.803894 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:49.803929 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:50.021789 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001584/id_001584.cc
[2025-11-05 08:27:50.021844 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:50.251242 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:50.251332 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:50.254182 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:50.254215 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:50.473447 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001585/id_001585.cc
[2025-11-05 08:27:50.473502 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:50.702462 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:50.702530 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:50.705385 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:50.705417 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:50.923164 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001586/id_001586.cc
[2025-11-05 08:27:50.923220 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:51.153355 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:51.153429 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:51.155925 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:51.155957 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:51.374998 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001587/id_001587.cc
[2025-11-05 08:27:51.375086 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:51.606486 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:51.606545 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:51.609368 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:51.609401 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:51.826892 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001588/id_001588.cc
[2025-11-05 08:27:51.826949 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:52.054373 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:52.054452 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:52.057267 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:52.057299 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:52.276218 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001589/id_001589.cc
[2025-11-05 08:27:52.276285 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:27:52.506083 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:27:52.506191 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:27:52.509019 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:27:52.509051 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:27:52.509090 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:27:52.509107 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1590, succ: 1589, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:27:52.509122 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:27:52.509148 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:27:52.782970 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1589 as an example for the next prompt.
[2025-11-05 08:27:52.783025 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 08:27:52.783059 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 08:27:52.783107 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,85.0,24.0,61.0,172.0,161.0,40.0,38.0,110.0,86.0,43.0,293.0,16.0,33.0,421.0,168.0,37.0,128.0,38.0,225.0,124.0,144.0,127.0,138.0,70.0,60.0,27.0,18.0,58.0,164.0,123.0,16.0,24.0,142.0,254.0,28.0,812.0,267.0,226.0,44.0,70.0,91.0,38.0,380.0,36.0,76.0,159.0,30.0,10.0,88.0,313.0,16.0,16.0,175.0,60.0,52.0,83.0,25.0,318.0,28.0,63.0,52.0,51.0,199.0,63.0,233.0,56.0,49.0,16.0]
[2025-11-05 08:27:52.783125 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:27:52.783179 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_log_errors energy: 86
[2025-11-05 08:27:52.783220 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 199
[2025-11-05 08:27:52.783249 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 70
[2025-11-05 08:27:52.783276 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 812
[2025-11-05 08:27:52.783310 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    int cre2_opt_case_sensitive(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 08:27:52.784009 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 159, quiet_round: 0, discovered_api_pairs: 2884
[2025-11-05 08:27:52.818215 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:27:52.818558 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_log_errors(cre2_options_t * opt, int flag),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    int cre2_opt_case_sensitive(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = -1;\n    int err_code = 0;\n    int ver_rev = 0;\n    int num_groups = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    err_code = cre2_error_code(re);\n    ver_rev = cre2_version_interface_revision();\n    num_groups = cre2_num_capturing_groups(re);\n    cre2_named_groups_iter_next(iter, &group_name, &group_index);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)err_code + (long)ver_rev + (long)num_groups + (long)group_index + (long)(group_name != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int ver_rev = 0;\n    const char rewrite_buf[] = \"$2-$1\";\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int check_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    ver_rev = cre2_version_interface_revision();\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    errmsg.data = NULL;\n    errmsg.length = 0;\n\n    // step 4: Operate\n    check_ret = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)ver_rev + (long)enc + (long)(re != NULL) + (long)check_ret + (long)rewrite.length + (long)errmsg.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:28:26.667107 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 08:28:26.667234 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27640, Completion: 18410, Total: 46050
[2025-11-05 08:28:26.667255 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:28:26.884610 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001590/id_001590.cc
[2025-11-05 08:28:26.884675 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:27.113324 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:27.113400 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:27.116448 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:27.116480 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:27.332477 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001591/id_001591.cc
[2025-11-05 08:28:27.332532 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:27.566147 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:27.566223 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:27.569395 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:27.569427 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:27.787093 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001592/id_001592.cc
[2025-11-05 08:28:27.787182 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:28.017304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:28.017363 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:28.020403 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:28.020436 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:28.237485 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001593/id_001593.cc
[2025-11-05 08:28:28.237547 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:28.467694 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:28.467774 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:28.471006 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:28.471037 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:28.688121 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001594/id_001594.cc
[2025-11-05 08:28:28.688176 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:28.916970 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:28.917080 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:28.919975 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:28.920007 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:29.138280 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001595/id_001595.cc
[2025-11-05 08:28:29.138336 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:29.368871 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:29.368944 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:29.371976 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:29.372029 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:29.590866 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001596/id_001596.cc
[2025-11-05 08:28:29.590920 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:29.820820 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:29.820893 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:29.823869 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:29.823902 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:30.041810 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001597/id_001597.cc
[2025-11-05 08:28:30.041893 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:30.272462 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:30.272534 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:30.275609 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:30.275640 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:30.493843 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001598/id_001598.cc
[2025-11-05 08:28:30.493901 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:30.723304 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:30.723374 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:30.726562 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:30.726595 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:30.944414 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001599/id_001599.cc
[2025-11-05 08:28:30.944468 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:28:31.173013 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:28:31.173102 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:28:31.176028 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:28:31.176060 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:28:31.176097 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:28:31.176114 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1600, succ: 1599, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:28:31.176130 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:28:31.176157 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:28:31.449485 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1599 as an example for the next prompt.
[2025-11-05 08:28:31.449548 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 08:28:31.449602 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 08:28:31.449652 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,85.0,24.0,61.0,172.0,161.0,40.0,38.0,110.0,91.0,43.0,302.0,16.0,33.0,421.0,168.0,37.0,128.0,38.0,227.0,124.0,151.0,127.0,138.0,76.0,60.0,27.0,18.0,58.0,164.0,123.0,16.0,24.0,142.0,255.0,28.0,816.0,271.0,226.0,44.0,83.0,93.0,38.0,380.0,36.0,76.0,159.0,30.0,10.0,88.0,313.0,16.0,16.0,175.0,60.0,52.0,83.0,25.0,318.0,28.0,63.0,52.0,51.0,203.0,63.0,233.0,56.0,49.0,16.0]
[2025-11-05 08:28:31.449681 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:28:31.449736 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 93
[2025-11-05 08:28:31.449769 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_log_errors energy: 91
[2025-11-05 08:28:31.449798 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 128
[2025-11-05 08:28:31.449828 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 421
[2025-11-05 08:28:31.449857 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 816
[2025-11-05 08:28:31.449904 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_version_interface_revision(),
    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    void cre2_delete(cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 08:28:31.450753 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 160, quiet_round: 0, discovered_api_pairs: 2903
[2025-11-05 08:28:31.486693 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:28:31.487075 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_version_interface_revision(),\n    void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    void cre2_delete(cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int ver_rev = 0;\n    const char rewrite_buf[] = \"$2-$1\";\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int check_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    ver_rev = cre2_version_interface_revision();\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    errmsg.data = NULL;\n    errmsg.length = 0;\n\n    // step 4: Operate\n    check_ret = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)ver_rev + (long)enc + (long)(re != NULL) + (long)check_ret + (long)rewrite.length + (long)errmsg.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = -1;\n    int case_sens = 0;\n    int err_code = 0;\n    int num_groups = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    case_sens = cre2_opt_case_sensitive(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    iter = cre2_named_groups_iter_new(re);\n    (void)cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    err_code = cre2_error_code(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)case_sens + (long)err_code + (long)num_groups + (long)group_index + (long)(group_name != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:29:04.954024 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 08:29:04.954149 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27840, Completion: 16877, Total: 44717
[2025-11-05 08:29:04.954170 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:29:05.172016 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001600/id_001600.cc
[2025-11-05 08:29:05.172069 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:05.401913 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:05.401971 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:05.404667 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:05.404699 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:05.621126 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001601/id_001601.cc
[2025-11-05 08:29:05.621180 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:05.850340 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:05.850398 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:05.853174 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:05.853206 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:06.070981 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001602/id_001602.cc
[2025-11-05 08:29:06.071066 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:06.298969 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:06.299026 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:06.302166 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:06.302200 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:06.521248 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001603/id_001603.cc
[2025-11-05 08:29:06.521302 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:06.749295 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:06.749367 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:06.751945 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:06.751976 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:06.969022 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001604/id_001604.cc
[2025-11-05 08:29:06.969076 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:07.197651 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:07.197749 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:07.200564 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:07.200596 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:07.418203 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001605/id_001605.cc
[2025-11-05 08:29:07.418258 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:07.647819 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:07.647898 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:07.650690 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:07.650723 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:07.866994 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001606/id_001606.cc
[2025-11-05 08:29:07.867048 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:08.096062 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:08.096134 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:08.098864 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:08.098899 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:08.317384 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001607/id_001607.cc
[2025-11-05 08:29:08.317467 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:08.546224 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:08.546292 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:08.549104 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:08.549138 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:08.765666 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001608/id_001608.cc
[2025-11-05 08:29:08.765722 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:08.993749 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:08.993819 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:08.996655 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:08.996691 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:09.213210 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001609/id_001609.cc
[2025-11-05 08:29:09.213264 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:09.441994 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:09.442100 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:09.444885 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:09.444919 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:09.444957 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:29:09.444973 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1610, succ: 1609, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:29:09.444988 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:29:09.445013 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:29:09.712317 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1609 as an example for the next prompt.
[2025-11-05 08:29:09.712373 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 25 new API pairs in this round.
[2025-11-05 08:29:09.712422 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 25
[2025-11-05 08:29:09.712470 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,85.0,24.0,61.0,172.0,161.0,40.0,38.0,110.0,95.0,43.0,306.0,16.0,33.0,427.0,168.0,37.0,136.0,38.0,228.0,124.0,156.0,127.0,138.0,76.0,60.0,27.0,18.0,58.0,164.0,123.0,16.0,24.0,142.0,255.0,28.0,828.0,271.0,226.0,44.0,83.0,107.0,38.0,380.0,36.0,85.0,159.0,30.0,10.0,96.0,313.0,16.0,16.0,175.0,60.0,52.0,83.0,25.0,322.0,28.0,63.0,52.0,51.0,203.0,63.0,233.0,56.0,49.0,16.0]
[2025-11-05 08:29:09.712489 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:29:09.712543 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 123
[2025-11-05 08:29:09.712574 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 60
[2025-11-05 08:29:09.712602 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 427
[2025-11-05 08:29:09.712638 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 271
[2025-11-05 08:29:09.712667 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 96
[2025-11-05 08:29:09.712703 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    int64_t cre2_opt_max_mem(cre2_options_t * opt),
    void cre2_delete(cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_opt_one_line(cre2_options_t * opt)
[2025-11-05 08:29:09.713544 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 161, quiet_round: 0, discovered_api_pairs: 2928
[2025-11-05 08:29:09.756489 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:29:09.756847 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    int64_t cre2_opt_max_mem(cre2_options_t * opt),\n    void cre2_delete(cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_opt_one_line(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = -1;\n    int case_sens = 0;\n    int err_code = 0;\n    int num_groups = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    case_sens = cre2_opt_case_sensitive(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    iter = cre2_named_groups_iter_new(re);\n    (void)cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    err_code = cre2_error_code(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)case_sens + (long)err_code + (long)num_groups + (long)group_index + (long)(group_name != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)baz\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * compiled_pat = NULL;\n    int ver_rev = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    ver_rev = cre2_version_interface_revision();\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)ver_rev + (long)(opt != NULL) + (long)(re != NULL) + (long)(compiled_pat != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:29:58.088654 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 48s
[2025-11-05 08:29:58.088765 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27480, Completion: 23236, Total: 50716
[2025-11-05 08:29:58.088786 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:29:58.305356 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001610/id_001610.cc
[2025-11-05 08:29:58.305410 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:58.536856 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:58.536929 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:58.539652 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:58.539684 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:58.757842 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001611/id_001611.cc
[2025-11-05 08:29:58.757899 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:58.987553 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:58.987623 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:58.990349 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:58.990382 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:59.208829 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001612/id_001612.cc
[2025-11-05 08:29:59.208914 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:59.438451 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:59.438509 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:59.441679 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:59.441712 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:29:59.660025 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001613/id_001613.cc
[2025-11-05 08:29:59.660081 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:29:59.888525 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:29:59.888597 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:29:59.891501 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:29:59.891526 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:00.107965 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001614/id_001614.cc
[2025-11-05 08:30:00.108021 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:00.337109 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:00.337250 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:00.339949 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:00.339981 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:00.558032 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001615/id_001615.cc
[2025-11-05 08:30:00.558088 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:00.786131 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:00.786207 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:00.789393 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:00.789425 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:01.007312 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001616/id_001616.cc
[2025-11-05 08:30:01.007365 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:01.234738 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:01.234811 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:01.237658 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:01.237690 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:01.455787 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001617/id_001617.cc
[2025-11-05 08:30:01.455873 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:01.685306 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:01.685376 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:01.687995 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:01.688028 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:01.906965 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001618/id_001618.cc
[2025-11-05 08:30:01.907022 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:02.136436 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:02.136511 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:02.139099 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:02.139125 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:02.357005 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001619/id_001619.cc
[2025-11-05 08:30:02.357061 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:02.587417 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:02.587530 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:02.590332 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:02.590367 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:02.590407 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:30:02.590424 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1620, succ: 1619, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:30:02.590463 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:30:02.590489 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:30:02.873797 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1619 as an example for the next prompt.
[2025-11-05 08:30:02.873853 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 08:30:02.873895 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 08:30:02.873943 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,85.0,24.0,61.0,172.0,161.0,40.0,38.0,110.0,98.0,43.0,306.0,16.0,33.0,428.0,168.0,37.0,144.0,38.0,229.0,124.0,156.0,127.0,138.0,76.0,60.0,27.0,18.0,58.0,164.0,128.0,16.0,24.0,142.0,255.0,28.0,830.0,273.0,226.0,44.0,83.0,107.0,38.0,380.0,36.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,175.0,70.0,52.0,83.0,25.0,324.0,28.0,63.0,58.0,51.0,206.0,63.0,233.0,56.0,49.0,16.0]
[2025-11-05 08:30:02.873961 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:30:02.874012 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 63
[2025-11-05 08:30:02.874046 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 324
[2025-11-05 08:30:02.874072 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 156
[2025-11-05 08:30:02.874099 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 226
[2025-11-05 08:30:02.874133 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_error_code(const cre2_regexp_t * re),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)
[2025-11-05 08:30:02.874829 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 162, quiet_round: 0, discovered_api_pairs: 2947
[2025-11-05 08:30:02.909175 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:30:02.909516 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_error_code(const cre2_regexp_t * re),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo|bar)baz\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * compiled_pat = NULL;\n    int ver_rev = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    ver_rev = cre2_version_interface_revision();\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)ver_rev + (long)(opt != NULL) + (long)(re != NULL) + (long)(compiled_pat != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobarbaz\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int nmatch = 2;\n    long long max_mem = 0;\n    int one_line_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n    max_mem = (long long)cre2_opt_max_mem(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    memset(ranges, 0, sizeof(ranges));\n    strings[0].data = text;\n    strings[0].length = 3;   // \"foo\"\n    strings[1].data = text + 3;\n    strings[1].length = 3;   // \"bar\"\n    cre2_strings_to_ranges(text, ranges, strings, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)one_line_flag + (long)max_mem + (long)strings[0].length + (long)strings[1].length\n               + (long)ranges[0].start + (long)ranges[0].past + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:30:33.162583 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 08:30:33.162700 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28010, Completion: 17773, Total: 45783
[2025-11-05 08:30:33.162721 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:30:33.380933 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001620/id_001620.cc
[2025-11-05 08:30:33.380988 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:33.609072 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:33.609149 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:33.611778 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:33.611813 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:33.829561 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001621/id_001621.cc
[2025-11-05 08:30:33.829617 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:34.060121 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:34.060198 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:34.062921 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:34.062949 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:34.280854 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001622/id_001622.cc
[2025-11-05 08:30:34.280940 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:34.512318 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:34.512394 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:34.515198 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:34.515232 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:34.732924 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001623/id_001623.cc
[2025-11-05 08:30:34.732980 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:34.962852 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:34.962931 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:34.965746 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:34.965777 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:35.183717 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001624/id_001624.cc
[2025-11-05 08:30:35.183771 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:35.412472 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:35.412590 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:35.415295 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:35.415323 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:35.634555 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001625/id_001625.cc
[2025-11-05 08:30:35.634611 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:35.863482 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:35.863557 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:35.866379 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:35.866408 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:36.087240 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001626/id_001626.cc
[2025-11-05 08:30:36.087294 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:36.316140 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:36.316217 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:36.319077 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:36.319114 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:36.540527 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001627/id_001627.cc
[2025-11-05 08:30:36.540641 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:36.769325 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:36.769400 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:36.772132 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:36.772160 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:36.989594 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001628/id_001628.cc
[2025-11-05 08:30:36.989649 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:37.218204 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:37.218282 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:37.221128 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:37.221156 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:37.438152 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001629/id_001629.cc
[2025-11-05 08:30:37.438207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:30:37.667499 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:30:37.667619 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:30:37.670386 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:30:37.670414 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:30:37.670454 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:30:37.670472 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1630, succ: 1629, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:30:37.670491 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:30:37.670523 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:30:37.942857 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1629 as an example for the next prompt.
[2025-11-05 08:30:37.942914 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 08:30:37.942954 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 08:30:37.943002 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,85.0,24.0,61.0,172.0,161.0,40.0,38.0,110.0,101.0,43.0,306.0,16.0,33.0,431.0,168.0,37.0,144.0,38.0,230.0,124.0,166.0,127.0,139.0,76.0,60.0,27.0,18.0,58.0,165.0,128.0,16.0,24.0,142.0,255.0,28.0,832.0,273.0,228.0,44.0,83.0,107.0,38.0,380.0,36.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,180.0,70.0,52.0,83.0,25.0,329.0,28.0,66.0,58.0,51.0,206.0,63.0,235.0,56.0,49.0,16.0]
[2025-11-05 08:30:37.943021 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:30:37.943074 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 124
[2025-11-05 08:30:37.943133 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 165
[2025-11-05 08:30:37.943162 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 206
[2025-11-05 08:30:37.943199 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 142
[2025-11-05 08:30:37.943231 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_set_compile(cre2_set * set),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)
[2025-11-05 08:30:37.943953 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 163, quiet_round: 0, discovered_api_pairs: 2962
[2025-11-05 08:30:37.972473 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:30:37.972821 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_set_compile(cre2_set * set),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobarbaz\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int nmatch = 2;\n    long long max_mem = 0;\n    int one_line_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n    max_mem = (long long)cre2_opt_max_mem(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    memset(ranges, 0, sizeof(ranges));\n    strings[0].data = text;\n    strings[0].length = 3;   // \"foo\"\n    strings[1].data = text + 3;\n    strings[1].length = 3;   // \"bar\"\n    cre2_strings_to_ranges(text, ranges, strings, nmatch);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)one_line_flag + (long)max_mem + (long)strings[0].length + (long)strings[1].length\n               + (long)ranges[0].start + (long)ranges[0].past + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"\\\\bfoo\\\\b(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix foo bar foo\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    int errcode = 0;\n    int match[4];\n    size_t nmatched = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    errcode = cre2_error_code(re);\n    memset(match, -1, sizeof(match));\n    nmatched = cre2_set_match(set, text, text_len, match, (size_t)(sizeof(match) / sizeof(match[0])));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)errcode + (long)(compiled_pat != NULL) + (long)nmatched\n               + (long)match[0] + (long)match[1] + (long)match[2] + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:31:28.180910 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 50s
[2025-11-05 08:31:28.181024 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29290, Completion: 19979, Total: 49269
[2025-11-05 08:31:28.181044 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:31:28.399203 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001630/id_001630.cc
[2025-11-05 08:31:28.399258 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:28.629060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:28.629132 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:28.631766 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:28.631798 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:28.849233 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001631/id_001631.cc
[2025-11-05 08:31:28.849287 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:29.080920 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:29.080988 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:29.083704 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:29.083735 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:29.303122 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001632/id_001632.cc
[2025-11-05 08:31:29.303207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:29.533984 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:29.534056 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:29.536954 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:29.536987 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:29.755514 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001633/id_001633.cc
[2025-11-05 08:31:29.755576 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:29.982940 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:29.982999 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:29.985830 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:29.985862 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:30.204283 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001634/id_001634.cc
[2025-11-05 08:31:30.204335 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:30.433362 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:30.433451 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:30.436604 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:30.436647 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:30.654330 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001635/id_001635.cc
[2025-11-05 08:31:30.654385 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:30.882594 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:30.882654 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:30.885607 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:30.885639 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:31.104444 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001636/id_001636.cc
[2025-11-05 08:31:31.104498 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:31.334102 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:31.334173 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:31.337424 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:31.337456 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:31.555920 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001637/id_001637.cc
[2025-11-05 08:31:31.556003 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:31.784752 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:31.784809 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:31.787764 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:31.787795 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:32.006402 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001638/id_001638.cc
[2025-11-05 08:31:32.006455 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:32.235605 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:32.235681 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:32.238527 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:32.238560 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:32.455395 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001639/id_001639.cc
[2025-11-05 08:31:32.455448 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:31:32.685477 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:31:32.685566 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:31:32.688747 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:31:32.688779 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:31:32.688817 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:31:32.688835 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1640, succ: 1639, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:31:32.688849 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:31:32.688876 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:31:32.974025 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1639 as an example for the next prompt.
[2025-11-05 08:31:32.974081 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 08:31:32.974117 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 08:31:32.974165 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,172.0,161.0,40.0,41.0,110.0,101.0,43.0,308.0,16.0,33.0,431.0,168.0,37.0,144.0,38.0,231.0,127.0,168.0,127.0,139.0,78.0,60.0,27.0,18.0,58.0,165.0,128.0,16.0,24.0,146.0,255.0,28.0,835.0,275.0,229.0,44.0,83.0,107.0,38.0,380.0,36.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,186.0,70.0,52.0,83.0,25.0,330.0,28.0,66.0,58.0,51.0,208.0,63.0,235.0,56.0,49.0,16.0]
[2025-11-05 08:31:32.974183 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:31:32.974236 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 330
[2025-11-05 08:31:32.974267 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 186
[2025-11-05 08:31:32.974295 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 60
[2025-11-05 08:31:32.974322 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 231
[2025-11-05 08:31:32.974349 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 127
[2025-11-05 08:31:32.974386 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    cre2_options_t *cre2_opt_new(),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 08:31:32.975198 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 164, quiet_round: 0, discovered_api_pairs: 2975
[2025-11-05 08:31:33.023665 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:31:33.024030 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"\\\\bfoo\\\\b(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"prefix foobar suffix foo bar foo\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    int errcode = 0;\n    int match[4];\n    size_t nmatched = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    errcode = cre2_error_code(re);\n    memset(match, -1, sizeof(match));\n    nmatched = cre2_set_match(set, text, text_len, match, (size_t)(sizeof(match) / sizeof(match[0])));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)errcode + (long)(compiled_pat != NULL) + (long)nmatched\n               + (long)match[0] + (long)match[1] + (long)match[2] + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"zzfooXXbar\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int match[4];\n    size_t nmatched = 0;\n    const char * compiled_pat = NULL;\n    int errcode = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    errcode = cre2_error_code(re);\n    memset(match, -1, sizeof(match));\n    nmatched = cre2_set_match(set, text, text_len, match, (size_t)(sizeof(match) / sizeof(match[0])));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)errcode + (long)nmatched + (long)match[0] + (long)match[1]\n               + (long)(compiled_pat != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:32:21.727075 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 48s
[2025-11-05 08:32:21.727197 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30100, Completion: 26781, Total: 56881
[2025-11-05 08:32:21.727217 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:32:21.945053 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001640/id_001640.cc
[2025-11-05 08:32:21.945107 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:22.175832 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:22.175904 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:22.178722 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:22.178755 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:22.396090 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001641/id_001641.cc
[2025-11-05 08:32:22.396145 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:22.624817 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:22.624888 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:22.627747 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:22.627780 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:22.846638 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001642/id_001642.cc
[2025-11-05 08:32:22.846724 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:23.076924 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:23.076998 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:23.079646 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:23.079678 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:23.296660 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001643/id_001643.cc
[2025-11-05 08:32:23.296715 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:23.526818 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:23.526878 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:23.529768 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:23.529803 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:23.749099 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001644/id_001644.cc
[2025-11-05 08:32:23.749163 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:23.978390 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:23.978479 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:23.981393 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:23.981426 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:24.198793 +00:00] WARN [src/fuzzer.rs:205] Program 1645 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001645/id_001645.cc:42:11: error: no matching function for call to 'cre2_set_new'
   42 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:32:24.247282 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:32:24.247627 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"xxfoobaryy foobar zzfoo\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    int match[8];\n    size_t nmatched = 0;\n    long checksum = 0;\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t text_and_target_str;\n    int extract_res = 0;\n    int replace_res = 0;\n    char rewrite_buf[] = \"\\\\1-\\\\2\";\n    char target_buf[] = \"\";\n    char text_and_target_buf[] = \"xxfoobaryy foobar zzfoo\";\n\n    // step 2: Setup (create options, regexp and set)\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 3: Operate (pattern info and set matching)\n    compiled_pat = cre2_pattern(re);\n    memset(match, -1, sizeof(match));\n    nmatched = cre2_set_match(set, text, text_len, match, (size_t)(sizeof(match) / sizeof(match[0])));\n\n    // step 4: Operate (extract and global replace using the compiled regexp)\n    text_str.data = text;\n    text_str.length = (int)text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = (int)(sizeof(rewrite_buf) - 1);\n    target_str.data = target_buf;\n    target_str.length = 0;\n    extract_res = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = (int)(sizeof(text_and_target_buf) - 1);\n    replace_res = cre2_global_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate (compute a checksum from results to use variables)\n    checksum = (long)pattern_len + (long)nmatched + (long)match[0] + (long)match[1] + (long)match[2]\n               + (long)extract_res + (long)replace_res + (long)(compiled_pat != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)target_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001645/id_001645.cc:42:11: error: no matching function for call to 'cre2_set_new'\n   42 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:32:46.405718 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 22s
[2025-11-05 08:32:46.405840 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24880, Completion: 13337, Total: 38217
[2025-11-05 08:32:46.624442 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001645/id_001645.cc
[2025-11-05 08:32:46.624497 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:46.854316 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:46.854390 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:46.857321 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:46.857346 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:46.857381 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1645!
[2025-11-05 08:32:47.077738 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001646/id_001646.cc
[2025-11-05 08:32:47.077796 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:47.310613 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:47.310678 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:47.313516 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:47.313549 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:47.531840 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001647/id_001647.cc
[2025-11-05 08:32:47.531925 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:47.762103 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:47.762177 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:47.764884 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:47.764917 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:47.982433 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001648/id_001648.cc
[2025-11-05 08:32:47.982489 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:48.211721 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:48.211797 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:48.214692 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:48.214718 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:48.433461 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001649/id_001649.cc
[2025-11-05 08:32:48.433524 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:32:48.663683 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:32:48.663785 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:32:48.666161 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:32:48.666192 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:32:48.666230 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:32:48.666250 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1650, succ: 1649, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:32:48.666266 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:32:48.666295 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:32:48.974616 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1649 as an example for the next prompt.
[2025-11-05 08:32:48.974670 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 22 new API pairs in this round.
[2025-11-05 08:32:48.974713 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 22
[2025-11-05 08:32:48.974760 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,172.0,161.0,40.0,41.0,110.0,101.0,43.0,308.0,16.0,33.0,432.0,168.0,37.0,144.0,38.0,231.0,127.0,168.0,137.0,139.0,78.0,73.0,27.0,18.0,58.0,168.0,128.0,16.0,24.0,148.0,256.0,28.0,837.0,275.0,229.0,44.0,83.0,107.0,38.0,380.0,36.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,196.0,70.0,52.0,83.0,25.0,335.0,28.0,67.0,58.0,51.0,208.0,63.0,235.0,56.0,49.0,16.0]
[2025-11-05 08:32:48.974777 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:32:48.974829 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 231
[2025-11-05 08:32:48.974861 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 837
[2025-11-05 08:32:48.974900 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_max_mem energy: 58
[2025-11-05 08:32:48.974926 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 308
[2025-11-05 08:32:48.974958 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m),
    int cre2_num_capturing_groups(const cre2_regexp_t * re)
[2025-11-05 08:32:48.975667 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 165, quiet_round: 0, discovered_api_pairs: 2997
[2025-11-05 08:32:49.010232 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:32:49.010583 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)|(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"zzfooXXbar\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int match[4];\n    size_t nmatched = 0;\n    const char * compiled_pat = NULL;\n    int errcode = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    errcode = cre2_error_code(re);\n    memset(match, -1, sizeof(match));\n    nmatched = cre2_set_match(set, text, text_len, match, (size_t)(sizeof(match) / sizeof(match[0])));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)errcode + (long)nmatched + (long)match[0] + (long)match[1]\n               + (long)(compiled_pat != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar foo\";\n    const size_t source_text_len = (size_t)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char target_buf[64];\n    const char rewrite[] = \"$1\";\n    const int rewrite_len = (int)(sizeof(rewrite) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    int match[8];\n    size_t nmatched = 0;\n    int extract_rc = 0;\n    int replace_rc = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    memset(match, -1, sizeof(match));\n    nmatched = cre2_set_match(set, source_text, source_text_len, match, (size_t)(sizeof(match) / sizeof(match[0])));\n\n    memcpy(text_and_target_buf, source_text, source_text_len);\n    text_and_target_buf[source_text_len] = '\\0';\n    memset(target_buf, 0, sizeof(target_buf));\n\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t text_and_target_str;\n\n    text_str.data = source_text;\n    text_str.length = (int)source_text_len;\n\n    rewrite_str.data = rewrite;\n    rewrite_str.length = rewrite_len;\n\n    target_str.data = target_buf;\n    target_str.length = 0;\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = (int)source_text_len;\n\n    extract_rc = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n    replace_rc = cre2_global_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)nmatched + (long)extract_rc + (long)replace_rc\n               + (long)match[0] + (long)match[1] + (long)match[2]\n               + (long)(compiled_pat != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:33:22.692276 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 33s
[2025-11-05 08:33:22.692395 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31830, Completion: 15628, Total: 47458
[2025-11-05 08:33:22.692415 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:33:22.909825 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001650/id_001650.cc
[2025-11-05 08:33:22.909878 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:23.139779 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:23.139854 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:23.142596 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:23.142623 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:23.359179 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001651/id_001651.cc
[2025-11-05 08:33:23.359234 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:23.587521 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:23.587599 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:23.590397 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:23.590429 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:23.807491 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001652/id_001652.cc
[2025-11-05 08:33:23.807575 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:24.036041 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:24.036114 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:24.038878 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:24.038909 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:24.255691 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001653/id_001653.cc
[2025-11-05 08:33:24.255745 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:24.483316 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:24.483389 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:24.486241 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:24.486295 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:24.704763 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001654/id_001654.cc
[2025-11-05 08:33:24.704815 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:24.932658 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:24.932773 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:24.935409 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:24.935442 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:25.153845 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001655/id_001655.cc
[2025-11-05 08:33:25.153898 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:25.382069 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:25.382142 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:25.384871 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:25.384905 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:25.602295 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001656/id_001656.cc
[2025-11-05 08:33:25.602348 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:25.831243 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:25.831317 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:25.834038 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:25.834071 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:26.050889 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001657/id_001657.cc
[2025-11-05 08:33:26.050975 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:26.279124 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:26.279197 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:26.282054 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:26.282088 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:26.500282 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001658/id_001658.cc
[2025-11-05 08:33:26.500336 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:26.729282 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:26.729356 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:26.732038 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:26.732070 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:26.951598 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001659/id_001659.cc
[2025-11-05 08:33:26.951651 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:33:27.181643 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:33:27.181754 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:33:27.184415 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:33:27.184468 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:33:27.184507 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:33:27.184522 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1660, succ: 1659, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:33:27.184537 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:33:27.184565 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:33:27.449106 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1659 as an example for the next prompt.
[2025-11-05 08:33:27.449161 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 3 new API pairs in this round.
[2025-11-05 08:33:27.449187 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 3
[2025-11-05 08:33:27.449237 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,172.0,161.0,40.0,41.0,110.0,101.0,43.0,311.0,16.0,33.0,434.0,168.0,37.0,144.0,38.0,231.0,127.0,168.0,137.0,139.0,78.0,73.0,27.0,18.0,58.0,168.0,128.0,16.0,24.0,148.0,256.0,28.0,838.0,275.0,229.0,44.0,83.0,107.0,38.0,380.0,36.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,196.0,70.0,52.0,83.0,25.0,336.0,28.0,67.0,59.0,51.0,208.0,63.0,235.0,56.0,49.0,16.0]
[2025-11-05 08:33:27.449258 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:33:27.449311 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 235
[2025-11-05 08:33:27.449342 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 336
[2025-11-05 08:33:27.449369 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 380
[2025-11-05 08:33:27.449407 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 83
[2025-11-05 08:33:27.449436 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 172
[2025-11-05 08:33:27.449474 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_add_simple(cre2_set * set, const char * pattern),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_case_sensitive(cre2_options_t * opt),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 08:33:27.450316 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 166, quiet_round: 0, discovered_api_pairs: 3000
[2025-11-05 08:33:27.497299 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:33:27.497654 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_add_simple(cre2_set * set, const char * pattern),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_case_sensitive(cre2_options_t * opt),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar foo\";\n    const size_t source_text_len = (size_t)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char target_buf[64];\n    const char rewrite[] = \"$1\";\n    const int rewrite_len = (int)(sizeof(rewrite) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    int match[8];\n    size_t nmatched = 0;\n    int extract_rc = 0;\n    int replace_rc = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    memset(match, -1, sizeof(match));\n    nmatched = cre2_set_match(set, source_text, source_text_len, match, (size_t)(sizeof(match) / sizeof(match[0])));\n\n    memcpy(text_and_target_buf, source_text, source_text_len);\n    text_and_target_buf[source_text_len] = '\\0';\n    memset(target_buf, 0, sizeof(target_buf));\n\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t text_and_target_str;\n\n    text_str.data = source_text;\n    text_str.length = (int)source_text_len;\n\n    rewrite_str.data = rewrite;\n    rewrite_str.length = rewrite_len;\n\n    target_str.data = target_buf;\n    target_str.length = 0;\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = (int)source_text_len;\n\n    extract_rc = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n    replace_rc = cre2_global_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)nmatched + (long)extract_rc + (long)replace_rc\n               + (long)match[0] + (long)match[1] + (long)match[2]\n               + (long)(compiled_pat != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    int num_groups = -1;\n    long checksum = 0;\n    char scratch[32];\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    num_groups = cre2_num_capturing_groups(re);\n    memset(scratch, 0, sizeof(scratch));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)(opt != NULL) + (long)(re != NULL) + (long)scratch[0];\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:34:10.074606 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 08:34:10.074728 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30300, Completion: 23736, Total: 54036
[2025-11-05 08:34:10.074750 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:34:10.292712 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001660/id_001660.cc
[2025-11-05 08:34:10.292768 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:34:10.521234 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:34:10.521310 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:34:10.523972 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:34:10.524005 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:34:10.741372 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001661/id_001661.cc
[2025-11-05 08:34:10.741424 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:34:10.970774 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:34:10.970847 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:34:10.973725 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:34:10.973758 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:34:11.191208 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001662/id_001662.cc
[2025-11-05 08:34:11.191289 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:34:11.421428 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:34:11.421503 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:34:11.424258 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:34:11.424291 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:34:11.640603 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001663/id_001663.cc
[2025-11-05 08:34:11.640670 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:34:11.870462 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:34:11.870536 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:34:11.873498 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:34:11.873531 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:34:12.093683 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001664/id_001664.cc
[2025-11-05 08:34:12.093736 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:34:12.322029 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:34:12.322145 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:34:12.325119 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:34:12.325152 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:34:12.543780 +00:00] WARN [src/fuzzer.rs:205] Program 1665 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001665/id_001665.cc:43:11: error: no matching function for call to 'cre2_set_new'
   43 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:34:12.590869 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:34:12.591220 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobar foobaz foo\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    cre2_string_t match_arr[4];\n    int match_rc = 0;\n    const char rewrite[] = \"$1\";\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int replace_rc = 0;\n    int cs_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    compiled_pat = cre2_pattern(re);\n\n    // step 4: Operate\n    memset(match_arr, 0, sizeof(match_arr));\n    match_rc = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, match_arr, (int)(sizeof(match_arr) / sizeof(match_arr[0])));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    text_and_target_buf[source_text_len] = '\\0';\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite;\n    rewrite_str.length = (int)(sizeof(rewrite) - 1);\n    replace_rc = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)match_rc + (long)replace_rc + (long)cs_flag\n               + (long)(compiled_pat != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL)\n               + (long)text_and_target_str.length + (long)rewrite_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001665/id_001665.cc:43:11: error: no matching function for call to 'cre2_set_new'\n   43 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:34:35.501700 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 22s
[2025-11-05 08:34:35.501827 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24010, Completion: 12407, Total: 36417
[2025-11-05 08:34:35.720543 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001665/id_001665.cc
[2025-11-05 08:34:35.720601 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:34:35.949651 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:34:35.949714 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:34:35.952507 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:34:35.952540 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:34:35.952573 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1665!
[2025-11-05 08:34:36.170827 +00:00] WARN [src/fuzzer.rs:205] Program 1666 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001666/id_001666.cc:44:11: error: no matching function for call to 'cre2_set_new'
   44 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:34:36.217932 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:34:36.218270 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar foo\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    const char rewrite[] = \"$1-$2\";\n    const int rewrite_len = (int)(sizeof(rewrite) - 1);\n    char text_and_target_buf[128];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    cre2_string_t matches[4];\n    int easy_rc = 0;\n    int add_simple_rc = 0;\n    int compile_rc = 0;\n    int replace_rc = 0;\n    int case_sensitive_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    case_sensitive_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    add_simple_rc = cre2_set_add_simple(set, pattern);\n    compile_rc = cre2_set_compile(set);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    memset(matches, 0, sizeof(matches));\n    easy_rc = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, matches, (int)(sizeof(matches) / sizeof(matches[0])));\n\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    text_and_target_buf[source_text_len] = '\\0';\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite;\n    rewrite_str.length = rewrite_len;\n    replace_rc = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)case_sensitive_flag + (long)add_simple_rc + (long)compile_rc + (long)easy_rc + (long)replace_rc\n               + (long)(compiled_pat != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001666/id_001666.cc:44:11: error: no matching function for call to 'cre2_set_new'\n   44 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:35:00.087995 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 23s
[2025-11-05 08:35:00.088113 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24350, Completion: 12542, Total: 36892
[2025-11-05 08:35:00.307849 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001666/id_001666.cc
[2025-11-05 08:35:00.307904 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:35:00.538290 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:35:00.538359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:35:00.541290 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:35:00.541324 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:35:00.541357 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1666!
[2025-11-05 08:35:00.758858 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001667/id_001667.cc
[2025-11-05 08:35:00.758912 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:35:00.988914 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:35:00.988973 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:35:00.991710 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:35:00.991743 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:35:01.209437 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001668/id_001668.cc
[2025-11-05 08:35:01.209523 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:35:01.440249 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:35:01.440328 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:35:01.443191 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:35:01.443226 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:35:01.659663 +00:00] WARN [src/fuzzer.rs:205] Program 1669 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001669/id_001669.cc:43:11: error: no matching function for call to 'cre2_set_new'
   43 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:35:01.706775 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:35:01.707121 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ab)(cd)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"abcd abc ab\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char match_buf[64];\n    char text_and_target_buf[128];\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    cre2_string_t match_str;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int easy_match_rc = 0;\n    int replace_rc = 0;\n    int cs_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1\", 2);\n\n    match_str.data = match_buf;\n    match_str.length = 0;\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 2;\n\n    easy_match_rc = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, &match_str, 1);\n    replace_rc = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)easy_match_rc + (long)replace_rc + (long)cs_flag + (long)(compiled_pat != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)match_str.length + (long)text_and_target_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001669/id_001669.cc:43:11: error: no matching function for call to 'cre2_set_new'\n   43 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:35:20.561412 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 18s
[2025-11-05 08:35:20.561533 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24120, Completion: 11051, Total: 35171
[2025-11-05 08:35:20.780877 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001669/id_001669.cc
[2025-11-05 08:35:20.780935 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:35:21.010275 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:35:21.010350 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:35:21.013261 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:35:21.013289 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:35:21.013321 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1669!
[2025-11-05 08:35:21.013360 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:35:21.013378 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1670, succ: 1669, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:35:21.013394 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:35:21.013418 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:35:21.321682 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1669 as an example for the next prompt.
[2025-11-05 08:35:21.321739 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 08:35:21.321773 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 08:35:21.321820 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,173.0,161.0,40.0,41.0,110.0,101.0,43.0,311.0,16.0,33.0,434.0,168.0,37.0,144.0,38.0,232.0,127.0,168.0,137.0,139.0,78.0,73.0,27.0,18.0,58.0,169.0,128.0,16.0,24.0,148.0,256.0,28.0,840.0,275.0,230.0,44.0,88.0,107.0,38.0,385.0,36.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,196.0,70.0,52.0,83.0,25.0,340.0,28.0,67.0,59.0,51.0,208.0,63.0,236.0,56.0,49.0,16.0]
[2025-11-05 08:35:21.321837 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:35:21.321890 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 208
[2025-11-05 08:35:21.321923 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 275
[2025-11-05 08:35:21.321949 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 340
[2025-11-05 08:35:21.321977 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_never_nl energy: 28
[2025-11-05 08:35:21.322008 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    const char *cre2_pattern(const cre2_regexp_t * re),
    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag)
[2025-11-05 08:35:21.322717 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 167, quiet_round: 0, discovered_api_pairs: 3011
[2025-11-05 08:35:21.353606 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:35:21.353949 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    int num_groups = -1;\n    long checksum = 0;\n    char scratch[32];\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    num_groups = cre2_num_capturing_groups(re);\n    memset(scratch, 0, sizeof(scratch));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)(opt != NULL) + (long)(re != NULL) + (long)scratch[0];\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ab)(cd)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"abcd abc ab\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char match_buf[64];\n    char text_and_target_buf[128];\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    cre2_string_t match_str;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int easy_match_rc = 0;\n    int replace_rc = 0;\n    int cs_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    /* cre2_set_new expects a cre2_anchor_t for the second argument; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1\", 2);\n\n    match_str.data = match_buf;\n    match_str.length = 0;\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 2;\n\n    easy_match_rc = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, &match_str, 1);\n    replace_rc = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)easy_match_rc + (long)replace_rc + (long)cs_flag + (long)(compiled_pat != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)match_str.length + (long)text_and_target_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:36:07.421282 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 08:36:07.421407 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29260, Completion: 18254, Total: 47514
[2025-11-05 08:36:07.421428 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:36:07.638669 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001670/id_001670.cc
[2025-11-05 08:36:07.638721 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:07.866919 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:07.866994 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:07.870063 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:07.870095 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:08.087080 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001671/id_001671.cc
[2025-11-05 08:36:08.087134 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:08.315652 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:08.315725 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:08.318957 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:08.318991 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:08.536176 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001672/id_001672.cc
[2025-11-05 08:36:08.536262 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:08.764978 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:08.765055 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:08.768022 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:08.768055 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:08.984677 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001673/id_001673.cc
[2025-11-05 08:36:08.984731 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:09.214250 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:09.214309 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:09.217377 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:09.217411 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:09.434380 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001674/id_001674.cc
[2025-11-05 08:36:09.434434 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:09.664724 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:09.664810 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:09.667426 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:09.667459 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:09.885853 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001675/id_001675.cc
[2025-11-05 08:36:09.885909 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:10.115443 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:10.115521 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:10.118617 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:10.118648 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:10.335221 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001676/id_001676.cc
[2025-11-05 08:36:10.335277 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:10.566153 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:10.566232 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:10.569288 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:10.569320 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:10.787559 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001677/id_001677.cc
[2025-11-05 08:36:10.787646 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:11.016368 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:11.016442 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:11.019231 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:11.019264 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:11.237648 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001678/id_001678.cc
[2025-11-05 08:36:11.237702 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:11.467050 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:11.467129 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:11.470390 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:11.470422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:11.687852 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001679/id_001679.cc
[2025-11-05 08:36:11.687906 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:11.918573 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:11.918693 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:11.921783 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:11.921815 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:11.921854 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:36:11.921870 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1680, succ: 1679, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:36:11.921885 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:36:11.921916 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:36:12.196926 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1679 as an example for the next prompt.
[2025-11-05 08:36:12.196982 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 08:36:12.197016 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 08:36:12.197064 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,173.0,161.0,40.0,41.0,110.0,101.0,43.0,313.0,16.0,33.0,436.0,168.0,37.0,144.0,38.0,233.0,127.0,168.0,137.0,139.0,79.0,73.0,27.0,18.0,58.0,169.0,128.0,16.0,24.0,148.0,256.0,28.0,842.0,278.0,230.0,44.0,88.0,107.0,38.0,385.0,36.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,196.0,70.0,52.0,83.0,25.0,342.0,30.0,67.0,59.0,51.0,214.0,63.0,236.0,56.0,49.0,16.0]
[2025-11-05 08:36:12.197081 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:36:12.197134 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 436
[2025-11-05 08:36:12.197165 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 127
[2025-11-05 08:36:12.197194 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 313
[2025-11-05 08:36:12.197250 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace energy: 36
[2025-11-05 08:36:12.197284 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 08:36:12.197995 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 168, quiet_round: 0, discovered_api_pairs: 3022
[2025-11-05 08:36:12.232150 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:36:12.232499 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ab)(cd)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"abcd abc ab\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char match_buf[64];\n    char text_and_target_buf[128];\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * compiled_pat = NULL;\n    cre2_string_t match_str;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int easy_match_rc = 0;\n    int replace_rc = 0;\n    int cs_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    /* cre2_set_new expects a cre2_anchor_t for the second argument; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    memset(match_buf, 0, sizeof(match_buf));\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1\", 2);\n\n    match_str.data = match_buf;\n    match_str.length = 0;\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 2;\n\n    easy_match_rc = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, &match_str, 1);\n    replace_rc = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)easy_match_rc + (long)replace_rc + (long)cs_flag + (long)(compiled_pat != NULL)\n               + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)match_str.length + (long)text_and_target_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *compiled_pat = NULL;\n    const char *found_name = NULL;\n    int found_index = -1;\n    int num_groups = 0;\n    char scratch[32];\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n    memset(scratch, 0, sizeof(scratch));\n    (void)cre2_named_groups_iter_next(iter, &found_name, &found_index);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)(opt != NULL) + (long)(re != NULL)\n               + (long)(iter != NULL) + (long)(compiled_pat != NULL) + (long)(found_name != NULL)\n               + (long)(found_index) + (long)scratch[0];\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:36:54.476887 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 08:36:54.477003 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30510, Completion: 19416, Total: 49926
[2025-11-05 08:36:54.477025 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:36:54.694360 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001680/id_001680.cc
[2025-11-05 08:36:54.694412 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:54.923462 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:54.923534 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:54.926434 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:54.926467 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:55.144722 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001681/id_001681.cc
[2025-11-05 08:36:55.144776 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:55.374588 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:55.374664 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:55.377436 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:55.377468 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:55.595405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001682/id_001682.cc
[2025-11-05 08:36:55.595490 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:55.825454 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:55.825523 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:55.828332 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:55.828365 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:56.045975 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001683/id_001683.cc
[2025-11-05 08:36:56.046027 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:56.275146 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:56.275222 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:56.277939 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:56.277972 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:56.496268 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001684/id_001684.cc
[2025-11-05 08:36:56.496323 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:56.725070 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:56.725187 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:56.727954 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:56.727986 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:56.945085 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001685/id_001685.cc
[2025-11-05 08:36:56.945139 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:57.174908 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:57.174985 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:57.177763 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:57.177797 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:57.395001 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001686/id_001686.cc
[2025-11-05 08:36:57.395056 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:57.625443 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:57.625520 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:57.628067 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:57.628100 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:57.846842 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001687/id_001687.cc
[2025-11-05 08:36:57.846927 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:58.076678 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:58.076752 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:58.079423 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:58.079456 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:58.295955 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001688/id_001688.cc
[2025-11-05 08:36:58.296009 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:58.524851 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:58.524920 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:58.527589 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:58.527622 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:58.745742 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001689/id_001689.cc
[2025-11-05 08:36:58.745797 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:36:58.975696 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:36:58.975813 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:36:58.978607 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:36:58.978640 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:36:58.978679 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:36:58.978697 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1690, succ: 1689, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:36:58.978712 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:36:58.978739 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:36:59.262886 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1689 as an example for the next prompt.
[2025-11-05 08:36:59.262943 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 08:36:59.262975 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 08:36:59.263022 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,173.0,161.0,40.0,41.0,110.0,101.0,43.0,318.0,16.0,33.0,438.0,168.0,37.0,144.0,38.0,233.0,127.0,168.0,137.0,139.0,79.0,73.0,27.0,18.0,58.0,169.0,128.0,16.0,24.0,148.0,256.0,28.0,843.0,278.0,230.0,44.0,88.0,107.0,38.0,385.0,42.0,85.0,159.0,30.0,10.0,107.0,313.0,16.0,16.0,196.0,70.0,52.0,83.0,25.0,342.0,30.0,67.0,59.0,51.0,214.0,63.0,236.0,56.0,49.0,16.0]
[2025-11-05 08:36:59.263052 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:36:59.263107 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 313
[2025-11-05 08:36:59.263149 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 168
[2025-11-05 08:36:59.263177 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 73
[2025-11-05 08:36:59.263205 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 159
[2025-11-05 08:36:59.263232 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 843
[2025-11-05 08:36:59.263270 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_error_code(const cre2_regexp_t * re),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 08:36:59.264096 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 169, quiet_round: 0, discovered_api_pairs: 3032
[2025-11-05 08:36:59.311063 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:36:59.311420 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_error_code(const cre2_regexp_t * re),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    const char *compiled_pat = NULL;\n    const char *found_name = NULL;\n    int found_index = -1;\n    int num_groups = 0;\n    char scratch[32];\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_never_nl(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    compiled_pat = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    num_groups = cre2_num_capturing_groups(re);\n    memset(scratch, 0, sizeof(scratch));\n    (void)cre2_named_groups_iter_next(iter, &found_name, &found_index);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)(opt != NULL) + (long)(re != NULL)\n               + (long)(iter != NULL) + (long)(compiled_pat != NULL) + (long)(found_name != NULL)\n               + (long)(found_index) + (long)scratch[0];\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"helloworld hello world\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int num_groups = 0;\n    int replace_rc = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$0\", 2);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 2;\n\n    num_groups = cre2_num_capturing_groups(re);\n    replace_rc = cre2_replace(pattern, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)replace_rc + (long)text_and_target_str.length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:37:52.243259 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 52s
[2025-11-05 08:37:52.243388 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29350, Completion: 26927, Total: 56277
[2025-11-05 08:37:52.243410 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:37:52.461731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001690/id_001690.cc
[2025-11-05 08:37:52.461784 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:52.691557 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:52.691629 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:52.694344 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:52.694375 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:52.911977 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001691/id_001691.cc
[2025-11-05 08:37:52.912031 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:53.141316 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:53.141389 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:53.143911 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:53.143943 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:53.363662 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001692/id_001692.cc
[2025-11-05 08:37:53.363749 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:53.593710 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:53.593782 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:53.596779 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:53.596813 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:53.814588 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001693/id_001693.cc
[2025-11-05 08:37:53.814642 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:54.046844 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:54.046904 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:54.049831 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:54.049865 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:54.268217 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001694/id_001694.cc
[2025-11-05 08:37:54.268273 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:54.497940 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:54.498045 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:54.500923 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:54.500955 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:54.718858 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001695/id_001695.cc
[2025-11-05 08:37:54.718914 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:54.949150 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:54.949220 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:54.951738 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:54.951770 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:55.170365 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001696/id_001696.cc
[2025-11-05 08:37:55.170425 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:55.398350 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:55.398428 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:55.401655 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:55.401688 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:55.619280 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001697/id_001697.cc
[2025-11-05 08:37:55.619378 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:55.849690 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:55.849766 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:55.852333 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:55.852365 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:56.071108 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001698/id_001698.cc
[2025-11-05 08:37:56.071165 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:56.300434 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:56.300507 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:56.303515 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:56.303547 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:56.522764 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001699/id_001699.cc
[2025-11-05 08:37:56.522819 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:37:56.754149 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:37:56.754247 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:37:56.756961 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:37:56.756988 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:37:56.757026 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:37:56.757041 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1700, succ: 1699, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:37:56.757056 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:37:56.757085 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:37:57.064761 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1699 as an example for the next prompt.
[2025-11-05 08:37:57.064816 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 08:37:57.064850 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 08:37:57.064899 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,173.0,161.0,40.0,41.0,110.0,101.0,43.0,318.0,16.0,33.0,440.0,168.0,37.0,144.0,38.0,233.0,127.0,172.0,137.0,139.0,79.0,79.0,27.0,18.0,58.0,169.0,128.0,16.0,24.0,148.0,256.0,28.0,844.0,278.0,230.0,44.0,88.0,107.0,38.0,385.0,42.0,85.0,167.0,30.0,10.0,107.0,315.0,16.0,16.0,196.0,70.0,52.0,83.0,25.0,342.0,30.0,67.0,59.0,51.0,214.0,63.0,236.0,56.0,49.0,16.0]
[2025-11-05 08:37:57.064917 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:37:57.064970 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 139
[2025-11-05 08:37:57.065003 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace energy: 42
[2025-11-05 08:37:57.065031 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 318
[2025-11-05 08:37:57.065057 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 167
[2025-11-05 08:37:57.065097 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_dot_nl energy: 56
[2025-11-05 08:37:57.065133 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_set_delete(cre2_set * set),
    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_opt_dot_nl(cre2_options_t * opt)
[2025-11-05 08:37:57.065958 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 170, quiet_round: 0, discovered_api_pairs: 3043
[2025-11-05 08:37:57.109301 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:37:57.109652 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_set_delete(cre2_set * set),\n    int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_opt_dot_nl(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"helloworld hello world\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int num_groups = 0;\n    int replace_rc = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$0\", 2);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 2;\n\n    num_groups = cre2_num_capturing_groups(re);\n    replace_rc = cre2_replace(pattern, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)replace_rc + (long)text_and_target_str.length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char source_text[] = \"foobarbaz\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[64];\n    char target_buf[64];\n    char rewrite_buf[] = \"$1-$2\";\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t pmatch[3];\n    int rc_partial = 0;\n    int rc_extract = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    text_str.data = text_buf;\n    text_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = (int)(sizeof(rewrite_buf) - 1);\n    target_str.data = target_buf;\n    target_str.length = 0;\n    memset(pmatch, 0, sizeof(pmatch));\n    rc_partial = cre2_partial_match(pattern, &text_str, pmatch, 3);\n    rc_extract = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n    err_code = cre2_error_code(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)rc_partial + (long)rc_extract + (long)err_code + (long)enc + (long)text_str.length + (long)target_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:38:43.949947 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 08:38:43.950056 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30240, Completion: 27056, Total: 57296
[2025-11-05 08:38:43.950076 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:38:44.167146 +00:00] WARN [src/fuzzer.rs:205] Program 1700 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001700/id_001700.cc:37:5: error: no matching function for call to 'cre2_opt_dot_nl'
   37 |     cre2_opt_dot_nl(opt, 1);
      |     ^~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:38:44.210546 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:38:44.210890 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"abx\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[64];\n    char rewrite_buf[16];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t pmatch[4];\n    int num_groups = 0;\n    int rc_partial = 0;\n    int rc_replace = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_dot_nl(opt, 1);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Prepare buffers and structures\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1$2\", 4);\n    memset(pmatch, 0, sizeof(pmatch));\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 4;\n\n    // step 4: Core API operations\n    num_groups = cre2_num_capturing_groups(re);\n    rc_partial = cre2_partial_match(pattern, &text_and_target_str, pmatch, 4);\n    rc_replace = cre2_replace(pattern, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate results\n    checksum = (long)pattern_len + (long)num_groups + (long)rc_partial + (long)rc_replace + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n    cre2_set_delete(set);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001700/id_001700.cc:37:5: error: no matching function for call to 'cre2_opt_dot_nl'\n   37 |     cre2_opt_dot_nl(opt, 1);\n      |     ^~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:39:05.469320 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 08:39:05.469437 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23600, Completion: 15848, Total: 39448
[2025-11-05 08:39:05.687417 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001700/id_001700.cc
[2025-11-05 08:39:05.687470 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:05.916011 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:05.916087 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:05.918830 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:05.918862 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:05.918896 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1700!
[2025-11-05 08:39:06.136875 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001701/id_001701.cc
[2025-11-05 08:39:06.136928 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:06.365806 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:06.365884 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:06.368639 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:06.368666 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:06.586697 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001702/id_001702.cc
[2025-11-05 08:39:06.586800 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:06.816747 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:06.816826 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:06.819521 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:06.819553 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:07.038218 +00:00] WARN [src/fuzzer.rs:205] Program 1703 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001703/id_001703.cc:37:5: error: no matching function for call to 'cre2_opt_dot_nl'
   37 |     cre2_opt_dot_nl(opt, 1);
      |     ^~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:39:07.081657 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:39:07.081998 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobarbaz foobar foo\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t pmatch[8];\n    int num_groups = 0;\n    int rc_partial = 0;\n    int replace_rc = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_dot_nl(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 4: Operate\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 6);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 6;\n\n    memset(pmatch, 0, sizeof(pmatch));\n    num_groups = cre2_num_capturing_groups(re);\n    rc_partial = cre2_partial_match(pattern, &text_and_target_str, pmatch, 8);\n    replace_rc = cre2_replace(pattern, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)rc_partial + (long)replace_rc + (long)text_and_target_str.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n    cre2_set_delete(set);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001703/id_001703.cc:37:5: error: no matching function for call to 'cre2_opt_dot_nl'\n   37 |     cre2_opt_dot_nl(opt, 1);\n      |     ^~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:78:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   78 | cre2_decl int cre2_opt_dot_nl                   (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:39:29.408266 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 22s
[2025-11-05 08:39:29.408390 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23530, Completion: 16164, Total: 39694
[2025-11-05 08:39:29.627960 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001703/id_001703.cc
[2025-11-05 08:39:29.628014 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:29.857329 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:29.857399 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:29.860262 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:29.860295 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:29.860328 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1703!
[2025-11-05 08:39:30.078112 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001704/id_001704.cc
[2025-11-05 08:39:30.078165 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:30.306537 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:30.306596 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:30.309407 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:30.309438 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:30.528062 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001705/id_001705.cc
[2025-11-05 08:39:30.528148 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:30.758739 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:30.758808 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:30.761673 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:30.761704 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:30.980830 +00:00] WARN [src/fuzzer.rs:205] Program 1706 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001706/id_001706.cc:42:11: error: no matching function for call to 'cre2_set_new'
   42 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:39:31.024199 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:39:31.024547 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobar foo\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_str;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t pmatch[3];\n    int num_groups = 0;\n    int rc_partial = 0;\n    int rc_replace = 0;\n    int dot_nl_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_dot_nl(opt, 1);\n    dot_nl_flag = cre2_opt_dot_nl(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, 0);\n\n    // step 3: Configure\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = (int)(sizeof(rewrite_buf) - 1);\n    text_str.data = text_and_target_buf;\n    text_str.length = source_text_len;\n    pmatch[0].data = NULL; pmatch[0].length = 0;\n    pmatch[1].data = NULL; pmatch[1].length = 0;\n    pmatch[2].data = NULL; pmatch[2].length = 0;\n\n    // step 4: Operate\n    num_groups = cre2_num_capturing_groups(re);\n    rc_partial = cre2_partial_match(pattern, &text_str, pmatch, 3);\n    rc_replace = cre2_replace(pattern, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = 0;\n    checksum += (long)pattern_len;\n    checksum += (long)num_groups;\n    checksum += (long)rc_partial;\n    checksum += (long)rc_replace;\n    checksum += (long)dot_nl_flag;\n    checksum += (long)text_and_target_str.length;\n    checksum += (long)(opt != NULL);\n    checksum += (long)(re != NULL);\n    checksum += (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n    cre2_set_delete(set);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001706/id_001706.cc:42:11: error: no matching function for call to 'cre2_set_new'\n   42 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:39:47.638186 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 16s
[2025-11-05 08:39:47.638312 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24710, Completion: 13717, Total: 38427
[2025-11-05 08:39:47.856239 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001706/id_001706.cc
[2025-11-05 08:39:47.856292 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:48.085786 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:48.085855 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:48.088586 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:48.088618 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:48.088661 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1706!
[2025-11-05 08:39:48.305695 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001707/id_001707.cc
[2025-11-05 08:39:48.305749 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:48.534927 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:48.534998 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:48.537715 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:48.537749 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:48.757268 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001708/id_001708.cc
[2025-11-05 08:39:48.757355 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:48.986038 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:48.986118 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:48.988981 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:48.989013 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:49.207385 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001709/id_001709.cc
[2025-11-05 08:39:49.207441 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:39:49.437477 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:39:49.437545 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:39:49.440301 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:39:49.440335 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:39:49.440374 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:39:49.440390 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1710, succ: 1709, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:39:49.440406 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:39:49.440430 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:39:49.747394 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1709 as an example for the next prompt.
[2025-11-05 08:39:49.747451 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 23 new API pairs in this round.
[2025-11-05 08:39:49.747495 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 23
[2025-11-05 08:39:49.747544 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,173.0,161.0,40.0,41.0,110.0,101.0,43.0,327.0,16.0,33.0,444.0,168.0,37.0,144.0,38.0,235.0,127.0,172.0,137.0,142.0,79.0,79.0,27.0,18.0,58.0,170.0,128.0,16.0,24.0,148.0,256.0,28.0,846.0,278.0,235.0,44.0,88.0,107.0,38.0,385.0,51.0,85.0,176.0,30.0,10.0,107.0,315.0,16.0,16.0,196.0,70.0,52.0,84.0,25.0,342.0,30.0,67.0,59.0,51.0,214.0,63.0,236.0,59.0,52.0,16.0]
[2025-11-05 08:39:49.747561 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:39:49.747613 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 846
[2025-11-05 08:39:49.747646 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 168
[2025-11-05 08:39:49.747685 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 110
[2025-11-05 08:39:49.747714 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 170
[2025-11-05 08:39:49.747742 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 196
[2025-11-05 08:39:49.747782 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_program_size(const cre2_regexp_t * re),
    int cre2_set_compile(cre2_set * set),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 08:39:49.748590 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 171, quiet_round: 0, discovered_api_pairs: 3066
[2025-11-05 08:39:49.807973 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:39:49.808364 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_program_size(const cre2_regexp_t * re),\n    int cre2_set_compile(cre2_set * set),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char source_text[] = \"foobarbaz\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[64];\n    char target_buf[64];\n    char rewrite_buf[] = \"$1-$2\";\n    cre2_string_t text_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t target_str;\n    cre2_string_t pmatch[3];\n    int rc_partial = 0;\n    int rc_extract = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n\n    // step 3: Configure\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(target_buf, 0, sizeof(target_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    text_str.data = text_buf;\n    text_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = (int)(sizeof(rewrite_buf) - 1);\n    target_str.data = target_buf;\n    target_str.length = 0;\n    memset(pmatch, 0, sizeof(pmatch));\n    rc_partial = cre2_partial_match(pattern, &text_str, pmatch, 3);\n    rc_extract = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n    err_code = cre2_error_code(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)rc_partial + (long)rc_extract + (long)err_code + (long)enc + (long)text_str.length + (long)target_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ab)(c)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"abc abc ab\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[64];\n    char rewrite_buf[16];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t text_str;\n    cre2_string_t pmatch[4];\n    int rc_partial = 0;\n    int rc_replace = 0;\n    int num_groups = 0;\n    int dot_nl_flag = 0;\n    long checksum = 0;\n    cre2_set * set_ptr = NULL;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure / Operate\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    text_str.data = text_and_target_buf;\n    text_str.length = source_text_len;\n\n    pmatch[0].data = NULL; pmatch[0].length = 0;\n    pmatch[1].data = NULL; pmatch[1].length = 0;\n    pmatch[2].data = NULL; pmatch[2].length = 0;\n    pmatch[3].data = NULL; pmatch[3].length = 0;\n\n    rc_partial = cre2_partial_match(pattern, &text_str, pmatch, 3);\n    rc_replace = cre2_replace(pattern, &text_and_target_str, &rewrite_str);\n    num_groups = cre2_num_capturing_groups(re);\n    dot_nl_flag = cre2_opt_dot_nl(opt);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)rc_partial + (long)rc_replace + (long)num_groups + (long)dot_nl_flag + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n    cre2_set_delete(set_ptr);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:40:22.585261 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 08:40:22.585383 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32970, Completion: 21607, Total: 54577
[2025-11-05 08:40:22.585403 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:40:22.805881 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001710/id_001710.cc
[2025-11-05 08:40:22.805935 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:23.038074 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:23.038132 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:23.040922 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:23.040954 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:23.265681 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001711/id_001711.cc
[2025-11-05 08:40:23.265735 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:23.497635 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:23.497716 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:23.500278 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:23.500309 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:23.721589 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001712/id_001712.cc
[2025-11-05 08:40:23.721673 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:23.952923 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:23.952982 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:23.955819 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:23.955853 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:24.174667 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001713/id_001713.cc
[2025-11-05 08:40:24.174721 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:24.404911 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:24.404988 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:24.407568 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:24.407600 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:24.628255 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001714/id_001714.cc
[2025-11-05 08:40:24.628309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:24.857910 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:24.858027 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:24.860773 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:24.860806 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:25.081850 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001715/id_001715.cc
[2025-11-05 08:40:25.081904 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:25.313876 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:25.313936 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:25.316737 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:25.316770 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:25.535840 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001716/id_001716.cc
[2025-11-05 08:40:25.535893 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:25.766132 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:25.766209 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:25.769092 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:25.769127 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:25.987212 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001717/id_001717.cc
[2025-11-05 08:40:25.987309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:26.218824 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:26.218899 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:26.221652 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:26.221686 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:26.439733 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001718/id_001718.cc
[2025-11-05 08:40:26.439789 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:26.669251 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:26.669331 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:26.672224 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:26.672255 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:26.891977 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001719/id_001719.cc
[2025-11-05 08:40:26.892037 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:27.122971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:27.123088 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:27.125968 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:27.126000 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:27.126039 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:40:27.126054 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1720, succ: 1719, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:40:27.126069 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:40:27.126094 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:40:27.426403 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1719 as an example for the next prompt.
[2025-11-05 08:40:27.426460 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 29 new API pairs in this round.
[2025-11-05 08:40:27.426507 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 29
[2025-11-05 08:40:27.426554 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,173.0,161.0,40.0,41.0,126.0,101.0,43.0,327.0,16.0,33.0,445.0,183.0,37.0,144.0,38.0,236.0,127.0,172.0,137.0,142.0,79.0,79.0,27.0,18.0,58.0,180.0,128.0,16.0,24.0,148.0,256.0,28.0,847.0,278.0,237.0,44.0,88.0,107.0,38.0,385.0,51.0,85.0,176.0,33.0,10.0,107.0,315.0,16.0,16.0,204.0,70.0,52.0,84.0,25.0,342.0,30.0,67.0,59.0,51.0,214.0,63.0,245.0,59.0,52.0,16.0]
[2025-11-05 08:40:27.426573 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:40:27.426626 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_next energy: 79
[2025-11-05 08:40:27.426657 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 385
[2025-11-05 08:40:27.426684 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 148
[2025-11-05 08:40:27.426709 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 173
[2025-11-05 08:40:27.426747 +00:00] INFO [src/request/prompt.rs:145] set combination: bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)
[2025-11-05 08:40:27.427470 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 172, quiet_round: 0, discovered_api_pairs: 3095
[2025-11-05 08:40:27.477667 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:40:27.478034 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nbool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(ab)(c)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"abc abc ab\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[64];\n    char rewrite_buf[16];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    cre2_string_t text_str;\n    cre2_string_t pmatch[4];\n    int rc_partial = 0;\n    int rc_replace = 0;\n    int num_groups = 0;\n    int dot_nl_flag = 0;\n    long checksum = 0;\n    cre2_set * set_ptr = NULL;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure / Operate\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    text_str.data = text_and_target_buf;\n    text_str.length = source_text_len;\n\n    pmatch[0].data = NULL; pmatch[0].length = 0;\n    pmatch[1].data = NULL; pmatch[1].length = 0;\n    pmatch[2].data = NULL; pmatch[2].length = 0;\n    pmatch[3].data = NULL; pmatch[3].length = 0;\n\n    rc_partial = cre2_partial_match(pattern, &text_str, pmatch, 3);\n    rc_replace = cre2_replace(pattern, &text_and_target_str, &rewrite_str);\n    num_groups = cre2_num_capturing_groups(re);\n    dot_nl_flag = cre2_opt_dot_nl(opt);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)rc_partial + (long)rc_replace + (long)num_groups + (long)dot_nl_flag + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n    cre2_set_delete(set_ptr);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char extra_pattern[] = \"baz\";\n    const int extra_pattern_len = (int)(sizeof(extra_pattern) - 1);\n    const char source_text[] = \"foobarbaz and foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set_ptr = NULL;\n    cre2_string_t pmatch[4];\n    int match_result = 0;\n    int prog_size = 0;\n    int set_compile_res = 0;\n    int set_match_indices[8];\n    size_t set_matches = 0;\n    char set_errbuf[64];\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n    set_ptr = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    memset(set_errbuf, 0, sizeof(set_errbuf));\n    cre2_set_add_simple(set_ptr, \"foo\");\n    cre2_set_add(set_ptr, extra_pattern, (size_t)extra_pattern_len, set_errbuf, sizeof(set_errbuf));\n    pmatch[0].data = NULL; pmatch[0].length = 0;\n    pmatch[1].data = NULL; pmatch[1].length = 0;\n    pmatch[2].data = NULL; pmatch[2].length = 0;\n    pmatch[3].data = NULL; pmatch[3].length = 0;\n    memset(set_match_indices, 0, sizeof(set_match_indices));\n\n    // step 4: Core operations\n    set_compile_res = cre2_set_compile(set_ptr);\n    prog_size = cre2_program_size(re);\n    match_result = cre2_match(re, source_text, source_text_len, 0, source_text_len, CRE2_UNANCHORED, pmatch, 4);\n    set_matches = cre2_set_match(set_ptr, source_text, (size_t)source_text_len, set_match_indices, sizeof(set_match_indices) / sizeof(set_match_indices[0]));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)match_result + (long)prog_size + (long)set_compile_res + (long)set_matches + (long)pmatch[0].length + (long)pmatch[1].length + (long)(set_errbuf[0]);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set_ptr);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:40:58.144721 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 08:40:58.144847 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33650, Completion: 26178, Total: 59828
[2025-11-05 08:40:58.144868 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:40:58.362374 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001720/id_001720.cc
[2025-11-05 08:40:58.362426 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:58.591188 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:58.591264 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:58.594562 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:58.594612 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:58.813154 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001721/id_001721.cc
[2025-11-05 08:40:58.813207 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:59.042211 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:59.042288 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:59.045408 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:59.045440 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:59.264874 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001722/id_001722.cc
[2025-11-05 08:40:59.264959 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:59.495605 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:59.495685 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:59.498715 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:59.498748 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:40:59.716832 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001723/id_001723.cc
[2025-11-05 08:40:59.716888 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:40:59.946575 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:40:59.946653 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:40:59.949842 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:40:59.949875 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:00.167907 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001724/id_001724.cc
[2025-11-05 08:41:00.167961 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:00.397984 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:00.398101 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:00.401355 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:00.401387 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:00.618330 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001725/id_001725.cc
[2025-11-05 08:41:00.618384 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:00.848840 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:00.848918 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:00.851814 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:00.851846 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:01.069040 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001726/id_001726.cc
[2025-11-05 08:41:01.069095 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:01.298622 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:01.298700 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:01.301529 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:01.301559 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:01.518621 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001727/id_001727.cc
[2025-11-05 08:41:01.518706 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:01.746626 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:01.746703 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:01.749987 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:01.750021 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:01.966590 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001728/id_001728.cc
[2025-11-05 08:41:01.966645 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:02.195886 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:02.195962 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:02.199090 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:02.199118 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:02.416410 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001729/id_001729.cc
[2025-11-05 08:41:02.416464 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:02.645298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:02.645415 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:02.648418 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:02.648452 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:02.648490 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:41:02.648506 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1730, succ: 1729, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:41:02.648522 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:41:02.648548 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:41:02.959401 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1729 as an example for the next prompt.
[2025-11-05 08:41:02.959458 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 08:41:02.959495 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 08:41:02.959542 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,179.0,161.0,40.0,41.0,126.0,101.0,43.0,327.0,16.0,33.0,445.0,183.0,37.0,144.0,38.0,236.0,127.0,172.0,137.0,142.0,88.0,79.0,27.0,18.0,58.0,180.0,128.0,16.0,24.0,148.0,256.0,28.0,848.0,283.0,237.0,44.0,88.0,107.0,38.0,394.0,51.0,85.0,176.0,33.0,10.0,107.0,315.0,16.0,16.0,204.0,70.0,52.0,84.0,25.0,342.0,30.0,67.0,59.0,51.0,216.0,63.0,245.0,59.0,52.0,16.0]
[2025-11-05 08:41:02.959560 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:41:02.959613 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 179
[2025-11-05 08:41:02.959652 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 315
[2025-11-05 08:41:02.959694 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 172
[2025-11-05 08:41:02.959722 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_nl energy: 38
[2025-11-05 08:41:02.959776 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 41
[2025-11-05 08:41:02.959812 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_error_code(const cre2_regexp_t * re),
    int cre2_opt_never_nl(cre2_options_t * opt),
    int cre2_opt_perl_classes(cre2_options_t * opt)
[2025-11-05 08:41:02.960650 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 173, quiet_round: 0, discovered_api_pairs: 3110
[2025-11-05 08:41:02.994625 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:41:02.994970 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_error_code(const cre2_regexp_t * re),\n    int cre2_opt_never_nl(cre2_options_t * opt),\n    int cre2_opt_perl_classes(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char extra_pattern[] = \"baz\";\n    const int extra_pattern_len = (int)(sizeof(extra_pattern) - 1);\n    const char source_text[] = \"foobarbaz and foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set_ptr = NULL;\n    cre2_string_t pmatch[4];\n    int match_result = 0;\n    int prog_size = 0;\n    int set_compile_res = 0;\n    int set_match_indices[8];\n    size_t set_matches = 0;\n    char set_errbuf[64];\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    re = cre2_new(pattern, pattern_len, opt);\n    set_ptr = cre2_set_new(opt, CRE2_UNANCHORED);\n\n    // step 3: Configure\n    memset(set_errbuf, 0, sizeof(set_errbuf));\n    cre2_set_add_simple(set_ptr, \"foo\");\n    cre2_set_add(set_ptr, extra_pattern, (size_t)extra_pattern_len, set_errbuf, sizeof(set_errbuf));\n    pmatch[0].data = NULL; pmatch[0].length = 0;\n    pmatch[1].data = NULL; pmatch[1].length = 0;\n    pmatch[2].data = NULL; pmatch[2].length = 0;\n    pmatch[3].data = NULL; pmatch[3].length = 0;\n    memset(set_match_indices, 0, sizeof(set_match_indices));\n\n    // step 4: Core operations\n    set_compile_res = cre2_set_compile(set_ptr);\n    prog_size = cre2_program_size(re);\n    match_result = cre2_match(re, source_text, source_text_len, 0, source_text_len, CRE2_UNANCHORED, pmatch, 4);\n    set_matches = cre2_set_match(set_ptr, source_text, (size_t)source_text_len, set_match_indices, sizeof(set_match_indices) / sizeof(set_match_indices[0]));\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)match_result + (long)prog_size + (long)set_compile_res + (long)set_matches + (long)pmatch[0].length + (long)pmatch[1].length + (long)(set_errbuf[0]);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set_ptr);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[64];\n    char rewrite_buf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t match_arr[4];\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    const char * found_name = NULL;\n    int found_index = -1;\n    bool iter_res = false;\n    int easy_match_res = 0;\n    int replace_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    match_arr[0].data = NULL; match_arr[0].length = 0;\n    match_arr[1].data = NULL; match_arr[1].length = 0;\n    match_arr[2].data = NULL; match_arr[2].length = 0;\n    match_arr[3].data = NULL; match_arr[3].length = 0;\n\n    // step 4: Operate / Validate\n    easy_match_res = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, match_arr, 4);\n    iter_res = cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    checksum = (long)pattern_len + (long)source_text_len + (long)easy_match_res + (long)replace_res + (long)iter_res + (long)found_index + (long)match_arr[0].length + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:41:30.051020 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 08:41:30.051151 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33830, Completion: 21745, Total: 55575
[2025-11-05 08:41:30.051174 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:41:30.269326 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001730/id_001730.cc
[2025-11-05 08:41:30.269392 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:30.500231 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:30.500304 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:30.503095 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:30.503127 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:30.720731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001731/id_001731.cc
[2025-11-05 08:41:30.720787 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:30.950766 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:30.950835 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:30.953656 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:30.953690 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:31.172826 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001732/id_001732.cc
[2025-11-05 08:41:31.172913 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:31.401231 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:31.401304 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:31.403843 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:31.403876 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:31.623111 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001733/id_001733.cc
[2025-11-05 08:41:31.623167 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:31.853987 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:31.854056 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:31.856872 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:31.856899 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:32.074222 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001734/id_001734.cc
[2025-11-05 08:41:32.074277 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:32.303313 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:32.303411 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:32.306088 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:32.306121 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:32.523943 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001735/id_001735.cc
[2025-11-05 08:41:32.523997 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:32.754963 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:32.755024 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:32.757755 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:32.757790 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:32.976002 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001736/id_001736.cc
[2025-11-05 08:41:32.976068 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:33.206490 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:33.206568 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:33.209449 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:33.209482 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:33.427207 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001737/id_001737.cc
[2025-11-05 08:41:33.427293 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:33.657328 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:33.657406 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:33.659947 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:33.659979 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:33.878085 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001738/id_001738.cc
[2025-11-05 08:41:33.878141 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:34.107106 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:34.107182 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:34.109980 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:34.110010 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:34.328367 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001739/id_001739.cc
[2025-11-05 08:41:34.328423 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:41:34.558130 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:41:34.558245 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:41:34.561038 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:41:34.561072 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:41:34.561110 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:41:34.561126 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1740, succ: 1739, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:41:34.561141 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:41:34.561170 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:41:34.868765 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1739 as an example for the next prompt.
[2025-11-05 08:41:34.868822 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 33 new API pairs in this round.
[2025-11-05 08:41:34.868876 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 33
[2025-11-05 08:41:34.868925 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,186.0,165.0,40.0,57.0,126.0,101.0,43.0,327.0,16.0,33.0,450.0,183.0,37.0,144.0,38.0,237.0,127.0,182.0,137.0,142.0,88.0,79.0,27.0,18.0,58.0,180.0,128.0,16.0,24.0,152.0,256.0,28.0,854.0,283.0,237.0,44.0,88.0,107.0,54.0,394.0,51.0,85.0,176.0,33.0,10.0,107.0,330.0,16.0,16.0,204.0,70.0,52.0,85.0,25.0,342.0,38.0,67.0,59.0,51.0,216.0,63.0,245.0,59.0,52.0,16.0]
[2025-11-05 08:41:34.868955 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:41:34.869010 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 216
[2025-11-05 08:41:34.869042 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 204
[2025-11-05 08:41:34.869067 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 854
[2025-11-05 08:41:34.869095 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 394
[2025-11-05 08:41:34.869134 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 08:41:34.869844 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 174, quiet_round: 0, discovered_api_pairs: 3143
[2025-11-05 08:41:34.923908 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:41:34.924275 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[64];\n    char rewrite_buf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t match_arr[4];\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    const char * found_name = NULL;\n    int found_index = -1;\n    bool iter_res = false;\n    int easy_match_res = 0;\n    int replace_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    match_arr[0].data = NULL; match_arr[0].length = 0;\n    match_arr[1].data = NULL; match_arr[1].length = 0;\n    match_arr[2].data = NULL; match_arr[2].length = 0;\n    match_arr[3].data = NULL; match_arr[3].length = 0;\n\n    // step 4: Operate / Validate\n    easy_match_res = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, match_arr, 4);\n    iter_res = cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    checksum = (long)pattern_len + (long)source_text_len + (long)easy_match_res + (long)replace_res + (long)iter_res + (long)found_index + (long)match_arr[0].length + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobarbaz and foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int replace_res = 0;\n    int err_code_before = 0;\n    int enc = 0;\n    int never_nl_flag = 0;\n    int perl_classes_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_never_nl(opt, 0);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = (int)cre2_opt_encoding(opt);\n    never_nl_flag = cre2_opt_never_nl(opt);\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code_before = cre2_error_code(re);\n\n    // step 3: Configure\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    // step 4: Core operations\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)replace_res + (long)err_code_before + (long)enc + (long)never_nl_flag + (long)perl_classes_flag + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:42:09.662695 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 08:42:09.662820 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33230, Completion: 25532, Total: 58762
[2025-11-05 08:42:09.662852 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:42:09.881080 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001740/id_001740.cc
[2025-11-05 08:42:09.881133 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:10.111795 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:10.111861 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:10.115041 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:10.115072 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:10.331256 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001741/id_001741.cc
[2025-11-05 08:42:10.331309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:10.560895 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:10.560962 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:10.564045 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:10.564076 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:10.781734 +00:00] WARN [src/fuzzer.rs:205] Program 1742 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001742/id_001742.cc:47:11: error: no matching function for call to 'cre2_set_new'
   47 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:42:10.835820 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:42:10.836171 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t match_arr[4];\n    cre2_set * set = NULL;\n    int set_matches_buf[8] = { -1, -1, -1, -1, -1, -1, -1, -1 };\n    size_t set_match_res = 0;\n    int easy_match_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure buffers and match array\n    match_arr[0].data = NULL; match_arr[0].length = 0;\n    match_arr[1].data = NULL; match_arr[1].length = 0;\n    match_arr[2].data = NULL; match_arr[2].length = 0;\n    match_arr[3].data = NULL; match_arr[3].length = 0;\n\n    // step 4: Operate - run easy match and set match\n    easy_match_res = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, match_arr, 4);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, \"(foo)\");\n    cre2_set_add_simple(set, \"(bar)\");\n    cre2_set_compile(set);\n    set_match_res = cre2_set_match(set, source_text, (size_t)source_text_len, set_matches_buf, 8);\n\n    // step 5: Validate (simple checksum to make use of results)\n    checksum = (long)pattern_len + (long)source_text_len + (long)easy_match_res + (long)set_match_res + (long)(match_arr[0].length) + (long)set_matches_buf[0] + (long)(re != NULL) + (long)(opt != NULL) + (long)(set != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001742/id_001742.cc:47:11: error: no matching function for call to 'cre2_set_new'\n   47 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:42:27.482881 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 16s
[2025-11-05 08:42:27.483002 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24440, Completion: 11703, Total: 36143
[2025-11-05 08:42:27.702540 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001742/id_001742.cc
[2025-11-05 08:42:27.702592 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:27.931244 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:27.931320 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:27.934577 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:27.934608 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:27.934642 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1742!
[2025-11-05 08:42:28.153362 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001743/id_001743.cc
[2025-11-05 08:42:28.153414 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:28.386548 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:28.386622 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:28.389727 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:28.389762 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:28.608277 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001744/id_001744.cc
[2025-11-05 08:42:28.608359 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:28.837790 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:28.837867 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:28.840957 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:28.840991 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:29.057870 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001745/id_001745.cc
[2025-11-05 08:42:29.057922 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:29.288943 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:29.289020 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:29.292047 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:29.292079 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:29.510207 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001746/id_001746.cc
[2025-11-05 08:42:29.510260 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:29.740566 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:29.740691 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:29.743686 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:29.743713 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:29.962717 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001747/id_001747.cc
[2025-11-05 08:42:29.962770 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:30.192514 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:30.192572 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:30.199712 +00:00] ERROR [src/execution/sanitize.rs:336] cre2 execution failed: stderr=, stdout=
[2025-11-05 08:42:30.199768 +00:00] WARN [src/fuzzer.rs:205] Program 1747 failed validation. Attempting to repair. Error: Execution Error: cre2 execution failed: stderr=, stdout=
[2025-11-05 08:42:30.255448 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:42:30.255796 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t match_arr[4];\n    int set_match_indices[8];\n    size_t set_matched = 0;\n    int easy_match_res = 0;\n    int set_add_res = 0;\n    int set_compile_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n    set_compile_res = cre2_set_compile(set);\n\n    // step 3: Configure\n    match_arr[0].data = NULL; match_arr[0].length = 0;\n    match_arr[1].data = NULL; match_arr[1].length = 0;\n    match_arr[2].data = NULL; match_arr[2].length = 0;\n    match_arr[3].data = NULL; match_arr[3].length = 0;\n    set_match_indices[0] = -1; set_match_indices[1] = -1; set_match_indices[2] = -1; set_match_indices[3] = -1;\n    set_match_indices[4] = -1; set_match_indices[5] = -1; set_match_indices[6] = -1; set_match_indices[7] = -1;\n\n    // step 4: Operate / Validate\n    easy_match_res = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, match_arr, 4);\n    set_matched = cre2_set_match(set, source_text, (size_t)source_text_len, set_match_indices, 8);\n    checksum = (long)pattern_len + (long)source_text_len + (long)easy_match_res + (long)set_add_res + (long)set_compile_res + (long)set_matched + (long)set_match_indices[0] + (long)match_arr[0].length + (long)(re != NULL) + (long)(iter != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Execution Error\nError Details:cre2 execution failed: stderr=, stdout=\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:42:56.944340 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 08:42:56.944462 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23170, Completion: 18904, Total: 42074
[2025-11-05 08:42:57.166515 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001747/id_001747.cc
[2025-11-05 08:42:57.166567 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:57.395616 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:57.395689 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:57.398753 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:57.398787 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:57.398822 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1747!
[2025-11-05 08:42:57.615496 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001748/id_001748.cc
[2025-11-05 08:42:57.615550 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:57.843824 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:57.843894 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:57.846775 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:57.846806 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:58.065037 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001749/id_001749.cc
[2025-11-05 08:42:58.065118 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:42:58.298605 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:42:58.298678 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:42:58.301789 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:42:58.301820 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:42:58.301858 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:42:58.301875 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1750, succ: 1749, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:42:58.301890 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:42:58.301916 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:42:58.605565 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1749 as an example for the next prompt.
[2025-11-05 08:42:58.605622 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 08:42:58.605656 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 08:42:58.605705 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,186.0,165.0,40.0,57.0,126.0,101.0,43.0,327.0,16.0,33.0,450.0,183.0,37.0,144.0,38.0,237.0,127.0,182.0,137.0,142.0,91.0,79.0,27.0,18.0,58.0,181.0,128.0,16.0,24.0,152.0,256.0,28.0,854.0,286.0,241.0,44.0,88.0,107.0,54.0,402.0,51.0,85.0,176.0,33.0,10.0,107.0,330.0,16.0,16.0,210.0,70.0,52.0,85.0,25.0,342.0,38.0,67.0,59.0,51.0,219.0,63.0,248.0,59.0,52.0,16.0]
[2025-11-05 08:42:58.605731 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:42:58.605783 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 327
[2025-11-05 08:42:58.605817 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 186
[2025-11-05 08:42:58.605845 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 241
[2025-11-05 08:42:58.605871 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 127
[2025-11-05 08:42:58.605903 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag)
[2025-11-05 08:42:58.606601 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 175, quiet_round: 0, discovered_api_pairs: 3155
[2025-11-05 08:42:58.644063 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:42:58.644417 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobarbaz and foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int replace_res = 0;\n    int err_code_before = 0;\n    int enc = 0;\n    int never_nl_flag = 0;\n    int perl_classes_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_never_nl(opt, 0);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    enc = (int)cre2_opt_encoding(opt);\n    never_nl_flag = cre2_opt_never_nl(opt);\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code_before = cre2_error_code(re);\n\n    // step 3: Configure\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    // step 4: Core operations\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)replace_res + (long)err_code_before + (long)enc + (long)never_nl_flag + (long)perl_classes_flag + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t match_arr[4];\n    int match_indices[8];\n    cre2_set * set = NULL;\n    size_t set_match_count = 0;\n    int easy_match_res = 0;\n    int set_compile_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    match_arr[0].data = NULL; match_arr[0].length = 0;\n    match_arr[1].data = NULL; match_arr[1].length = 0;\n    match_arr[2].data = NULL; match_arr[2].length = 0;\n    match_arr[3].data = NULL; match_arr[3].length = 0;\n    memset(match_indices, 0, sizeof(match_indices));\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n    set_compile_res = cre2_set_compile(set);\n\n    // step 4: Operate / Validate\n    easy_match_res = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, match_arr, 4);\n    set_match_count = cre2_set_match(set, source_text, (size_t)source_text_len, match_indices, (size_t)8);\n    checksum = (long)pattern_len + (long)source_text_len + (long)easy_match_res + (long)set_compile_res + (long)set_match_count + (long)(re != NULL) + (long)(opt != NULL) + (long)match_arr[0].length + (long)match_indices[0];\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:43:23.910933 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 25s
[2025-11-05 08:43:23.911058 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32260, Completion: 20406, Total: 52666
[2025-11-05 08:43:23.911078 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:43:24.128568 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001750/id_001750.cc
[2025-11-05 08:43:24.128642 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:24.358961 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:24.359036 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:24.361916 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:24.361949 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:24.581070 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001751/id_001751.cc
[2025-11-05 08:43:24.581123 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:24.812115 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:24.812190 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:24.814974 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:24.815006 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:25.034034 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001752/id_001752.cc
[2025-11-05 08:43:25.034119 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:25.264241 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:25.264316 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:25.267072 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:25.267104 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:25.485467 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001753/id_001753.cc
[2025-11-05 08:43:25.485521 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:25.714649 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:25.714726 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:25.717615 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:25.717647 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:25.935313 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001754/id_001754.cc
[2025-11-05 08:43:25.935367 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:26.165284 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:26.165398 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:26.168151 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:26.168186 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:26.386029 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001755/id_001755.cc
[2025-11-05 08:43:26.386083 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:26.615559 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:26.615634 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:26.618556 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:26.618589 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:26.836307 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001756/id_001756.cc
[2025-11-05 08:43:26.836372 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:27.066198 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:27.066272 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:27.068988 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:27.069019 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:27.286639 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001757/id_001757.cc
[2025-11-05 08:43:27.286723 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:27.516385 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:27.516461 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:27.519202 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:27.519229 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:27.736322 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001758/id_001758.cc
[2025-11-05 08:43:27.736376 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:27.966158 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:27.966234 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:27.968956 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:27.968988 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:28.186981 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001759/id_001759.cc
[2025-11-05 08:43:28.187034 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:28.416517 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:28.416642 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:28.419404 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:28.419431 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:28.419468 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:43:28.419483 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1760, succ: 1759, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:43:28.419498 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:43:28.419523 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:43:28.717925 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1759 as an example for the next prompt.
[2025-11-05 08:43:28.717982 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 08:43:28.718021 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 08:43:28.718069 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,199.0,165.0,40.0,57.0,126.0,101.0,43.0,335.0,16.0,33.0,450.0,183.0,37.0,144.0,38.0,237.0,127.0,182.0,137.0,145.0,91.0,79.0,27.0,18.0,58.0,184.0,128.0,16.0,24.0,152.0,256.0,28.0,855.0,286.0,244.0,44.0,88.0,107.0,54.0,402.0,51.0,85.0,176.0,33.0,10.0,107.0,330.0,16.0,16.0,213.0,70.0,52.0,85.0,25.0,342.0,38.0,67.0,59.0,51.0,219.0,63.0,252.0,59.0,52.0,16.0]
[2025-11-05 08:43:28.718099 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:43:28.718151 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 252
[2025-11-05 08:43:28.718185 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 67
[2025-11-05 08:43:28.718210 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 199
[2025-11-05 08:43:28.718237 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 330
[2025-11-05 08:43:28.718265 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 342
[2025-11-05 08:43:28.718301 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 08:43:28.719095 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 176, quiet_round: 0, discovered_api_pairs: 3172
[2025-11-05 08:43:28.762257 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:43:28.762614 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_add_simple(cre2_set * set, const char * pattern),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foo bar foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t match_arr[4];\n    int match_indices[8];\n    cre2_set * set = NULL;\n    size_t set_match_count = 0;\n    int easy_match_res = 0;\n    int set_compile_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 3: Configure\n    match_arr[0].data = NULL; match_arr[0].length = 0;\n    match_arr[1].data = NULL; match_arr[1].length = 0;\n    match_arr[2].data = NULL; match_arr[2].length = 0;\n    match_arr[3].data = NULL; match_arr[3].length = 0;\n    memset(match_indices, 0, sizeof(match_indices));\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    cre2_set_add_simple(set, pattern);\n    set_compile_res = cre2_set_compile(set);\n\n    // step 4: Operate / Validate\n    easy_match_res = cre2_easy_match(pattern, pattern_len, source_text, source_text_len, match_arr, 4);\n    set_match_count = cre2_set_match(set, source_text, (size_t)source_text_len, match_indices, (size_t)8);\n    checksum = (long)pattern_len + (long)source_text_len + (long)easy_match_res + (long)set_compile_res + (long)set_match_count + (long)(re != NULL) + (long)(opt != NULL) + (long)match_arr[0].length + (long)match_indices[0];\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobarbaz foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int match_indices[8];\n    memset(match_indices, 0, sizeof(match_indices));\n    int group_count = 0;\n    int replace_res = 0;\n    int set_compile_res = 0;\n    size_t set_match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    group_count = cre2_num_capturing_groups(re);\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n    set = cre2_set_new(opt, (cre2_anchor_t)CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    set_compile_res = cre2_set_compile(set);\n    set_match_count = cre2_set_match(set, text_and_target_buf, (size_t)text_and_target_str.length, match_indices, (size_t)8);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)group_count + (long)replace_res + (long)set_compile_res + (long)set_match_count + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL) + (long)(set != NULL) + (long)match_indices[0];\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:43:55.861404 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 08:43:55.861527 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32670, Completion: 20182, Total: 52852
[2025-11-05 08:43:55.861549 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:43:56.079112 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001760/id_001760.cc
[2025-11-05 08:43:56.079168 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:56.309369 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:56.309447 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:56.312202 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:56.312236 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:56.529129 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001761/id_001761.cc
[2025-11-05 08:43:56.529181 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:56.758805 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:56.758882 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:56.761747 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:56.761782 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:56.980929 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001762/id_001762.cc
[2025-11-05 08:43:56.981014 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:57.212172 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:57.212249 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:57.215029 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:57.215062 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:57.433055 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001763/id_001763.cc
[2025-11-05 08:43:57.433109 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:57.661753 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:57.661830 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:57.664672 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:57.664704 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:57.884268 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001764/id_001764.cc
[2025-11-05 08:43:57.884322 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:58.114699 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:58.114819 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:58.117584 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:58.117612 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:58.335523 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001765/id_001765.cc
[2025-11-05 08:43:58.335577 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:58.564950 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:58.565027 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:58.567589 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:58.567621 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:58.786518 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001766/id_001766.cc
[2025-11-05 08:43:58.786573 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:59.014985 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:59.015055 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:59.017872 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:59.017901 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:59.236294 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001767/id_001767.cc
[2025-11-05 08:43:59.236377 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:59.466223 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:59.466297 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:59.469086 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:59.469118 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:43:59.687459 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001768/id_001768.cc
[2025-11-05 08:43:59.687515 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:43:59.916431 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:43:59.916490 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:43:59.919254 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:43:59.919284 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:00.137243 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001769/id_001769.cc
[2025-11-05 08:44:00.137296 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:00.366435 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:00.366547 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:00.369356 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:00.369390 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:00.369430 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:44:00.369446 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1770, succ: 1769, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:44:00.369461 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:44:00.369486 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:44:00.670341 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1769 as an example for the next prompt.
[2025-11-05 08:44:00.670398 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 18 new API pairs in this round.
[2025-11-05 08:44:00.670438 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 18
[2025-11-05 08:44:00.670486 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,203.0,165.0,40.0,57.0,126.0,101.0,43.0,335.0,16.0,33.0,451.0,183.0,37.0,144.0,38.0,237.0,127.0,182.0,137.0,148.0,91.0,79.0,27.0,18.0,58.0,186.0,128.0,16.0,24.0,152.0,256.0,28.0,858.0,286.0,250.0,44.0,88.0,107.0,54.0,402.0,51.0,85.0,176.0,33.0,10.0,107.0,335.0,16.0,16.0,215.0,70.0,52.0,85.0,25.0,348.0,38.0,68.0,59.0,51.0,219.0,63.0,256.0,59.0,52.0,16.0]
[2025-11-05 08:44:00.670515 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:44:00.670568 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 128
[2025-11-05 08:44:00.670601 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 250
[2025-11-05 08:44:00.670629 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 335
[2025-11-05 08:44:00.670668 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 451
[2025-11-05 08:44:00.670707 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 215
[2025-11-05 08:44:00.670745 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_delete(cre2_regexp_t * re),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 08:44:00.671566 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 177, quiet_round: 0, discovered_api_pairs: 3190
[2025-11-05 08:44:00.726917 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:44:00.727288 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_delete(cre2_regexp_t * re),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobarbaz foobar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int match_indices[8];\n    memset(match_indices, 0, sizeof(match_indices));\n    int group_count = 0;\n    int replace_res = 0;\n    int set_compile_res = 0;\n    size_t set_match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 1);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    group_count = cre2_num_capturing_groups(re);\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n    set = cre2_set_new(opt, (cre2_anchor_t)CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    set_compile_res = cre2_set_compile(set);\n    set_match_count = cre2_set_match(set, text_and_target_buf, (size_t)text_and_target_str.length, match_indices, (size_t)8);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)group_count + (long)replace_res + (long)set_compile_res + (long)set_match_count + (long)text_and_target_str.length + (long)rewrite_str.length + (long)(re != NULL) + (long)(opt != NULL) + (long)(set != NULL) + (long)match_indices[0];\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobar foo bar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int replace_res = 0;\n    int set_add_res = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char * pattern_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    // step 4: Operate\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)replace_res + (long)set_add_res + (long)enc + (long)(pattern_from_re != NULL) + (long)text_and_target_str.length + (long)rewrite_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:44:28.231822 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 08:44:28.231947 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32940, Completion: 23465, Total: 56405
[2025-11-05 08:44:28.231992 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:44:28.450418 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001770/id_001770.cc
[2025-11-05 08:44:28.450470 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:28.679613 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:28.679681 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:28.682466 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:28.682498 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:28.900777 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001771/id_001771.cc
[2025-11-05 08:44:28.900831 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:29.130601 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:29.130672 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:29.133571 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:29.133604 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:29.350668 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001772/id_001772.cc
[2025-11-05 08:44:29.350750 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:29.579939 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:29.580012 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:29.582921 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:29.582953 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:29.801731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001773/id_001773.cc
[2025-11-05 08:44:29.801786 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:30.032914 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:30.032992 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:30.035744 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:30.035776 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:30.256161 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001774/id_001774.cc
[2025-11-05 08:44:30.256215 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:30.485395 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:30.485502 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:30.488341 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:30.488372 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:30.705618 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001775/id_001775.cc
[2025-11-05 08:44:30.705672 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:30.936919 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:30.936992 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:30.939652 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:30.939685 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:31.157310 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001776/id_001776.cc
[2025-11-05 08:44:31.157364 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:31.386912 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:31.386985 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:31.389800 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:31.389833 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:31.608787 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001777/id_001777.cc
[2025-11-05 08:44:31.608873 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:31.839452 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:31.839510 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:31.842498 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:31.842532 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:32.061061 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001778/id_001778.cc
[2025-11-05 08:44:32.061115 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:32.291370 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:32.291439 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:32.294228 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:32.294260 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:32.512228 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001779/id_001779.cc
[2025-11-05 08:44:32.512281 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:44:32.742540 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:44:32.742647 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:44:32.745336 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:44:32.745368 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:44:32.745404 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:44:32.745420 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1780, succ: 1779, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:44:32.745436 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:44:32.745463 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:44:33.047791 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1779 as an example for the next prompt.
[2025-11-05 08:44:33.047847 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 08:44:33.047881 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 08:44:33.047929 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,203.0,165.0,40.0,57.0,126.0,101.0,43.0,335.0,16.0,33.0,451.0,185.0,37.0,144.0,38.0,238.0,127.0,182.0,137.0,149.0,91.0,79.0,27.0,18.0,58.0,188.0,139.0,16.0,24.0,152.0,256.0,28.0,862.0,286.0,254.0,44.0,88.0,107.0,54.0,402.0,51.0,85.0,176.0,33.0,10.0,107.0,337.0,16.0,16.0,218.0,70.0,52.0,85.0,25.0,348.0,38.0,68.0,59.0,51.0,219.0,63.0,257.0,59.0,52.0,16.0]
[2025-11-05 08:44:33.047960 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:44:33.048014 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 176
[2025-11-05 08:44:33.048047 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 337
[2025-11-05 08:44:33.048074 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 68
[2025-11-05 08:44:33.048102 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 188
[2025-11-05 08:44:33.048129 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 451
[2025-11-05 08:44:33.048164 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    int cre2_set_compile(cre2_set * set),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 08:44:33.048985 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 178, quiet_round: 0, discovered_api_pairs: 3202
[2025-11-05 08:44:33.091951 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:44:33.092308 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    int cre2_set_compile(cre2_set * set),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"foobar foo bar\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_and_target_buf[128];\n    char rewrite_buf[32];\n    memset(text_and_target_buf, 0, sizeof(text_and_target_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target_str;\n    cre2_string_t rewrite_str;\n    int replace_res = 0;\n    int set_add_res = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char * pattern_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure\n    memcpy(text_and_target_buf, source_text, (size_t)source_text_len);\n    memcpy(rewrite_buf, \"$1-$2\", 5);\n    text_and_target_str.data = text_and_target_buf;\n    text_and_target_str.length = source_text_len;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = 5;\n\n    // step 4: Operate\n    replace_res = cre2_replace_re(re, &text_and_target_str, &rewrite_str);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)replace_res + (long)set_add_res + (long)enc + (long)(pattern_from_re != NULL) + (long)text_and_target_str.length + (long)rewrite_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)|(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"prefooMIDbarPOST\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[64];\n    memset(work_buf, 0, sizeof(work_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int match_indices[8];\n    memset(match_indices, 0, sizeof(match_indices));\n    memset(ranges, 0, sizeof(ranges));\n    memset(strings, 0, sizeof(strings));\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    size_t set_match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, (cre2_anchor_t)CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n\n    // step 4: Operate\n    strings[0].data = work_buf;\n    strings[0].length = 3;                     // \"pre\"\n    strings[1].data = work_buf + 3;\n    strings[1].length = source_text_len - 3;   // \"fooMIDbarPOST\"\n    cre2_strings_to_ranges(work_buf, ranges, strings, 2);\n    set_match_count = cre2_set_match(set, work_buf, (size_t)source_text_len, match_indices, (size_t)8);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)enc + (long)set_match_count + (long)match_indices[0] + (long)ranges[0].start + (long)ranges[0].past + (long)(re != NULL) + (long)(opt != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:45:01.254371 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 08:45:01.254493 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31870, Completion: 23127, Total: 54997
[2025-11-05 08:45:01.254513 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:45:01.471929 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001780/id_001780.cc
[2025-11-05 08:45:01.471992 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:01.701509 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:01.701585 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:01.704405 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:01.704436 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:01.921771 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001781/id_001781.cc
[2025-11-05 08:45:01.921823 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:02.151033 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:02.151110 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:02.153871 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:02.153904 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:02.372193 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001782/id_001782.cc
[2025-11-05 08:45:02.372277 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:02.600446 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:02.600523 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:02.603149 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:02.603176 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:02.821555 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001783/id_001783.cc
[2025-11-05 08:45:02.821608 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:03.052104 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:03.052181 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:03.055059 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:03.055091 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:03.272450 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001784/id_001784.cc
[2025-11-05 08:45:03.272502 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:03.500335 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:03.500451 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:03.503207 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:03.503240 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:03.721464 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001785/id_001785.cc
[2025-11-05 08:45:03.721518 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:03.950755 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:03.950832 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:03.953658 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:03.953689 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:04.171576 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001786/id_001786.cc
[2025-11-05 08:45:04.171630 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:04.400329 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:04.400405 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:04.403154 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:04.403182 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:04.620680 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001787/id_001787.cc
[2025-11-05 08:45:04.620763 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:04.849875 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:04.849933 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:04.852661 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:04.852689 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:05.070969 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001788/id_001788.cc
[2025-11-05 08:45:05.071022 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:05.299897 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:05.299971 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:05.302808 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:05.302840 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:05.520560 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001789/id_001789.cc
[2025-11-05 08:45:05.520614 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:05.751140 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:05.751255 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:05.754124 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:05.754157 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:05.754194 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:45:05.754210 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1790, succ: 1789, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:45:05.754228 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:45:05.754255 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:45:06.041117 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1789 as an example for the next prompt.
[2025-11-05 08:45:06.041175 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 08:45:06.041204 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 08:45:06.041252 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,203.0,165.0,40.0,57.0,126.0,101.0,43.0,335.0,16.0,33.0,451.0,185.0,37.0,144.0,38.0,238.0,127.0,182.0,137.0,151.0,91.0,79.0,27.0,18.0,58.0,192.0,139.0,16.0,24.0,152.0,256.0,28.0,863.0,286.0,255.0,44.0,88.0,107.0,54.0,402.0,51.0,85.0,180.0,33.0,10.0,107.0,337.0,16.0,16.0,218.0,70.0,52.0,85.0,25.0,348.0,38.0,68.0,59.0,51.0,219.0,63.0,258.0,59.0,52.0,16.0]
[2025-11-05 08:45:06.041280 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:45:06.041362 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 192
[2025-11-05 08:45:06.041398 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 152
[2025-11-05 08:45:06.041425 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 337
[2025-11-05 08:45:06.041452 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 185
[2025-11-05 08:45:06.041479 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_posix_syntax energy: 43
[2025-11-05 08:45:06.041516 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_compile(cre2_set * set),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag)
[2025-11-05 08:45:06.042335 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 179, quiet_round: 0, discovered_api_pairs: 3208
[2025-11-05 08:45:06.095738 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:45:06.096101 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_compile(cre2_set * set),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)|(bar)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"prefooMIDbarPOST\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[64];\n    memset(work_buf, 0, sizeof(work_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int match_indices[8];\n    memset(match_indices, 0, sizeof(match_indices));\n    memset(ranges, 0, sizeof(ranges));\n    memset(strings, 0, sizeof(strings));\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    size_t set_match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, (cre2_anchor_t)CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n\n    // step 4: Operate\n    strings[0].data = work_buf;\n    strings[0].length = 3;                     // \"pre\"\n    strings[1].data = work_buf + 3;\n    strings[1].length = source_text_len - 3;   // \"fooMIDbarPOST\"\n    cre2_strings_to_ranges(work_buf, ranges, strings, 2);\n    set_match_count = cre2_set_match(set, work_buf, (size_t)source_text_len, match_indices, (size_t)8);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)enc + (long)set_match_count + (long)match_indices[0] + (long)ranges[0].start + (long)ranges[0].past + (long)(re != NULL) + (long)(opt != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[64];\n    char match_buf[32];\n    memset(work_buf, 0, sizeof(work_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t input_str;\n    cre2_string_t match_str;\n    int set_add_res = 0;\n    int compile_res = 0;\n    int pm_res = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n    input_str.data = work_buf;\n    input_str.length = source_text_len;\n    match_str.data = match_buf;\n    match_str.length = 0;\n\n    // step 4: Operate\n    compile_res = cre2_set_compile(set);\n    pm_res = cre2_partial_match(pattern, &input_str, &match_str, 2);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)set_add_res + (long)compile_res + (long)pm_res + (long)enc + (long)(re != NULL) + (long)match_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:45:35.199378 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 08:45:35.199505 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32120, Completion: 18870, Total: 50990
[2025-11-05 08:45:35.199527 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:45:35.416551 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001790/id_001790.cc
[2025-11-05 08:45:35.416607 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:35.646717 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:35.646795 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:35.649679 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:35.649712 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:35.868534 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001791/id_001791.cc
[2025-11-05 08:45:35.868588 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:36.098394 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:36.098463 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:36.101367 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:36.101400 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:36.317865 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001792/id_001792.cc
[2025-11-05 08:45:36.317950 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:36.549562 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:36.549622 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:36.552358 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:36.552391 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:36.770245 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001793/id_001793.cc
[2025-11-05 08:45:36.770300 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:36.998673 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:36.998743 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:37.001618 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:37.001651 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:37.218604 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001794/id_001794.cc
[2025-11-05 08:45:37.218659 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:37.449214 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:37.449303 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:37.452007 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:37.452043 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:37.670773 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001795/id_001795.cc
[2025-11-05 08:45:37.670828 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:37.900327 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:37.900399 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:37.903225 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:37.903259 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:38.121706 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001796/id_001796.cc
[2025-11-05 08:45:38.121771 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:38.351145 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:38.351222 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:38.354081 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:38.354113 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:38.571232 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001797/id_001797.cc
[2025-11-05 08:45:38.571317 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:38.798704 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:38.798778 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:38.801608 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:38.801642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:39.020326 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001798/id_001798.cc
[2025-11-05 08:45:39.020381 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:39.250712 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:39.250779 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:39.253639 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:39.253671 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:39.472314 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001799/id_001799.cc
[2025-11-05 08:45:39.472368 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:45:39.702573 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:45:39.702664 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:45:39.705412 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:45:39.705444 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:45:39.705482 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:45:39.705498 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1800, succ: 1799, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:45:39.705514 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:45:39.705542 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:45:40.004797 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1799 as an example for the next prompt.
[2025-11-05 08:45:40.004853 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 08:45:40.004884 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 08:45:40.004932 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,203.0,165.0,40.0,57.0,126.0,101.0,47.0,335.0,16.0,33.0,451.0,189.0,37.0,144.0,38.0,240.0,127.0,182.0,137.0,153.0,91.0,79.0,27.0,18.0,58.0,195.0,139.0,16.0,24.0,156.0,256.0,28.0,863.0,286.0,255.0,44.0,88.0,107.0,54.0,402.0,51.0,85.0,180.0,33.0,10.0,107.0,339.0,16.0,16.0,218.0,70.0,52.0,85.0,25.0,348.0,38.0,68.0,59.0,51.0,219.0,63.0,258.0,59.0,52.0,16.0]
[2025-11-05 08:45:40.004951 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:45:40.005014 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 335
[2025-11-05 08:45:40.005047 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 286
[2025-11-05 08:45:40.005073 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 107
[2025-11-05 08:45:40.005101 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 256
[2025-11-05 08:45:40.005131 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_num_capturing_groups(const cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_version_interface_revision(),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)
[2025-11-05 08:45:40.005832 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 180, quiet_round: 0, discovered_api_pairs: 3216
[2025-11-05 08:45:40.032980 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:45:40.033313 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_num_capturing_groups(const cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_version_interface_revision(),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[64];\n    char match_buf[32];\n    memset(work_buf, 0, sizeof(work_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t input_str;\n    cre2_string_t match_str;\n    int set_add_res = 0;\n    int compile_res = 0;\n    int pm_res = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_res = cre2_set_add_simple(set, pattern);\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n    input_str.data = work_buf;\n    input_str.length = source_text_len;\n    match_str.data = match_buf;\n    match_str.length = 0;\n\n    // step 4: Operate\n    compile_res = cre2_set_compile(set);\n    pm_res = cre2_partial_match(pattern, &input_str, &match_str, 2);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)set_add_res + (long)compile_res + (long)pm_res + (long)enc + (long)(re != NULL) + (long)match_str.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[64];\n    char match_buf[64];\n    memset(work_buf, 0, sizeof(work_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t matches[3];\n    memset(matches, 0, sizeof(matches));\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res = 0;\n    int compile_res = 0;\n    int match_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_posix_syntax(opt, 0);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, (cre2_anchor_t)CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n    matches[0].data = work_buf;\n    matches[0].length = 0;\n    matches[1].data = work_buf;\n    matches[1].length = 0;\n    matches[2].data = work_buf;\n    matches[2].length = 0;\n\n    // step 4: Operate\n    match_res = cre2_match(re, work_buf, source_text_len, 0, source_text_len, (cre2_anchor_t)CRE2_UNANCHORED, matches, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)enc + (long)add_res + (long)compile_res + (long)match_res + (long)matches[0].length + (long)matches[1].length + (long)(re != NULL) + (long)(opt != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:46:11.390744 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 08:46:11.390871 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31030, Completion: 20300, Total: 51330
[2025-11-05 08:46:11.390892 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:46:11.608466 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001800/id_001800.cc
[2025-11-05 08:46:11.608520 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:11.838435 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:11.838495 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:11.841648 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:11.841680 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:12.059937 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001801/id_001801.cc
[2025-11-05 08:46:12.060000 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:12.288227 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:12.288307 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:12.291388 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:12.291420 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:12.509586 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001802/id_001802.cc
[2025-11-05 08:46:12.509674 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:12.740232 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:12.740305 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:12.743459 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:12.743494 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:12.961459 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001803/id_001803.cc
[2025-11-05 08:46:12.961513 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:13.192017 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:13.192087 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:13.195242 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:13.195276 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:13.413949 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001804/id_001804.cc
[2025-11-05 08:46:13.414003 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:13.643543 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:13.643643 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:13.646756 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:13.646789 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:13.865189 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001805/id_001805.cc
[2025-11-05 08:46:13.865243 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:14.094338 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:14.094408 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:14.097493 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:14.097525 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:14.313175 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001806/id_001806.cc
[2025-11-05 08:46:14.313229 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:14.543027 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:14.543086 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:14.546280 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:14.546313 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:14.765780 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001807/id_001807.cc
[2025-11-05 08:46:14.765877 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:14.996379 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:14.996438 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:14.999576 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:14.999611 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:15.217419 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001808/id_001808.cc
[2025-11-05 08:46:15.217473 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:15.448537 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:15.448608 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:15.451592 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:15.451626 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:15.669286 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001809/id_001809.cc
[2025-11-05 08:46:15.669342 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:15.899297 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:15.899407 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:15.902644 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:15.902676 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:15.902715 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:46:15.902734 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1810, succ: 1809, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:46:15.902749 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:46:15.902775 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:46:16.200581 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1809 as an example for the next prompt.
[2025-11-05 08:46:16.200648 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 22 new API pairs in this round.
[2025-11-05 08:46:16.200693 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 22
[2025-11-05 08:46:16.200741 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,203.0,165.0,40.0,57.0,126.0,101.0,47.0,345.0,16.0,33.0,451.0,195.0,37.0,144.0,38.0,241.0,127.0,182.0,137.0,153.0,95.0,79.0,27.0,18.0,58.0,195.0,139.0,16.0,24.0,156.0,258.0,28.0,869.0,295.0,255.0,44.0,88.0,117.0,54.0,402.0,51.0,85.0,180.0,33.0,10.0,107.0,339.0,16.0,16.0,218.0,70.0,52.0,85.0,25.0,348.0,38.0,68.0,59.0,51.0,221.0,63.0,258.0,59.0,52.0,16.0]
[2025-11-05 08:46:16.200760 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:46:16.200815 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace energy: 51
[2025-11-05 08:46:16.200850 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 156
[2025-11-05 08:46:16.200876 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 241
[2025-11-05 08:46:16.200902 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 339
[2025-11-05 08:46:16.200934 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    cre2_options_t *cre2_opt_new(),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 08:46:16.201649 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 181, quiet_round: 0, discovered_api_pairs: 3238
[2025-11-05 08:46:16.232294 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:46:16.232668 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    cre2_options_t *cre2_opt_new(),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[64];\n    char match_buf[64];\n    memset(work_buf, 0, sizeof(work_buf));\n    memset(match_buf, 0, sizeof(match_buf));\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t matches[3];\n    memset(matches, 0, sizeof(matches));\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res = 0;\n    int compile_res = 0;\n    int match_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_posix_syntax(opt, 0);\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n\n    // step 3: Configure\n    set = cre2_set_new(opt, (cre2_anchor_t)CRE2_UNANCHORED);\n    add_res = cre2_set_add_simple(set, pattern);\n    compile_res = cre2_set_compile(set);\n    matches[0].data = work_buf;\n    matches[0].length = 0;\n    matches[1].data = work_buf;\n    matches[1].length = 0;\n    matches[2].data = work_buf;\n    matches[2].length = 0;\n\n    // step 4: Operate\n    match_res = cre2_match(re, work_buf, source_text_len, 0, source_text_len, (cre2_anchor_t)CRE2_UNANCHORED, matches, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)enc + (long)add_res + (long)compile_res + (long)match_res + (long)matches[0].length + (long)matches[1].length + (long)(re != NULL) + (long)(opt != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[128];\n    char match_buf0[64];\n    char match_buf1[64];\n    memset(work_buf, 0, sizeof(work_buf));\n    memset(match_buf0, 0, sizeof(match_buf0));\n    memset(match_buf1, 0, sizeof(match_buf1));\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    cre2_string_t matches[3];\n    memset(matches, 0, sizeof(matches));\n    const char *named = NULL;\n    int named_index = 0;\n    int num_groups = 0;\n    int version_rev = 0;\n    int match_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    version_rev = cre2_version_interface_revision();\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n    matches[0].data = work_buf;\n    matches[0].length = 0;\n    matches[1].data = work_buf;\n    matches[1].length = 0;\n    matches[2].data = work_buf;\n    matches[2].length = 0;\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    cre2_named_groups_iter_next(iter, &named, &named_index);\n    match_res = cre2_match(re, work_buf, source_text_len, 0, source_text_len, (cre2_anchor_t)0, matches, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)num_groups + (long)version_rev + (long)match_res + (long)(re != NULL) + (long)(opt != NULL) + (long)matches[0].length + (long)(named != NULL) + (long)named_index;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:46:45.483704 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 08:46:45.483825 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32360, Completion: 18608, Total: 50968
[2025-11-05 08:46:45.483846 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:46:45.701984 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001810/id_001810.cc
[2025-11-05 08:46:45.702037 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:45.932648 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:45.932719 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:45.935330 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:45.935363 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:46.155119 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001811/id_001811.cc
[2025-11-05 08:46:46.155171 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:46.384166 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:46.384244 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:46.387014 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:46.387046 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:46.603772 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001812/id_001812.cc
[2025-11-05 08:46:46.603856 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:46.832316 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:46.832389 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:46.835167 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:46.835200 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:47.053867 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001813/id_001813.cc
[2025-11-05 08:46:47.053920 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:47.284249 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:47.284318 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:47.287041 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:47.287074 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:47.505405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001814/id_001814.cc
[2025-11-05 08:46:47.505459 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:47.736254 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:47.736355 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:47.739148 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:47.739180 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:47.956731 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001815/id_001815.cc
[2025-11-05 08:46:47.956786 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:48.184992 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:48.185064 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:48.187674 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:48.187706 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:48.406890 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001816/id_001816.cc
[2025-11-05 08:46:48.406944 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:48.634539 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:48.634598 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:48.637400 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:48.637433 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:48.855277 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001817/id_001817.cc
[2025-11-05 08:46:48.855362 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:49.084372 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:49.084468 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:49.087227 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:49.087253 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:49.305632 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001818/id_001818.cc
[2025-11-05 08:46:49.305684 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:49.533633 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:49.533705 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:49.536287 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:49.536318 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:49.754347 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001819/id_001819.cc
[2025-11-05 08:46:49.754401 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:46:49.982876 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:46:49.982963 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:46:49.985785 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:46:49.985817 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:46:49.985855 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:46:49.985871 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1820, succ: 1819, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:46:49.985887 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:46:49.985915 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:46:50.262350 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1819 as an example for the next prompt.
[2025-11-05 08:46:50.262406 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 5 new API pairs in this round.
[2025-11-05 08:46:50.262434 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 5
[2025-11-05 08:46:50.262481 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [61.0,57.0,88.0,24.0,61.0,203.0,165.0,40.0,57.0,126.0,101.0,47.0,345.0,16.0,33.0,451.0,195.0,37.0,144.0,38.0,241.0,127.0,182.0,137.0,153.0,95.0,79.0,27.0,18.0,58.0,195.0,139.0,16.0,24.0,158.0,258.0,28.0,869.0,295.0,255.0,44.0,88.0,117.0,54.0,402.0,54.0,85.0,180.0,33.0,10.0,107.0,343.0,16.0,16.0,218.0,70.0,52.0,87.0,25.0,348.0,38.0,68.0,59.0,51.0,221.0,63.0,258.0,59.0,52.0,16.0]
[2025-11-05 08:46:50.262500 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:46:50.262552 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 61
[2025-11-05 08:46:50.262585 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 402
[2025-11-05 08:46:50.262612 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 345
[2025-11-05 08:46:50.262637 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_and_consume energy: 58
[2025-11-05 08:46:50.262673 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int )
[2025-11-05 08:46:50.263396 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 182, quiet_round: 0, discovered_api_pairs: 3243
[2025-11-05 08:46:50.304886 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:46:50.305234 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_find_and_consume(const char * , cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char work_buf[128];\n    char match_buf0[64];\n    char match_buf1[64];\n    memset(work_buf, 0, sizeof(work_buf));\n    memset(match_buf0, 0, sizeof(match_buf0));\n    memset(match_buf1, 0, sizeof(match_buf1));\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    cre2_string_t matches[3];\n    memset(matches, 0, sizeof(matches));\n    const char *named = NULL;\n    int named_index = 0;\n    int num_groups = 0;\n    int version_rev = 0;\n    int match_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    version_rev = cre2_version_interface_revision();\n    memcpy(work_buf, source_text, (size_t)source_text_len);\n    matches[0].data = work_buf;\n    matches[0].length = 0;\n    matches[1].data = work_buf;\n    matches[1].length = 0;\n    matches[2].data = work_buf;\n    matches[2].length = 0;\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    cre2_named_groups_iter_next(iter, &named, &named_index);\n    match_res = cre2_match(re, work_buf, source_text_len, 0, source_text_len, (cre2_anchor_t)0, matches, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)num_groups + (long)version_rev + (long)match_res + (long)(re != NULL) + (long)(opt != NULL) + (long)matches[0].length + (long)(named != NULL) + (long)named_index;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foo yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    char rewrite_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    cre2_options_t *opt = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    const char rewrite_literal[] = \"bar\";\n    memcpy(rewrite_buf, rewrite_literal, (size_t)(sizeof(rewrite_literal) - 1));\n\n    // step 3: Configure\n    text_and_target.data = text_buf;\n    text_and_target.length = source_text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_literal) - 1);\n\n    // step 4: Operate\n    replace_res = cre2_replace(pattern, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)rewrite.length + (long)enc + (long)replace_res + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:47:34.578782 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 44s
[2025-11-05 08:47:34.578903 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30760, Completion: 25704, Total: 56464
[2025-11-05 08:47:34.578925 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:47:34.798502 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001820/id_001820.cc
[2025-11-05 08:47:34.798554 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:35.027168 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:35.027229 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:35.030020 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:35.030052 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:35.250801 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001821/id_001821.cc
[2025-11-05 08:47:35.250856 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:35.481074 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:35.481148 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:35.483819 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:35.483851 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:35.701059 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001822/id_001822.cc
[2025-11-05 08:47:35.701145 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:35.930350 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:35.930423 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:35.933360 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:35.933393 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:36.151673 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001823/id_001823.cc
[2025-11-05 08:47:36.151726 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:36.380351 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:36.380424 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:36.383193 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:36.383225 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:36.601600 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001824/id_001824.cc
[2025-11-05 08:47:36.601656 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:36.831976 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:36.832075 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:36.834903 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:36.834935 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:37.052934 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001825/id_001825.cc
[2025-11-05 08:47:37.052988 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:37.283503 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:37.283572 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:37.286382 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:37.286415 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:37.503686 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001826/id_001826.cc
[2025-11-05 08:47:37.503739 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:37.732414 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:37.732486 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:37.735195 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:37.735222 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:37.951553 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001827/id_001827.cc
[2025-11-05 08:47:37.951638 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:38.183823 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:38.183892 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:38.186747 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:38.186773 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:38.404392 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001828/id_001828.cc
[2025-11-05 08:47:38.404457 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:38.633163 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:38.633234 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:38.635840 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:38.635873 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:38.853992 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001829/id_001829.cc
[2025-11-05 08:47:38.854047 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:47:39.083131 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:47:39.083222 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:47:39.086042 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:47:39.086075 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:47:39.086113 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:47:39.086130 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1830, succ: 1829, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:47:39.086146 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:47:39.086172 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:47:39.407186 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1829 as an example for the next prompt.
[2025-11-05 08:47:39.407243 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 08:47:39.407281 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 08:47:39.407329 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [68.0,57.0,88.0,24.0,61.0,203.0,165.0,40.0,57.0,126.0,101.0,47.0,349.0,16.0,33.0,454.0,195.0,37.0,144.0,38.0,243.0,127.0,182.0,137.0,153.0,95.0,79.0,27.0,18.0,66.0,195.0,139.0,16.0,24.0,162.0,261.0,28.0,870.0,295.0,255.0,44.0,88.0,117.0,54.0,411.0,54.0,85.0,180.0,33.0,10.0,107.0,343.0,16.0,16.0,218.0,70.0,52.0,87.0,25.0,348.0,38.0,68.0,59.0,51.0,221.0,63.0,258.0,59.0,52.0,16.0]
[2025-11-05 08:47:39.407346 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:47:39.407398 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 57
[2025-11-05 08:47:39.407431 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 261
[2025-11-05 08:47:39.407458 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 411
[2025-11-05 08:47:39.407484 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match_re energy: 25
[2025-11-05 08:47:39.407510 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume_re energy: 61
[2025-11-05 08:47:39.407549 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_perl_classes(cre2_options_t * opt),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int )
[2025-11-05 08:47:39.408358 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 183, quiet_round: 0, discovered_api_pairs: 3260
[2025-11-05 08:47:39.461947 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:47:39.462338 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_perl_classes(cre2_options_t * opt),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_consume_re(cre2_regexp_t * , cre2_string_t * , cre2_string_t * , int )\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"foo\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foo yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    char rewrite_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    cre2_options_t *opt = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    const char rewrite_literal[] = \"bar\";\n    memcpy(rewrite_buf, rewrite_literal, (size_t)(sizeof(rewrite_literal) - 1));\n\n    // step 3: Configure\n    text_and_target.data = text_buf;\n    text_and_target.length = source_text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_literal) - 1);\n\n    // step 4: Operate\n    replace_res = cre2_replace(pattern, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)rewrite.length + (long)enc + (long)replace_res + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[256];\n    char rewrite_buf[128];\n    char errmsg_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t matches[4];\n    memset(matches, 0, sizeof(matches));\n    cre2_string_t text_and_target;\n    cre2_string_t consumed_match;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int num_groups = 0;\n    int easy_res = 0;\n    int find_consume_res = 0;\n    int check_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = source_text_len;\n    consumed_match.data = text_buf;\n    consumed_match.length = 0;\n    matches[0].data = text_buf;\n    matches[0].length = 0;\n    matches[1].data = text_buf;\n    matches[1].length = 0;\n    matches[2].data = text_buf;\n    matches[2].length = 0;\n    matches[3].data = text_buf;\n    matches[3].length = 0;\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    const char rewrite_literal[] = \"$1-REWRITTEN\";\n    memcpy(rewrite_buf, rewrite_literal, (size_t)(sizeof(rewrite_literal) - 1));\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_literal) - 1);\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, matches, 3);\n    find_consume_res = cre2_find_and_consume(pattern, &text_and_target, &consumed_match, 1);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)num_groups + (long)easy_res + (long)find_consume_res + (long)check_res + (long)(re != NULL) + (long)(opt != NULL) + (long)matches[0].length + (long)consumed_match.length + (long)rewrite.length + (long)errmsg.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:48:22.321122 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 08:48:22.321242 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32360, Completion: 24870, Total: 57230
[2025-11-05 08:48:22.321264 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:48:22.539827 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001830/id_001830.cc
[2025-11-05 08:48:22.539880 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:22.769701 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:22.769759 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:22.772588 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:22.772631 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:22.990533 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001831/id_001831.cc
[2025-11-05 08:48:22.990587 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:23.220899 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:23.220967 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:23.223497 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:23.223529 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:23.441866 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001832/id_001832.cc
[2025-11-05 08:48:23.441952 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:23.672246 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:23.672320 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:23.675153 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:23.675185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:23.891467 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001833/id_001833.cc
[2025-11-05 08:48:23.891520 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:24.120698 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:24.120770 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:24.123391 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:24.123422 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:24.341578 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001834/id_001834.cc
[2025-11-05 08:48:24.341632 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:24.573795 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:24.573883 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:24.576611 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:24.576645 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:24.793903 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001835/id_001835.cc
[2025-11-05 08:48:24.793957 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:25.023055 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:25.023124 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:25.025962 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:25.025996 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:25.242717 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001836/id_001836.cc
[2025-11-05 08:48:25.242771 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:25.471381 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:25.471451 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:25.474183 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:25.474216 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:25.691738 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001837/id_001837.cc
[2025-11-05 08:48:25.691824 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:25.920547 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:25.920629 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:25.923232 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:25.923259 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:26.139995 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001838/id_001838.cc
[2025-11-05 08:48:26.140049 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:26.368854 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:26.368923 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:26.371667 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:26.371699 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:26.590269 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001839/id_001839.cc
[2025-11-05 08:48:26.590324 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:48:26.821833 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:48:26.821941 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:48:26.824811 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:48:26.824845 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:48:26.824884 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:48:26.824901 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1840, succ: 1839, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:48:26.824916 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:48:26.824942 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:48:27.147500 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1839 as an example for the next prompt.
[2025-11-05 08:48:27.147555 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 14 new API pairs in this round.
[2025-11-05 08:48:27.147592 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 14
[2025-11-05 08:48:27.147639 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [68.0,57.0,88.0,24.0,64.0,203.0,165.0,40.0,66.0,126.0,101.0,47.0,349.0,16.0,33.0,455.0,195.0,37.0,144.0,38.0,245.0,127.0,182.0,137.0,153.0,95.0,79.0,27.0,18.0,66.0,195.0,139.0,16.0,24.0,163.0,269.0,28.0,876.0,295.0,255.0,44.0,88.0,117.0,54.0,414.0,54.0,85.0,180.0,33.0,10.0,107.0,343.0,16.0,16.0,218.0,70.0,52.0,87.0,29.0,348.0,38.0,68.0,59.0,51.0,221.0,63.0,258.0,59.0,52.0,16.0]
[2025-11-05 08:48:27.147656 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:48:27.147710 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 414
[2025-11-05 08:48:27.147755 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_current energy: 52
[2025-11-05 08:48:27.147782 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_string energy: 16
[2025-11-05 08:48:27.147810 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 245
[2025-11-05 08:48:27.147865 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 221
[2025-11-05 08:48:27.147902 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_version_interface_current(),
    const char *cre2_error_string(const cre2_regexp_t * re),
    cre2_options_t *cre2_opt_new(),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)
[2025-11-05 08:48:27.148728 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 184, quiet_round: 0, discovered_api_pairs: 3274
[2025-11-05 08:48:27.188547 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:48:27.188938 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_version_interface_current(),\n    const char *cre2_error_string(const cre2_regexp_t * re),\n    cre2_options_t *cre2_opt_new(),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[256];\n    char rewrite_buf[128];\n    char errmsg_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t matches[4];\n    memset(matches, 0, sizeof(matches));\n    cre2_string_t text_and_target;\n    cre2_string_t consumed_match;\n    cre2_string_t rewrite;\n    cre2_string_t errmsg;\n    int num_groups = 0;\n    int easy_res = 0;\n    int find_consume_res = 0;\n    int check_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    text_and_target.data = text_buf;\n    text_and_target.length = source_text_len;\n    consumed_match.data = text_buf;\n    consumed_match.length = 0;\n    matches[0].data = text_buf;\n    matches[0].length = 0;\n    matches[1].data = text_buf;\n    matches[1].length = 0;\n    matches[2].data = text_buf;\n    matches[2].length = 0;\n    matches[3].data = text_buf;\n    matches[3].length = 0;\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    const char rewrite_literal[] = \"$1-REWRITTEN\";\n    memcpy(rewrite_buf, rewrite_literal, (size_t)(sizeof(rewrite_literal) - 1));\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_literal) - 1);\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n\n    // step 4: Operate\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, matches, 3);\n    find_consume_res = cre2_find_and_consume(pattern, &text_and_target, &consumed_match, 1);\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)num_groups + (long)easy_res + (long)find_consume_res + (long)check_res + (long)(re != NULL) + (long)(opt != NULL) + (long)matches[0].length + (long)consumed_match.length + (long)rewrite.length + (long)errmsg.length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    char consume_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(consume_buf, 0, sizeof(consume_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    memcpy(consume_buf, source_text, (size_t)source_text_len);\n\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n\n    cre2_string_t easy_matches[4];\n    cre2_string_t partial_matches[4];\n    cre2_string_t consume_matches[4];\n    memset(easy_matches, 0, sizeof(easy_matches));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    memset(consume_matches, 0, sizeof(consume_matches));\n\n    cre2_string_t text_input_const;\n    cre2_string_t text_input_mut;\n    text_input_const.data = text_buf;\n    text_input_const.length = source_text_len;\n    text_input_mut.data = consume_buf;\n    text_input_mut.length = source_text_len;\n\n    int perl_flag = 0;\n    int case_flag = 1;\n    int easy_res = 0;\n    int partial_res = 0;\n    int consume_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n    cre2_opt_set_case_sensitive(opt, case_flag);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    easy_matches[0].data = text_buf;\n    easy_matches[0].length = 0;\n    easy_matches[1].data = text_buf;\n    easy_matches[1].length = 0;\n    easy_matches[2].data = text_buf;\n    easy_matches[2].length = 0;\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, easy_matches, 3);\n\n    partial_matches[0].data = text_buf;\n    partial_matches[0].length = 0;\n    partial_matches[1].data = text_buf;\n    partial_matches[1].length = 0;\n    partial_matches[2].data = text_buf;\n    partial_matches[2].length = 0;\n    partial_res = cre2_partial_match_re(re, &text_input_const, partial_matches, 3);\n\n    consume_matches[0].data = consume_buf;\n    consume_matches[0].length = 0;\n    consume_matches[1].data = consume_buf;\n    consume_matches[1].length = 0;\n    consume_matches[2].data = consume_buf;\n    consume_matches[2].length = 0;\n    consume_res = cre2_consume_re(re, &text_input_mut, consume_matches, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)perl_flag + (long)case_flag + (long)(re != NULL) + (long)easy_res + (long)partial_res + (long)consume_res + (long)easy_matches[0].length + (long)partial_matches[0].length + (long)consume_matches[0].length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:49:04.624013 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 08:49:04.624131 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 36180, Completion: 22877, Total: 59057
[2025-11-05 08:49:04.624179 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:49:04.846727 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001840/id_001840.cc
[2025-11-05 08:49:04.846779 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:05.077172 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:05.077248 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:05.079990 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:05.080024 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:05.296924 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001841/id_001841.cc
[2025-11-05 08:49:05.296977 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:05.526655 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:05.526731 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:05.529482 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:05.529509 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:05.747932 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001842/id_001842.cc
[2025-11-05 08:49:05.748018 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:05.975962 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:05.976037 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:05.978888 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:05.978920 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:06.197862 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001843/id_001843.cc
[2025-11-05 08:49:06.197917 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:06.427966 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:06.428043 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:06.430798 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:06.430831 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:06.648395 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001844/id_001844.cc
[2025-11-05 08:49:06.648448 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:06.877298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:06.877395 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:06.879971 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:06.879999 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:07.099322 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001845/id_001845.cc
[2025-11-05 08:49:07.099376 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:07.327235 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:07.327312 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:07.330218 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:07.330253 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:07.548012 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001846/id_001846.cc
[2025-11-05 08:49:07.548066 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:07.775764 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:07.775840 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:07.778642 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:07.778669 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:07.996271 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001847/id_001847.cc
[2025-11-05 08:49:07.996354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:08.225762 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:08.225839 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:08.228564 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:08.228597 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:08.446950 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001848/id_001848.cc
[2025-11-05 08:49:08.447003 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:08.675809 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:08.675885 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:08.678757 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:08.678790 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:08.896405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001849/id_001849.cc
[2025-11-05 08:49:08.896462 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:09.124662 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:09.124752 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:09.127358 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:09.127387 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:09.127422 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:49:09.127437 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1850, succ: 1849, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:49:09.127451 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:49:09.127475 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:49:09.429403 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1849 as an example for the next prompt.
[2025-11-05 08:49:09.429460 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 24 new API pairs in this round.
[2025-11-05 08:49:09.429506 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 24
[2025-11-05 08:49:09.429554 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [68.0,57.0,88.0,24.0,64.0,203.0,165.0,40.0,66.0,126.0,101.0,47.0,353.0,16.0,33.0,455.0,195.0,37.0,144.0,38.0,246.0,127.0,182.0,137.0,153.0,95.0,79.0,27.0,18.0,66.0,195.0,139.0,16.0,24.0,166.0,270.0,28.0,882.0,304.0,255.0,44.0,88.0,117.0,54.0,429.0,54.0,85.0,180.0,33.0,10.0,107.0,343.0,28.0,16.0,218.0,70.0,68.0,87.0,29.0,348.0,38.0,68.0,59.0,51.0,226.0,63.0,258.0,59.0,52.0,16.0]
[2025-11-05 08:49:09.429582 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:49:09.429637 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 144
[2025-11-05 08:49:09.429669 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 195
[2025-11-05 08:49:09.429694 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 180
[2025-11-05 08:49:09.429721 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 66
[2025-11-05 08:49:09.429746 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 153
[2025-11-05 08:49:09.429786 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_opt_perl_classes(cre2_options_t * opt),
    void cre2_set_delete(cre2_set * set)
[2025-11-05 08:49:09.430592 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 185, quiet_round: 0, discovered_api_pairs: 3298
[2025-11-05 08:49:09.486147 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:49:09.486513 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_opt_perl_classes(cre2_options_t * opt),\n    void cre2_set_delete(cre2_set * set)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    char consume_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memset(consume_buf, 0, sizeof(consume_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    memcpy(consume_buf, source_text, (size_t)source_text_len);\n\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n\n    cre2_string_t easy_matches[4];\n    cre2_string_t partial_matches[4];\n    cre2_string_t consume_matches[4];\n    memset(easy_matches, 0, sizeof(easy_matches));\n    memset(partial_matches, 0, sizeof(partial_matches));\n    memset(consume_matches, 0, sizeof(consume_matches));\n\n    cre2_string_t text_input_const;\n    cre2_string_t text_input_mut;\n    text_input_const.data = text_buf;\n    text_input_const.length = source_text_len;\n    text_input_mut.data = consume_buf;\n    text_input_mut.length = source_text_len;\n\n    int perl_flag = 0;\n    int case_flag = 1;\n    int easy_res = 0;\n    int partial_res = 0;\n    int consume_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n    cre2_opt_set_case_sensitive(opt, case_flag);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    easy_matches[0].data = text_buf;\n    easy_matches[0].length = 0;\n    easy_matches[1].data = text_buf;\n    easy_matches[1].length = 0;\n    easy_matches[2].data = text_buf;\n    easy_matches[2].length = 0;\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, easy_matches, 3);\n\n    partial_matches[0].data = text_buf;\n    partial_matches[0].length = 0;\n    partial_matches[1].data = text_buf;\n    partial_matches[1].length = 0;\n    partial_matches[2].data = text_buf;\n    partial_matches[2].length = 0;\n    partial_res = cre2_partial_match_re(re, &text_input_const, partial_matches, 3);\n\n    consume_matches[0].data = consume_buf;\n    consume_matches[0].length = 0;\n    consume_matches[1].data = consume_buf;\n    consume_matches[1].length = 0;\n    consume_matches[2].data = consume_buf;\n    consume_matches[2].length = 0;\n    consume_res = cre2_consume_re(re, &text_input_mut, consume_matches, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)perl_flag + (long)case_flag + (long)(re != NULL) + (long)easy_res + (long)partial_res + (long)consume_res + (long)easy_matches[0].length + (long)partial_matches[0].length + (long)consume_matches[0].length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[4];\n    memset(matches, 0, sizeof(matches));\n    matches[0].data = text_buf;\n    matches[0].length = 0;\n    matches[1].data = text_buf;\n    matches[1].length = 0;\n    matches[2].data = text_buf;\n    matches[2].length = 0;\n    matches[3].data = text_buf;\n    matches[3].length = 0;\n    int easy_res = 0;\n    int ver_iface = 0;\n    const char * errstr = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    ver_iface = cre2_version_interface_current();\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, matches, 3);\n    errstr = cre2_error_string(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)ver_iface + (long)easy_res + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL) + (long)(errstr != NULL) + (long)matches[0].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:49:45.311482 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 35s
[2025-11-05 08:49:45.311608 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 34640, Completion: 25663, Total: 60303
[2025-11-05 08:49:45.311628 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:49:45.530660 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001850/id_001850.cc
[2025-11-05 08:49:45.530714 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:45.760421 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:45.760490 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:45.763317 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:45.763350 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:45.979364 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001851/id_001851.cc
[2025-11-05 08:49:45.979418 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:46.208613 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:46.208696 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:46.211346 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:46.211373 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:46.429738 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001852/id_001852.cc
[2025-11-05 08:49:46.429821 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:46.658876 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:46.658934 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:46.661777 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:46.661808 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:46.879674 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001853/id_001853.cc
[2025-11-05 08:49:46.879727 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:47.109256 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:47.109327 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:47.111864 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:47.111895 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:47.331108 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001854/id_001854.cc
[2025-11-05 08:49:47.331162 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:47.560121 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:47.560252 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:47.563077 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:47.563108 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:47.781595 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001855/id_001855.cc
[2025-11-05 08:49:47.781649 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:48.010976 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:48.011048 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:48.013944 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:48.013977 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:48.231995 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001856/id_001856.cc
[2025-11-05 08:49:48.232048 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:48.461714 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:48.461792 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:48.464695 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:48.464727 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:48.679960 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001857/id_001857.cc
[2025-11-05 08:49:48.680044 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:48.909473 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:48.909532 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:48.912183 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:48.912217 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:49.131221 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001858/id_001858.cc
[2025-11-05 08:49:49.131276 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:49.360370 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:49.360439 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:49.363241 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:49.363267 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:49.581794 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001859/id_001859.cc
[2025-11-05 08:49:49.581848 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:49:49.813849 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:49:49.813958 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:49:49.816820 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:49:49.816854 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:49:49.816892 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:49:49.816908 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1860, succ: 1859, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:49:49.816944 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:49:49.816973 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:49:50.137708 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1859 as an example for the next prompt.
[2025-11-05 08:49:50.137767 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 18 new API pairs in this round.
[2025-11-05 08:49:50.137809 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 18
[2025-11-05 08:49:50.137857 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [68.0,57.0,88.0,24.0,64.0,203.0,165.0,40.0,76.0,126.0,101.0,47.0,353.0,16.0,33.0,456.0,199.0,37.0,151.0,38.0,246.0,127.0,182.0,137.0,156.0,95.0,79.0,27.0,18.0,66.0,196.0,139.0,16.0,24.0,170.0,270.0,28.0,886.0,304.0,262.0,44.0,88.0,117.0,54.0,429.0,54.0,85.0,186.0,33.0,10.0,112.0,343.0,28.0,16.0,219.0,70.0,68.0,87.0,29.0,348.0,38.0,68.0,59.0,51.0,226.0,63.0,259.0,59.0,52.0,16.0]
[2025-11-05 08:49:50.137876 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:49:50.137929 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 259
[2025-11-05 08:49:50.137962 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 429
[2025-11-05 08:49:50.137989 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 170
[2025-11-05 08:49:50.138015 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_string energy: 40
[2025-11-05 08:49:50.138043 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 79
[2025-11-05 08:49:50.138082 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    const char *cre2_version_string(),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)
[2025-11-05 08:49:50.138888 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 186, quiet_round: 0, discovered_api_pairs: 3316
[2025-11-05 08:49:50.189258 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:49:50.189620 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    const char *cre2_version_string(),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t matches[4];\n    memset(matches, 0, sizeof(matches));\n    matches[0].data = text_buf;\n    matches[0].length = 0;\n    matches[1].data = text_buf;\n    matches[1].length = 0;\n    matches[2].data = text_buf;\n    matches[2].length = 0;\n    matches[3].data = text_buf;\n    matches[3].length = 0;\n    int easy_res = 0;\n    int ver_iface = 0;\n    const char * errstr = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate\n    ver_iface = cre2_version_interface_current();\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, matches, 3);\n    errstr = cre2_error_string(re);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)ver_iface + (long)easy_res + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL) + (long)(errstr != NULL) + (long)matches[0].length;\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n\n    cre2_string_t match_arr[4];\n    cre2_string_t partial_arr[4];\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(partial_arr, 0, sizeof(partial_arr));\n    match_arr[0].data = text_buf;\n    match_arr[0].length = 0;\n    match_arr[1].data = text_buf;\n    match_arr[1].length = 0;\n    match_arr[2].data = text_buf;\n    match_arr[2].length = 0;\n    partial_arr[0].data = text_buf;\n    partial_arr[0].length = 0;\n    partial_arr[1].data = text_buf;\n    partial_arr[1].length = 0;\n    partial_arr[2].data = text_buf;\n    partial_arr[2].length = 0;\n\n    cre2_string_t text_input_const;\n    text_input_const.data = text_buf;\n    text_input_const.length = source_text_len;\n\n    int perl_flag = 0;\n    int one_line_flag = 0;\n    int match_res = 0;\n    int partial_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, \"foo\");\n    cre2_set_add_simple(set, \"bar\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    match_arr[0].data = text_buf;\n    match_arr[0].length = 0;\n    match_arr[1].data = text_buf;\n    match_arr[1].length = 0;\n    match_arr[2].data = text_buf;\n    match_arr[2].length = 0;\n    match_res = cre2_match(re, text_buf, source_text_len, 0, source_text_len, CRE2_UNANCHORED, match_arr, 3);\n\n    partial_arr[0].data = text_buf;\n    partial_arr[0].length = 0;\n    partial_arr[1].data = text_buf;\n    partial_arr[1].length = 0;\n    partial_arr[2].data = text_buf;\n    partial_arr[2].length = 0;\n    partial_res = cre2_partial_match(pattern, &text_input_const, partial_arr, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)perl_flag + (long)one_line_flag + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)match_res + (long)partial_res + (long)match_arr[0].length + (long)partial_arr[0].length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:50:18.499624 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 08:50:18.499749 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 34580, Completion: 23602, Total: 58182
[2025-11-05 08:50:18.499770 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:50:18.717696 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001860/id_001860.cc
[2025-11-05 08:50:18.717749 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:18.949377 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:18.949457 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:18.952238 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:18.952271 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:19.170160 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001861/id_001861.cc
[2025-11-05 08:50:19.170214 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:19.402222 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:19.402297 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:19.405199 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:19.405233 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:19.623025 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001862/id_001862.cc
[2025-11-05 08:50:19.623118 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:19.852110 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:19.852180 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:19.854737 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:19.854767 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:20.075788 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001863/id_001863.cc
[2025-11-05 08:50:20.075844 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:20.308151 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:20.308237 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:20.310848 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:20.310874 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:20.532087 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001864/id_001864.cc
[2025-11-05 08:50:20.532143 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:20.764435 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:20.764551 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:20.767116 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:20.767145 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:20.988248 +00:00] WARN [src/fuzzer.rs:205] Program 1865 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001865/id_001865.cc:64:11: error: no matching function for call to 'cre2_set_new'
   64 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:50:21.039756 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:50:21.040098 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n\n    cre2_string_t matches[4];\n    memset(matches, 0, sizeof(matches));\n    matches[0].data = text_buf;\n    matches[0].length = 0;\n    matches[1].data = text_buf;\n    matches[1].length = 0;\n    matches[2].data = text_buf;\n    matches[2].length = 0;\n    matches[3].data = text_buf;\n    matches[3].length = 0;\n\n    cre2_string_t text_str;\n    text_str.data = text_buf;\n    text_str.length = source_text_len;\n\n    char rewrite_buf[] = \"$1\";\n    cre2_string_t rewrite_str;\n    rewrite_str.data = rewrite_buf;\n    rewrite_str.length = (int)(sizeof(rewrite_buf) - 1);\n\n    char target_buf[64];\n    cre2_string_t target_str;\n    memset(target_buf, 0, sizeof(target_buf));\n    target_str.data = target_buf;\n    target_str.length = 0;\n\n    const char * ver = NULL;\n    int easy_res = 0;\n    int extract_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    set = cre2_set_new(opt, 0);\n    cre2_set_add_simple(set, \"foo\");\n    cre2_set_add_simple(set, \"bar\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    ver = cre2_version_string();\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, matches, 3);\n    extract_res = cre2_extract_re(re, &text_str, &rewrite_str, &target_str);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)easy_res + (long)extract_res + (long)(ver != NULL) + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)matches[0].length + (long)target_str.length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001865/id_001865.cc:64:11: error: no matching function for call to 'cre2_set_new'\n   64 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:50:40.093917 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 19s
[2025-11-05 08:50:40.094041 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24800, Completion: 13784, Total: 38584
[2025-11-05 08:50:40.313088 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001865/id_001865.cc
[2025-11-05 08:50:40.313142 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:40.544151 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:40.544228 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:40.547012 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:40.547044 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:40.547075 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1865!
[2025-11-05 08:50:40.764967 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001866/id_001866.cc
[2025-11-05 08:50:40.765020 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:40.994970 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:40.995046 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:40.997980 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:40.998012 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:41.217272 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001867/id_001867.cc
[2025-11-05 08:50:41.217358 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:41.447786 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:41.447858 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:41.450674 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:41.450706 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:41.667886 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001868/id_001868.cc
[2025-11-05 08:50:41.667941 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:41.898704 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:41.898779 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:41.901606 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:41.901639 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:42.118940 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001869/id_001869.cc
[2025-11-05 08:50:42.118995 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:50:42.348049 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:50:42.348164 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:50:42.350965 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:50:42.350997 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:50:42.351035 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:50:42.351051 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1870, succ: 1869, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:50:42.351067 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:50:42.351091 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:50:42.674299 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1869 as an example for the next prompt.
[2025-11-05 08:50:42.674358 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 08:50:42.674389 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 08:50:42.674436 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [68.0,57.0,88.0,24.0,64.0,203.0,165.0,46.0,76.0,126.0,101.0,47.0,353.0,16.0,33.0,457.0,199.0,37.0,151.0,38.0,247.0,127.0,182.0,137.0,158.0,95.0,82.0,27.0,18.0,66.0,197.0,139.0,16.0,24.0,172.0,270.0,28.0,888.0,304.0,264.0,44.0,88.0,117.0,54.0,432.0,54.0,85.0,186.0,33.0,10.0,112.0,343.0,28.0,16.0,219.0,70.0,68.0,87.0,29.0,348.0,38.0,68.0,59.0,51.0,226.0,63.0,260.0,59.0,52.0,16.0]
[2025-11-05 08:50:42.674454 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:50:42.674506 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 888
[2025-11-05 08:50:42.674538 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_string energy: 28
[2025-11-05 08:50:42.674564 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 247
[2025-11-05 08:50:42.674589 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 260
[2025-11-05 08:50:42.674617 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 343
[2025-11-05 08:50:42.674652 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    const char *cre2_error_string(const cre2_regexp_t * re),
    cre2_options_t *cre2_opt_new(),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 08:50:42.675472 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 187, quiet_round: 0, discovered_api_pairs: 3324
[2025-11-05 08:50:42.711984 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:50:42.712345 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    const char *cre2_error_string(const cre2_regexp_t * re),\n    cre2_options_t *cre2_opt_new(),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n\n    cre2_string_t match_arr[4];\n    cre2_string_t partial_arr[4];\n    memset(match_arr, 0, sizeof(match_arr));\n    memset(partial_arr, 0, sizeof(partial_arr));\n    match_arr[0].data = text_buf;\n    match_arr[0].length = 0;\n    match_arr[1].data = text_buf;\n    match_arr[1].length = 0;\n    match_arr[2].data = text_buf;\n    match_arr[2].length = 0;\n    partial_arr[0].data = text_buf;\n    partial_arr[0].length = 0;\n    partial_arr[1].data = text_buf;\n    partial_arr[1].length = 0;\n    partial_arr[2].data = text_buf;\n    partial_arr[2].length = 0;\n\n    cre2_string_t text_input_const;\n    text_input_const.data = text_buf;\n    text_input_const.length = source_text_len;\n\n    int perl_flag = 0;\n    int one_line_flag = 0;\n    int match_res = 0;\n    int partial_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    perl_flag = cre2_opt_perl_classes(opt);\n    cre2_opt_set_one_line(opt, 1);\n    one_line_flag = cre2_opt_one_line(opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, \"foo\");\n    cre2_set_add_simple(set, \"bar\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    match_arr[0].data = text_buf;\n    match_arr[0].length = 0;\n    match_arr[1].data = text_buf;\n    match_arr[1].length = 0;\n    match_arr[2].data = text_buf;\n    match_arr[2].length = 0;\n    match_res = cre2_match(re, text_buf, source_text_len, 0, source_text_len, CRE2_UNANCHORED, match_arr, 3);\n\n    partial_arr[0].data = text_buf;\n    partial_arr[0].length = 0;\n    partial_arr[1].data = text_buf;\n    partial_arr[1].length = 0;\n    partial_arr[2].data = text_buf;\n    partial_arr[2].length = 0;\n    partial_res = cre2_partial_match(pattern, &text_input_const, partial_arr, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)perl_flag + (long)one_line_flag + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)match_res + (long)partial_res + (long)match_arr[0].length + (long)partial_arr[0].length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n\n    cre2_string_t matches[4];\n    memset(matches, 0, sizeof(matches));\n    matches[0].data = text_buf;\n    matches[0].length = 0;\n    matches[1].data = text_buf;\n    matches[1].length = 0;\n    matches[2].data = text_buf;\n    matches[2].length = 0;\n    matches[3].data = text_buf;\n    matches[3].length = 0;\n\n    cre2_string_t text_input;\n    text_input.data = text_buf;\n    text_input.length = source_text_len;\n\n    char rewrite_buf[] = \"$1\";\n    cre2_string_t rewrite;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n\n    char target_buf[64];\n    memset(target_buf, 0, sizeof(target_buf));\n    cre2_string_t target;\n    target.data = target_buf;\n    target.length = 0;\n\n    const char * verstr = NULL;\n    int add1_res = 0;\n    int add2_res = 0;\n    int easy_res = 0;\n    int extract_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add1_res = cre2_set_add_simple(set, \"foo\");\n    add2_res = cre2_set_add_simple(set, \"bar\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    verstr = cre2_version_string();\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, matches, 3);\n    extract_res = cre2_extract_re(re, &text_input, &rewrite, &target);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)(verstr != NULL) + (long)add1_res + (long)add2_res + (long)easy_res + (long)extract_res + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)matches[0].length + (long)target.length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:51:09.638632 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 08:51:09.638756 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 36230, Completion: 19641, Total: 55871
[2025-11-05 08:51:09.638781 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:51:09.857034 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001870/id_001870.cc
[2025-11-05 08:51:09.857087 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:10.086247 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:10.086324 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:10.089046 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:10.089074 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:10.308021 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001871/id_001871.cc
[2025-11-05 08:51:10.308083 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:10.537253 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:10.537327 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:10.540021 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:10.540053 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:10.756290 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001872/id_001872.cc
[2025-11-05 08:51:10.756374 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:10.984684 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:10.984757 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:10.987376 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:10.987404 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:11.204580 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001873/id_001873.cc
[2025-11-05 08:51:11.204643 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:11.432205 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:11.432279 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:11.434975 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:11.435005 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:11.651003 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001874/id_001874.cc
[2025-11-05 08:51:11.651056 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:11.880802 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:11.880920 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:11.883511 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:11.883536 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:12.103683 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001875/id_001875.cc
[2025-11-05 08:51:12.103736 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:12.331331 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:12.331407 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:12.334277 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:12.334311 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:12.551302 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001876/id_001876.cc
[2025-11-05 08:51:12.551354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:12.780779 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:12.780855 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:12.783446 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:12.783474 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:13.000988 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001877/id_001877.cc
[2025-11-05 08:51:13.001075 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:13.230802 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:13.230881 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:13.233742 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:13.233773 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:13.452052 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001878/id_001878.cc
[2025-11-05 08:51:13.452105 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:13.680038 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:13.680112 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:13.682843 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:13.682876 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:13.901710 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001879/id_001879.cc
[2025-11-05 08:51:13.901764 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:14.131292 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:14.131404 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:14.134289 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:14.134323 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:14.134361 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:51:14.134377 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1880, succ: 1879, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:51:14.134393 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:51:14.134417 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:51:14.407182 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1879 as an example for the next prompt.
[2025-11-05 08:51:14.407239 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 08:51:14.407273 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 08:51:14.407321 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [68.0,57.0,88.0,24.0,64.0,203.0,165.0,46.0,76.0,126.0,101.0,47.0,353.0,16.0,33.0,459.0,199.0,37.0,151.0,38.0,248.0,127.0,182.0,137.0,164.0,95.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,172.0,270.0,28.0,893.0,304.0,265.0,44.0,88.0,117.0,54.0,432.0,54.0,85.0,186.0,33.0,10.0,112.0,346.0,38.0,16.0,219.0,70.0,68.0,87.0,29.0,348.0,38.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:51:14.407339 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:51:14.407392 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 265
[2025-11-05 08:51:14.407423 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 346
[2025-11-05 08:51:14.407450 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 270
[2025-11-05 08:51:14.407490 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 151
[2025-11-05 08:51:14.407528 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 893
[2025-11-05 08:51:14.407564 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 08:51:14.408372 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 188, quiet_round: 0, discovered_api_pairs: 3336
[2025-11-05 08:51:14.453061 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:51:14.453419 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char source_text[] = \"xx foobar yy\";\n    const int source_text_len = (int)(sizeof(source_text) - 1);\n    char text_buf[128];\n    memset(text_buf, 0, sizeof(text_buf));\n    memcpy(text_buf, source_text, (size_t)source_text_len);\n\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n\n    cre2_string_t matches[4];\n    memset(matches, 0, sizeof(matches));\n    matches[0].data = text_buf;\n    matches[0].length = 0;\n    matches[1].data = text_buf;\n    matches[1].length = 0;\n    matches[2].data = text_buf;\n    matches[2].length = 0;\n    matches[3].data = text_buf;\n    matches[3].length = 0;\n\n    cre2_string_t text_input;\n    text_input.data = text_buf;\n    text_input.length = source_text_len;\n\n    char rewrite_buf[] = \"$1\";\n    cre2_string_t rewrite;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n\n    char target_buf[64];\n    memset(target_buf, 0, sizeof(target_buf));\n    cre2_string_t target;\n    target.data = target_buf;\n    target.length = 0;\n\n    const char * verstr = NULL;\n    int add1_res = 0;\n    int add2_res = 0;\n    int easy_res = 0;\n    int extract_res = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add1_res = cre2_set_add_simple(set, \"foo\");\n    add2_res = cre2_set_add_simple(set, \"bar\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    verstr = cre2_version_string();\n    easy_res = cre2_easy_match(pattern, pattern_len, text_buf, source_text_len, matches, 3);\n    extract_res = cre2_extract_re(re, &text_input, &rewrite, &target);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)source_text_len + (long)(verstr != NULL) + (long)add1_res + (long)add2_res + (long)easy_res + (long)extract_res + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)matches[0].length + (long)target.length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * errstr = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res1 = 0;\n    int add_res2 = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    enc = cre2_opt_encoding(opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res1 = cre2_set_add_simple(set, \"hello\");\n    add_res2 = cre2_set_add_simple(set, \"world\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    errstr = cre2_error_string(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)enc + (long)add_res1 + (long)add_res2 + (long)(errstr != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:51:41.559604 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 08:51:41.559726 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31620, Completion: 19561, Total: 51181
[2025-11-05 08:51:41.559752 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:51:41.777532 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001880/id_001880.cc
[2025-11-05 08:51:41.777584 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:42.007511 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:42.007589 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:42.010348 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:42.010374 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:42.226985 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001881/id_001881.cc
[2025-11-05 08:51:42.227038 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:42.456041 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:42.456118 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:42.458852 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:42.458886 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:42.677091 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001882/id_001882.cc
[2025-11-05 08:51:42.677176 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:42.909419 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:42.909488 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:42.911985 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:42.912017 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:43.130240 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001883/id_001883.cc
[2025-11-05 08:51:43.130298 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:43.359109 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:43.359194 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:43.362162 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:43.362195 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:43.579722 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001884/id_001884.cc
[2025-11-05 08:51:43.579782 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:43.808968 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:43.809088 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:43.811677 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:43.811706 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:44.028970 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001885/id_001885.cc
[2025-11-05 08:51:44.029023 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:44.259554 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:44.259629 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:44.262521 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:44.262553 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:44.480158 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001886/id_001886.cc
[2025-11-05 08:51:44.480213 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:44.709950 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:44.710024 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:44.712797 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:44.712826 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:44.930207 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001887/id_001887.cc
[2025-11-05 08:51:44.930293 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:45.160279 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:45.160379 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:45.163148 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:45.163182 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:45.380832 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001888/id_001888.cc
[2025-11-05 08:51:45.380885 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:45.610560 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:45.610633 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:45.613491 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:45.613524 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:45.831706 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001889/id_001889.cc
[2025-11-05 08:51:45.831759 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:51:46.061770 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:51:46.061887 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:51:46.064587 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:51:46.064646 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:51:46.064686 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:51:46.064705 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1890, succ: 1889, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:51:46.064720 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:51:46.064748 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:51:46.337551 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1889 as an example for the next prompt.
[2025-11-05 08:51:46.337608 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 08:51:46.337642 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 08:51:46.337690 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [68.0,57.0,88.0,24.0,64.0,203.0,165.0,46.0,76.0,129.0,101.0,47.0,359.0,16.0,33.0,461.0,199.0,37.0,151.0,38.0,248.0,127.0,185.0,137.0,173.0,95.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,172.0,270.0,28.0,898.0,304.0,266.0,44.0,88.0,117.0,54.0,432.0,54.0,85.0,186.0,33.0,10.0,112.0,346.0,41.0,16.0,220.0,70.0,68.0,87.0,29.0,351.0,38.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:51:46.337709 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:51:46.337763 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 898
[2025-11-05 08:51:46.337795 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 68
[2025-11-05 08:51:46.337822 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 112
[2025-11-05 08:51:46.337849 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 185
[2025-11-05 08:51:46.337884 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    int cre2_opt_one_line(cre2_options_t * opt),
    int cre2_error_code(const cre2_regexp_t * re)
[2025-11-05 08:51:46.338589 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 189, quiet_round: 0, discovered_api_pairs: 3348
[2025-11-05 08:51:46.372906 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:51:46.373236 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    int cre2_error_code(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    const char * errstr = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add_res1 = 0;\n    int add_res2 = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    enc = cre2_opt_encoding(opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_res1 = cre2_set_add_simple(set, \"hello\");\n    add_res2 = cre2_set_add_simple(set, \"world\");\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    errstr = cre2_error_string(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)enc + (long)add_res1 + (long)add_res2 + (long)(errstr != NULL) + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha)(beta)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add1_res = 0;\n    int add2_res = 0;\n    int compile_res = 0;\n    const char * re_pat = NULL;\n    int num_groups = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add1_res = cre2_set_add_simple(set, \"alpha\");\n    add2_res = cre2_set_add_simple(set, \"beta\");\n    compile_res = cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    re_pat = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n    err_code = cre2_error_code(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)enc + (long)add1_res + (long)add2_res + (long)compile_res + (long)(re_pat != NULL) + (long)num_groups + (long)err_code + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:52:15.460886 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 08:52:15.461013 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28350, Completion: 21605, Total: 49955
[2025-11-05 08:52:15.461033 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:52:15.677912 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001890/id_001890.cc
[2025-11-05 08:52:15.677972 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:15.906042 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:15.906122 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:15.908891 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:15.908922 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:16.127584 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001891/id_001891.cc
[2025-11-05 08:52:16.127644 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:16.356768 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:16.356848 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:16.359482 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:16.359511 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:16.578160 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001892/id_001892.cc
[2025-11-05 08:52:16.578254 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:16.807977 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:16.808049 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:16.810752 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:16.810783 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:17.031069 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001893/id_001893.cc
[2025-11-05 08:52:17.031121 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:17.260727 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:17.260805 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:17.263529 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:17.263562 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:17.480673 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001894/id_001894.cc
[2025-11-05 08:52:17.480728 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:17.709276 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:17.709389 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:17.712042 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:17.712075 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:17.929562 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001895/id_001895.cc
[2025-11-05 08:52:17.929615 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:18.159004 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:18.159078 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:18.161949 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:18.161981 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:18.379768 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001896/id_001896.cc
[2025-11-05 08:52:18.379822 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:18.608990 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:18.609062 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:18.611616 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:18.611642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:18.828036 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001897/id_001897.cc
[2025-11-05 08:52:18.828120 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:19.056665 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:19.056743 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:19.059460 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:19.059486 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:19.277036 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001898/id_001898.cc
[2025-11-05 08:52:19.277090 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:19.506154 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:19.506229 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:19.509098 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:19.509128 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:19.726765 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001899/id_001899.cc
[2025-11-05 08:52:19.726819 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:19.956234 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:19.956340 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:19.959165 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:19.959217 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:19.959255 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:52:19.959272 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1900, succ: 1899, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:52:19.959287 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:52:19.959314 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:52:20.235972 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1899 as an example for the next prompt.
[2025-11-05 08:52:20.236029 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 08:52:20.236063 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 08:52:20.236111 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,203.0,165.0,46.0,76.0,129.0,101.0,47.0,359.0,16.0,33.0,463.0,199.0,37.0,153.0,38.0,249.0,127.0,192.0,137.0,173.0,95.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,172.0,271.0,28.0,904.0,304.0,266.0,44.0,88.0,117.0,54.0,432.0,54.0,85.0,186.0,33.0,10.0,117.0,346.0,41.0,16.0,220.0,70.0,68.0,87.0,29.0,351.0,38.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:52:20.236128 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:52:20.236209 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 351
[2025-11-05 08:52:20.236240 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 263
[2025-11-05 08:52:20.236268 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 271
[2025-11-05 08:52:20.236293 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 173
[2025-11-05 08:52:20.236322 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_never_nl energy: 38
[2025-11-05 08:52:20.236356 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    void cre2_set_delete(cre2_set * set),
    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag)
[2025-11-05 08:52:20.237201 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 190, quiet_round: 0, discovered_api_pairs: 3360
[2025-11-05 08:52:20.275069 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:52:20.275416 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    void cre2_set_delete(cre2_set * set),\n    void cre2_opt_set_never_nl(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha)(beta)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int add1_res = 0;\n    int add2_res = 0;\n    int compile_res = 0;\n    const char * re_pat = NULL;\n    int num_groups = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add1_res = cre2_set_add_simple(set, \"alpha\");\n    add2_res = cre2_set_add_simple(set, \"beta\");\n    compile_res = cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 3: Core operations\n    re_pat = cre2_pattern(re);\n    num_groups = cre2_num_capturing_groups(re);\n    err_code = cre2_error_code(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)enc + (long)add1_res + (long)add2_res + (long)compile_res + (long)(re_pat != NULL) + (long)num_groups + (long)err_code + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    char rewrite_buf[] = \"\\\\1\";\n    cre2_string_t rewrite;\n    char errmsg_buf[256];\n    cre2_string_t errmsg;\n    int one_line_flag = 0;\n    int check_res = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    one_line_flag = cre2_opt_one_line(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code = cre2_error_code(re);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)one_line_flag + (long)check_res + (long)err_code + (long)(re != NULL) + (long)rewrite.length + (long)(errmsg_buf[0] != 0);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:52:46.726665 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 08:52:46.726788 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28510, Completion: 18127, Total: 46637
[2025-11-05 08:52:46.726809 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:52:46.944273 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001900/id_001900.cc
[2025-11-05 08:52:46.944337 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:47.174762 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:47.174840 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:47.177595 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:47.177621 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:47.398285 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001901/id_001901.cc
[2025-11-05 08:52:47.398340 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:47.631726 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:47.631802 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:47.634467 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:47.634501 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:47.856559 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001902/id_001902.cc
[2025-11-05 08:52:47.856658 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:48.087118 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:48.087195 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:48.090066 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:48.090100 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:48.311557 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001903/id_001903.cc
[2025-11-05 08:52:48.311612 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:48.543810 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:48.543903 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:48.546757 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:48.546786 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:48.767266 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001904/id_001904.cc
[2025-11-05 08:52:48.767320 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:49.000824 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:49.000935 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:49.003607 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:49.003638 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:49.221839 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001905/id_001905.cc
[2025-11-05 08:52:49.221893 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:49.452161 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:49.452226 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:49.454945 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:49.454974 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:49.675286 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001906/id_001906.cc
[2025-11-05 08:52:49.675346 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:49.906105 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:49.906188 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:49.909187 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:49.909213 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:50.127322 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001907/id_001907.cc
[2025-11-05 08:52:50.127404 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:50.358706 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:50.358781 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:50.361440 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:50.361468 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:50.579266 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001908/id_001908.cc
[2025-11-05 08:52:50.579320 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:52:50.811060 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:52:50.811126 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:52:50.813882 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:52:50.813909 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:52:51.035963 +00:00] WARN [src/fuzzer.rs:205] Program 1909 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001909/id_001909.cc:34:11: error: no matching function for call to 'cre2_set_new'
   34 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:52:51.073943 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:52:51.074269 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * re_pat = NULL;\n    int add_res1 = 0;\n    int add_res2 = 0;\n    int compile_res = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_never_nl(opt, 1);\n    set = cre2_set_new(opt, 0);\n    add_res1 = cre2_set_add_simple(set, \"hello\");\n    add_res2 = cre2_set_add_simple(set, \"world\");\n    compile_res = cre2_set_compile(set);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n    err_code = cre2_error_code(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)add_res1 + (long)add_res2 + (long)compile_res + (long)(re_pat != NULL) + (long)err_code + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001909/id_001909.cc:34:11: error: no matching function for call to 'cre2_set_new'\n   34 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:53:03.647269 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 12s
[2025-11-05 08:53:03.647392 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21860, Completion: 8108, Total: 29968
[2025-11-05 08:53:03.864489 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001909/id_001909.cc
[2025-11-05 08:53:03.864542 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:04.094411 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:04.094484 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:04.097371 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:04.097403 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:04.097435 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1909!
[2025-11-05 08:53:04.097472 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:53:04.097487 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1910, succ: 1909, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:53:04.097501 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:53:04.097525 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:53:04.370494 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1909 as an example for the next prompt.
[2025-11-05 08:53:04.370550 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 08:53:04.370580 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 08:53:04.370627 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,203.0,165.0,46.0,76.0,129.0,101.0,47.0,361.0,16.0,33.0,464.0,199.0,37.0,153.0,38.0,250.0,127.0,194.0,137.0,177.0,95.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,172.0,273.0,28.0,904.0,304.0,267.0,44.0,90.0,117.0,57.0,432.0,54.0,85.0,186.0,33.0,10.0,117.0,346.0,41.0,16.0,220.0,70.0,68.0,87.0,29.0,352.0,40.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:53:04.370644 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:53:04.370696 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_log_errors energy: 101
[2025-11-05 08:53:04.370726 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 127
[2025-11-05 08:53:04.370753 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 226
[2025-11-05 08:53:04.370790 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 904
[2025-11-05 08:53:04.370818 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 346
[2025-11-05 08:53:04.370856 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_log_errors(cre2_options_t * opt, int flag),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 08:53:04.371666 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 191, quiet_round: 0, discovered_api_pairs: 3368
[2025-11-05 08:53:04.412868 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:53:04.413232 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_log_errors(cre2_options_t * opt, int flag),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    char rewrite_buf[] = \"\\\\1\";\n    cre2_string_t rewrite;\n    char errmsg_buf[256];\n    cre2_string_t errmsg;\n    int one_line_flag = 0;\n    int check_res = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    one_line_flag = cre2_opt_one_line(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code = cre2_error_code(re);\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    memset(errmsg_buf, 0, sizeof(errmsg_buf));\n    errmsg.data = errmsg_buf;\n    errmsg.length = 0;\n    check_res = cre2_check_rewrite_string(re, &rewrite, &errmsg);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)one_line_flag + (long)check_res + (long)err_code + (long)(re != NULL) + (long)rewrite.length + (long)(errmsg_buf[0] != 0);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * re_pat = NULL;\n    int add_res1 = 0;\n    int add_res2 = 0;\n    int compile_res = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_never_nl(opt, 1);\n    /* cre2_set_new expects a cre2_anchor_t for the second argument; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_res1 = cre2_set_add_simple(set, \"hello\");\n    add_res2 = cre2_set_add_simple(set, \"world\");\n    compile_res = cre2_set_compile(set);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n    err_code = cre2_error_code(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)add_res1 + (long)add_res2 + (long)compile_res + (long)(re_pat != NULL) + (long)err_code + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:53:34.528469 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 08:53:34.528593 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28650, Completion: 20262, Total: 48912
[2025-11-05 08:53:34.528614 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:53:34.746721 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001910/id_001910.cc
[2025-11-05 08:53:34.746776 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:34.977300 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:34.977373 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:34.979836 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:34.979869 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:35.197708 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001911/id_001911.cc
[2025-11-05 08:53:35.197762 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:35.425685 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:35.425745 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:35.428926 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:35.428959 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:35.647732 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001912/id_001912.cc
[2025-11-05 08:53:35.647817 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:35.877347 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:35.877419 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:35.880272 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:35.880323 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:36.096902 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001913/id_001913.cc
[2025-11-05 08:53:36.096956 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:36.325063 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:36.325135 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:36.327983 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:36.328015 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:36.546865 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001914/id_001914.cc
[2025-11-05 08:53:36.546919 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:36.777195 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:36.777304 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:36.779820 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:36.779851 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:36.998762 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001915/id_001915.cc
[2025-11-05 08:53:36.998818 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:37.227882 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:37.227950 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:37.231135 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:37.231169 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:37.449746 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001916/id_001916.cc
[2025-11-05 08:53:37.449801 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:37.678542 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:37.678603 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:37.681428 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:37.681460 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:37.901015 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001917/id_001917.cc
[2025-11-05 08:53:37.901101 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:38.131437 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:38.131510 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:38.134715 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:38.134749 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:38.351819 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001918/id_001918.cc
[2025-11-05 08:53:38.351873 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:38.580536 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:38.580604 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:38.583589 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:38.583617 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:38.800288 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001919/id_001919.cc
[2025-11-05 08:53:38.800342 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:53:39.030272 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:53:39.030359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:53:39.033521 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:53:39.033553 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:53:39.033591 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:53:39.033608 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1920, succ: 1919, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:53:39.033623 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:53:39.033654 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:53:39.306178 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1919 as an example for the next prompt.
[2025-11-05 08:53:39.306234 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 08:53:39.306266 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 08:53:39.306313 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,203.0,165.0,46.0,76.0,129.0,103.0,47.0,363.0,16.0,33.0,464.0,199.0,37.0,153.0,38.0,250.0,131.0,199.0,137.0,177.0,96.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,172.0,273.0,28.0,904.0,307.0,267.0,44.0,90.0,117.0,57.0,432.0,54.0,85.0,186.0,33.0,10.0,117.0,350.0,43.0,16.0,220.0,70.0,68.0,87.0,29.0,356.0,40.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:53:39.306331 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:53:39.306386 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 464
[2025-11-05 08:53:39.306417 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 363
[2025-11-05 08:53:39.306456 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 273
[2025-11-05 08:53:39.306483 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_nl energy: 57
[2025-11-05 08:53:39.306514 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_opt_never_nl(cre2_options_t * opt)
[2025-11-05 08:53:39.307207 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 192, quiet_round: 0, discovered_api_pairs: 3378
[2025-11-05 08:53:39.334126 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:53:39.334463 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_opt_never_nl(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * re_pat = NULL;\n    int add_res1 = 0;\n    int add_res2 = 0;\n    int compile_res = 0;\n    int err_code = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_never_nl(opt, 1);\n    /* cre2_set_new expects a cre2_anchor_t for the second argument; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_res1 = cre2_set_add_simple(set, \"hello\");\n    add_res2 = cre2_set_add_simple(set, \"world\");\n    compile_res = cre2_set_compile(set);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    re_pat = cre2_pattern(re);\n    err_code = cre2_error_code(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)add_res1 + (long)add_res2 + (long)compile_res + (long)(re_pat != NULL) + (long)err_code + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>foo)(?P<second>bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * found_name = NULL;\n    int found_index = -1;\n    bool iter_next_result = false;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int err_code = 0;\n    int num_groups = 0;\n    const char * re_pat = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Core operations\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code = cre2_error_code(re);\n    num_groups = cre2_num_capturing_groups(re);\n    re_pat = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    iter_next_result = cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)enc + (long)err_code + (long)num_groups + (long)(re_pat != NULL) + (long)(iter_next_result ? 1 : 0) + (long)(found_index) + (long)(found_name != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:54:04.765017 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 25s
[2025-11-05 08:54:04.765141 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28420, Completion: 16941, Total: 45361
[2025-11-05 08:54:04.765161 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:54:04.982421 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001920/id_001920.cc
[2025-11-05 08:54:04.982473 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:05.209889 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:05.209949 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:05.212820 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:05.212853 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:05.430140 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001921/id_001921.cc
[2025-11-05 08:54:05.430191 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:05.660143 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:05.660214 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:05.662957 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:05.662983 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:05.881276 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001922/id_001922.cc
[2025-11-05 08:54:05.881358 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:06.110742 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:06.110819 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:06.113548 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:06.113580 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:06.331445 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001923/id_001923.cc
[2025-11-05 08:54:06.331497 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:06.561386 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:06.561465 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:06.564180 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:06.564214 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:06.781498 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001924/id_001924.cc
[2025-11-05 08:54:06.781550 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:07.010813 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:07.010920 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:07.013762 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:07.013794 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:07.231226 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001925/id_001925.cc
[2025-11-05 08:54:07.231288 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:07.458491 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:07.458549 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:07.461305 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:07.461337 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:07.678405 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001926/id_001926.cc
[2025-11-05 08:54:07.678458 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:07.908204 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:07.908265 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:07.911067 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:07.911101 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:08.129593 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001927/id_001927.cc
[2025-11-05 08:54:08.129677 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:08.358895 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:08.358954 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:08.361646 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:08.361678 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:08.578808 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001928/id_001928.cc
[2025-11-05 08:54:08.578862 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:08.806847 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:08.806907 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:08.809530 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:08.809562 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:09.029195 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001929/id_001929.cc
[2025-11-05 08:54:09.029250 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:09.258876 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:09.258962 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:09.261759 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:09.261792 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:09.261829 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:54:09.261845 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1930, succ: 1929, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:54:09.261861 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:54:09.261893 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:54:09.527359 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1929 as an example for the next prompt.
[2025-11-05 08:54:09.527411 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 11 new API pairs in this round.
[2025-11-05 08:54:09.527456 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 11
[2025-11-05 08:54:09.527505 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,203.0,165.0,46.0,76.0,129.0,103.0,47.0,369.0,16.0,33.0,466.0,199.0,37.0,153.0,38.0,250.0,131.0,205.0,137.0,177.0,96.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,172.0,275.0,28.0,908.0,307.0,267.0,44.0,90.0,117.0,64.0,432.0,54.0,85.0,186.0,33.0,10.0,117.0,350.0,43.0,16.0,220.0,70.0,68.0,87.0,29.0,359.0,43.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:54:09.527524 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:54:09.527577 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 369
[2025-11-05 08:54:09.527610 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 203
[2025-11-05 08:54:09.527650 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 350
[2025-11-05 08:54:09.527679 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 908
[2025-11-05 08:54:09.527712 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 08:54:09.528414 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 193, quiet_round: 0, discovered_api_pairs: 3389
[2025-11-05 08:54:09.564672 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:54:09.565009 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>foo)(?P<second>bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * found_name = NULL;\n    int found_index = -1;\n    bool iter_next_result = false;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int err_code = 0;\n    int num_groups = 0;\n    const char * re_pat = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_log_errors(opt, 1);\n    cre2_opt_set_literal(opt, 0);\n\n    // step 3: Core operations\n    enc = cre2_opt_encoding(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code = cre2_error_code(re);\n    num_groups = cre2_num_capturing_groups(re);\n    re_pat = cre2_pattern(re);\n    iter = cre2_named_groups_iter_new(re);\n    iter_next_result = cre2_named_groups_iter_next(iter, &found_name, &found_index);\n    cre2_named_groups_iter_delete(iter);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)enc + (long)err_code + (long)num_groups + (long)(re_pat != NULL) + (long)(iter_next_result ? 1 : 0) + (long)(found_index) + (long)(found_name != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha)(beta)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int num_groups = 0;\n    int never_nl_flag = -1;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_never_nl(opt, 1);\n    never_nl_flag = cre2_opt_never_nl(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)never_nl_flag + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:54:37.861631 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 08:54:37.861759 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 27680, Completion: 21169, Total: 48849
[2025-11-05 08:54:37.861780 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:54:38.078939 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001930/id_001930.cc
[2025-11-05 08:54:38.078993 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:38.307765 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:38.307841 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:38.310752 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:38.310783 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:38.529284 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001931/id_001931.cc
[2025-11-05 08:54:38.529340 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:38.757500 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:38.757572 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:38.760427 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:38.760483 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:38.978539 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001932/id_001932.cc
[2025-11-05 08:54:38.978627 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:39.208171 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:39.208230 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:39.210901 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:39.210935 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:39.429486 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001933/id_001933.cc
[2025-11-05 08:54:39.429542 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:39.657779 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:39.657856 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:39.660686 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:39.660720 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:39.878854 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001934/id_001934.cc
[2025-11-05 08:54:39.878908 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:40.106219 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:40.106331 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:40.109206 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:40.109238 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:40.325571 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001935/id_001935.cc
[2025-11-05 08:54:40.325626 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:40.554638 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:40.554716 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:40.557581 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:40.557612 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:40.774628 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001936/id_001936.cc
[2025-11-05 08:54:40.774683 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:41.003981 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:41.004057 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:41.006941 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:41.006973 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:41.224467 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001937/id_001937.cc
[2025-11-05 08:54:41.224552 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:41.454595 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:41.454671 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:41.457559 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:41.457592 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:41.674665 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001938/id_001938.cc
[2025-11-05 08:54:41.674718 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:41.901986 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:41.902062 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:41.904920 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:41.904952 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:42.121360 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001939/id_001939.cc
[2025-11-05 08:54:42.121415 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:54:42.349761 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:54:42.349877 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:54:42.352764 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:54:42.352796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:54:42.352836 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:54:42.352853 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1940, succ: 1939, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:54:42.352868 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:54:42.352896 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:54:42.631075 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1939 as an example for the next prompt.
[2025-11-05 08:54:42.631131 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 08:54:42.631159 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 08:54:42.631206 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,76.0,129.0,108.0,47.0,370.0,16.0,33.0,466.0,199.0,37.0,153.0,38.0,250.0,131.0,205.0,137.0,177.0,96.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,174.0,277.0,28.0,909.0,307.0,267.0,44.0,90.0,117.0,64.0,432.0,54.0,85.0,186.0,33.0,10.0,117.0,354.0,43.0,16.0,220.0,70.0,68.0,87.0,29.0,359.0,43.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:54:42.631222 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:54:42.631277 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 277
[2025-11-05 08:54:42.631307 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 909
[2025-11-05 08:54:42.631336 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 199
[2025-11-05 08:54:42.631370 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 117
[2025-11-05 08:54:42.631408 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_opt_one_line(cre2_options_t * opt)
[2025-11-05 08:54:42.632114 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 194, quiet_round: 0, discovered_api_pairs: 3395
[2025-11-05 08:54:42.680593 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:54:42.680983 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_opt_one_line(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(alpha)(beta)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int num_groups = 0;\n    int never_nl_flag = -1;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_never_nl(opt, 1);\n    never_nl_flag = cre2_opt_never_nl(opt);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)num_groups + (long)never_nl_flag + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int num_groups = 0;\n    const char text[] = \"foobar foobar\";\n    const char rewrite_text[] = \"$1-$2\";\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations (compile and inspect)\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate (prepare strings and perform replace)\n    text_and_target.data = text;\n    text_and_target.length = (int)(sizeof(text) - 1);\n    rewrite.data = rewrite_text;\n    rewrite.length = (int)(sizeof(rewrite_text) - 1);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)enc + (long)num_groups + (long)replace_ret + (long)text_and_target.length + (long)rewrite.length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:55:10.829350 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 28s
[2025-11-05 08:55:10.829470 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28030, Completion: 19576, Total: 47606
[2025-11-05 08:55:10.829490 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:55:11.047241 +00:00] WARN [src/fuzzer.rs:205] Program 1940 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001940/id_001940.cc:31:5: error: no matching function for call to 'cre2_opt_one_line'
   31 |     cre2_opt_one_line(opt, 1);
      |     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:55:11.095865 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:55:11.096199 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(Alpha)(Beta)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char text[] = \"AlphaBeta Alpha\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_string_t matches[3];\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    matches[0].data = NULL; matches[0].length = 0;\n    matches[1].data = NULL; matches[1].length = 0;\n    matches[2].data = NULL; matches[2].length = 0;\n    match_ret = cre2_match(re, text, text_len, 0, text_len, CRE2_UNANCHORED, matches, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001940/id_001940.cc:31:5: error: no matching function for call to 'cre2_opt_one_line'\n   31 |     cre2_opt_one_line(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:55:25.226426 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 14s
[2025-11-05 08:55:25.226550 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22090, Completion: 9477, Total: 31567
[2025-11-05 08:55:25.444912 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001940/id_001940.cc
[2025-11-05 08:55:25.444968 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:25.674969 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:25.675028 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:25.677815 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:25.677847 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:25.677879 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1940!
[2025-11-05 08:55:25.896286 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001941/id_001941.cc
[2025-11-05 08:55:25.896341 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:26.125130 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:26.125197 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:26.127933 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:26.127964 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:26.345573 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001942/id_001942.cc
[2025-11-05 08:55:26.345660 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:26.574570 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:26.574628 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:26.577457 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:26.577488 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:26.795761 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001943/id_001943.cc
[2025-11-05 08:55:26.795814 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:27.025296 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:27.025363 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:27.027889 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:27.027921 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:27.244897 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001944/id_001944.cc
[2025-11-05 08:55:27.244952 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:27.474211 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:27.474314 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:27.477211 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:27.477243 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:27.694719 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001945/id_001945.cc
[2025-11-05 08:55:27.694787 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:27.923144 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:27.923210 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:27.926065 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:27.926097 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:28.143389 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001946/id_001946.cc
[2025-11-05 08:55:28.143443 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:28.371350 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:28.371418 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:28.374307 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:28.374339 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:28.592204 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001947/id_001947.cc
[2025-11-05 08:55:28.592290 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:28.821855 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:28.821922 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:28.824774 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:28.824806 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:29.042761 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001948/id_001948.cc
[2025-11-05 08:55:29.042818 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:29.271378 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:29.271446 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:29.274347 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:29.274378 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:29.492376 +00:00] WARN [src/fuzzer.rs:205] Program 1949 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001949/id_001949.cc:31:5: error: no matching function for call to 'cre2_opt_one_line'
   31 |     cre2_opt_one_line(opt, 1);
      |     ^~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 08:55:29.540977 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:55:29.541304 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char text[] = \"helloworld hello\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_string_t matches[3] = { {NULL, 0}, {NULL, 0}, {NULL, 0} };\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    match_ret = cre2_match(re, text, text_len, 0, text_len, CRE2_UNANCHORED, matches, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001949/id_001949.cc:31:5: error: no matching function for call to 'cre2_opt_one_line'\n   31 |     cre2_opt_one_line(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:83:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   83 | cre2_decl int cre2_opt_one_line                 (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:55:42.664699 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 13s
[2025-11-05 08:55:42.664823 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21760, Completion: 9704, Total: 31464
[2025-11-05 08:55:42.881607 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001949/id_001949.cc
[2025-11-05 08:55:42.881659 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:55:43.112797 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:55:43.112865 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:55:43.115382 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:55:43.115414 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:55:43.115447 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1949!
[2025-11-05 08:55:43.115482 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:55:43.115498 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1950, succ: 1949, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:55:43.115512 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:55:43.115538 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:55:43.387409 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1949 as an example for the next prompt.
[2025-11-05 08:55:43.387463 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 08:55:43.387493 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 08:55:43.387540 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,76.0,129.0,108.0,47.0,371.0,16.0,33.0,467.0,204.0,37.0,155.0,38.0,250.0,131.0,205.0,137.0,177.0,96.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,174.0,277.0,28.0,913.0,307.0,267.0,44.0,93.0,117.0,64.0,432.0,54.0,85.0,186.0,33.0,10.0,120.0,354.0,43.0,16.0,220.0,70.0,68.0,87.0,29.0,359.0,43.0,68.0,59.0,51.0,226.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:55:43.387558 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:55:43.387621 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 354
[2025-11-05 08:55:43.387655 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_string energy: 43
[2025-11-05 08:55:43.387682 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 307
[2025-11-05 08:55:43.387736 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 432
[2025-11-05 08:55:43.387776 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 85
[2025-11-05 08:55:43.387815 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    const char *cre2_error_string(const cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_opt_log_errors(cre2_options_t * opt)
[2025-11-05 08:55:43.388609 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 195, quiet_round: 0, discovered_api_pairs: 3403
[2025-11-05 08:55:43.432067 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:55:43.432412 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    const char *cre2_error_string(const cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_opt_log_errors(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int num_groups = 0;\n    const char text[] = \"foobar foobar\";\n    const char rewrite_text[] = \"$1-$2\";\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Core operations (compile and inspect)\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate (prepare strings and perform replace)\n    text_and_target.data = text;\n    text_and_target.length = (int)(sizeof(text) - 1);\n    rewrite.data = rewrite_text;\n    rewrite.length = (int)(sizeof(rewrite_text) - 1);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)enc + (long)num_groups + (long)replace_ret + (long)text_and_target.length + (long)rewrite.length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char text[] = \"helloworld hello\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_string_t matches[3] = { {NULL, 0}, {NULL, 0}, {NULL, 0} };\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    match_ret = cre2_match(re, text, text_len, 0, text_len, CRE2_UNANCHORED, matches, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:56:13.754541 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 30s
[2025-11-05 08:56:13.754666 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28760, Completion: 22185, Total: 50945
[2025-11-05 08:56:13.754687 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:56:13.972424 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001950/id_001950.cc
[2025-11-05 08:56:13.972477 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:14.202506 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:14.202583 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:14.205700 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:14.205731 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:14.424241 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001951/id_001951.cc
[2025-11-05 08:56:14.424295 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:14.654055 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:14.654132 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:14.657017 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:14.657050 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:14.876441 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001952/id_001952.cc
[2025-11-05 08:56:14.876528 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:15.105923 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:15.106002 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:15.108849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:15.108882 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:15.327436 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001953/id_001953.cc
[2025-11-05 08:56:15.327490 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:15.556019 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:15.556097 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:15.558950 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:15.558984 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:15.775922 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001954/id_001954.cc
[2025-11-05 08:56:15.775975 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:16.005805 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:16.005922 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:16.009144 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:16.009178 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:16.227190 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001955/id_001955.cc
[2025-11-05 08:56:16.227244 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:16.457316 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:16.457388 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:16.460136 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:16.460167 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:16.677118 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001956/id_001956.cc
[2025-11-05 08:56:16.677172 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:16.907294 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:16.907369 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:16.910303 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:16.910335 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:17.129543 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001957/id_001957.cc
[2025-11-05 08:56:17.129628 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:17.359040 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:17.359117 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:17.361958 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:17.361991 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:17.578888 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001958/id_001958.cc
[2025-11-05 08:56:17.578953 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:17.809342 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:17.809419 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:17.812058 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:17.812090 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:18.029677 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001959/id_001959.cc
[2025-11-05 08:56:18.029732 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:18.259948 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:18.260062 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:18.262860 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:18.262893 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:18.262930 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:56:18.262946 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1960, succ: 1959, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:56:18.262962 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:56:18.262985 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:56:18.545021 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1959 as an example for the next prompt.
[2025-11-05 08:56:18.545077 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 16 new API pairs in this round.
[2025-11-05 08:56:18.545116 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 16
[2025-11-05 08:56:18.545165 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,76.0,129.0,112.0,47.0,371.0,16.0,33.0,467.0,204.0,37.0,156.0,38.0,251.0,131.0,205.0,137.0,177.0,96.0,82.0,27.0,18.0,66.0,198.0,139.0,16.0,24.0,174.0,278.0,28.0,918.0,311.0,267.0,44.0,93.0,117.0,64.0,440.0,54.0,92.0,186.0,33.0,10.0,120.0,359.0,51.0,16.0,220.0,70.0,68.0,87.0,29.0,359.0,43.0,68.0,59.0,51.0,228.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:56:18.545182 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:56:18.545235 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_arg energy: 16
[2025-11-05 08:56:18.545269 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 139
[2025-11-05 08:56:18.545295 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract_re energy: 82
[2025-11-05 08:56:18.545331 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 251
[2025-11-05 08:56:18.545362 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 918
[2025-11-05 08:56:18.545403 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg),
    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    cre2_options_t *cre2_opt_new(),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 08:56:18.546260 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 196, quiet_round: 0, discovered_api_pairs: 3419
[2025-11-05 08:56:18.595048 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:56:18.595445 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_error_arg(const cre2_regexp_t * re, cre2_string_t * arg),\n    void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    int cre2_extract_re(cre2_regexp_t * rex, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    cre2_options_t *cre2_opt_new(),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char text[] = \"helloworld hello\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_string_t matches[3] = { {NULL, 0}, {NULL, 0}, {NULL, 0} };\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    match_ret = cre2_match(re, text, text_len, 0, text_len, CRE2_UNANCHORED, matches, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar baz foo\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * named_iter = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int log_flag = 0;\n    cre2_string_t matches[3] = { {NULL, 0}, {NULL, 0}, {NULL, 0} };\n    int match_ret = 0;\n    const char * errstr = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    log_flag = cre2_opt_log_errors(opt);\n\n    // step 3: Core operations\n    match_ret = cre2_easy_match(pattern, pattern_len, text, text_len, matches, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Inspect compiled regexp\n    errstr = cre2_error_string(re);\n    named_iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate (compute a checksum to use results meaningfully)\n    checksum = (long)pattern_len + (long)text_len + (long)enc + (long)log_flag + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(errstr != NULL) + (long)(named_iter != NULL) + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(named_iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:56:57.793027 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 39s
[2025-11-05 08:56:57.793150 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29410, Completion: 25972, Total: 55382
[2025-11-05 08:56:57.793171 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:56:58.011510 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001960/id_001960.cc
[2025-11-05 08:56:58.011565 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:58.242356 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:58.242424 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:58.245230 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:58.245257 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:58.464404 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001961/id_001961.cc
[2025-11-05 08:56:58.464456 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:58.693743 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:58.693803 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:58.696683 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:58.696711 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:58.914514 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001962/id_001962.cc
[2025-11-05 08:56:58.914599 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:59.142881 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:59.142949 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:59.145690 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:59.145718 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:59.363162 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001963/id_001963.cc
[2025-11-05 08:56:59.363216 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:56:59.592817 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:56:59.592890 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:56:59.595471 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:56:59.595502 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:56:59.814354 +00:00] WARN [src/fuzzer.rs:205] Program 1964 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_001964/id_001964.cc:60:5: error: unknown type name 'API'
   60 |     API sequence test completed successfully
      |     ^
/root/promptfuzz/output/cre2/work/id_001964/id_001964.cc:60:17: error: expected ';' at end of declaration
   60 |     API sequence test completed successfully
      |                 ^
      |                 ;
2 errors generated.

[2025-11-05 08:56:59.863033 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:56:59.863370 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(a)(b)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char text[] = \"abxab\";\n    const int text_len = (int)(sizeof(text) - 1);\n    const char rewrite_fmt[] = \"$1-$2\";\n    cre2_string_t text_str = { text, text_len };\n    cre2_string_t rewrite_str = { rewrite_fmt, (int)(sizeof(rewrite_fmt) - 1) };\n    cre2_string_t target = { NULL, 0 };\n    cre2_string_t errarg = { NULL, 0 };\n    cre2_string_t strings[2];\n    cre2_range_t ranges[2];\n    int extract_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_error_arg(re, &errarg);\n    extract_ret = cre2_extract_re(re, &text_str, &rewrite_str, &target);\n\n    // step 4: Convert string slices to ranges\n    strings[0].data = text + 0;\n    strings[0].length = 1;\n    strings[1].data = text + 1;\n    strings[1].length = 1;\n    memset(ranges, 0, sizeof(ranges));\n    cre2_strings_to_ranges(text, ranges, strings, 2);\n\n    // step 5: Validate (compute a checksum to use results meaningfully)\n    checksum = (long)pattern_len + (long)text_len + (long)rewrite_str.length + (long)errarg.length + (long)extract_ret + (long)strings[0].length + (long)strings[1].length + (long)ranges[0].start + (long)ranges[0].past + (long)ranges[1].start + (long)ranges[1].past + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_001964/id_001964.cc:60:5: error: unknown type name 'API'\n   60 |     API sequence test completed successfully\n      |     ^\n/root/promptfuzz/output/cre2/work/id_001964/id_001964.cc:60:17: error: expected ';' at end of declaration\n   60 |     API sequence test completed successfully\n      |                 ^\n      |                 ;\n2 errors generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 08:57:18.874120 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 19s
[2025-11-05 08:57:18.874242 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 23230, Completion: 11515, Total: 34745
[2025-11-05 08:57:19.093245 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001964/id_001964.cc
[2025-11-05 08:57:19.093299 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:19.322456 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:19.322517 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:19.325254 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:19.325282 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:19.325314 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 1964!
[2025-11-05 08:57:19.543633 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001965/id_001965.cc
[2025-11-05 08:57:19.543689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:19.773185 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:19.773258 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:19.775883 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:19.775915 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:19.994136 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001966/id_001966.cc
[2025-11-05 08:57:19.994222 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:20.223030 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:20.223109 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:20.226019 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:20.226051 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:20.445512 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001967/id_001967.cc
[2025-11-05 08:57:20.445567 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:20.674485 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:20.674562 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:20.677469 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:20.677502 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:20.895406 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001968/id_001968.cc
[2025-11-05 08:57:20.895462 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:21.123342 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:21.123431 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:21.126217 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:21.126251 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:21.344230 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001969/id_001969.cc
[2025-11-05 08:57:21.344287 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:21.573354 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:21.573433 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:21.576000 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:21.576032 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:21.576072 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:57:21.576089 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1970, succ: 1969, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:57:21.576132 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:57:21.576161 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:57:21.866044 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1969 as an example for the next prompt.
[2025-11-05 08:57:21.866100 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 08:57:21.866141 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 08:57:21.866189 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,76.0,129.0,112.0,47.0,371.0,16.0,33.0,470.0,204.0,37.0,158.0,38.0,252.0,131.0,205.0,137.0,177.0,96.0,97.0,27.0,18.0,66.0,198.0,148.0,28.0,24.0,175.0,279.0,28.0,926.0,311.0,267.0,44.0,93.0,117.0,64.0,441.0,54.0,92.0,186.0,33.0,10.0,120.0,359.0,51.0,16.0,220.0,70.0,68.0,87.0,29.0,359.0,43.0,68.0,59.0,51.0,228.0,63.0,263.0,59.0,52.0,16.0]
[2025-11-05 08:57:21.866207 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:57:21.866261 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_named_capturing_groups energy: 51
[2025-11-05 08:57:21.866292 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 263
[2025-11-05 08:57:21.866321 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 137
[2025-11-05 08:57:21.866346 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 470
[2025-11-05 08:57:21.866374 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 441
[2025-11-05 08:57:21.866412 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_delete(cre2_regexp_t * re),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)
[2025-11-05 08:57:21.867242 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 197, quiet_round: 0, discovered_api_pairs: 3438
[2025-11-05 08:57:21.914197 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:57:21.914551 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_delete(cre2_regexp_t * re),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar baz foo\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * named_iter = NULL;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    int log_flag = 0;\n    cre2_string_t matches[3] = { {NULL, 0}, {NULL, 0}, {NULL, 0} };\n    int match_ret = 0;\n    const char * errstr = NULL;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    enc = cre2_opt_encoding(opt);\n    log_flag = cre2_opt_log_errors(opt);\n\n    // step 3: Core operations\n    match_ret = cre2_easy_match(pattern, pattern_len, text, text_len, matches, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Inspect compiled regexp\n    errstr = cre2_error_string(re);\n    named_iter = cre2_named_groups_iter_new(re);\n\n    // step 5: Validate (compute a checksum to use results meaningfully)\n    checksum = (long)pattern_len + (long)text_len + (long)enc + (long)log_flag + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(errstr != NULL) + (long)(named_iter != NULL) + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(named_iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"helloworld hello\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    cre2_string_t errarg;\n    cre2_string_t strings[3];\n    cre2_range_t ranges[3];\n    int extract_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    memset(&errarg, 0, sizeof(errarg));\n    memset(&target, 0, sizeof(target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_str.data = text;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_error_arg(re, &errarg);\n    rewrite.data = \"$1\";\n    rewrite.length = 2;\n    extract_ret = cre2_extract_re(re, &text_str, &rewrite, &target);\n    strings[0].data = text;\n    strings[0].length = 5;           // \"hello\" at start\n    strings[1].data = text + 5;\n    strings[1].length = 5;           // \"world\" following\n    strings[2].data = text + 11;\n    strings[2].length = 5;           // second \"hello\"\n    cre2_strings_to_ranges(text, ranges, strings, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)extract_ret + (long)errarg.length + (long)target.length + ranges[0].start + ranges[0].past + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:57:54.789416 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 08:57:54.789534 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31230, Completion: 23796, Total: 55026
[2025-11-05 08:57:54.789556 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:57:55.007300 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001970/id_001970.cc
[2025-11-05 08:57:55.007354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:55.238052 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:55.238128 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:55.241387 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:55.241421 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:55.458608 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001971/id_001971.cc
[2025-11-05 08:57:55.458661 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:55.686703 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:55.686780 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:55.690127 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:55.690162 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:55.908547 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001972/id_001972.cc
[2025-11-05 08:57:55.908651 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:56.137747 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:56.137823 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:56.141052 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:56.141086 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:56.360438 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001973/id_001973.cc
[2025-11-05 08:57:56.360490 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:56.590787 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:56.590862 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:56.594116 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:56.594149 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:56.810988 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001974/id_001974.cc
[2025-11-05 08:57:56.811042 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:57.039600 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:57.039716 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:57.042894 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:57.042948 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:57.261995 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001975/id_001975.cc
[2025-11-05 08:57:57.262048 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:57.492325 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:57.492402 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:57.495576 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:57.495608 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:57.712516 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001976/id_001976.cc
[2025-11-05 08:57:57.712570 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:57.942357 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:57.942435 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:57.945677 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:57.945710 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:58.162281 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001977/id_001977.cc
[2025-11-05 08:57:58.162367 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:58.392321 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:58.392398 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:58.395518 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:58.395552 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:58.613174 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001978/id_001978.cc
[2025-11-05 08:57:58.613227 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:58.843445 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:58.843517 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:58.846784 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:58.846817 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:59.065176 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001979/id_001979.cc
[2025-11-05 08:57:59.065229 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:57:59.295352 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:57:59.295469 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:57:59.298701 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:57:59.298733 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:57:59.298773 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:57:59.298788 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1980, succ: 1979, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:57:59.298803 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:57:59.298854 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:57:59.598668 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1979 as an example for the next prompt.
[2025-11-05 08:57:59.598723 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 26 new API pairs in this round.
[2025-11-05 08:57:59.598772 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 26
[2025-11-05 08:57:59.598820 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,76.0,129.0,115.0,47.0,371.0,16.0,33.0,472.0,204.0,37.0,159.0,38.0,252.0,131.0,205.0,145.0,179.0,96.0,97.0,27.0,18.0,66.0,199.0,148.0,28.0,24.0,178.0,281.0,28.0,934.0,311.0,277.0,44.0,93.0,117.0,64.0,454.0,54.0,92.0,186.0,33.0,10.0,120.0,359.0,51.0,16.0,220.0,70.0,68.0,87.0,29.0,359.0,43.0,68.0,59.0,65.0,228.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 08:57:59.598838 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:57:59.598889 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 277
[2025-11-05 08:57:59.598921 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_one_line energy: 159
[2025-11-05 08:57:59.598946 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add energy: 33
[2025-11-05 08:57:59.598977 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 220
[2025-11-05 08:57:59.599015 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),
    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)
[2025-11-05 08:57:59.599711 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 198, quiet_round: 0, discovered_api_pairs: 3464
[2025-11-05 08:57:59.646139 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:57:59.646495 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    void cre2_opt_set_one_line(cre2_options_t * opt, int flag),\n    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(hello)(world)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"helloworld hello\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t text_str;\n    cre2_string_t rewrite;\n    cre2_string_t target;\n    cre2_string_t errarg;\n    cre2_string_t strings[3];\n    cre2_range_t ranges[3];\n    int extract_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(strings, 0, sizeof(strings));\n    memset(ranges, 0, sizeof(ranges));\n    memset(&errarg, 0, sizeof(errarg));\n    memset(&target, 0, sizeof(target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    text_str.data = text;\n    text_str.length = text_len;\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    re = cre2_new(pattern, pattern_len, opt);\n    cre2_error_arg(re, &errarg);\n    rewrite.data = \"$1\";\n    rewrite.length = 2;\n    extract_ret = cre2_extract_re(re, &text_str, &rewrite, &target);\n    strings[0].data = text;\n    strings[0].length = 5;           // \"hello\" at start\n    strings[1].data = text + 5;\n    strings[1].length = 5;           // \"world\" following\n    strings[2].data = text + 11;\n    strings[2].length = 5;           // second \"hello\"\n    cre2_strings_to_ranges(text, ranges, strings, 3);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)extract_ret + (long)errarg.length + (long)target.length + ranges[0].start + ranges[0].past + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar foo\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_match_ret = 0;\n    int named_index = 0;\n    int set_add_ret = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Operate - lightweight match then compile and set creation\n    easy_match_ret = cre2_easy_match(pattern, pattern_len, text, text_len, matches, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 4: Operate - inspect named group and add simple pattern to set\n    named_index = cre2_find_named_capturing_groups(re, \"name\");\n    set_add_ret = cre2_set_add_simple(set, \"(foo)\");\n\n    // step 5: Operate - perform a global replace using compiled regexp\n    text_and_target.data = text;\n    text_and_target.length = text_len;\n    rewrite.data = \"$1\";\n    rewrite.length = 2;\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 6: Validate and Cleanup\n    checksum = (long)pattern_len + (long)text_len + (long)easy_match_ret + (long)named_index + (long)set_add_ret + (long)replace_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:58:21.953248 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 22s
[2025-11-05 08:58:21.953371 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31830, Completion: 18770, Total: 50600
[2025-11-05 08:58:21.953392 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:58:22.171639 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001980/id_001980.cc
[2025-11-05 08:58:22.171693 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:22.400021 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:22.400095 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:22.403019 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:22.403051 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:22.621650 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001981/id_001981.cc
[2025-11-05 08:58:22.621707 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:22.850673 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:22.850747 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:22.853467 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:22.853499 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:23.069649 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001982/id_001982.cc
[2025-11-05 08:58:23.069735 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:23.300766 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:23.300842 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:23.303549 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:23.303581 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:23.522100 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001983/id_001983.cc
[2025-11-05 08:58:23.522154 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:23.751609 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:23.751683 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:23.754422 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:23.754456 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:23.972829 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001984/id_001984.cc
[2025-11-05 08:58:23.972883 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:24.204126 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:24.204240 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:24.207099 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:24.207131 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:24.424701 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001985/id_001985.cc
[2025-11-05 08:58:24.424767 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:24.654341 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:24.654416 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:24.657234 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:24.657266 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:24.875543 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001986/id_001986.cc
[2025-11-05 08:58:24.875597 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:25.104993 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:25.105069 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:25.107663 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:25.107697 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:25.325711 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001987/id_001987.cc
[2025-11-05 08:58:25.325798 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:25.556523 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:25.556596 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:25.559184 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:25.559211 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:25.777095 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001988/id_001988.cc
[2025-11-05 08:58:25.777148 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:26.006238 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:26.006310 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:26.009139 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:26.009171 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:26.227974 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001989/id_001989.cc
[2025-11-05 08:58:26.228030 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:26.457855 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:26.457971 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:26.460876 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:26.460908 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:26.460947 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:58:26.460963 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 1990, succ: 1989, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:58:26.460978 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:58:26.461005 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:58:26.736506 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1989 as an example for the next prompt.
[2025-11-05 08:58:26.736572 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 08:58:26.736600 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 08:58:26.736658 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,76.0,129.0,115.0,47.0,371.0,16.0,33.0,472.0,204.0,37.0,160.0,38.0,252.0,131.0,205.0,145.0,180.0,96.0,97.0,27.0,18.0,66.0,200.0,148.0,28.0,24.0,178.0,281.0,28.0,934.0,311.0,280.0,44.0,93.0,117.0,64.0,454.0,54.0,92.0,186.0,42.0,10.0,120.0,359.0,51.0,16.0,223.0,70.0,68.0,87.0,29.0,359.0,43.0,68.0,59.0,65.0,228.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 08:58:26.736678 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:58:26.736730 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 359
[2025-11-05 08:58:26.736764 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 76
[2025-11-05 08:58:26.736790 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 934
[2025-11-05 08:58:26.736816 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 131
[2025-11-05 08:58:26.736843 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_max_mem energy: 59
[2025-11-05 08:58:26.736878 +00:00] INFO [src/request/prompt.rs:145] set combination: const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_opt_perl_classes(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m)
[2025-11-05 08:58:26.737684 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 199, quiet_round: 0, discovered_api_pairs: 3470
[2025-11-05 08:58:26.777461 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:58:26.777815 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nconst char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_opt_perl_classes(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>foo)(bar)?\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"foobar foo\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_match_ret = 0;\n    int named_index = 0;\n    int set_add_ret = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Operate - lightweight match then compile and set creation\n    easy_match_ret = cre2_easy_match(pattern, pattern_len, text, text_len, matches, 3);\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n\n    // step 4: Operate - inspect named group and add simple pattern to set\n    named_index = cre2_find_named_capturing_groups(re, \"name\");\n    set_add_ret = cre2_set_add_simple(set, \"(foo)\");\n\n    // step 5: Operate - perform a global replace using compiled regexp\n    text_and_target.data = text;\n    text_and_target.length = text_len;\n    rewrite.data = \"$1\";\n    rewrite.length = 2;\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 6: Validate and Cleanup\n    checksum = (long)pattern_len + (long)text_len + (long)easy_match_ret + (long)named_index + (long)set_add_ret + (long)replace_ret + (long)matches[0].length + (long)matches[1].length + (long)matches[2].length + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern1[] = \"foo([0-9]+)\";\n    const int pattern1_len = (int)(sizeof(pattern1) - 1);\n    const char pattern2[] = \"bar(baz)?\";\n    const int pattern2_len = (int)(sizeof(pattern2) - 1);\n    const char text[] = \"prefix foo123 middle barbaz suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    char err1[128];\n    char err2[128];\n    int add_ret1 = 0;\n    int add_ret2 = 0;\n    int compile_ret = 0;\n    int matches[8];\n    size_t match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(err1, 0, sizeof(err1));\n    memset(err2, 0, sizeof(err2));\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_ret1 = cre2_set_add(set, pattern1, (size_t)pattern1_len, err1, sizeof(err1));\n    add_ret2 = cre2_set_add(set, pattern2, (size_t)pattern2_len, err2, sizeof(err2));\n    compile_ret = cre2_set_compile(set);\n    match_count = cre2_set_match(set, text, (size_t)text_len, matches, (size_t)8);\n\n    // step 4: Validate\n    checksum = (long)pattern1_len + (long)pattern2_len + (long)text_len + (long)add_ret1 + (long)add_ret2 + (long)compile_ret + (long)match_count + (long)matches[0] + (long)(opt != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:58:54.524278 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 08:58:54.524397 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30960, Completion: 23084, Total: 54044
[2025-11-05 08:58:54.524418 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:58:54.742019 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001990/id_001990.cc
[2025-11-05 08:58:54.742084 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:54.971047 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:54.971122 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:54.974004 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:54.974031 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:55.190147 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001991/id_001991.cc
[2025-11-05 08:58:55.190202 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:55.419306 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:55.419382 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:55.422138 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:55.422165 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:55.639042 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001992/id_001992.cc
[2025-11-05 08:58:55.639128 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:55.867458 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:55.867533 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:55.870175 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:55.870202 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:56.086813 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001993/id_001993.cc
[2025-11-05 08:58:56.086874 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:56.315459 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:56.315537 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:56.318304 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:56.318332 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:56.536767 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001994/id_001994.cc
[2025-11-05 08:58:56.536822 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:56.767204 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:56.767321 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:56.770146 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:56.770177 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:56.987588 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001995/id_001995.cc
[2025-11-05 08:58:56.987644 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:57.217404 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:57.217482 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:57.220011 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:57.220043 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:57.437358 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001996/id_001996.cc
[2025-11-05 08:58:57.437412 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:57.665565 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:57.665643 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:57.668369 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:57.668403 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:57.886298 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001997/id_001997.cc
[2025-11-05 08:58:57.886381 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:58.116343 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:58.116418 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:58.119104 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:58.119133 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:58.337079 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001998/id_001998.cc
[2025-11-05 08:58:58.337134 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:58.565920 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:58.565995 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:58.568851 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:58.568884 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:58.784953 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_001999/id_001999.cc
[2025-11-05 08:58:58.785007 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:58:59.014460 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:58:59.014578 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:58:59.017318 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:58:59.017350 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:58:59.017389 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:58:59.017406 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2000, succ: 1999, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:58:59.017422 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:58:59.017449 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:58:59.286007 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 1999 as an example for the next prompt.
[2025-11-05 08:58:59.286063 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 08:58:59.286092 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 08:58:59.286139 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,82.0,129.0,115.0,47.0,371.0,16.0,33.0,473.0,204.0,37.0,160.0,38.0,253.0,136.0,205.0,145.0,180.0,96.0,97.0,27.0,18.0,66.0,200.0,148.0,28.0,24.0,179.0,281.0,28.0,937.0,311.0,280.0,44.0,93.0,117.0,64.0,454.0,54.0,92.0,186.0,42.0,10.0,120.0,359.0,51.0,16.0,223.0,70.0,68.0,87.0,29.0,362.0,43.0,68.0,63.0,65.0,228.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 08:58:59.286167 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:58:59.286221 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_strings_to_ranges energy: 148
[2025-11-05 08:58:59.286252 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 311
[2025-11-05 08:58:59.286281 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 145
[2025-11-05 08:58:59.286308 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 473
[2025-11-05 08:58:59.286343 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 08:58:59.287053 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 200, quiet_round: 0, discovered_api_pairs: 3478
[2025-11-05 08:58:59.324681 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:58:59.325033 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_strings_to_ranges(const char * text, cre2_range_t * ranges, cre2_string_t * strings, int nmatch),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern1[] = \"foo([0-9]+)\";\n    const int pattern1_len = (int)(sizeof(pattern1) - 1);\n    const char pattern2[] = \"bar(baz)?\";\n    const int pattern2_len = (int)(sizeof(pattern2) - 1);\n    const char text[] = \"prefix foo123 middle barbaz suffix\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    char err1[128];\n    char err2[128];\n    int add_ret1 = 0;\n    int add_ret2 = 0;\n    int compile_ret = 0;\n    int matches[8];\n    size_t match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(err1, 0, sizeof(err1));\n    memset(err2, 0, sizeof(err2));\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Core operations\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_ret1 = cre2_set_add(set, pattern1, (size_t)pattern1_len, err1, sizeof(err1));\n    add_ret2 = cre2_set_add(set, pattern2, (size_t)pattern2_len, err2, sizeof(err2));\n    compile_ret = cre2_set_compile(set);\n    match_count = cre2_set_match(set, text, (size_t)text_len, matches, (size_t)8);\n\n    // step 4: Validate\n    checksum = (long)pattern1_len + (long)pattern2_len + (long)text_len + (long)add_ret1 + (long)add_ret2 + (long)compile_ret + (long)match_count + (long)matches[0] + (long)(opt != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)[0-9]+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    int perl_classes_flag = 0;\n    long long max_mem_value = 1024LL * 1024LL;\n    long checksum = 0;\n\n    // step 2: Setup - create and configure options\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_max_mem(opt, max_mem_value);\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n\n    // step 3: Operate - compile regexp with configured options\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 4: Validate - compute a simple checksum based on results\n    checksum = (long)pattern_len + (long)max_mem_value + (long)perl_classes_flag + (long)(opt != NULL) + (long)(re != NULL) + (long)(pattern_from_re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 08:59:43.614025 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 44s
[2025-11-05 08:59:43.614151 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28960, Completion: 27376, Total: 56336
[2025-11-05 08:59:43.614171 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 08:59:43.832361 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002000/id_002000.cc
[2025-11-05 08:59:43.832413 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:44.060760 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:44.060832 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:44.063758 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:44.063789 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:44.281384 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002001/id_002001.cc
[2025-11-05 08:59:44.281440 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:44.511721 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:44.511794 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:44.514682 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:44.514714 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:44.733645 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002002/id_002002.cc
[2025-11-05 08:59:44.733741 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:44.963332 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:44.963408 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:44.966314 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:44.966347 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:45.185435 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002003/id_002003.cc
[2025-11-05 08:59:45.185489 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:45.415406 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:45.415482 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:45.418393 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:45.418426 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:45.637113 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002004/id_002004.cc
[2025-11-05 08:59:45.637166 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:45.866571 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:45.866690 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:45.869554 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:45.869586 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:46.087713 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002005/id_002005.cc
[2025-11-05 08:59:46.087767 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:46.316680 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:46.316747 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:46.319199 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:46.319231 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:46.537695 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002006/id_002006.cc
[2025-11-05 08:59:46.537749 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:46.768147 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:46.768221 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:46.771088 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:46.771120 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:46.987223 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002007/id_002007.cc
[2025-11-05 08:59:46.987309 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:47.216787 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:47.216861 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:47.219487 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:47.219519 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:47.437980 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002008/id_002008.cc
[2025-11-05 08:59:47.438033 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:47.667428 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:47.667501 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:47.670327 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:47.670359 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:47.887680 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002009/id_002009.cc
[2025-11-05 08:59:47.887734 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 08:59:48.114945 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 08:59:48.115046 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 08:59:48.117871 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 08:59:48.117903 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 08:59:48.117941 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:59:48.117957 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2010, succ: 2009, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 08:59:48.117972 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 08:59:48.117998 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 08:59:48.419602 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2009 as an example for the next prompt.
[2025-11-05 08:59:48.419658 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 08:59:48.419697 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 08:59:48.419744 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,82.0,129.0,115.0,47.0,371.0,16.0,33.0,473.0,204.0,37.0,161.0,38.0,253.0,136.0,205.0,159.0,180.0,96.0,97.0,27.0,18.0,66.0,200.0,159.0,28.0,24.0,181.0,281.0,28.0,942.0,320.0,280.0,44.0,93.0,117.0,64.0,454.0,54.0,92.0,186.0,42.0,10.0,120.0,359.0,51.0,16.0,223.0,70.0,68.0,87.0,29.0,362.0,43.0,68.0,63.0,65.0,231.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 08:59:48.419764 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 08:59:48.419844 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 92
[2025-11-05 08:59:48.419877 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 280
[2025-11-05 08:59:48.419906 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 320
[2025-11-05 08:59:48.419932 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 362
[2025-11-05 08:59:48.419965 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_log_errors(cre2_options_t * opt),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 08:59:48.420682 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 201, quiet_round: 0, discovered_api_pairs: 3495
[2025-11-05 08:59:48.453360 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 08:59:48.453701 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_log_errors(cre2_options_t * opt),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)[0-9]+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * pattern_from_re = NULL;\n    int perl_classes_flag = 0;\n    long long max_mem_value = 1024LL * 1024LL;\n    long checksum = 0;\n\n    // step 2: Setup - create and configure options\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    cre2_opt_set_max_mem(opt, max_mem_value);\n    perl_classes_flag = cre2_opt_perl_classes(opt);\n\n    // step 3: Operate - compile regexp with configured options\n    re = cre2_new(pattern, pattern_len, opt);\n    pattern_from_re = cre2_pattern(re);\n\n    // step 4: Validate - compute a simple checksum based on results\n    checksum = (long)pattern_len + (long)max_mem_value + (long)perl_classes_flag + (long)(opt != NULL) + (long)(re != NULL) + (long)(pattern_from_re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // step 6: API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"[0-9]+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"abc123def\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"NUM\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t strings[1];\n    cre2_range_t ranges[1];\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    strings[0].data = text_and_target.data + 3;\n    strings[0].length = 3;\n    memset(ranges, 0, sizeof(ranges));\n\n    // step 3: Operate - compile regexp, create iterator, perform global replace, convert strings to ranges\n    re = cre2_new(pattern, pattern_len, NULL);\n    iter = cre2_named_groups_iter_new(re);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    cre2_strings_to_ranges(text_and_target.data, ranges, strings, 1);\n\n    // step 4: Validate - simple checksum using results\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)rewrite.length + ranges[0].start + ranges[0].past + (long)replace_ret + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:00:21.046742 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 09:00:21.046870 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28410, Completion: 21355, Total: 49765
[2025-11-05 09:00:21.046892 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:00:21.265243 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002010/id_002010.cc
[2025-11-05 09:00:21.265297 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:21.493432 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:21.493491 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:21.496335 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:21.496368 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:21.713294 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002011/id_002011.cc
[2025-11-05 09:00:21.713347 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:21.943564 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:21.943638 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:21.946847 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:21.946877 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:22.164859 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002012/id_002012.cc
[2025-11-05 09:00:22.164944 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:22.394046 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:22.394119 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:22.397354 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:22.397386 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:22.614957 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002013/id_002013.cc
[2025-11-05 09:00:22.615011 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:22.843480 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:22.843554 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:22.846406 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:22.846437 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:23.064585 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002014/id_002014.cc
[2025-11-05 09:00:23.064665 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:23.293706 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:23.293821 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:23.296935 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:23.296968 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:23.514317 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002015/id_002015.cc
[2025-11-05 09:00:23.514370 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:23.744938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:23.745011 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:23.748088 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:23.748119 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:23.965294 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002016/id_002016.cc
[2025-11-05 09:00:23.965349 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:24.194945 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:24.195021 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:24.197889 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:24.197920 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:24.416915 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002017/id_002017.cc
[2025-11-05 09:00:24.417001 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:24.646119 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:24.646192 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:24.649092 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:24.649124 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:24.867027 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002018/id_002018.cc
[2025-11-05 09:00:24.867080 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:25.095893 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:25.095964 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:25.099188 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:25.099221 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:25.317275 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002019/id_002019.cc
[2025-11-05 09:00:25.317329 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:25.547855 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:25.547970 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:25.550709 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:25.550741 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:25.550777 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:00:25.550816 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2020, succ: 2019, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:00:25.550831 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:00:25.550856 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:00:25.833366 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2019 as an example for the next prompt.
[2025-11-05 09:00:25.833422 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 09:00:25.833452 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 09:00:25.833499 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,167.0,46.0,82.0,129.0,117.0,47.0,371.0,16.0,33.0,473.0,204.0,37.0,161.0,38.0,254.0,136.0,205.0,159.0,180.0,96.0,97.0,27.0,18.0,66.0,202.0,159.0,28.0,24.0,181.0,283.0,28.0,943.0,321.0,283.0,44.0,93.0,117.0,64.0,454.0,54.0,96.0,186.0,45.0,10.0,120.0,359.0,51.0,16.0,224.0,70.0,68.0,87.0,29.0,363.0,43.0,68.0,63.0,65.0,231.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 09:00:25.833518 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:00:25.833571 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 70
[2025-11-05 09:00:25.833602 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 454
[2025-11-05 09:00:25.833630 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 473
[2025-11-05 09:00:25.833658 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 359
[2025-11-05 09:00:25.833692 +00:00] INFO [src/request/prompt.rs:145] set combination: int64_t cre2_opt_max_mem(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_delete(cre2_regexp_t * re),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)
[2025-11-05 09:00:25.834394 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 202, quiet_round: 0, discovered_api_pairs: 3503
[2025-11-05 09:00:25.875539 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:00:25.875888 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint64_t cre2_opt_max_mem(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_delete(cre2_regexp_t * re),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"[0-9]+\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"abc123def\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[] = \"NUM\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t strings[1];\n    cre2_range_t ranges[1];\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    strings[0].data = text_and_target.data + 3;\n    strings[0].length = 3;\n    memset(ranges, 0, sizeof(ranges));\n\n    // step 3: Operate - compile regexp, create iterator, perform global replace, convert strings to ranges\n    re = cre2_new(pattern, pattern_len, NULL);\n    iter = cre2_named_groups_iter_new(re);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    cre2_strings_to_ranges(text_and_target.data, ranges, strings, 1);\n\n    // step 4: Validate - simple checksum using results\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)rewrite.length + ranges[0].start + ranges[0].past + (long)replace_ret + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)[0-9]+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"bar42\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * pattern_from_re = NULL;\n    int matches[4];\n    size_t match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup - create options and observe current log-errors flag\n    opt = cre2_opt_new();\n    int initial_log_errors = cre2_opt_log_errors(opt);\n\n    // step 3: Configure - change some options and re-check log-errors\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    int after_set_log_errors = cre2_opt_log_errors(opt);\n\n    // step 4: Operate - create a set, add pattern, compile, and also compile a regexp and create iterator\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    pattern_from_re = cre2_pattern(re);\n    memset(matches, 0, sizeof(matches));\n    match_count = cre2_set_match(set, text, text_len, matches, 4);\n\n    // step 5: Validate - compute a simple checksum from results to ensure values flow through\n    checksum = (long)pattern_len + (long)initial_log_errors + (long)after_set_log_errors + (long)match_count + (long)matches[0] + (long)(pattern_from_re != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:00:52.128537 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 09:00:52.128686 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30390, Completion: 20885, Total: 51275
[2025-11-05 09:00:52.128707 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:00:52.347206 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002020/id_002020.cc
[2025-11-05 09:00:52.347259 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:52.575457 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:52.575515 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:52.578441 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:52.578474 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:52.795936 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002021/id_002021.cc
[2025-11-05 09:00:52.795989 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:53.023012 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:53.023088 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:53.025950 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:53.025983 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:53.244196 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002022/id_002022.cc
[2025-11-05 09:00:53.244282 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:53.471960 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:53.472033 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:53.474941 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:53.474973 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:53.694054 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002023/id_002023.cc
[2025-11-05 09:00:53.694107 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:53.922240 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:53.922308 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:53.925138 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:53.925172 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:54.145159 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002024/id_002024.cc
[2025-11-05 09:00:54.145211 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:54.375599 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:54.375704 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:54.378597 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:54.378629 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:54.598013 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002025/id_002025.cc
[2025-11-05 09:00:54.598066 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:54.827028 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:54.827105 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:54.829999 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:54.830030 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:55.046995 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002026/id_002026.cc
[2025-11-05 09:00:55.047050 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:55.274988 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:55.275047 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:55.277855 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:55.277887 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:55.494536 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002027/id_002027.cc
[2025-11-05 09:00:55.494621 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:55.723098 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:55.723166 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:55.726049 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:55.726082 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:55.942793 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002028/id_002028.cc
[2025-11-05 09:00:55.942845 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:56.171699 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:56.171759 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:56.174473 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:56.174504 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:56.392340 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002029/id_002029.cc
[2025-11-05 09:00:56.392393 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:00:56.621437 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:00:56.621526 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:00:56.624338 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:00:56.624371 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:00:56.624409 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:00:56.624426 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2030, succ: 2029, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:00:56.624440 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:00:56.624464 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:00:56.895350 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2029 as an example for the next prompt.
[2025-11-05 09:00:56.895406 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 19 new API pairs in this round.
[2025-11-05 09:00:56.895456 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 19
[2025-11-05 09:00:56.895503 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,371.0,16.0,33.0,475.0,204.0,37.0,161.0,38.0,259.0,136.0,205.0,159.0,180.0,96.0,97.0,27.0,18.0,66.0,202.0,159.0,28.0,24.0,181.0,285.0,28.0,947.0,321.0,283.0,44.0,93.0,117.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,120.0,366.0,51.0,16.0,224.0,83.0,68.0,87.0,29.0,363.0,43.0,68.0,71.0,65.0,231.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 09:00:56.895521 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:00:56.895572 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 259
[2025-11-05 09:00:56.895604 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_max_mem energy: 71
[2025-11-05 09:00:56.895628 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 947
[2025-11-05 09:00:56.895653 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 205
[2025-11-05 09:00:56.895703 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 283
[2025-11-05 09:00:56.895738 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_options_t *cre2_opt_new(),
    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_error_code(const cre2_regexp_t * re),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)
[2025-11-05 09:00:56.896559 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 203, quiet_round: 0, discovered_api_pairs: 3522
[2025-11-05 09:00:56.937988 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:00:56.938343 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_options_t *cre2_opt_new(),\n    void cre2_opt_set_max_mem(cre2_options_t * opt, int64_t m),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_error_code(const cre2_regexp_t * re),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)[0-9]+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"bar42\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_set * set = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    const char * pattern_from_re = NULL;\n    int matches[4];\n    size_t match_count = 0;\n    long checksum = 0;\n\n    // step 2: Setup - create options and observe current log-errors flag\n    opt = cre2_opt_new();\n    int initial_log_errors = cre2_opt_log_errors(opt);\n\n    // step 3: Configure - change some options and re-check log-errors\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_log_errors(opt, 1);\n    int after_set_log_errors = cre2_opt_log_errors(opt);\n\n    // step 4: Operate - create a set, add pattern, compile, and also compile a regexp and create iterator\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    pattern_from_re = cre2_pattern(re);\n    memset(matches, 0, sizeof(matches));\n    match_count = cre2_set_match(set, text, text_len, matches, 4);\n\n    // step 5: Validate - compute a simple checksum from results to ensure values flow through\n    checksum = (long)pattern_len + (long)initial_log_errors + (long)after_set_log_errors + (long)match_count + (long)matches[0] + (long)(pattern_from_re != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^([a-z]+)([0-9]+)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"abc123\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match[2];\n    int match_ret = 0;\n    int64_t max_mem = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024);\n    max_mem = cre2_opt_max_mem(opt);\n    enc = cre2_opt_encoding(opt);\n    match[0].data = NULL;\n    match[0].length = 0;\n    match[1].data = NULL;\n    match[1].length = 0;\n\n    // step 3: Operate\n    match_ret = cre2_easy_match(pattern, pattern_len, text, text_len, match, 2);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)match_ret + (long)max_mem + (long)enc + (long)(re != NULL) + (long)match[0].length + (long)match[1].length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:01:26.512835 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 09:01:26.512956 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30080, Completion: 19511, Total: 49591
[2025-11-05 09:01:26.512977 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:01:26.731362 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002030/id_002030.cc
[2025-11-05 09:01:26.731416 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:26.961429 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:26.961490 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:26.964224 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:26.964257 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:27.183043 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002031/id_002031.cc
[2025-11-05 09:01:27.183097 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:27.414085 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:27.414165 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:27.416849 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:27.416881 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:27.633314 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002032/id_002032.cc
[2025-11-05 09:01:27.633400 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:27.861663 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:27.861742 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:27.864259 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:27.864291 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:28.081627 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002033/id_002033.cc
[2025-11-05 09:01:28.081681 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:28.310761 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:28.310842 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:28.313667 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:28.313700 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:28.531604 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002034/id_002034.cc
[2025-11-05 09:01:28.531657 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:28.760690 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:28.760809 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:28.763450 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:28.763484 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:28.981333 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002035/id_002035.cc
[2025-11-05 09:01:28.981387 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:29.212502 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:29.212565 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:29.215155 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:29.215183 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:29.431801 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002036/id_002036.cc
[2025-11-05 09:01:29.431856 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:29.660185 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:29.660263 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:29.663128 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:29.663163 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:29.881333 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002037/id_002037.cc
[2025-11-05 09:01:29.881418 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:30.109575 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:30.109652 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:30.112155 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:30.112187 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:30.330586 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002038/id_002038.cc
[2025-11-05 09:01:30.330640 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:30.558492 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:30.558568 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:30.561373 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:30.561405 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:30.779197 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002039/id_002039.cc
[2025-11-05 09:01:30.779252 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:31.008805 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:31.008916 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:31.011671 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:31.011703 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:31.011741 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:01:31.011757 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2040, succ: 2039, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:01:31.011772 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:01:31.011800 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:01:31.275612 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2039 as an example for the next prompt.
[2025-11-05 09:01:31.275669 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 4 new API pairs in this round.
[2025-11-05 09:01:31.275696 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 4
[2025-11-05 09:01:31.275741 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,371.0,16.0,33.0,477.0,204.0,37.0,161.0,38.0,259.0,136.0,208.0,159.0,181.0,96.0,97.0,27.0,18.0,66.0,203.0,159.0,28.0,24.0,181.0,285.0,28.0,949.0,321.0,285.0,44.0,93.0,117.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,120.0,366.0,51.0,16.0,224.0,83.0,68.0,87.0,29.0,363.0,43.0,68.0,72.0,65.0,231.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 09:01:31.275760 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:01:31.275814 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_word_boundary energy: 33
[2025-11-05 09:01:31.275845 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 366
[2025-11-05 09:01:31.275886 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 68
[2025-11-05 09:01:31.275912 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 321
[2025-11-05 09:01:31.275939 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 477
[2025-11-05 09:01:31.275971 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_word_boundary(cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    void cre2_delete(cre2_regexp_t * re)
[2025-11-05 09:01:31.276782 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 204, quiet_round: 0, discovered_api_pairs: 3526
[2025-11-05 09:01:31.310764 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:01:31.311110 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_word_boundary(cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    void cre2_delete(cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^([a-z]+)([0-9]+)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"abc123\";\n    const int text_len = (int)(sizeof(text) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match[2];\n    int match_ret = 0;\n    int64_t max_mem = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_max_mem(opt, (int64_t)1024 * 1024);\n    max_mem = cre2_opt_max_mem(opt);\n    enc = cre2_opt_encoding(opt);\n    match[0].data = NULL;\n    match[0].length = 0;\n    match[1].data = NULL;\n    match[1].length = 0;\n\n    // step 3: Operate\n    match_ret = cre2_easy_match(pattern, pattern_len, text, text_len, match, 2);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)match_ret + (long)max_mem + (long)enc + (long)(re != NULL) + (long)match[0].length + (long)match[1].length;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)[0-9]+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"bar42\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    int matches[4];\n    size_t match_count = 0;\n    int err_code = 0;\n    int64_t desired_max_mem = (int64_t)16 * 1024 * 1024; // 16 MB\n    long checksum = 0;\n\n    // step 2: Setup - create options and configure max memory\n    opt = cre2_opt_new();\n    cre2_opt_set_max_mem(opt, desired_max_mem);\n\n    // step 3: Operate - create a set, add pattern, compile, and also compile a regexp\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code = cre2_error_code(re);\n    memset(matches, 0, sizeof(matches));\n    match_count = cre2_set_match(set, text, text_len, matches, 4);\n\n    // step 4: Validate - compute a simple checksum to ensure values flow through\n    checksum = (long)pattern_len + (long)err_code + (long)match_count + (long)matches[0] + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)desired_max_mem;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:01:55.547236 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 24s
[2025-11-05 09:01:55.547362 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29140, Completion: 17871, Total: 47011
[2025-11-05 09:01:55.547382 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:01:55.764989 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002040/id_002040.cc
[2025-11-05 09:01:55.765043 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:55.994938 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:55.995008 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:55.998154 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:55.998187 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:56.215812 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002041/id_002041.cc
[2025-11-05 09:01:56.215865 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:56.443032 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:56.443105 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:56.446273 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:56.446307 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:56.663383 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002042/id_002042.cc
[2025-11-05 09:01:56.663466 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:56.890535 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:56.890602 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:56.893703 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:56.893748 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:57.112366 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002043/id_002043.cc
[2025-11-05 09:01:57.112419 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:57.342149 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:57.342210 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:57.345383 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:57.345417 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:57.564193 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002044/id_002044.cc
[2025-11-05 09:01:57.564246 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:57.793966 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:57.794075 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:57.797242 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:57.797274 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:58.015195 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002045/id_002045.cc
[2025-11-05 09:01:58.015248 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:58.243237 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:58.243306 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:58.246478 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:58.246511 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:58.463279 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002046/id_002046.cc
[2025-11-05 09:01:58.463332 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:58.692760 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:58.692836 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:58.695750 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:58.695783 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:58.912367 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002047/id_002047.cc
[2025-11-05 09:01:58.912449 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:59.139059 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:59.139127 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:59.142220 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:59.142252 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:59.359803 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002048/id_002048.cc
[2025-11-05 09:01:59.359857 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:01:59.587473 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:01:59.587545 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:01:59.590370 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:01:59.590402 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:01:59.808210 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002049/id_002049.cc
[2025-11-05 09:01:59.808264 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:00.036420 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:00.036527 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:00.039346 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:00.039378 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:00.039417 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:02:00.039433 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2050, succ: 2049, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:02:00.039448 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:02:00.039473 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:02:00.308739 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2049 as an example for the next prompt.
[2025-11-05 09:02:00.308795 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 09:02:00.308830 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 09:02:00.308876 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,372.0,16.0,45.0,477.0,204.0,37.0,161.0,38.0,260.0,136.0,208.0,159.0,181.0,96.0,97.0,27.0,18.0,66.0,203.0,159.0,28.0,24.0,181.0,285.0,28.0,951.0,323.0,285.0,44.0,93.0,117.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,120.0,376.0,51.0,16.0,224.0,83.0,68.0,87.0,29.0,363.0,43.0,76.0,72.0,65.0,232.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 09:02:00.308894 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:02:00.308947 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 224
[2025-11-05 09:02:00.308980 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 120
[2025-11-05 09:02:00.309006 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 376
[2025-11-05 09:02:00.309034 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 232
[2025-11-05 09:02:00.309071 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 363
[2025-11-05 09:02:00.309106 +00:00] INFO [src/request/prompt.rs:145] set combination: size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    int cre2_opt_one_line(cre2_options_t * opt),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 09:02:00.309919 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 205, quiet_round: 0, discovered_api_pairs: 3539
[2025-11-05 09:02:00.355286 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:02:00.355722 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nsize_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo|bar)[0-9]+$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"bar42\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    int matches[4];\n    size_t match_count = 0;\n    int err_code = 0;\n    int64_t desired_max_mem = (int64_t)16 * 1024 * 1024; // 16 MB\n    long checksum = 0;\n\n    // step 2: Setup - create options and configure max memory\n    opt = cre2_opt_new();\n    cre2_opt_set_max_mem(opt, desired_max_mem);\n\n    // step 3: Operate - create a set, add pattern, compile, and also compile a regexp\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code = cre2_error_code(re);\n    memset(matches, 0, sizeof(matches));\n    match_count = cre2_set_match(set, text, text_len, matches, 4);\n\n    // step 4: Validate - compute a simple checksum to ensure values flow through\n    checksum = (long)pattern_len + (long)err_code + (long)match_count + (long)matches[0] + (long)(opt != NULL) + (long)(set != NULL) + (long)(re != NULL) + (long)desired_max_mem;\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    int wb_before = 0;\n    int wb_after = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    wb_before = cre2_opt_word_boundary(opt);\n    cre2_opt_set_word_boundary(opt, 1);\n    wb_after = cre2_opt_word_boundary(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)wb_before + (long)wb_after + (long)enc + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:02:28.058973 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 09:02:28.059104 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28440, Completion: 21933, Total: 50373
[2025-11-05 09:02:28.059127 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:02:28.276543 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002050/id_002050.cc
[2025-11-05 09:02:28.276598 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:28.506154 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:28.506214 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:28.509391 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:28.509424 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:28.727167 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002051/id_002051.cc
[2025-11-05 09:02:28.727221 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:28.956375 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:28.956447 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:28.959659 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:28.959693 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:29.176274 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002052/id_002052.cc
[2025-11-05 09:02:29.176364 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:29.404527 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:29.404601 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:29.407544 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:29.407570 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:29.625279 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002053/id_002053.cc
[2025-11-05 09:02:29.625334 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:29.854186 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:29.854249 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:29.857429 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:29.857462 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:30.077128 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002054/id_002054.cc
[2025-11-05 09:02:30.077184 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:30.307973 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:30.308082 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:30.311314 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:30.311349 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:30.529967 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002055/id_002055.cc
[2025-11-05 09:02:30.530021 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:30.762007 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:30.762081 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:30.765367 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:30.765399 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:30.983102 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002056/id_002056.cc
[2025-11-05 09:02:30.983157 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:31.211280 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:31.211349 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:31.214567 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:31.214601 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:31.433281 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002057/id_002057.cc
[2025-11-05 09:02:31.433367 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:31.661723 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:31.661783 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:31.664933 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:31.664965 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:31.881617 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002058/id_002058.cc
[2025-11-05 09:02:31.881670 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:32.111361 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:32.111431 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:32.114628 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:32.114663 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:32.332604 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002059/id_002059.cc
[2025-11-05 09:02:32.332676 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:02:32.562455 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:02:32.562544 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:02:32.565735 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:02:32.565770 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:02:32.565807 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:02:32.565824 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2060, succ: 2059, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:02:32.565855 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:02:32.565887 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:02:32.853752 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2059 as an example for the next prompt.
[2025-11-05 09:02:32.853810 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 3 new API pairs in this round.
[2025-11-05 09:02:32.853841 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 3
[2025-11-05 09:02:32.853889 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,372.0,16.0,45.0,477.0,204.0,37.0,163.0,38.0,261.0,136.0,208.0,159.0,181.0,96.0,97.0,27.0,18.0,66.0,203.0,159.0,28.0,24.0,181.0,285.0,28.0,951.0,324.0,285.0,44.0,93.0,117.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,123.0,376.0,51.0,16.0,225.0,83.0,68.0,87.0,29.0,364.0,43.0,76.0,72.0,65.0,232.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 09:02:32.853910 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:02:32.853977 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 204
[2025-11-05 09:02:32.854053 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 204
[2025-11-05 09:02:32.854090 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_one_line energy: 123
[2025-11-05 09:02:32.854123 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 274
[2025-11-05 09:02:32.854166 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    int cre2_opt_one_line(cre2_options_t * opt),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 09:02:32.854919 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 206, quiet_round: 0, discovered_api_pairs: 3542
[2025-11-05 09:02:32.903270 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:02:32.903654 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    int cre2_opt_one_line(cre2_options_t * opt),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    int wb_before = 0;\n    int wb_after = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    long checksum = 0;\n\n    // step 2: Setup\n    opt = cre2_opt_new();\n    wb_before = cre2_opt_word_boundary(opt);\n    cre2_opt_set_word_boundary(opt, 1);\n    wb_after = cre2_opt_word_boundary(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Operate\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Validate\n    checksum = (long)pattern_len + (long)wb_before + (long)wb_after + (long)enc + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"Alice-12345\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    int matches[8];\n    size_t match_count = 0;\n    int one_line_before = 0;\n    int one_line_after = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char *pat_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup (Initialize options and capture initial flags)\n    opt = cre2_opt_new();\n    one_line_before = cre2_opt_one_line(opt);\n    cre2_opt_set_one_line(opt, 1);\n    one_line_after = cre2_opt_one_line(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure (build a set and compile it, and build a regexp)\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate and Validate (perform matching and inspect pattern string)\n    memset(matches, 0, sizeof(matches));\n    match_count = cre2_set_match(set, text, text_len, matches, 8);\n    pat_from_re = cre2_pattern(re);\n    checksum = (long)pattern_len + (long)match_count + (long)matches[0] + (long)one_line_before + (long)one_line_after + (long)enc + (long)(re != NULL) + (long)(iter != NULL) + (long)(pat_from_re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup (delete iter, regexp, set and options)\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:03:10.656958 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 09:03:10.657096 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29590, Completion: 25660, Total: 55250
[2025-11-05 09:03:10.657118 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:03:10.875729 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002060/id_002060.cc
[2025-11-05 09:03:10.875789 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:11.105382 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:11.105466 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:11.108213 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:11.108243 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:11.324849 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002061/id_002061.cc
[2025-11-05 09:03:11.324913 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:11.553480 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:11.553560 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:11.556473 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:11.556499 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:11.773151 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002062/id_002062.cc
[2025-11-05 09:03:11.773240 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:12.001854 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:12.001928 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:12.004654 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:12.004685 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:12.221794 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002063/id_002063.cc
[2025-11-05 09:03:12.221849 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:12.452117 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:12.452196 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:12.455125 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:12.455162 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:12.673398 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002064/id_002064.cc
[2025-11-05 09:03:12.673459 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:12.902761 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:12.902875 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:12.906148 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:12.906185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:13.123771 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002065/id_002065.cc
[2025-11-05 09:03:13.123834 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:13.352498 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:13.352574 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:13.355217 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:13.355244 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:13.572509 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002066/id_002066.cc
[2025-11-05 09:03:13.572573 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:13.803306 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:13.803378 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:13.806315 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:13.806352 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:14.025836 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002067/id_002067.cc
[2025-11-05 09:03:14.025920 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:14.255399 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:14.255481 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:14.258432 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:14.258470 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:14.476844 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002068/id_002068.cc
[2025-11-05 09:03:14.476899 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:14.705777 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:14.705850 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:14.708607 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:14.708642 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:14.927729 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002069/id_002069.cc
[2025-11-05 09:03:14.927782 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:15.156812 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:15.156931 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:15.159553 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:15.159579 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:15.159616 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:03:15.159638 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2070, succ: 2069, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:03:15.159656 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:03:15.159688 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:03:15.460047 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2069 as an example for the next prompt.
[2025-11-05 09:03:15.460104 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 1 new API pairs in this round.
[2025-11-05 09:03:15.460129 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 1
[2025-11-05 09:03:15.460179 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,372.0,16.0,45.0,477.0,205.0,37.0,163.0,38.0,261.0,136.0,208.0,159.0,181.0,96.0,97.0,27.0,18.0,66.0,203.0,159.0,28.0,24.0,181.0,285.0,28.0,951.0,324.0,285.0,44.0,93.0,117.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,123.0,376.0,51.0,16.0,225.0,83.0,68.0,87.0,29.0,364.0,43.0,76.0,72.0,65.0,232.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 09:03:15.460202 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:03:15.460279 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 951
[2025-11-05 09:03:15.460321 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 372
[2025-11-05 09:03:15.460354 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 324
[2025-11-05 09:03:15.460385 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_find_named_capturing_groups energy: 65
[2025-11-05 09:03:15.460414 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_delete energy: 87
[2025-11-05 09:03:15.460452 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),
    void cre2_opt_delete(cre2_options_t * opt)
[2025-11-05 09:03:15.461334 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 207, quiet_round: 0, discovered_api_pairs: 3543
[2025-11-05 09:03:15.500208 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:03:15.500578 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_find_named_capturing_groups(const cre2_regexp_t * re, const char * name),\n    void cre2_opt_delete(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char text[] = \"Alice-12345\";\n    const size_t text_len = (size_t)(sizeof(text) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    int matches[8];\n    size_t match_count = 0;\n    int one_line_before = 0;\n    int one_line_after = 0;\n    cre2_encoding_t enc = CRE2_UNKNOWN;\n    const char *pat_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup (Initialize options and capture initial flags)\n    opt = cre2_opt_new();\n    one_line_before = cre2_opt_one_line(opt);\n    cre2_opt_set_one_line(opt, 1);\n    one_line_after = cre2_opt_one_line(opt);\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure (build a set and compile it, and build a regexp)\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate and Validate (perform matching and inspect pattern string)\n    memset(matches, 0, sizeof(matches));\n    match_count = cre2_set_match(set, text, text_len, matches, 8);\n    pat_from_re = cre2_pattern(re);\n    checksum = (long)pattern_len + (long)match_count + (long)matches[0] + (long)one_line_before + (long)one_line_after + (long)enc + (long)(re != NULL) + (long)(iter != NULL) + (long)(pat_from_re != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup (delete iter, regexp, set and options)\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice12345\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_template[] = \"$1-REPL\";\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_and_target = { text_buf, text_len };\n    cre2_string_t rewrite_str = { rewrite_template, (int)(sizeof(rewrite_template) - 1) };\n    int one_line_before = 0;\n    int one_line_after = 0;\n    long checksum = 0;\n\n    // step 2: Setup (initialize options and toggle one_line flag)\n    opt = cre2_opt_new();\n    one_line_before = cre2_opt_one_line(opt);\n    cre2_opt_set_one_line(opt, 1);\n    one_line_after = cre2_opt_one_line(opt);\n\n    // step 3: Configure (build a set and add a simple pattern)\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate (compile regexp, perform match, then perform replace using the regexp)\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(matches, 0, sizeof(matches));\n    int match_count = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, 3);\n    int replace_result = cre2_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate (produce a checksum combining results so values flow through)\n    checksum = (long)pattern_len + (long)match_count + (long)replace_result + (long)one_line_before + (long)one_line_after + (long)matches[0].length + (long)text_and_target.length + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (delete regexp, set and options)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:03:45.394618 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 09:03:45.394751 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31390, Completion: 20409, Total: 51799
[2025-11-05 09:03:45.394775 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:03:45.612215 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002070/id_002070.cc
[2025-11-05 09:03:45.612267 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:45.840929 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:45.841031 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:45.844121 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:45.844156 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:46.061336 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002071/id_002071.cc
[2025-11-05 09:03:46.061396 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:46.291701 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:46.291779 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:46.294925 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:46.294961 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:46.511062 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002072/id_002072.cc
[2025-11-05 09:03:46.511155 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:46.740022 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:46.740105 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:46.743295 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:46.743333 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:46.961800 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002073/id_002073.cc
[2025-11-05 09:03:46.961854 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:47.191410 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:47.191490 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:47.194606 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:47.194643 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:47.413637 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002074/id_002074.cc
[2025-11-05 09:03:47.413692 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:47.644156 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:47.644276 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:47.647378 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:47.647411 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:47.863935 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002075/id_002075.cc
[2025-11-05 09:03:47.863987 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:48.093953 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:48.094027 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:48.097086 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:48.097117 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:48.314900 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002076/id_002076.cc
[2025-11-05 09:03:48.314960 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:48.543092 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:48.543175 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:48.546408 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:48.546444 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:48.763624 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002077/id_002077.cc
[2025-11-05 09:03:48.763720 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:48.992934 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:48.993016 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:48.995877 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:48.995908 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:49.215842 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002078/id_002078.cc
[2025-11-05 09:03:49.215901 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:49.445022 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:49.445103 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:49.448200 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:49.448231 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:49.664904 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002079/id_002079.cc
[2025-11-05 09:03:49.664965 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:03:49.893928 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:03:49.894055 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:03:49.897140 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:03:49.897167 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:03:49.897206 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:03:49.897222 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2080, succ: 2079, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:03:49.897240 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:03:49.897266 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:03:50.166192 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2079 as an example for the next prompt.
[2025-11-05 09:03:50.166247 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 18 new API pairs in this round.
[2025-11-05 09:03:50.166288 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 18
[2025-11-05 09:03:50.166335 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,378.0,16.0,45.0,477.0,205.0,37.0,164.0,38.0,262.0,136.0,208.0,159.0,181.0,101.0,97.0,27.0,18.0,66.0,203.0,159.0,28.0,24.0,181.0,285.0,28.0,954.0,334.0,285.0,44.0,93.0,117.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,123.0,376.0,51.0,16.0,225.0,83.0,68.0,87.0,29.0,369.0,43.0,76.0,72.0,83.0,237.0,63.0,274.0,59.0,52.0,16.0]
[2025-11-05 09:03:50.166354 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:03:50.166408 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 285
[2025-11-05 09:03:50.166453 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_full_match_re energy: 24
[2025-11-05 09:03:50.166481 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 274
[2025-11-05 09:03:50.166507 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_revision energy: 117
[2025-11-05 09:03:50.166540 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),
    int cre2_full_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    int cre2_version_interface_revision()
[2025-11-05 09:03:50.167253 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 208, quiet_round: 0, discovered_api_pairs: 3561
[2025-11-05 09:03:50.204901 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:03:50.205256 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor),\n    int cre2_full_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern),\n    int cre2_version_interface_revision()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice12345\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_template[] = \"$1-REPL\";\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t text_and_target = { text_buf, text_len };\n    cre2_string_t rewrite_str = { rewrite_template, (int)(sizeof(rewrite_template) - 1) };\n    int one_line_before = 0;\n    int one_line_after = 0;\n    long checksum = 0;\n\n    // step 2: Setup (initialize options and toggle one_line flag)\n    opt = cre2_opt_new();\n    one_line_before = cre2_opt_one_line(opt);\n    cre2_opt_set_one_line(opt, 1);\n    one_line_after = cre2_opt_one_line(opt);\n\n    // step 3: Configure (build a set and add a simple pattern)\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate (compile regexp, perform match, then perform replace using the regexp)\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(matches, 0, sizeof(matches));\n    int match_count = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, matches, 3);\n    int replace_result = cre2_replace_re(re, &text_and_target, &rewrite_str);\n\n    // step 5: Validate (produce a checksum combining results so values flow through)\n    checksum = (long)pattern_len + (long)match_count + (long)replace_result + (long)one_line_before + (long)one_line_after + (long)matches[0].length + (long)text_and_target.length + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (delete regexp, set and options)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)-(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char lookup_name[] = \"name\";\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    int num_groups = 0;\n    int found_index = -1;\n    long checksum = 0;\n\n    // step 2: Setup (initialize options)\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure (build a regexp from the pattern using options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (inspect regexp: count capturing groups, create named-group iterator, find named group)\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n    found_index = cre2_find_named_capturing_groups(re, lookup_name);\n\n    // step 5: Validate and Cleanup (combine results and release resources)\n    checksum = (long)pattern_len + (long)num_groups + (long)found_index + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:04:13.252069 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 23s
[2025-11-05 09:04:13.252184 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29760, Completion: 18442, Total: 48202
[2025-11-05 09:04:13.252208 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:04:13.470703 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002080/id_002080.cc
[2025-11-05 09:04:13.470757 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:13.699000 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:13.699078 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:13.701761 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:13.701796 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:13.919395 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002081/id_002081.cc
[2025-11-05 09:04:13.919451 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:14.149559 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:14.149632 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:14.152304 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:14.152338 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:14.370537 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002082/id_002082.cc
[2025-11-05 09:04:14.370624 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:14.599126 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:14.599200 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:14.602069 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:14.602100 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:14.819956 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002083/id_002083.cc
[2025-11-05 09:04:14.820012 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:15.049095 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:15.049156 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:15.051769 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:15.051801 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:15.270640 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002084/id_002084.cc
[2025-11-05 09:04:15.270694 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:15.497870 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:15.497986 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:15.500859 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:15.500890 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:15.719758 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002085/id_002085.cc
[2025-11-05 09:04:15.719813 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:15.947615 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:15.947691 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:15.950537 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:15.950570 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:16.167018 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002086/id_002086.cc
[2025-11-05 09:04:16.167073 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:16.395588 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:16.395667 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:16.398524 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:16.398556 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:16.617645 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002087/id_002087.cc
[2025-11-05 09:04:16.617732 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:16.847201 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:16.847263 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:16.850083 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:16.850116 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:17.067278 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002088/id_002088.cc
[2025-11-05 09:04:17.067338 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:17.295971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:17.296048 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:17.298942 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:17.298975 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:17.514754 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002089/id_002089.cc
[2025-11-05 09:04:17.514809 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:17.744844 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:17.744934 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:17.747623 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:17.747654 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:17.747691 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:04:17.747708 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2090, succ: 2089, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:04:17.747723 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:04:17.747748 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:04:18.025382 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2089 as an example for the next prompt.
[2025-11-05 09:04:18.025438 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 15 new API pairs in this round.
[2025-11-05 09:04:18.025476 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 15
[2025-11-05 09:04:18.025524 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,378.0,16.0,45.0,480.0,205.0,37.0,167.0,38.0,266.0,136.0,208.0,159.0,182.0,101.0,97.0,27.0,18.0,66.0,205.0,159.0,28.0,31.0,181.0,285.0,28.0,958.0,334.0,290.0,44.0,93.0,128.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,123.0,376.0,51.0,16.0,225.0,83.0,68.0,87.0,29.0,369.0,43.0,76.0,72.0,83.0,237.0,63.0,277.0,59.0,52.0,16.0]
[2025-11-05 09:04:18.025541 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:04:18.025596 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_version_interface_current energy: 68
[2025-11-05 09:04:18.025635 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match_re energy: 29
[2025-11-05 09:04:18.025672 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 83
[2025-11-05 09:04:18.025710 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 958
[2025-11-05 09:04:18.025752 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_version_interface_current(),
    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),
    int64_t cre2_opt_max_mem(cre2_options_t * opt),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)
[2025-11-05 09:04:18.026458 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 209, quiet_round: 0, discovered_api_pairs: 3576
[2025-11-05 09:04:18.062889 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:04:18.063258 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_version_interface_current(),\n    int cre2_partial_match_re(cre2_regexp_t * , const cre2_string_t * , cre2_string_t * , int ),\n    int64_t cre2_opt_max_mem(cre2_options_t * opt),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)-(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    const char lookup_name[] = \"name\";\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    int num_groups = 0;\n    int found_index = -1;\n    long checksum = 0;\n\n    // step 2: Setup (initialize options)\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure (build a regexp from the pattern using options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (inspect regexp: count capturing groups, create named-group iterator, find named group)\n    num_groups = cre2_num_capturing_groups(re);\n    iter = cre2_named_groups_iter_new(re);\n    found_index = cre2_find_named_capturing_groups(re, lookup_name);\n\n    // step 5: Validate and Cleanup (combine results and release resources)\n    checksum = (long)pattern_len + (long)num_groups + (long)found_index + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^([A-Za-z]+)([0-9]+)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Bob2025\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t input = { text_buf, text_len };\n    cre2_string_t matches[3];\n    long checksum = 0;\n    int add_result = 0;\n    int full_match_result = 0;\n    int version_rev = 0;\n\n    // step 2: Setup (create options)\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure (create a set and add a simple pattern)\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_result = cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate (compile regexp and perform full match using compiled regexp)\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(matches, 0, sizeof(matches));\n    full_match_result = cre2_full_match_re(re, &input, matches, 3);\n    version_rev = cre2_version_interface_revision();\n\n    // step 5: Validate (combine results so values flow through)\n    checksum = (long)pattern_len + (long)add_result + (long)full_match_result + (long)version_rev + (long)matches[0].length + (long)input.length + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (delete regexp, set and options)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:04:43.815172 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 25s
[2025-11-05 09:04:43.815301 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28440, Completion: 19947, Total: 48387
[2025-11-05 09:04:43.815321 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:04:44.033991 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002090/id_002090.cc
[2025-11-05 09:04:44.034046 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:44.263500 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:44.263560 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:44.266278 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:44.266310 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:44.485209 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002091/id_002091.cc
[2025-11-05 09:04:44.485263 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:44.714090 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:44.714169 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:44.716985 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:44.717016 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:44.933625 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002092/id_002092.cc
[2025-11-05 09:04:44.933710 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:45.164300 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:45.164359 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:45.167095 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:45.167128 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:45.385839 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002093/id_002093.cc
[2025-11-05 09:04:45.385892 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:45.616112 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:45.616172 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:45.618889 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:45.618923 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:45.835453 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002094/id_002094.cc
[2025-11-05 09:04:45.835507 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:46.065490 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:46.065608 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:46.068357 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:46.068390 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:46.283971 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002095/id_002095.cc
[2025-11-05 09:04:46.284024 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:46.511445 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:46.511515 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:46.514305 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:46.514336 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:46.731661 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002096/id_002096.cc
[2025-11-05 09:04:46.731716 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:46.959498 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:46.959567 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:46.962394 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:46.962428 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:47.180347 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002097/id_002097.cc
[2025-11-05 09:04:47.180432 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:47.408616 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:47.408699 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:47.411240 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:47.411272 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:47.628261 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002098/id_002098.cc
[2025-11-05 09:04:47.628316 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:47.856283 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:47.856353 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:47.859172 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:47.859199 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:48.077351 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002099/id_002099.cc
[2025-11-05 09:04:48.077405 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:04:48.306696 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:04:48.306814 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:04:48.309659 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:04:48.309715 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:04:48.309756 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:04:48.309773 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2100, succ: 2099, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:04:48.309800 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:04:48.309827 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:04:48.584677 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2099 as an example for the next prompt.
[2025-11-05 09:04:48.584734 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 09:04:48.584770 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 09:04:48.584816 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,117.0,47.0,380.0,16.0,45.0,482.0,205.0,37.0,170.0,38.0,268.0,136.0,208.0,159.0,182.0,101.0,97.0,27.0,18.0,66.0,205.0,159.0,28.0,31.0,181.0,285.0,28.0,964.0,334.0,290.0,44.0,93.0,128.0,64.0,459.0,54.0,96.0,186.0,45.0,10.0,123.0,376.0,51.0,16.0,225.0,91.0,72.0,87.0,34.0,369.0,43.0,76.0,74.0,83.0,237.0,63.0,277.0,59.0,52.0,16.0]
[2025-11-05 09:04:48.584836 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:04:48.584888 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_literal energy: 136
[2025-11-05 09:04:48.584920 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 186
[2025-11-05 09:04:48.584946 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_log_errors energy: 96
[2025-11-05 09:04:48.584971 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 369
[2025-11-05 09:04:48.585003 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_literal(cre2_options_t * opt, int flag),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_opt_log_errors(cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re)
[2025-11-05 09:04:48.585710 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 210, quiet_round: 0, discovered_api_pairs: 3589
[2025-11-05 09:04:48.622061 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:04:48.622404 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_literal(cre2_options_t * opt, int flag),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_opt_log_errors(cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^([A-Za-z]+)([0-9]+)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Bob2025\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_set *set = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t input = { text_buf, text_len };\n    cre2_string_t matches[3];\n    long checksum = 0;\n    int add_result = 0;\n    int full_match_result = 0;\n    int version_rev = 0;\n\n    // step 2: Setup (create options)\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure (create a set and add a simple pattern)\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_result = cre2_set_add_simple(set, pattern);\n    cre2_set_compile(set);\n\n    // step 4: Operate (compile regexp and perform full match using compiled regexp)\n    re = cre2_new(pattern, pattern_len, opt);\n    memset(matches, 0, sizeof(matches));\n    full_match_result = cre2_full_match_re(re, &input, matches, 3);\n    version_rev = cre2_version_interface_revision();\n\n    // step 5: Validate (combine results so values flow through)\n    checksum = (long)pattern_len + (long)add_result + (long)full_match_result + (long)version_rev + (long)matches[0].length + (long)input.length + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (delete regexp, set and options)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^Hello (World)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Hello World\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t input = { text_buf, text_len };\n    cre2_string_t matches[3];\n    int partial_result = 0;\n    int version_cur = 0;\n    int64_t max_mem = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure (inspect option and compile regexp)\n    max_mem = cre2_opt_max_mem(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (prepare match storage and perform partial match)\n    memset(matches, 0, sizeof(matches));\n    partial_result = cre2_partial_match_re(re, &input, matches, 3);\n\n    // step 5: Validate (use version and combine results so values flow)\n    version_cur = cre2_version_interface_current();\n    checksum = (long)pattern_len + (long)partial_result + (long)version_cur + (long)max_mem + (long)matches[0].length + (long)matches[1].length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:05:12.620005 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 24s
[2025-11-05 09:05:12.620134 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28860, Completion: 19752, Total: 48612
[2025-11-05 09:05:12.620155 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:05:12.837924 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002100/id_002100.cc
[2025-11-05 09:05:12.837979 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:13.066875 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:13.066943 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:13.069732 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:13.069764 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:13.287186 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002101/id_002101.cc
[2025-11-05 09:05:13.287239 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:13.517089 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:13.517150 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:13.519797 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:13.519830 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:13.738425 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002102/id_002102.cc
[2025-11-05 09:05:13.738512 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:13.966276 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:13.966335 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:13.969112 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:13.969144 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:14.186986 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002103/id_002103.cc
[2025-11-05 09:05:14.187041 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:14.416315 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:14.416384 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:14.419177 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:14.419210 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:14.637162 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002104/id_002104.cc
[2025-11-05 09:05:14.637218 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:14.866345 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:14.866453 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:14.869285 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:14.869317 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:15.086986 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002105/id_002105.cc
[2025-11-05 09:05:15.087042 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:15.314708 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:15.314786 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:15.317615 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:15.317669 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:15.535661 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002106/id_002106.cc
[2025-11-05 09:05:15.535716 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:15.765791 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:15.765863 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:15.768730 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:15.768765 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:15.985766 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002107/id_002107.cc
[2025-11-05 09:05:15.985853 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:16.215419 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:16.215485 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:16.218248 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:16.218281 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:16.435640 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002108/id_002108.cc
[2025-11-05 09:05:16.435694 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:16.663281 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:16.663350 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:16.666151 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:16.666185 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:16.883253 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002109/id_002109.cc
[2025-11-05 09:05:16.883307 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:05:17.111771 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:05:17.111862 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:05:17.114693 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:05:17.114726 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:05:17.114765 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:05:17.114782 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2110, succ: 2109, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:05:17.114797 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:05:17.114826 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:05:17.388764 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2109 as an example for the next prompt.
[2025-11-05 09:05:17.388821 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 6 new API pairs in this round.
[2025-11-05 09:05:17.388850 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 6
[2025-11-05 09:05:17.388901 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,118.0,47.0,380.0,16.0,45.0,483.0,205.0,37.0,170.0,38.0,268.0,137.0,208.0,159.0,182.0,101.0,97.0,27.0,18.0,66.0,205.0,159.0,28.0,31.0,181.0,285.0,28.0,966.0,334.0,290.0,44.0,93.0,128.0,64.0,459.0,54.0,100.0,189.0,45.0,10.0,123.0,376.0,51.0,16.0,225.0,91.0,72.0,87.0,34.0,373.0,43.0,76.0,74.0,83.0,237.0,63.0,277.0,59.0,52.0,16.0]
[2025-11-05 09:05:17.388928 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:05:17.388984 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_error_code energy: 208
[2025-11-05 09:05:17.389016 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add energy: 45
[2025-11-05 09:05:17.389045 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 380
[2025-11-05 09:05:17.389072 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 966
[2025-11-05 09:05:17.389100 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 181
[2025-11-05 09:05:17.389136 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_error_code(const cre2_regexp_t * re),
    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)
[2025-11-05 09:05:17.389957 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 211, quiet_round: 0, discovered_api_pairs: 3595
[2025-11-05 09:05:17.436927 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:05:17.437282 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_error_code(const cre2_regexp_t * re),\n    int cre2_set_add(cre2_set * set, const char * pattern, size_t pattern_len, char * error, size_t error_len),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^Hello (World)$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Hello World\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t input = { text_buf, text_len };\n    cre2_string_t matches[3];\n    int partial_result = 0;\n    int version_cur = 0;\n    int64_t max_mem = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_one_line(opt, 1);\n\n    // step 3: Configure (inspect option and compile regexp)\n    max_mem = cre2_opt_max_mem(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (prepare match storage and perform partial match)\n    memset(matches, 0, sizeof(matches));\n    partial_result = cre2_partial_match_re(re, &input, matches, 3);\n\n    // step 5: Validate (use version and combine results so values flow)\n    version_cur = cre2_version_interface_current();\n    checksum = (long)pattern_len + (long)partial_result + (long)version_cur + (long)max_mem + (long)matches[0].length + (long)matches[1].length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice123\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t input = { text_buf, text_len };\n    cre2_string_t matches[4];\n    int partial_result = 0;\n    int log_errors_flag = 0;\n    const char *pat_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup (create options and configure literal handling)\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    log_errors_flag = cre2_opt_log_errors(opt);\n\n    // step 3: Configure (compile a regexp using the options)\n    re = cre2_new(pattern, pattern_len, opt);\n    pat_from_re = cre2_pattern(re);\n\n    // step 4: Operate (prepare match storage and perform a partial match using pattern from compiled regexp)\n    memset(matches, 0, sizeof(matches));\n    partial_result = cre2_partial_match(pat_from_re, &input, matches, 4);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)partial_result + (long)log_errors_flag + (long)matches[0].length + (long)matches[1].length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:05:59.683570 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 42s
[2025-11-05 09:05:59.683698 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28740, Completion: 20877, Total: 49617
[2025-11-05 09:05:59.683718 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:05:59.902050 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002110/id_002110.cc
[2025-11-05 09:05:59.902105 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:00.130072 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:00.130131 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:00.132946 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:00.132977 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:00.350603 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002111/id_002111.cc
[2025-11-05 09:06:00.350656 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:00.580273 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:00.580343 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:00.583048 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:00.583080 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:00.799429 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002112/id_002112.cc
[2025-11-05 09:06:00.799519 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:01.027722 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:01.027791 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:01.030944 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:01.030976 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:01.248816 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002113/id_002113.cc
[2025-11-05 09:06:01.248870 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:01.477463 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:01.477532 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:01.480027 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:01.480059 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:01.698458 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002114/id_002114.cc
[2025-11-05 09:06:01.698513 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:01.928579 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:01.928708 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:01.931313 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:01.931340 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:02.147704 +00:00] WARN [src/fuzzer.rs:205] Program 2115 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_002115/id_002115.cc:40:11: error: no matching function for call to 'cre2_set_new'
   40 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 09:06:02.194838 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:06:02.195172 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)(bar)?$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    char set_error[128];\n    memset(set_error, 0, sizeof(set_error));\n    int add_result = 0;\n    int err_code = 0;\n    int num_groups = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure (compile a regexp using the options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (inspect regexp and add pattern to a set)\n    num_groups = cre2_num_capturing_groups(re);\n    err_code = cre2_error_code(re);\n    set = cre2_set_new(opt, 0);\n    add_result = cre2_set_add(set, pattern, (size_t)pattern_len, set_error, sizeof(set_error));\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)num_groups + (long)err_code + (long)add_result + (long)(re != NULL) + (long)(set != NULL) + (long)set_error[0];\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_002115/id_002115.cc:40:11: error: no matching function for call to 'cre2_set_new'\n   40 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 09:06:24.644244 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 22s
[2025-11-05 09:06:24.644372 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 21880, Completion: 9748, Total: 31628
[2025-11-05 09:06:24.863761 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002115/id_002115.cc
[2025-11-05 09:06:24.863815 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:25.093428 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:25.093488 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:25.096104 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:25.096137 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:25.096169 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 2115!
[2025-11-05 09:06:25.314561 +00:00] WARN [src/fuzzer.rs:205] Program 2116 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_002116/id_002116.cc:40:11: error: no matching function for call to 'cre2_set_new'
   40 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 09:06:25.361585 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:06:25.361919 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(foo)(bar)?$\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    struct cre2_set *set = NULL;\n    char set_error[64];\n    int err_code = 0;\n    int num_groups = 0;\n    int add_result = 0;\n    int compile_result = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure (compile regexp using options and inspect)\n    re = cre2_new(pattern, pattern_len, opt);\n    err_code = cre2_error_code(re);\n    num_groups = cre2_num_capturing_groups(re);\n\n    // step 4: Operate (create a set, add pattern and compile the set)\n    set = cre2_set_new(opt, 0);\n    memset(set_error, 0, sizeof(set_error));\n    add_result = cre2_set_add(set, pattern, (size_t)pattern_len, set_error, sizeof(set_error));\n    compile_result = cre2_set_compile(set);\n\n    // step 5: Validate (combine results so values flow through)\n    checksum = (long)pattern_len + (long)err_code + (long)num_groups + (long)add_result + (long)compile_result + (long)(re != NULL) + (long)(set != NULL) + (long)set_error[0];\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_002116/id_002116.cc:40:11: error: no matching function for call to 'cre2_set_new'\n   40 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 09:06:45.162846 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 19s
[2025-11-05 09:06:45.162965 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22150, Completion: 10846, Total: 32996
[2025-11-05 09:06:45.381571 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002116/id_002116.cc
[2025-11-05 09:06:45.381624 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:45.611797 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:45.611876 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:45.614790 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:45.614822 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:45.614855 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 2116!
[2025-11-05 09:06:45.832802 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002117/id_002117.cc
[2025-11-05 09:06:45.832854 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:46.061186 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:46.061244 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:46.063943 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:46.063975 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:46.281422 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002118/id_002118.cc
[2025-11-05 09:06:46.281504 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:46.510778 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:46.510880 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:46.513714 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:46.513747 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:46.730497 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002119/id_002119.cc
[2025-11-05 09:06:46.730550 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:06:46.959160 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:06:46.959237 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:06:46.962425 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:06:46.962457 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:06:46.962497 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:06:46.962513 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2120, succ: 2119, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:06:46.962528 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:06:46.962554 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:06:47.230579 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2119 as an example for the next prompt.
[2025-11-05 09:06:47.230635 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 20 new API pairs in this round.
[2025-11-05 09:06:47.230676 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 20
[2025-11-05 09:06:47.230723 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,118.0,47.0,387.0,16.0,45.0,489.0,205.0,37.0,170.0,38.0,269.0,137.0,215.0,159.0,185.0,101.0,97.0,27.0,18.0,66.0,208.0,159.0,28.0,31.0,182.0,285.0,28.0,966.0,334.0,300.0,44.0,93.0,128.0,64.0,459.0,54.0,100.0,189.0,57.0,10.0,123.0,376.0,51.0,16.0,225.0,91.0,72.0,87.0,34.0,373.0,43.0,76.0,74.0,83.0,237.0,63.0,277.0,59.0,52.0,16.0]
[2025-11-05 09:06:47.230741 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:06:47.230791 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_extract energy: 16
[2025-11-05 09:06:47.230850 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 159
[2025-11-05 09:06:47.230880 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 966
[2025-11-05 09:06:47.230906 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 334
[2025-11-05 09:06:47.230944 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_extract(const char * pattern, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)
[2025-11-05 09:06:47.231644 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 212, quiet_round: 0, discovered_api_pairs: 3615
[2025-11-05 09:06:47.273186 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:06:47.273527 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_extract(const char * pattern, cre2_string_t * text, cre2_string_t * rewrite, cre2_string_t * target),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]*)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice123\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_string_t input = { text_buf, text_len };\n    cre2_string_t matches[4];\n    int partial_result = 0;\n    int log_errors_flag = 0;\n    const char *pat_from_re = NULL;\n    long checksum = 0;\n\n    // step 2: Setup (create options and configure literal handling)\n    opt = cre2_opt_new();\n    cre2_opt_set_literal(opt, 0);\n    log_errors_flag = cre2_opt_log_errors(opt);\n\n    // step 3: Configure (compile a regexp using the options)\n    re = cre2_new(pattern, pattern_len, opt);\n    pat_from_re = cre2_pattern(re);\n\n    // step 4: Operate (prepare match storage and perform a partial match using pattern from compiled regexp)\n    memset(matches, 0, sizeof(matches));\n    partial_result = cre2_partial_match(pat_from_re, &input, matches, 4);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)partial_result + (long)log_errors_flag + (long)matches[0].length + (long)matches[1].length + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)-(\\\\d{2,4})\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    char set_errbuf[128];\n    int add_result = 0;\n    int num_caps = 0;\n    int compile_err = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure (compile a regexp using the options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (inspect regexp and manipulate a set)\n    num_caps = cre2_num_capturing_groups(re);\n    compile_err = cre2_error_code(re);\n    memset(set_errbuf, 0, sizeof(set_errbuf));\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_result = cre2_set_add(set, pattern, (size_t)pattern_len, set_errbuf, sizeof(set_errbuf));\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)num_caps + (long)compile_err + (long)add_result + (long)set_errbuf[0] + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:07:18.412514 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 09:07:18.412654 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29090, Completion: 24730, Total: 53820
[2025-11-05 09:07:18.412676 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:07:18.629514 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002120/id_002120.cc
[2025-11-05 09:07:18.629566 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:18.858971 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:18.859039 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:18.862251 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:18.862283 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:19.079830 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002121/id_002121.cc
[2025-11-05 09:07:19.079883 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:19.309502 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:19.309575 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:19.312767 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:19.312799 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:19.529017 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002122/id_002122.cc
[2025-11-05 09:07:19.529102 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:19.757530 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:19.757588 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:19.760705 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:19.760738 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:19.978742 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002123/id_002123.cc
[2025-11-05 09:07:19.978795 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:20.206082 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:20.206143 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:20.209304 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:20.209335 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:20.428420 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002124/id_002124.cc
[2025-11-05 09:07:20.428484 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:20.657783 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:20.657872 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:20.661096 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:20.661128 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:20.879863 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002125/id_002125.cc
[2025-11-05 09:07:20.879916 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:21.109236 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:21.109307 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:21.112202 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:21.112234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:21.330512 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002126/id_002126.cc
[2025-11-05 09:07:21.330565 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:21.562041 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:21.562113 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:21.565293 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:21.565327 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:21.783458 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002127/id_002127.cc
[2025-11-05 09:07:21.783546 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:22.012854 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:22.012926 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:22.015840 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:22.015872 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:22.233801 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002128/id_002128.cc
[2025-11-05 09:07:22.233855 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:22.462569 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:22.462637 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:22.465780 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:22.465813 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:22.683339 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002129/id_002129.cc
[2025-11-05 09:07:22.683393 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:22.912869 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:22.912977 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:22.915956 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:22.915990 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:22.916028 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:07:22.916067 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2130, succ: 2129, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:07:22.916082 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:07:22.916107 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:07:23.205683 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2129 as an example for the next prompt.
[2025-11-05 09:07:23.205739 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 13 new API pairs in this round.
[2025-11-05 09:07:23.205774 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 13
[2025-11-05 09:07:23.205821 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,24.0,64.0,204.0,174.0,46.0,82.0,129.0,118.0,47.0,387.0,28.0,45.0,491.0,205.0,37.0,170.0,38.0,269.0,137.0,215.0,168.0,185.0,102.0,97.0,27.0,18.0,66.0,208.0,159.0,28.0,31.0,182.0,286.0,28.0,971.0,338.0,300.0,44.0,93.0,128.0,64.0,459.0,54.0,100.0,189.0,57.0,10.0,123.0,376.0,51.0,16.0,225.0,91.0,72.0,87.0,34.0,373.0,43.0,76.0,74.0,83.0,239.0,63.0,277.0,59.0,52.0,16.0]
[2025-11-05 09:07:23.205841 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:07:23.205894 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 204
[2025-11-05 09:07:23.205927 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 338
[2025-11-05 09:07:23.205954 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_full_match energy: 24
[2025-11-05 09:07:23.205980 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 91
[2025-11-05 09:07:23.206006 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 277
[2025-11-05 09:07:23.206046 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int64_t cre2_opt_max_mem(cre2_options_t * opt),
    int cre2_set_add_simple(cre2_set * set, const char * pattern)
[2025-11-05 09:07:23.206863 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 213, quiet_round: 0, discovered_api_pairs: 3628
[2025-11-05 09:07:23.253807 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:07:23.254165 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_full_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int64_t cre2_opt_max_mem(cre2_options_t * opt),\n    int cre2_set_add_simple(cre2_set * set, const char * pattern)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)-(\\\\d{2,4})\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_set *set = NULL;\n    char set_errbuf[128];\n    int add_result = 0;\n    int num_caps = 0;\n    int compile_err = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure (compile a regexp using the options)\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate (inspect regexp and manipulate a set)\n    num_caps = cre2_num_capturing_groups(re);\n    compile_err = cre2_error_code(re);\n    memset(set_errbuf, 0, sizeof(set_errbuf));\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_result = cre2_set_add(set, pattern, (size_t)pattern_len, set_errbuf, sizeof(set_errbuf));\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)num_caps + (long)compile_err + (long)add_result + (long)set_errbuf[0] + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char source_buf[] = \"Bob42 and Alice123\";\n    int source_len = (int)(sizeof(source_buf) - 1);\n    char target_buf[128];\n    char text_and_target_buf[] = \"Name99 Name88\";\n    int tat_len = (int)(sizeof(text_and_target_buf) - 1);\n    char rewrite_buf[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text = { source_buf, source_len };\n    cre2_string_t rewrite = { rewrite_buf, (int)(sizeof(rewrite_buf) - 1) };\n    cre2_string_t target = { target_buf, 0 };\n    cre2_string_t text_and_target = { text_and_target_buf, tat_len };\n    int extract_ret = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure (compile regexp and prepare named-groups iterator)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate (prepare buffers and perform extract)\n    memset(target_buf, 0, sizeof(target_buf));\n    target.data = target_buf;\n    target.length = 0;\n    extract_ret = cre2_extract(pattern, &text, &rewrite, &target);\n\n    // step 5: Operate (perform a global replace using compiled regexp) and Validate (combine values)\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    checksum = (long)pattern_len + (long)extract_ret + (long)replace_ret + (long)target.length + (long)text.length + (long)text_and_target.length + (long)(re != NULL) + (long)(opt != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:07:57.782799 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 09:07:57.782927 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30750, Completion: 26170, Total: 56920
[2025-11-05 09:07:57.782947 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:07:58.000678 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002130/id_002130.cc
[2025-11-05 09:07:58.000733 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:58.230890 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:58.230959 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:58.234095 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:58.234128 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:58.450973 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002131/id_002131.cc
[2025-11-05 09:07:58.451026 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:58.680459 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:58.680533 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:58.683147 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:58.683173 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:58.900828 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002132/id_002132.cc
[2025-11-05 09:07:58.900914 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:59.130720 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:59.130780 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:59.133995 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:59.134027 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:59.351443 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002133/id_002133.cc
[2025-11-05 09:07:59.351497 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:07:59.582157 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:07:59.582217 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:07:59.585356 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:07:59.585388 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:07:59.803251 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002134/id_002134.cc
[2025-11-05 09:07:59.803305 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:00.032659 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:00.032759 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:00.035626 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:00.035678 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:00.252829 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002135/id_002135.cc
[2025-11-05 09:08:00.252883 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:00.484021 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:00.484090 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:00.487194 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:00.487226 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:00.704885 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002136/id_002136.cc
[2025-11-05 09:08:00.704939 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:00.933764 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:00.933834 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:00.937124 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:00.937160 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:01.155507 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002137/id_002137.cc
[2025-11-05 09:08:01.155590 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:01.385299 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:01.385376 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:01.388471 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:01.388506 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:01.605946 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002138/id_002138.cc
[2025-11-05 09:08:01.606001 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:01.836262 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:01.836337 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:01.839420 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:01.839454 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:02.056296 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002139/id_002139.cc
[2025-11-05 09:08:02.056351 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:02.285939 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:02.286048 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:02.289302 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:02.289334 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:02.289372 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:08:02.289388 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2140, succ: 2139, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:08:02.289405 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:08:02.289450 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:08:02.596835 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2139 as an example for the next prompt.
[2025-11-05 09:08:02.596892 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 28 new API pairs in this round.
[2025-11-05 09:08:02.596942 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 28
[2025-11-05 09:08:02.596992 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,88.0,38.0,64.0,211.0,174.0,46.0,82.0,129.0,118.0,47.0,387.0,28.0,45.0,492.0,205.0,37.0,170.0,38.0,269.0,137.0,218.0,168.0,186.0,102.0,97.0,27.0,18.0,66.0,208.0,159.0,28.0,31.0,183.0,290.0,28.0,974.0,344.0,306.0,44.0,93.0,128.0,64.0,459.0,54.0,100.0,189.0,57.0,10.0,123.0,376.0,51.0,16.0,225.0,101.0,72.0,87.0,34.0,373.0,43.0,76.0,74.0,83.0,243.0,63.0,288.0,59.0,52.0,16.0]
[2025-11-05 09:08:02.597011 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:08:02.597066 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 88
[2025-11-05 09:08:02.597097 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_word_boundary energy: 76
[2025-11-05 09:08:02.597124 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 459
[2025-11-05 09:08:02.597150 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_partial_match energy: 189
[2025-11-05 09:08:02.597177 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_case_sensitive energy: 93
[2025-11-05 09:08:02.597214 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_literal(cre2_options_t * opt),
    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),
    int cre2_opt_case_sensitive(cre2_options_t * opt)
[2025-11-05 09:08:02.598034 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 214, quiet_round: 0, discovered_api_pairs: 3656
[2025-11-05 09:08:02.643097 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:08:02.643454 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_literal(cre2_options_t * opt),\n    void cre2_opt_set_word_boundary(cre2_options_t * opt, int flag),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_partial_match(const char * , const cre2_string_t * , cre2_string_t * , int ),\n    int cre2_opt_case_sensitive(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char source_buf[] = \"Bob42 and Alice123\";\n    int source_len = (int)(sizeof(source_buf) - 1);\n    char target_buf[128];\n    char text_and_target_buf[] = \"Name99 Name88\";\n    int tat_len = (int)(sizeof(text_and_target_buf) - 1);\n    char rewrite_buf[] = \"$1-$2\";\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    cre2_string_t text = { source_buf, source_len };\n    cre2_string_t rewrite = { rewrite_buf, (int)(sizeof(rewrite_buf) - 1) };\n    cre2_string_t target = { target_buf, 0 };\n    cre2_string_t text_and_target = { text_and_target_buf, tat_len };\n    int extract_ret = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure (compile regexp and prepare named-groups iterator)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate (prepare buffers and perform extract)\n    memset(target_buf, 0, sizeof(target_buf));\n    target.data = target_buf;\n    target.length = 0;\n    extract_ret = cre2_extract(pattern, &text, &rewrite, &target);\n\n    // step 5: Operate (perform a global replace using compiled regexp) and Validate (combine values)\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n    checksum = (long)pattern_len + (long)extract_ret + (long)replace_ret + (long)target.length + (long)text.length + (long)text_and_target.length + (long)(re != NULL) + (long)(opt != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<word>\\\\w+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    cre2_set *set = NULL;\n    int add_simple_ret = 0;\n    int full_ret = 0;\n    int replace_ret = 0;\n    int64_t max_mem = 0;\n    long checksum = 0;\n\n    // buffers for matching and replacing\n    char subject_buf[] = \"abc-123\";\n    cre2_string_t subject = { subject_buf, (int)(sizeof(subject_buf) - 1) };\n    char full_target_buf[64];\n    memset(full_target_buf, 0, sizeof(full_target_buf));\n    cre2_string_t full_target = { full_target_buf, 0 };\n\n    char text_and_target_buf[] = \"abc-123 abc-456\";\n    cre2_string_t text_and_target = { text_and_target_buf, (int)(sizeof(text_and_target_buf) - 1) };\n    char rewrite_buf[] = \"$1:$2\";\n    cre2_string_t rewrite = { rewrite_buf, (int)(sizeof(rewrite_buf) - 1) };\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 0);\n    max_mem = cre2_opt_max_mem(opt);\n\n    // step 3: Configure (compile regexp, create set and iterator)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_simple_ret = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate (perform a full match and a replace using compiled regexp)\n    full_ret = cre2_full_match(pattern, &subject, &full_target, 10);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)full_ret + (long)replace_ret + (long)add_simple_ret + (long)full_target.length + (long)text_and_target.length + (long)max_mem + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:08:35.216805 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 32s
[2025-11-05 09:08:35.216934 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32730, Completion: 25700, Total: 58430
[2025-11-05 09:08:35.216954 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:08:35.434303 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002140/id_002140.cc
[2025-11-05 09:08:35.434357 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:35.664791 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:35.664859 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:35.667391 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:35.667424 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:35.884508 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002141/id_002141.cc
[2025-11-05 09:08:35.884562 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:36.113563 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:36.113622 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:36.116271 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:36.116303 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:36.334628 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002142/id_002142.cc
[2025-11-05 09:08:36.334714 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:36.562392 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:36.562454 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:36.565288 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:36.565321 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:36.783024 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002143/id_002143.cc
[2025-11-05 09:08:36.783079 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:37.013591 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:37.013664 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:37.016180 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:37.016205 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:37.233281 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002144/id_002144.cc
[2025-11-05 09:08:37.233346 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:37.461976 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:37.462092 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:37.464828 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:37.464860 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:37.683589 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002145/id_002145.cc
[2025-11-05 09:08:37.683643 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:08:37.913151 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:08:37.913223 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:08:37.916448 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:08:37.916481 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:08:38.134141 +00:00] WARN [src/fuzzer.rs:205] Program 2146 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_002146/id_002146.cc:49:47: error: taking the address of a temporary object of type 'cre2_string_t' [-Waddress-of-temporary]
   49 |     partial_ret = cre2_partial_match(pattern, & (cre2_string_t){ text_buf, text_len }, &match2, 2);
      |                                               ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 09:08:38.179245 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:08:38.179572 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([a-z]+)\\\\d*\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"abc123xyz\";\n    int text_len = (int)(sizeof(text_buf) - 1);\n    char match1_buf[64];\n    char match2_buf[64];\n    cre2_string_t match1 = { match1_buf, 0 };\n    cre2_string_t match2 = { match2_buf, 0 };\n    cre2_options_t * opt = NULL;\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int lit_flag = 0;\n    int case_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_word_boundary(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n    lit_flag = cre2_opt_literal(opt);\n    case_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Operate (perform easy and partial matches)\n    memset(match1_buf, 0, sizeof(match1_buf));\n    match1.data = match1_buf;\n    match1.length = 0;\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, &match1, 2);\n\n    memset(match2_buf, 0, sizeof(match2_buf));\n    match2.data = match2_buf;\n    match2.length = 0;\n    partial_ret = cre2_partial_match(pattern, & (cre2_string_t){ text_buf, text_len }, &match2, 2);\n\n    // step 4: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)easy_ret + (long)partial_ret + (long)match1.length + (long)match2.length + (long)lit_flag + (long)case_flag + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 5: Cleanup (release resources)\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_002146/id_002146.cc:49:47: error: taking the address of a temporary object of type 'cre2_string_t' [-Waddress-of-temporary]\n   49 |     partial_ret = cre2_partial_match(pattern, & (cre2_string_t){ text_buf, text_len }, &match2, 2);\n      |                                               ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 09:08:59.685812 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 21s
[2025-11-05 09:08:59.685938 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 22300, Completion: 11727, Total: 34027
[2025-11-05 09:08:59.904205 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002146/id_002146.cc
[2025-11-05 09:08:59.904259 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:00.133114 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:00.133185 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:00.135993 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:00.136020 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:00.136052 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 2146!
[2025-11-05 09:09:00.355857 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002147/id_002147.cc
[2025-11-05 09:09:00.355911 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:00.585510 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:00.585577 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:00.588236 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:00.588268 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:00.804348 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002148/id_002148.cc
[2025-11-05 09:09:00.804433 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:01.032926 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:01.032993 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:01.035751 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:01.035776 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:01.253079 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002149/id_002149.cc
[2025-11-05 09:09:01.253133 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:01.483063 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:01.483135 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:01.486017 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:01.486049 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:01.486087 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:09:01.486107 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2150, succ: 2149, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:09:01.486122 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:09:01.486148 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:09:01.774971 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2149 as an example for the next prompt.
[2025-11-05 09:09:01.775028 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 24 new API pairs in this round.
[2025-11-05 09:09:01.775074 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 24
[2025-11-05 09:09:01.775122 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,100.0,38.0,64.0,211.0,174.0,46.0,82.0,129.0,118.0,47.0,387.0,28.0,45.0,492.0,205.0,37.0,170.0,38.0,273.0,143.0,218.0,168.0,186.0,102.0,97.0,27.0,18.0,66.0,208.0,159.0,28.0,31.0,183.0,298.0,28.0,974.0,344.0,306.0,44.0,101.0,128.0,64.0,461.0,54.0,100.0,193.0,57.0,10.0,123.0,376.0,51.0,16.0,225.0,101.0,72.0,89.0,34.0,373.0,43.0,94.0,74.0,83.0,243.0,63.0,288.0,59.0,52.0,16.0]
[2025-11-05 09:09:01.775139 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:09:01.775192 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 461
[2025-11-05 09:09:01.775222 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_replace_re energy: 211
[2025-11-05 09:09:01.775249 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 974
[2025-11-05 09:09:01.775275 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 306
[2025-11-05 09:09:01.775315 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)
[2025-11-05 09:09:01.776002 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 215, quiet_round: 0, discovered_api_pairs: 3680
[2025-11-05 09:09:01.824481 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:09:01.824872 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    int cre2_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<word>\\\\w+)-(\\\\d+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    cre2_options_t *opt = NULL;\n    cre2_regexp_t *re = NULL;\n    cre2_named_groups_iter_t *iter = NULL;\n    cre2_set *set = NULL;\n    int add_simple_ret = 0;\n    int full_ret = 0;\n    int replace_ret = 0;\n    int64_t max_mem = 0;\n    long checksum = 0;\n\n    // buffers for matching and replacing\n    char subject_buf[] = \"abc-123\";\n    cre2_string_t subject = { subject_buf, (int)(sizeof(subject_buf) - 1) };\n    char full_target_buf[64];\n    memset(full_target_buf, 0, sizeof(full_target_buf));\n    cre2_string_t full_target = { full_target_buf, 0 };\n\n    char text_and_target_buf[] = \"abc-123 abc-456\";\n    cre2_string_t text_and_target = { text_and_target_buf, (int)(sizeof(text_and_target_buf) - 1) };\n    char rewrite_buf[] = \"$1:$2\";\n    cre2_string_t rewrite = { rewrite_buf, (int)(sizeof(rewrite_buf) - 1) };\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 0);\n    max_mem = cre2_opt_max_mem(opt);\n\n    // step 3: Configure (compile regexp, create set and iterator)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    add_simple_ret = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate (perform a full match and a replace using compiled regexp)\n    full_ret = cre2_full_match(pattern, &subject, &full_target, 10);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)full_ret + (long)replace_ret + (long)add_simple_ret + (long)full_target.length + (long)text_and_target.length + (long)max_mem + (long)(re != NULL) + (long)(set != NULL) + (long)(opt != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Bob42 and Alice123\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t text = { text_buf, text_len };\n    cre2_options_t * opt = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t pmatch[3];\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int literal_flag = 0;\n    int cs_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_word_boundary(opt, 1);\n    literal_flag = cre2_opt_literal(opt);\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Initialize match containers\n    matches[0].data = NULL; matches[0].length = 0;\n    matches[1].data = NULL; matches[1].length = 0;\n    matches[2].data = NULL; matches[2].length = 0;\n    pmatch[0].data = NULL; pmatch[0].length = 0;\n    pmatch[1].data = NULL; pmatch[1].length = 0;\n    pmatch[2].data = NULL; pmatch[2].length = 0;\n\n    // step 4: Operate (perform easy match and partial match)\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    partial_ret = cre2_partial_match(pattern, &text, pmatch, 3);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)easy_ret + (long)partial_ret + (long)matches[0].length + (long)matches[1].length + (long)pmatch[0].length + (long)literal_flag + (long)cs_flag + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:09:33.454575 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 31s
[2025-11-05 09:09:33.454702 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 32920, Completion: 23087, Total: 56007
[2025-11-05 09:09:33.454722 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:09:33.671273 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002150/id_002150.cc
[2025-11-05 09:09:33.671327 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:33.901671 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:33.901742 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:33.904638 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:33.904664 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:34.120591 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002151/id_002151.cc
[2025-11-05 09:09:34.120665 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:34.349348 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:34.349421 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:34.351983 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:34.352009 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:34.569374 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002152/id_002152.cc
[2025-11-05 09:09:34.569461 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:34.799132 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:34.799192 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:34.802004 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:34.802035 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:35.020283 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002153/id_002153.cc
[2025-11-05 09:09:35.020337 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:35.248797 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:35.248872 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:35.251574 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:35.251605 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:35.469945 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002154/id_002154.cc
[2025-11-05 09:09:35.470000 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:35.700407 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:35.700523 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:35.703247 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:35.703282 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:35.919907 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002155/id_002155.cc
[2025-11-05 09:09:35.919961 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:36.149928 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:36.150006 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:36.152779 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:36.152810 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:36.370510 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002156/id_002156.cc
[2025-11-05 09:09:36.370566 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:36.599250 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:36.599323 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:36.602073 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:36.602106 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:36.823161 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002157/id_002157.cc
[2025-11-05 09:09:36.823248 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:37.051972 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:37.052048 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:37.054831 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:37.054862 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:37.274493 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002158/id_002158.cc
[2025-11-05 09:09:37.274550 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:37.505391 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:37.505463 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:37.508319 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:37.508352 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:37.725690 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002159/id_002159.cc
[2025-11-05 09:09:37.725746 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:09:37.956459 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:09:37.956550 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:09:37.959352 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:09:37.959385 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:09:37.959422 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:09:37.959437 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2160, succ: 2159, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:09:37.959453 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:09:37.959477 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:09:38.256225 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2159 as an example for the next prompt.
[2025-11-05 09:09:38.256283 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 10 new API pairs in this round.
[2025-11-05 09:09:38.256317 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 10
[2025-11-05 09:09:38.256365 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,57.0,100.0,38.0,64.0,216.0,174.0,46.0,82.0,129.0,118.0,47.0,387.0,28.0,45.0,492.0,205.0,37.0,170.0,38.0,273.0,143.0,218.0,168.0,187.0,102.0,97.0,27.0,18.0,66.0,209.0,159.0,28.0,31.0,186.0,302.0,28.0,975.0,344.0,308.0,44.0,102.0,128.0,64.0,467.0,54.0,100.0,193.0,57.0,10.0,123.0,376.0,51.0,16.0,226.0,101.0,72.0,89.0,34.0,373.0,43.0,97.0,74.0,83.0,243.0,63.0,289.0,59.0,52.0,16.0]
[2025-11-05 09:09:38.256382 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:09:38.256436 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_posix_syntax energy: 44
[2025-11-05 09:09:38.256466 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace energy: 57
[2025-11-05 09:09:38.256496 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_encoding energy: 174
[2025-11-05 09:09:38.256521 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 387
[2025-11-05 09:09:38.256548 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 129
[2025-11-05 09:09:38.256583 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_posix_syntax(cre2_options_t * opt),
    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    int cre2_program_size(const cre2_regexp_t * re)
[2025-11-05 09:09:38.257416 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 216, quiet_round: 0, discovered_api_pairs: 3690
[2025-11-05 09:09:38.297096 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:09:38.297454 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_posix_syntax(cre2_options_t * opt),\n    int cre2_global_replace(const char * pattern, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    void cre2_opt_set_encoding(cre2_options_t * opt, cre2_encoding_t enc),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    int cre2_program_size(const cre2_regexp_t * re)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Bob42 and Alice123\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t text = { text_buf, text_len };\n    cre2_options_t * opt = NULL;\n    cre2_string_t matches[3];\n    cre2_string_t pmatch[3];\n    int easy_ret = 0;\n    int partial_ret = 0;\n    int literal_flag = 0;\n    int cs_flag = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_word_boundary(opt, 1);\n    literal_flag = cre2_opt_literal(opt);\n    cs_flag = cre2_opt_case_sensitive(opt);\n\n    // step 3: Initialize match containers\n    matches[0].data = NULL; matches[0].length = 0;\n    matches[1].data = NULL; matches[1].length = 0;\n    matches[2].data = NULL; matches[2].length = 0;\n    pmatch[0].data = NULL; pmatch[0].length = 0;\n    pmatch[1].data = NULL; pmatch[1].length = 0;\n    pmatch[2].data = NULL; pmatch[2].length = 0;\n\n    // step 4: Operate (perform easy match and partial match)\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    partial_ret = cre2_partial_match(pattern, &text, pmatch, 3);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)easy_ret + (long)partial_ret + (long)matches[0].length + (long)matches[1].length + (long)pmatch[0].length + (long)literal_flag + (long)cs_flag + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t matches[3];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_ret = 0;\n    int replace_ret = 0;\n    int add_simple_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup (initialize match containers and options)\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure (compile regexp and create set)\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_simple_ret = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate (perform an easy match and a replacement using compiled regexp)\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    const char rewrite_buf[] = \"$1:$2\";\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)easy_ret + (long)replace_ret + (long)add_simple_ret + (long)matches[0].length + (long)matches[1].length + (long)text_and_target.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:10:07.877226 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 09:10:07.877353 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 31660, Completion: 20036, Total: 51696
[2025-11-05 09:10:07.877374 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:10:08.095446 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002160/id_002160.cc
[2025-11-05 09:10:08.095501 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:08.324375 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:08.324446 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:08.327235 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:08.327263 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:08.544722 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002161/id_002161.cc
[2025-11-05 09:10:08.544777 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:08.776406 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:08.776476 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:08.779227 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:08.779253 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:08.995944 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002162/id_002162.cc
[2025-11-05 09:10:08.996030 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:09.225152 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:09.225226 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:09.227912 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:09.227945 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:09.446145 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002163/id_002163.cc
[2025-11-05 09:10:09.446200 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:09.675968 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:09.676031 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:09.678898 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:09.678932 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:09.899414 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002164/id_002164.cc
[2025-11-05 09:10:09.899469 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:10.128983 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:10.129092 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:10.131918 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:10.131951 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:10.349081 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002165/id_002165.cc
[2025-11-05 09:10:10.349135 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:10.578052 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:10.578134 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:10.581018 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:10.581051 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:10.798174 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002166/id_002166.cc
[2025-11-05 09:10:10.798228 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:11.028445 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:11.028515 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:11.031285 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:11.031311 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:11.248483 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002167/id_002167.cc
[2025-11-05 09:10:11.248570 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:11.478057 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:11.478130 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:11.481033 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:11.481065 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:11.697807 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002168/id_002168.cc
[2025-11-05 09:10:11.697863 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:11.927788 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:11.927864 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:11.930736 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:11.930767 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:12.149341 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002169/id_002169.cc
[2025-11-05 09:10:12.149397 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:12.378834 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:12.378949 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:12.381778 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:12.381809 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:12.381848 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:10:12.381864 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2170, succ: 2169, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:10:12.381878 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:10:12.381904 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:10:12.669208 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2169 as an example for the next prompt.
[2025-11-05 09:10:12.669265 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 09:10:12.669313 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 09:10:12.669362 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,100.0,38.0,64.0,216.0,180.0,46.0,82.0,135.0,118.0,50.0,393.0,28.0,45.0,494.0,205.0,37.0,170.0,38.0,275.0,143.0,218.0,168.0,187.0,102.0,97.0,27.0,18.0,66.0,209.0,159.0,28.0,31.0,186.0,304.0,28.0,981.0,344.0,308.0,52.0,102.0,128.0,64.0,467.0,54.0,100.0,193.0,57.0,10.0,123.0,376.0,51.0,16.0,226.0,101.0,72.0,89.0,34.0,373.0,43.0,97.0,74.0,83.0,243.0,63.0,289.0,59.0,52.0,16.0]
[2025-11-05 09:10:12.669380 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:10:12.669434 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_capture energy: 18
[2025-11-05 09:10:12.669464 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_new energy: 344
[2025-11-05 09:10:12.669493 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 168
[2025-11-05 09:10:12.669520 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_word_boundary energy: 45
[2025-11-05 09:10:12.669555 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_never_capture(cre2_options_t * opt),
    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),
    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    int cre2_opt_word_boundary(cre2_options_t * opt)
[2025-11-05 09:10:12.670255 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 217, quiet_round: 0, discovered_api_pairs: 3707
[2025-11-05 09:10:12.700795 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:10:12.701141 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_never_capture(cre2_options_t * opt),\n    cre2_named_groups_iter_t *cre2_named_groups_iter_new(const cre2_regexp_t * re),\n    int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    int cre2_opt_word_boundary(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t matches[3];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int easy_ret = 0;\n    int replace_ret = 0;\n    int add_simple_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup (initialize match containers and options)\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure (compile regexp and create set)\n    re = cre2_new(pattern, pattern_len, opt);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    add_simple_ret = cre2_set_add_simple(set, pattern);\n\n    // step 4: Operate (perform an easy match and a replacement using compiled regexp)\n    easy_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    const char rewrite_buf[] = \"$1:$2\";\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_ret = cre2_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)easy_ret + (long)replace_ret + (long)add_simple_ret + (long)matches[0].length + (long)matches[1].length + (long)text_and_target.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    const char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int posix_flag = 0;\n    int replace_ret = 0;\n    int num_groups = 0;\n    int prog_size = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_posix_syntax(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    posix_flag = cre2_opt_posix_syntax(opt);\n\n    // step 3: Configure (compile regexp and prepare strings)\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    prog_size = cre2_program_size(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n\n    // step 4: Operate (perform a global replace using pattern)\n    replace_ret = cre2_global_replace(pattern, &text_and_target, &rewrite);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)replace_ret + (long)num_groups + (long)prog_size + (long)text_and_target.length + (long)rewrite.length + (long)posix_flag + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:10:51.213338 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 38s
[2025-11-05 09:10:51.213466 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30950, Completion: 23369, Total: 54319
[2025-11-05 09:10:51.213487 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:10:51.430563 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002170/id_002170.cc
[2025-11-05 09:10:51.430628 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:51.661531 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:51.661591 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:51.664712 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:51.664747 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:51.882378 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002171/id_002171.cc
[2025-11-05 09:10:51.882433 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:52.113852 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:52.113920 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:52.117080 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:52.117114 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:52.333904 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002172/id_002172.cc
[2025-11-05 09:10:52.333995 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:52.564924 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:52.564997 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:52.567977 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:52.568008 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:52.786782 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002173/id_002173.cc
[2025-11-05 09:10:52.786836 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:53.017965 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:53.018041 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:53.021108 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:53.021140 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:53.239649 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002174/id_002174.cc
[2025-11-05 09:10:53.239703 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:53.468898 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:53.468985 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:53.471922 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:53.471956 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:53.690185 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002175/id_002175.cc
[2025-11-05 09:10:53.690239 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:10:53.920474 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:10:53.920542 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:10:53.923866 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:10:53.923898 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:10:54.141592 +00:00] WARN [src/fuzzer.rs:205] Program 2176 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_002176/id_002176.cc:37:5: error: no matching function for call to 'cre2_opt_never_capture'
   37 |     cre2_opt_never_capture(opt, 1);
      |     ^~~~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:79:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   79 | cre2_decl int cre2_opt_never_capture            (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/cre2/work/id_002176/id_002176.cc:38:5: error: no matching function for call to 'cre2_opt_word_boundary'
   38 |     cre2_opt_word_boundary(opt, 1);
      |     ^~~~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:82:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   82 | cre2_decl int cre2_opt_word_boundary            (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
2 errors generated.

[2025-11-05 09:10:54.172216 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:10:54.172551 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)-(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int replace_ret = 0;\n    int num_groups = 0;\n    long checksum = 0;\n\n    // step 2: Setup (initialize containers and create options)\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    opt = cre2_opt_new();\n    cre2_opt_never_capture(opt, 1);\n    cre2_opt_word_boundary(opt, 1);\n\n    // step 3: Configure (compile regexp and create named-groups iterator)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n\n    // step 4: Operate (prepare strings and perform a global replace using compiled regexp)\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (extract some properties and fold values into checksum)\n    num_groups = cre2_num_capturing_groups(re);\n    checksum = (long)pattern_len + (long)replace_ret + (long)num_groups + (long)text_and_target.length + (long)rewrite.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_002176/id_002176.cc:37:5: error: no matching function for call to 'cre2_opt_never_capture'\n   37 |     cre2_opt_never_capture(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:79:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   79 | cre2_decl int cre2_opt_never_capture            (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/cre2/work/id_002176/id_002176.cc:38:5: error: no matching function for call to 'cre2_opt_word_boundary'\n   38 |     cre2_opt_word_boundary(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:82:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   82 | cre2_decl int cre2_opt_word_boundary            (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n2 errors generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 09:11:18.250416 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 24s
[2025-11-05 09:11:18.250544 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24640, Completion: 12164, Total: 36804
[2025-11-05 09:11:18.469767 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002176/id_002176.cc
[2025-11-05 09:11:18.469822 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:11:18.701217 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:11:18.701301 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:11:18.704396 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:11:18.704423 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:11:18.704459 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 2176!
[2025-11-05 09:11:18.920526 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002177/id_002177.cc
[2025-11-05 09:11:18.920580 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:11:19.149781 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:11:19.149852 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:11:19.152917 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:11:19.152946 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:11:19.372321 +00:00] WARN [src/fuzzer.rs:205] Program 2178 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_002178/id_002178.cc:36:5: error: no matching function for call to 'cre2_opt_never_capture'
   36 |     cre2_opt_never_capture(opt, 1);
      |     ^~~~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:79:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   79 | cre2_decl int cre2_opt_never_capture            (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/cre2/work/id_002178/id_002178.cc:37:5: error: no matching function for call to 'cre2_opt_word_boundary'
   37 |     cre2_opt_word_boundary(opt, 1);
      |     ^~~~~~~~~~~~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:82:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided
   82 | cre2_decl int cre2_opt_word_boundary            (cre2_options_t *opt);
      |               ^                                  ~~~~~~~~~~~~~~~~~~~
2 errors generated.

[2025-11-05 09:11:19.402942 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:11:19.403263 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<name>[A-Za-z]+)-(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"$name:$num\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    opt = cre2_opt_new();\n    cre2_opt_never_capture(opt, 1);\n    cre2_opt_word_boundary(opt, 1);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n\n    // step 4: Operate\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)replace_ret + (long)text_and_target.length + (long)rewrite.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_002178/id_002178.cc:36:5: error: no matching function for call to 'cre2_opt_never_capture'\n   36 |     cre2_opt_never_capture(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:79:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   79 | cre2_decl int cre2_opt_never_capture            (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/cre2/work/id_002178/id_002178.cc:37:5: error: no matching function for call to 'cre2_opt_word_boundary'\n   37 |     cre2_opt_word_boundary(opt, 1);\n      |     ^~~~~~~~~~~~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:82:15: note: candidate function not viable: requires single argument 'opt', but 2 arguments were provided\n   82 | cre2_decl int cre2_opt_word_boundary            (cre2_options_t *opt);\n      |               ^                                  ~~~~~~~~~~~~~~~~~~~\n2 errors generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 09:11:37.899973 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 18s
[2025-11-05 09:11:37.900076 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24020, Completion: 13676, Total: 37696
[2025-11-05 09:11:38.120193 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002178/id_002178.cc
[2025-11-05 09:11:38.120248 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:11:38.351194 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:11:38.351276 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:11:38.354473 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:11:38.354502 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:11:38.354537 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 2178!
[2025-11-05 09:11:38.571802 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002179/id_002179.cc
[2025-11-05 09:11:38.571869 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:11:38.801339 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:11:38.801423 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:11:38.804649 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:11:38.804682 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:11:38.804726 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:11:38.804744 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2180, succ: 2179, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:11:38.804759 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:11:38.804787 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:11:39.107307 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2179 as an example for the next prompt.
[2025-11-05 09:11:39.107395 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 17 new API pairs in this round.
[2025-11-05 09:11:39.107447 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 17
[2025-11-05 09:11:39.107505 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,100.0,38.0,64.0,216.0,180.0,46.0,82.0,137.0,118.0,50.0,396.0,28.0,48.0,494.0,205.0,37.0,170.0,38.0,277.0,143.0,218.0,173.0,187.0,106.0,97.0,27.0,23.0,66.0,209.0,159.0,28.0,31.0,186.0,307.0,28.0,984.0,350.0,308.0,52.0,102.0,128.0,64.0,467.0,54.0,100.0,193.0,57.0,15.0,123.0,376.0,51.0,16.0,226.0,101.0,72.0,89.0,34.0,373.0,43.0,104.0,74.0,83.0,245.0,63.0,289.0,59.0,52.0,16.0]
[2025-11-05 09:11:39.107526 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:11:39.107614 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 984
[2025-11-05 09:11:39.107654 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_pattern energy: 373
[2025-11-05 09:11:39.107701 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_consume energy: 63
[2025-11-05 09:11:39.107734 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_perl_classes energy: 82
[2025-11-05 09:11:39.107770 +00:00] INFO [src/request/prompt.rs:145] set combination: cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    const char *cre2_pattern(const cre2_regexp_t * re),
    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),
    int cre2_opt_perl_classes(cre2_options_t * opt)
[2025-11-05 09:11:39.108462 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 218, quiet_round: 0, discovered_api_pairs: 3724
[2025-11-05 09:11:39.144937 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:11:39.145304 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\ncre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    const char *cre2_pattern(const cre2_regexp_t * re),\n    int cre2_consume(const char * , cre2_string_t * , cre2_string_t * , int ),\n    int cre2_opt_perl_classes(cre2_options_t * opt)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    const char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    int posix_flag = 0;\n    int replace_ret = 0;\n    int num_groups = 0;\n    int prog_size = 0;\n    long checksum = 0;\n\n    // step 2: Setup (create and configure options)\n    opt = cre2_opt_new();\n    cre2_opt_set_posix_syntax(opt, 1);\n    cre2_opt_set_encoding(opt, CRE2_UTF8);\n    posix_flag = cre2_opt_posix_syntax(opt);\n\n    // step 3: Configure (compile regexp and prepare strings)\n    re = cre2_new(pattern, pattern_len, opt);\n    num_groups = cre2_num_capturing_groups(re);\n    prog_size = cre2_program_size(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n\n    // step 4: Operate (perform a global replace using pattern)\n    replace_ret = cre2_global_replace(pattern, &text_and_target, &rewrite);\n\n    // step 5: Validate (combine values so results flow through)\n    checksum = (long)pattern_len + (long)replace_ret + (long)num_groups + (long)prog_size + (long)text_and_target.length + (long)rewrite.length + (long)posix_flag + (long)(opt != NULL) + (long)(re != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup (release resources)\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)-(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int never_capture_flag = 0;\n    int word_boundary_flag = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    opt = cre2_opt_new();\n    cre2_opt_set_never_capture(opt, 1);\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 3: Configure\n    never_capture_flag = cre2_opt_never_capture(opt);\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    iter = cre2_named_groups_iter_new(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)replace_ret + (long)never_capture_flag + (long)word_boundary_flag + (long)text_and_target.length + (long)rewrite.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:12:05.326311 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 26s
[2025-11-05 09:12:05.326437 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30560, Completion: 21134, Total: 51694
[2025-11-05 09:12:05.326457 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:12:05.544660 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002180/id_002180.cc
[2025-11-05 09:12:05.544715 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:05.774013 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:05.774072 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:05.776824 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:05.776852 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:05.994455 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002181/id_002181.cc
[2025-11-05 09:12:05.994508 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:06.222807 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:06.222885 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:06.225757 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:06.225790 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:06.443575 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002182/id_002182.cc
[2025-11-05 09:12:06.443663 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:06.672265 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:06.672340 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:06.674983 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:06.675016 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:06.893024 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002183/id_002183.cc
[2025-11-05 09:12:06.893079 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:07.122088 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:07.122164 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:07.125206 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:07.125239 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:07.341724 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002184/id_002184.cc
[2025-11-05 09:12:07.341777 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:07.569715 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:07.569832 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:07.572681 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:07.572714 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:07.791861 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002185/id_002185.cc
[2025-11-05 09:12:07.791916 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:08.022019 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:08.022093 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:08.024800 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:08.024832 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:08.245959 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002186/id_002186.cc
[2025-11-05 09:12:08.246013 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:08.473771 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:08.473844 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:08.476675 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:08.476708 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:08.694642 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002187/id_002187.cc
[2025-11-05 09:12:08.694725 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:08.923723 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:08.923796 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:08.926661 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:08.926695 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:09.143955 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002188/id_002188.cc
[2025-11-05 09:12:09.144008 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:09.372782 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:09.372855 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:09.375494 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:09.375527 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:09.593423 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002189/id_002189.cc
[2025-11-05 09:12:09.593478 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:09.821680 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:09.821790 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:09.824506 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:09.824537 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:09.824575 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:12:09.824615 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2190, succ: 2189, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:12:09.824658 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:12:09.824683 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:12:10.102667 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2189 as an example for the next prompt.
[2025-11-05 09:12:10.102725 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 3 new API pairs in this round.
[2025-11-05 09:12:10.102750 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 3
[2025-11-05 09:12:10.102797 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,100.0,38.0,64.0,216.0,180.0,46.0,84.0,137.0,118.0,50.0,396.0,28.0,48.0,494.0,205.0,37.0,170.0,38.0,277.0,143.0,218.0,173.0,187.0,106.0,97.0,27.0,23.0,66.0,209.0,159.0,28.0,31.0,186.0,307.0,28.0,986.0,350.0,308.0,52.0,102.0,128.0,64.0,467.0,54.0,100.0,193.0,57.0,15.0,123.0,376.0,51.0,16.0,226.0,101.0,72.0,89.0,34.0,374.0,43.0,104.0,74.0,83.0,245.0,65.0,289.0,59.0,52.0,16.0]
[2025-11-05 09:12:10.102816 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:12:10.102869 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 307
[2025-11-05 09:12:10.102901 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_longest_match energy: 16
[2025-11-05 09:12:10.102927 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_never_nl energy: 64
[2025-11-05 09:12:10.102954 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_easy_match energy: 467
[2025-11-05 09:12:10.102982 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_posix_syntax energy: 50
[2025-11-05 09:12:10.103018 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),
    int cre2_opt_longest_match(cre2_options_t * opt),
    int cre2_opt_never_nl(cre2_options_t * opt),
    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),
    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag)
[2025-11-05 09:12:10.103828 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 219, quiet_round: 0, discovered_api_pairs: 3727
[2025-11-05 09:12:10.145000 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:12:10.145348 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag),\n    int cre2_opt_longest_match(cre2_options_t * opt),\n    int cre2_opt_never_nl(cre2_options_t * opt),\n    int cre2_easy_match(const char * pattern, int pattern_len, const char * text, int text_len, cre2_string_t * match, int nmatch),\n    void cre2_opt_set_posix_syntax(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"(?P<first>[A-Za-z]+)-(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    const char rewrite_buf[] = \"$1:$2\";\n    const int rewrite_len = (int)(sizeof(rewrite_buf) - 1);\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_named_groups_iter_t * iter = NULL;\n    int never_capture_flag = 0;\n    int word_boundary_flag = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    opt = cre2_opt_new();\n    cre2_opt_set_never_capture(opt, 1);\n    cre2_opt_set_word_boundary(opt, 1);\n\n    // step 3: Configure\n    never_capture_flag = cre2_opt_never_capture(opt);\n    word_boundary_flag = cre2_opt_word_boundary(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n\n    // step 4: Operate\n    iter = cre2_named_groups_iter_new(re);\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = rewrite_len;\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)replace_ret + (long)never_capture_flag + (long)word_boundary_flag + (long)text_and_target.length + (long)rewrite.length + (long)(opt != NULL) + (long)(re != NULL) + (long)(iter != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_named_groups_iter_delete(iter);\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t subject;\n    cre2_string_t match;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * retrieved_pattern = NULL;\n    int perl_flag = 0;\n    int consume_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&subject, 0, sizeof(subject));\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    perl_flag = cre2_opt_perl_classes(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    retrieved_pattern = cre2_pattern(re);\n    subject.data = text_buf;\n    subject.length = text_len;\n\n    // step 4: Operate\n    consume_ret = cre2_consume(pattern, &subject, &match, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)consume_ret + (long)perl_flag + (long)(opt != NULL) + (long)(re != NULL) + (long)subject.length + (long)match.length + (long)(retrieved_pattern != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:12:37.911217 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 27s
[2025-11-05 09:12:37.911347 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 29720, Completion: 19581, Total: 49301
[2025-11-05 09:12:37.911367 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:12:38.129424 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002190/id_002190.cc
[2025-11-05 09:12:38.129479 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:38.358846 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:38.358926 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:38.361834 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:38.361866 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:38.579300 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002191/id_002191.cc
[2025-11-05 09:12:38.579354 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:38.807761 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:38.807830 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:38.810676 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:38.810709 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:39.029346 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002192/id_002192.cc
[2025-11-05 09:12:39.029433 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:39.258424 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:39.258496 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:39.261316 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:39.261348 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:39.478411 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002193/id_002193.cc
[2025-11-05 09:12:39.478465 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:39.707757 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:39.707830 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:39.710639 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:39.710671 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:39.929382 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002194/id_002194.cc
[2025-11-05 09:12:39.929436 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:40.158693 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:40.158800 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:40.161697 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:40.161730 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:40.379042 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002195/id_002195.cc
[2025-11-05 09:12:40.379095 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:40.609272 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:40.609345 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:40.611965 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:40.611998 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:40.830168 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002196/id_002196.cc
[2025-11-05 09:12:40.830224 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:41.059188 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:41.059268 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:41.062167 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:41.062200 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:41.280035 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002197/id_002197.cc
[2025-11-05 09:12:41.280122 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:41.507197 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:41.507271 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:41.510119 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:41.510151 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:41.729240 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002198/id_002198.cc
[2025-11-05 09:12:41.729295 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:41.958566 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:41.958625 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:41.961364 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:41.961398 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:42.179952 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002199/id_002199.cc
[2025-11-05 09:12:42.180007 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:12:42.408730 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:12:42.408844 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:12:42.411504 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:12:42.411537 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:12:42.411575 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:12:42.411590 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2200, succ: 2199, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:12:42.411605 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:12:42.411629 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:12:42.683798 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2199 as an example for the next prompt.
[2025-11-05 09:12:42.683853 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 09:12:42.683897 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 09:12:42.683946 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,100.0,38.0,64.0,216.0,180.0,46.0,84.0,137.0,118.0,57.0,396.0,28.0,48.0,494.0,205.0,37.0,170.0,38.0,277.0,143.0,218.0,173.0,187.0,106.0,97.0,27.0,23.0,66.0,209.0,159.0,28.0,31.0,186.0,312.0,28.0,986.0,350.0,308.0,52.0,105.0,128.0,70.0,469.0,54.0,100.0,193.0,57.0,15.0,123.0,376.0,51.0,16.0,226.0,101.0,72.0,90.0,34.0,374.0,46.0,104.0,74.0,83.0,245.0,65.0,289.0,59.0,52.0,25.0]
[2025-11-05 09:12:42.683964 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:12:42.684015 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_delete energy: 494
[2025-11-05 09:12:42.684049 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_encoding energy: 376
[2025-11-05 09:12:42.684077 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_program_size energy: 137
[2025-11-05 09:12:42.684104 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_match energy: 205
[2025-11-05 09:12:42.684131 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_new energy: 277
[2025-11-05 09:12:42.684167 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_delete(cre2_regexp_t * re),
    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),
    int cre2_program_size(const cre2_regexp_t * re),
    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),
    cre2_options_t *cre2_opt_new()
[2025-11-05 09:12:42.685007 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 220, quiet_round: 0, discovered_api_pairs: 3739
[2025-11-05 09:12:42.731551 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:12:42.731908 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_delete(cre2_regexp_t * re),\n    cre2_encoding_t cre2_opt_encoding(cre2_options_t * opt),\n    int cre2_program_size(const cre2_regexp_t * re),\n    int cre2_match(const cre2_regexp_t * re, const char * text, int textlen, int startpos, int endpos, cre2_anchor_t anchor, cre2_string_t * match, int nmatch),\n    cre2_options_t *cre2_opt_new()\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_string_t subject;\n    cre2_string_t match;\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    const char * retrieved_pattern = NULL;\n    int perl_flag = 0;\n    int consume_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&subject, 0, sizeof(subject));\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Configure\n    perl_flag = cre2_opt_perl_classes(opt);\n    re = cre2_new(pattern, pattern_len, opt);\n    retrieved_pattern = cre2_pattern(re);\n    subject.data = text_buf;\n    subject.length = text_len;\n\n    // step 4: Operate\n    consume_ret = cre2_consume(pattern, &subject, &match, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)consume_ret + (long)perl_flag + (long)(opt != NULL) + (long)(re != NULL) + (long)subject.length + (long)match.length + (long)(retrieved_pattern != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_string_t matches[3];\n    int longest_flag = 0;\n    int never_nl_flag = 0;\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_posix_syntax(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    longest_flag = cre2_opt_longest_match(opt);\n    never_nl_flag = cre2_opt_never_nl(opt);\n\n    // step 4: Operate\n    match_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)longest_flag + (long)never_nl_flag + (long)(opt != NULL) + (long)(matches[0].data != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:13:11.890936 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 29s
[2025-11-05 09:13:11.891058 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28900, Completion: 18487, Total: 47387
[2025-11-05 09:13:11.891078 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:13:12.109402 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002200/id_002200.cc
[2025-11-05 09:13:12.109455 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:12.338944 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:12.339013 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:12.341735 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:12.341767 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:12.558649 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002201/id_002201.cc
[2025-11-05 09:13:12.558703 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:12.785495 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:12.785593 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:12.788140 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:12.788171 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:13.006394 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002202/id_002202.cc
[2025-11-05 09:13:13.006478 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:13.235720 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:13.235797 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:13.238682 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:13.238714 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:13.455682 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002203/id_002203.cc
[2025-11-05 09:13:13.455733 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:13.684267 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:13.684334 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:13.686912 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:13.686945 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:13.905083 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002204/id_002204.cc
[2025-11-05 09:13:13.905137 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:14.133348 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:14.133449 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:14.136264 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:14.136297 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:14.355022 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002205/id_002205.cc
[2025-11-05 09:13:14.355073 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:14.583842 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:14.583917 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:14.586786 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:14.586817 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:14.803713 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002206/id_002206.cc
[2025-11-05 09:13:14.803764 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:15.033652 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:15.033724 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:15.036583 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:15.036615 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:15.253637 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002207/id_002207.cc
[2025-11-05 09:13:15.253719 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:15.482636 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:15.482710 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:15.485566 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:15.485597 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:15.704248 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002208/id_002208.cc
[2025-11-05 09:13:15.704302 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:15.934122 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:15.934195 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:15.936904 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:15.936935 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:16.156213 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002209/id_002209.cc
[2025-11-05 09:13:16.156266 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:13:16.384204 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:13:16.384304 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:13:16.387119 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:13:16.387152 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:13:16.387191 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:13:16.387206 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2210, succ: 2209, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:13:16.387221 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:13:16.387245 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:13:16.661122 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2209 as an example for the next prompt.
[2025-11-05 09:13:16.661179 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 3 new API pairs in this round.
[2025-11-05 09:13:16.661205 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 3
[2025-11-05 09:13:16.661254 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,100.0,38.0,64.0,216.0,180.0,46.0,84.0,140.0,118.0,57.0,396.0,28.0,48.0,495.0,208.0,37.0,170.0,38.0,277.0,143.0,218.0,173.0,187.0,106.0,97.0,27.0,23.0,66.0,209.0,159.0,28.0,31.0,186.0,312.0,28.0,988.0,350.0,308.0,52.0,105.0,128.0,70.0,469.0,54.0,100.0,193.0,57.0,15.0,123.0,376.0,51.0,16.0,226.0,101.0,72.0,90.0,34.0,374.0,46.0,104.0,74.0,83.0,245.0,65.0,289.0,59.0,52.0,25.0]
[2025-11-05 09:13:16.661274 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:13:16.661331 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_global_replace_re energy: 173
[2025-11-05 09:13:16.661362 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_new energy: 988
[2025-11-05 09:13:16.661388 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_next energy: 106
[2025-11-05 09:13:16.661418 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_compile energy: 209
[2025-11-05 09:13:16.661456 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 245
[2025-11-05 09:13:16.661503 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),
    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),
    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),
    int cre2_set_compile(cre2_set * set),
    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)
[2025-11-05 09:13:16.662360 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 221, quiet_round: 0, discovered_api_pairs: 3742
[2025-11-05 09:13:16.710773 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:13:16.711124 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_global_replace_re(cre2_regexp_t * rex, cre2_string_t * text_and_target, cre2_string_t * rewrite),\n    cre2_regexp_t *cre2_new(const char * pattern, int pattern_len, const cre2_options_t * opt),\n    bool cre2_named_groups_iter_next(cre2_named_groups_iter_t * iter, const char ** name, int * index),\n    int cre2_set_compile(cre2_set * set),\n    void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_string_t matches[3];\n    int longest_flag = 0;\n    int never_nl_flag = 0;\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(matches, 0, sizeof(matches));\n    opt = cre2_opt_new();\n    cre2_opt_set_posix_syntax(opt, 1);\n    cre2_opt_set_case_sensitive(opt, 1);\n\n    // step 3: Configure\n    longest_flag = cre2_opt_longest_match(opt);\n    never_nl_flag = cre2_opt_never_nl(opt);\n\n    // step 4: Operate\n    match_ret = cre2_easy_match(pattern, pattern_len, text_buf, text_len, matches, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)match_ret + (long)matches[0].length + (long)matches[1].length + (long)longest_flag + (long)never_nl_flag + (long)(opt != NULL) + (long)(matches[0].data != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_encoding_t enc;\n    int prog_size = 0;\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 4: Operate\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, &match, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)prog_size + (long)match_ret + (long)(enc == CRE2_UTF8) + (long)(opt != NULL) + (long)(re != NULL) + (long)match.length + (long)(match.data != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:14:03.320223 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 46s
[2025-11-05 09:14:03.320347 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 28320, Completion: 27011, Total: 55331
[2025-11-05 09:14:03.320368 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:14:03.539039 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002210/id_002210.cc
[2025-11-05 09:14:03.539094 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:03.769904 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:03.769973 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:03.773076 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:03.773109 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:03.991048 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002211/id_002211.cc
[2025-11-05 09:14:03.991101 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:04.221965 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:04.222044 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:04.224814 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:04.224846 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:04.443071 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002212/id_002212.cc
[2025-11-05 09:14:04.443158 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:04.673361 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:04.673420 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:04.676532 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:04.676564 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:04.894360 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002213/id_002213.cc
[2025-11-05 09:14:04.894414 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:05.125655 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:05.125717 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:05.128891 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:05.128918 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:05.346606 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002214/id_002214.cc
[2025-11-05 09:14:05.346659 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:05.576605 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:05.576713 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:05.579575 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:05.579608 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:05.798085 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002215/id_002215.cc
[2025-11-05 09:14:05.798139 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:06.029050 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:06.029129 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:06.031909 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:06.031943 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:06.250582 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002216/id_002216.cc
[2025-11-05 09:14:06.250636 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:06.479392 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:06.479464 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:06.482744 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:06.482777 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:06.701343 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002217/id_002217.cc
[2025-11-05 09:14:06.701429 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:06.932063 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:06.932140 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:06.934982 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:06.935014 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:07.152739 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002218/id_002218.cc
[2025-11-05 09:14:07.152794 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:07.381551 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:07.381611 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:07.384767 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:07.384798 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:07.602188 +00:00] WARN [src/fuzzer.rs:205] Program 2219 failed validation. Attempting to repair. Error: Syntax Error: /root/promptfuzz/output/cre2/work/id_002219/id_002219.cc:49:11: error: no matching function for call to 'cre2_set_new'
   49 |     set = cre2_set_new(opt, 0);
      |           ^~~~~~~~~~~~
/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument
  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);
      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~
1 error generated.

[2025-11-05 09:14:07.650739 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:14:07.651082 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"The previous attempt to generate code failed with the following error:\n\nError code:/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = 0;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Initialize regex, iterator and set\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    cre2_named_groups_iter_delete(iter);\n    set = cre2_set_new(opt, 0);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Prepare strings and perform global replace using compiled regex\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (compute a checksum to tie together results)\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)group_index + (long)(group_name != NULL)\n             + (long)set_add_ret + (long)set_compile_ret + (long)replace_ret + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\nError Type: Syntax Error\nError Details:/root/promptfuzz/output/cre2/work/id_002219/id_002219.cc:49:11: error: no matching function for call to 'cre2_set_new'\n   49 |     set = cre2_set_new(opt, 0);\n      |           ^~~~~~~~~~~~\n/root/promptfuzz/output/build/cre2/include/cre2.h:320:21: note: candidate function not viable: no known conversion from 'int' to 'cre2_anchor_t' for 2nd argument\n  320 | cre2_decl cre2_set *cre2_set_new(cre2_options_t *opt, cre2_anchor_t anchor);\n      |                     ^                                 ~~~~~~~~~~~~~~~~~~~~\n1 error generated.\n\nPlease regenerate a new program to repair the error without changing the logic, do not redefine main function and any other parameters even if the error is not defined, and do not change the function name.\nIf error type is execution error without error details, you can regard it as Segmentation fault (core dumped)\n"

[2025-11-05 09:14:27.056785 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 19s
[2025-11-05 09:14:27.056908 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 24190, Completion: 13857, Total: 38047
[2025-11-05 09:14:27.276252 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002219/id_002219.cc
[2025-11-05 09:14:27.276323 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:14:27.506012 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:14:27.506079 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:14:27.508894 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:14:27.508928 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:14:27.508962 +00:00] INFO [src/fuzzer.rs:228] Successfully repaired program 2219!
[2025-11-05 09:14:27.508998 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:14:27.509015 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2220, succ: 2219, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:14:27.509029 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:14:27.509052 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:14:27.813651 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2219 as an example for the next prompt.
[2025-11-05 09:14:27.813705 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 8 new API pairs in this round.
[2025-11-05 09:14:27.813735 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 8
[2025-11-05 09:14:27.813781 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,100.0,38.0,64.0,216.0,180.0,46.0,84.0,140.0,118.0,57.0,396.0,28.0,48.0,496.0,208.0,37.0,170.0,38.0,277.0,143.0,218.0,177.0,188.0,110.0,97.0,27.0,23.0,66.0,212.0,159.0,28.0,31.0,186.0,312.0,28.0,988.0,351.0,312.0,52.0,105.0,128.0,70.0,469.0,54.0,100.0,193.0,57.0,15.0,123.0,376.0,51.0,16.0,226.0,101.0,72.0,90.0,34.0,374.0,46.0,104.0,74.0,83.0,249.0,65.0,291.0,59.0,52.0,25.0]
[2025-11-05 09:14:27.813800 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:14:27.813853 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_named_groups_iter_delete energy: 249
[2025-11-05 09:14:27.813884 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_perl_classes energy: 186
[2025-11-05 09:14:27.813910 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_num_capturing_groups energy: 396
[2025-11-05 09:14:27.813936 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_new energy: 312
[2025-11-05 09:14:27.813969 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),
    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),
    int cre2_num_capturing_groups(const cre2_regexp_t * re),
    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)
[2025-11-05 09:14:27.814665 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 222, quiet_round: 0, discovered_api_pairs: 3750
[2025-11-05 09:14:27.848658 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:14:27.849013 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nvoid cre2_named_groups_iter_delete(cre2_named_groups_iter_t * iter),\n    void cre2_opt_set_perl_classes(cre2_options_t * opt, int flag),\n    int cre2_num_capturing_groups(const cre2_regexp_t * re),\n    cre2_set *cre2_set_new(cre2_options_t * opt, cre2_anchor_t anchor)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    cre2_string_t match;\n    cre2_encoding_t enc;\n    int prog_size = 0;\n    int match_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&match, 0, sizeof(match));\n    opt = cre2_opt_new();\n    enc = cre2_opt_encoding(opt);\n\n    // step 3: Configure\n    re = cre2_new(pattern, pattern_len, opt);\n    prog_size = cre2_program_size(re);\n\n    // step 4: Operate\n    match_ret = cre2_match(re, text_buf, text_len, 0, text_len, CRE2_UNANCHORED, &match, 3);\n\n    // step 5: Validate\n    checksum = (long)pattern_len + (long)text_len + (long)prog_size + (long)match_ret + (long)(enc == CRE2_UTF8) + (long)(opt != NULL) + (long)(re != NULL) + (long)match.length + (long)(match.data != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = 0;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Initialize regex, iterator and set\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    cre2_named_groups_iter_delete(iter);\n    /* cre2_set_new expects a cre2_anchor_t for the second parameter; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Prepare strings and perform global replace using compiled regex\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (compute a checksum to tie together results)\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)group_index + (long)(group_name != NULL)\n             + (long)set_add_ret + (long)set_compile_ret + (long)replace_ret + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:15:02.293357 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 34s
[2025-11-05 09:15:02.293486 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 30670, Completion: 22470, Total: 53140
[2025-11-05 09:15:02.293508 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:15:02.511844 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002220/id_002220.cc
[2025-11-05 09:15:02.511899 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:02.741894 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:02.741969 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:02.745204 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:02.745234 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:02.963534 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002221/id_002221.cc
[2025-11-05 09:15:02.963587 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:03.191920 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:03.191993 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:03.195223 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:03.195254 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:03.412890 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002222/id_002222.cc
[2025-11-05 09:15:03.412976 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:03.641910 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:03.641986 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:03.644758 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:03.644790 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:03.862330 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002223/id_002223.cc
[2025-11-05 09:15:03.862384 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:04.089844 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:04.089919 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:04.093146 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:04.093178 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:04.311134 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002224/id_002224.cc
[2025-11-05 09:15:04.311197 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:04.541619 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:04.541736 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:04.544499 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:04.544532 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:04.763287 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002225/id_002225.cc
[2025-11-05 09:15:04.763341 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:04.992875 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:04.992953 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:04.996041 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:04.996073 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:05.214682 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002226/id_002226.cc
[2025-11-05 09:15:05.214735 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:05.444150 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:05.444225 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:05.446992 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:05.447019 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:05.664706 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002227/id_002227.cc
[2025-11-05 09:15:05.664795 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:05.895170 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:05.895246 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:05.898473 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:05.898506 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:06.117699 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002228/id_002228.cc
[2025-11-05 09:15:06.117752 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:06.346619 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:06.346693 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:06.349936 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:06.349967 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:06.567121 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002229/id_002229.cc
[2025-11-05 09:15:06.567176 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:06.797429 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:06.797544 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:06.800685 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:06.800718 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:06.800757 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:15:06.800795 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2230, succ: 2229, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:15:06.800811 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:15:06.800836 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:15:07.102653 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2229 as an example for the next prompt.
[2025-11-05 09:15:07.102711 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 7 new API pairs in this round.
[2025-11-05 09:15:07.102742 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 7
[2025-11-05 09:15:07.102789 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,100.0,38.0,64.0,216.0,180.0,46.0,84.0,140.0,118.0,57.0,400.0,28.0,48.0,497.0,210.0,37.0,170.0,38.0,277.0,143.0,218.0,177.0,188.0,112.0,97.0,27.0,23.0,66.0,213.0,159.0,28.0,31.0,186.0,312.0,28.0,988.0,352.0,316.0,52.0,105.0,128.0,70.0,469.0,54.0,100.0,193.0,57.0,15.0,123.0,376.0,51.0,16.0,227.0,101.0,72.0,90.0,34.0,374.0,46.0,104.0,74.0,83.0,254.0,65.0,291.0,59.0,52.0,25.0]
[2025-11-05 09:15:07.102807 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:15:07.102860 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_literal energy: 100
[2025-11-05 09:15:07.102890 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_max_mem energy: 101
[2025-11-05 09:15:07.102921 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_match energy: 227
[2025-11-05 09:15:07.102999 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_case_sensitive energy: 312
[2025-11-05 09:15:07.103033 +00:00] INFO [src/request/prompt.rs:145] set combination: int cre2_opt_literal(cre2_options_t * opt),
    int64_t cre2_opt_max_mem(cre2_options_t * opt),
    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),
    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)
[2025-11-05 09:15:07.103731 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 223, quiet_round: 0, discovered_api_pairs: 3757
[2025-11-05 09:15:07.141271 +00:00] DEBUG [src/request/prompt.rs:192] Using ApiCombination generation mode
[2025-11-05 09:15:07.141627 +00:00] DEBUG [src/request/prompt.rs:269] user Prompt:"Your task is to write a complete, logically correct C++ function named `int test_cre2_api_sequence()` using the cre2 library.\n\nUse the following APIs in your function:\nint cre2_opt_literal(cre2_options_t * opt),\n    int64_t cre2_opt_max_mem(cre2_options_t * opt),\n    size_t cre2_set_match(cre2_set * set, const char * text, size_t text_len, int * match, size_t match_len),\n    void cre2_opt_set_case_sensitive(cre2_options_t * opt, int flag)\nHere are some successful examples:\nHere are some successful examples:\n```cpp\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"([A-Za-z]+)-([0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = 0;\n    struct cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int replace_ret = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    opt = cre2_opt_new();\n    cre2_opt_set_case_sensitive(opt, 1);\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Initialize regex, iterator and set\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    cre2_named_groups_iter_delete(iter);\n    /* cre2_set_new expects a cre2_anchor_t for the second parameter; cast 0 to that type */\n    set = cre2_set_new(opt, (cre2_anchor_t)0);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Prepare strings and perform global replace using compiled regex\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (compute a checksum to tie together results)\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)group_index + (long)(group_name != NULL)\n             + (long)set_add_ret + (long)set_compile_ret + (long)replace_ret + (long)(re != NULL) + (long)(opt != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n\n---\n\n/**/\nint test_cre2_api_sequence() {\n    // step 1: Declarations\n    const char pattern[] = \"^(?P<name>[A-Za-z]+)-(?P<num>[0-9]+)\";\n    const int pattern_len = (int)(sizeof(pattern) - 1);\n    char text_buf[] = \"Alice-123 Bob-456 Carol-789\";\n    const int text_len = (int)(sizeof(text_buf) - 1);\n    char rewrite_buf[64];\n    cre2_options_t * opt = NULL;\n    cre2_regexp_t * re = NULL;\n    struct cre2_named_groups_iter_t * iter = NULL;\n    const char * group_name = NULL;\n    int group_index = 0;\n    cre2_set * set = NULL;\n    cre2_string_t text_and_target;\n    cre2_string_t rewrite;\n    cre2_string_t match;\n    int set_add_ret = 0;\n    int set_compile_ret = 0;\n    int replace_ret = 0;\n    int num_groups = 0;\n    long checksum = 0;\n\n    // step 2: Setup\n    memset(&text_and_target, 0, sizeof(text_and_target));\n    memset(&rewrite, 0, sizeof(rewrite));\n    memset(&match, 0, sizeof(match));\n    memset(rewrite_buf, 0, sizeof(rewrite_buf));\n    opt = cre2_opt_new();\n    cre2_opt_set_perl_classes(opt, 1);\n\n    // step 3: Core operations (compile regex, iterate named groups, build set)\n    re = cre2_new(pattern, pattern_len, opt);\n    iter = cre2_named_groups_iter_new(re);\n    cre2_named_groups_iter_next(iter, &group_name, &group_index);\n    cre2_named_groups_iter_delete(iter);\n    num_groups = cre2_num_capturing_groups(re);\n    set = cre2_set_new(opt, CRE2_UNANCHORED);\n    set_add_ret = cre2_set_add_simple(set, pattern);\n    set_compile_ret = cre2_set_compile(set);\n\n    // step 4: Operate (perform a global replace using the compiled regex)\n    text_and_target.data = text_buf;\n    text_and_target.length = text_len;\n    rewrite.data = rewrite_buf;\n    rewrite.length = (int)(sizeof(rewrite_buf) - 1);\n    replace_ret = cre2_global_replace_re(re, &text_and_target, &rewrite);\n\n    // step 5: Validate (compute a checksum tying results together)\n    checksum = (long)pattern_len + (long)text_and_target.length + (long)num_groups + (long)group_index\n             + (long)(group_name != NULL) + (long)set_add_ret + (long)set_compile_ret + (long)replace_ret\n             + (long)(opt != NULL) + (long)(re != NULL) + (long)(set != NULL) + (long)match.length + (long)(match.data != NULL);\n    (void)checksum;\n\n    // step 6: Cleanup\n    cre2_delete(re);\n    cre2_set_delete(set);\n    cre2_opt_delete(opt);\n\n    // API sequence test completed successfully\n    return 66;\n}\n```\nFunction Requirements:\n1. The function must return `66` on success.  \n2. Do not include if branches or loops; the function should be a straight-line sequence of API calls.\n3. You must not redefine or include the cre2 library.  \n4. Do not use `std::memset`; use plain `memset`.  do not create new functions, use the existing APIs.\n5. The function must end with:\n   API sequence test completed successfully\n6. When you enter a new phase, use `// step ...` to indicate the phase. different operations are in different steps, steps cannot exceed 6\n\nBelow is project's specific rules:\n{project_rules}\n\nCode Quality Rules:\n- The function must be self-contained: declare, initialize, and clean up all variables and resources.\n- The API sequence should follow a realistic and complete usage pattern:\n  - Initialize → Configure → Operate → Validate → Cleanup\n- Ensure that data flows meaningfully between API calls (no dummy or unused variables).\n- Do not use placeholders like `// your code here`.\n- No comments needed — just clean and understandable code.\n- If you have to write any helper functions, begin them with static\nOutput Instructions:\n\nOnly output the function body `int test_cre2_api_sequence() { ... }`  \nNo `#include` directives or `main()` function.\n\nExample Outline:\n```cpp\nint test_cre2_api_sequence() {\n    // Step 1: Declarations\n    // Step 2: Setup\n    // Step 3: Core operations\n    // Step ...\n    // step ... : Cleanup\n    return 66;\n}\n```"

[2025-11-05 09:15:44.961775 +00:00] INFO [src/request/openai.rs:96] OpenAI Generate time: 37s
[2025-11-05 09:15:44.961904 +00:00] INFO [src/request/openai.rs:97] OpenAI Token Usage - Prompt: 33190, Completion: 22296, Total: 55486
[2025-11-05 09:15:44.961926 +00:00] DEBUG [src/fuzzer.rs:196] LLM generated 10 programs. Sanitize those programs!
[2025-11-05 09:15:45.180891 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002230/id_002230.cc
[2025-11-05 09:15:45.180945 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:45.410176 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:45.410251 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:45.413125 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:45.413156 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:45.631270 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002231/id_002231.cc
[2025-11-05 09:15:45.631325 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:45.861267 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:45.861342 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:45.864196 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:45.864229 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:46.080571 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002232/id_002232.cc
[2025-11-05 09:15:46.080689 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:46.309472 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:46.309548 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:46.312316 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:46.312349 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:46.529977 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002233/id_002233.cc
[2025-11-05 09:15:46.530031 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:46.758298 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:46.758375 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:46.761262 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:46.761293 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:46.978989 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002234/id_002234.cc
[2025-11-05 09:15:46.979043 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:47.208111 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:47.208229 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:47.210893 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:47.210919 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:47.428353 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002235/id_002235.cc
[2025-11-05 09:15:47.428408 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:47.658107 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:47.658184 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:47.661039 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:47.661073 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:47.877933 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002236/id_002236.cc
[2025-11-05 09:15:47.877989 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:48.107139 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:48.107214 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:48.110048 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:48.110080 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:48.327516 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002237/id_002237.cc
[2025-11-05 09:15:48.327604 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:48.556336 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:48.556412 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:48.559275 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:48.559309 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:48.776436 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002238/id_002238.cc
[2025-11-05 09:15:48.776492 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:49.004427 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:49.004502 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:49.007013 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:49.007040 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:49.225763 +00:00] DEBUG [src/execution/sanitize.rs:282] Validating cre2 program: /root/promptfuzz/output/cre2/work/id_002239/id_002239.cc
[2025-11-05 09:15:49.225818 +00:00] DEBUG [src/execution/sanitize.rs:288] Step 1: Compiling cre2 program
[2025-11-05 09:15:49.455676 +00:00] DEBUG [src/execution/sanitize.rs:320] cre2 compilation successful
[2025-11-05 09:15:49.455824 +00:00] DEBUG [src/execution/sanitize.rs:323] Step 2: Running cre2 program
[2025-11-05 09:15:49.458567 +00:00] DEBUG [src/execution/sanitize.rs:340] cre2 execution successful with return code 0
[2025-11-05 09:15:49.458599 +00:00] DEBUG [src/execution/sanitize.rs:349] cre2 validation completed successfully
[2025-11-05 09:15:49.458638 +00:00] DEBUG [src/execution/logger.rs:285] [round] total: 10, succ: 10, syntax: 0, link: 0, execute: 0, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:15:49.458657 +00:00] DEBUG [src/execution/logger.rs:296] [global] total: 2240, succ: 2239, syntax: 0, link: 0, execute: 1, hang: 0, fuzzer: 0, coverage: 0
[2025-11-05 09:15:49.458675 +00:00] DEBUG [src/execution/logger.rs:307] [Asan] df: 0, uaf: 0, ho: 0, so: 0, leak: 0, segv: 0, undefined: 0, FDSan:0, others: 1
[2025-11-05 09:15:49.458704 +00:00] DEBUG [src/fuzzer.rs:464] LLM generated 10 successful programs. Sanitize those programs!
[2025-11-05 09:15:49.739853 +00:00] INFO [src/fuzzer.rs:503] Adding successful program 2239 as an example for the next prompt.
[2025-11-05 09:15:49.739910 +00:00] DEBUG [src/fuzzer.rs:514] Discovered 12 new API pairs in this round.
[2025-11-05 09:15:49.739945 +00:00] DEBUG [src/feedback/schedule.rs:159] Updated energies from API pairs: 12
[2025-11-05 09:15:49.739992 +00:00] DEBUG [src/feedback/schedule.rs:161] energies: [78.0,63.0,108.0,38.0,64.0,216.0,180.0,46.0,84.0,140.0,118.0,57.0,400.0,28.0,48.0,497.0,210.0,37.0,170.0,38.0,278.0,146.0,218.0,177.0,190.0,112.0,97.0,27.0,23.0,66.0,213.0,159.0,28.0,31.0,186.0,318.0,28.0,988.0,352.0,320.0,52.0,105.0,128.0,70.0,469.0,54.0,100.0,193.0,57.0,15.0,123.0,376.0,51.0,16.0,228.0,107.0,72.0,91.0,34.0,374.0,46.0,104.0,77.0,83.0,254.0,65.0,292.0,59.0,52.0,25.0]
[2025-11-05 09:15:49.740013 +00:00] INFO [src/feedback/schedule.rs:204] random assemble new prompt combination with their engies.
[2025-11-05 09:15:49.740066 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_opt_set_dot_nl energy: 52
[2025-11-05 09:15:49.740097 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_check_rewrite_string energy: 78
[2025-11-05 09:15:49.740123 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_add_simple energy: 292
[2025-11-05 09:15:49.740152 +00:00] INFO [src/feedback/schedule.rs:215] choose api: cre2_set_delete energy: 190
[2025-11-05 09:15:49.740186 +00:00] INFO [src/request/prompt.rs:145] set combination: void cre2_opt_set_dot_nl(cre2_options_t * opt, int flag),
    int cre2_check_rewrite_string(cre2_regexp_t * rex, cre2_string_t * rewrite, cre2_string_t * errmsg),
    int cre2_set_add_simple(cre2_set * set, const char * pattern),
    void cre2_set_delete(cre2_set * set)
[2025-11-05 09:15:49.740889 +00:00] INFO [src/fuzzer.rs:526] [Mutate Loop]: loop: 224, quiet_round: 0, discovered_api_pairs: 3769
[2025-11-05 09:15:49.740921 +00:00] INFO [src/fuzzer.rs:420] Time out is reached. Stopping seed generation.
[2025-11-05 09:15:49.743195 +00:00] INFO [src/fuzzer.rs:541] Fuzzing loop finished. Starting minimization...
[2025-11-05 09:15:49.743229 +00:00] INFO [src/fuzzer.rs:549] Minimizing corpus by unique API pairs...
[2025-11-05 09:15:51.512932 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001355.cc"
[2025-11-05 09:15:51.513079 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001859.cc"
[2025-11-05 09:15:51.513155 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000441.cc"
[2025-11-05 09:15:51.513227 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000446.cc"
[2025-11-05 09:15:51.513296 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000449.cc"
[2025-11-05 09:15:51.513390 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001385.cc"
[2025-11-05 09:15:51.513461 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001388.cc"
[2025-11-05 09:15:51.513545 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001631.cc"
[2025-11-05 09:15:51.513615 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001857.cc"
[2025-11-05 09:15:51.513684 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001861.cc"
[2025-11-05 09:15:51.513754 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002057.cc"
[2025-11-05 09:15:51.513822 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002130.cc"
[2025-11-05 09:15:51.513893 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002135.cc"
[2025-11-05 09:15:51.513961 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002136.cc"
[2025-11-05 09:15:51.514032 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000181.cc"
[2025-11-05 09:15:51.514117 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000281.cc"
[2025-11-05 09:15:51.514203 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000283.cc"
[2025-11-05 09:15:51.514277 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000403.cc"
[2025-11-05 09:15:51.514352 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000685.cc"
[2025-11-05 09:15:51.514422 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000732.cc"
[2025-11-05 09:15:51.514492 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000735.cc"
[2025-11-05 09:15:51.514563 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000738.cc"
[2025-11-05 09:15:51.514634 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000749.cc"
[2025-11-05 09:15:51.514722 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000761.cc"
[2025-11-05 09:15:51.514795 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000765.cc"
[2025-11-05 09:15:51.514864 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000766.cc"
[2025-11-05 09:15:51.514936 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000833.cc"
[2025-11-05 09:15:51.515004 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000849.cc"
[2025-11-05 09:15:51.515073 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000998.cc"
[2025-11-05 09:15:51.515144 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001040.cc"
[2025-11-05 09:15:51.515237 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001054.cc"
[2025-11-05 09:15:51.515357 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001057.cc"
[2025-11-05 09:15:51.515429 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001222.cc"
[2025-11-05 09:15:51.515497 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001354.cc"
[2025-11-05 09:15:51.515564 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001356.cc"
[2025-11-05 09:15:51.515632 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001381.cc"
[2025-11-05 09:15:51.515699 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001632.cc"
[2025-11-05 09:15:51.515768 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001634.cc"
[2025-11-05 09:15:51.515844 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001637.cc"
[2025-11-05 09:15:51.515915 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001750.cc"
[2025-11-05 09:15:51.515985 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001752.cc"
[2025-11-05 09:15:51.516051 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001754.cc"
[2025-11-05 09:15:51.516119 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001755.cc"
[2025-11-05 09:15:51.516188 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001757.cc"
[2025-11-05 09:15:51.516255 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001760.cc"
[2025-11-05 09:15:51.516325 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001764.cc"
[2025-11-05 09:15:51.516425 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001766.cc"
[2025-11-05 09:15:51.516519 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001767.cc"
[2025-11-05 09:15:51.516589 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001851.cc"
[2025-11-05 09:15:51.516668 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001860.cc"
[2025-11-05 09:15:51.516737 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001867.cc"
[2025-11-05 09:15:51.516807 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002019.cc"
[2025-11-05 09:15:51.516875 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002131.cc"
[2025-11-05 09:15:51.516944 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002177.cc"
[2025-11-05 09:15:51.517011 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002220.cc"
[2025-11-05 09:15:51.517080 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000170.cc"
[2025-11-05 09:15:51.517150 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000171.cc"
[2025-11-05 09:15:51.517217 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000172.cc"
[2025-11-05 09:15:51.517284 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000177.cc"
[2025-11-05 09:15:51.517360 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000178.cc"
[2025-11-05 09:15:51.517427 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000179.cc"
[2025-11-05 09:15:51.517525 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000184.cc"
[2025-11-05 09:15:51.517593 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000280.cc"
[2025-11-05 09:15:51.517667 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000282.cc"
[2025-11-05 09:15:51.517738 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000285.cc"
[2025-11-05 09:15:51.517804 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000400.cc"
[2025-11-05 09:15:51.517872 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000404.cc"
[2025-11-05 09:15:51.517937 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000408.cc"
[2025-11-05 09:15:51.518012 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000410.cc"
[2025-11-05 09:15:51.518078 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000412.cc"
[2025-11-05 09:15:51.518146 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000415.cc"
[2025-11-05 09:15:51.518214 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000417.cc"
[2025-11-05 09:15:51.518279 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000443.cc"
[2025-11-05 09:15:51.518346 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000460.cc"
[2025-11-05 09:15:51.518412 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000463.cc"
[2025-11-05 09:15:51.518478 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000730.cc"
[2025-11-05 09:15:51.518560 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000733.cc"
[2025-11-05 09:15:51.518633 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000734.cc"
[2025-11-05 09:15:51.518701 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000742.cc"
[2025-11-05 09:15:51.518776 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000746.cc"
[2025-11-05 09:15:51.518873 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000763.cc"
[2025-11-05 09:15:51.518942 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000768.cc"
[2025-11-05 09:15:51.519011 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000830.cc"
[2025-11-05 09:15:51.519077 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001041.cc"
[2025-11-05 09:15:51.519140 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001042.cc"
[2025-11-05 09:15:51.519207 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001045.cc"
[2025-11-05 09:15:51.519276 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001360.cc"
[2025-11-05 09:15:51.519342 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001369.cc"
[2025-11-05 09:15:51.519414 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001379.cc"
[2025-11-05 09:15:51.519480 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001386.cc"
[2025-11-05 09:15:51.519545 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001641.cc"
[2025-11-05 09:15:51.519610 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001646.cc"
[2025-11-05 09:15:51.519684 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001649.cc"
[2025-11-05 09:15:51.519757 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001701.cc"
[2025-11-05 09:15:51.519820 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001707.cc"
[2025-11-05 09:15:51.519887 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001736.cc"
[2025-11-05 09:15:51.519955 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001738.cc"
[2025-11-05 09:15:51.520018 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001739.cc"
[2025-11-05 09:15:51.520081 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001745.cc"
[2025-11-05 09:15:51.520161 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001746.cc"
[2025-11-05 09:15:51.520230 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001759.cc"
[2025-11-05 09:15:51.520296 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001762.cc"
[2025-11-05 09:15:51.520361 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001763.cc"
[2025-11-05 09:15:51.520428 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001854.cc"
[2025-11-05 09:15:51.520494 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001858.cc"
[2025-11-05 09:15:51.520559 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001885.cc"
[2025-11-05 09:15:51.520637 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002067.cc"
[2025-11-05 09:15:51.520705 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002137.cc"
[2025-11-05 09:15:51.520773 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002213.cc"
[2025-11-05 09:15:51.520842 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002215.cc"
[2025-11-05 09:15:51.520910 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002219.cc"
[2025-11-05 09:15:51.520997 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002221.cc"
[2025-11-05 09:15:51.521120 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002229.cc"
[2025-11-05 09:15:51.521197 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000000.cc"
[2025-11-05 09:15:51.521271 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000164.cc"
[2025-11-05 09:15:51.521336 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000175.cc"
[2025-11-05 09:15:51.521406 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000176.cc"
[2025-11-05 09:15:51.521481 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000180.cc"
[2025-11-05 09:15:51.521555 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000187.cc"
[2025-11-05 09:15:51.521625 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000189.cc"
[2025-11-05 09:15:51.521692 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000196.cc"
[2025-11-05 09:15:51.521763 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000197.cc"
[2025-11-05 09:15:51.521832 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000202.cc"
[2025-11-05 09:15:51.521898 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000407.cc"
[2025-11-05 09:15:51.521967 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000411.cc"
[2025-11-05 09:15:51.522040 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000440.cc"
[2025-11-05 09:15:51.522110 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000496.cc"
[2025-11-05 09:15:51.522181 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000568.cc"
[2025-11-05 09:15:51.522266 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000680.cc"
[2025-11-05 09:15:51.522349 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000727.cc"
[2025-11-05 09:15:51.522416 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000729.cc"
[2025-11-05 09:15:51.522481 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000741.cc"
[2025-11-05 09:15:51.522551 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000744.cc"
[2025-11-05 09:15:51.522617 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000745.cc"
[2025-11-05 09:15:51.522688 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000760.cc"
[2025-11-05 09:15:51.522758 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000791.cc"
[2025-11-05 09:15:51.522827 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000793.cc"
[2025-11-05 09:15:51.522897 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000832.cc"
[2025-11-05 09:15:51.522964 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000840.cc"
[2025-11-05 09:15:51.523034 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000845.cc"
[2025-11-05 09:15:51.523106 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000862.cc"
[2025-11-05 09:15:51.523175 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000864.cc"
[2025-11-05 09:15:51.523246 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000925.cc"
[2025-11-05 09:15:51.523316 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000932.cc"
[2025-11-05 09:15:51.523382 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000934.cc"
[2025-11-05 09:15:51.523447 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001043.cc"
[2025-11-05 09:15:51.523513 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001229.cc"
[2025-11-05 09:15:51.523580 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001233.cc"
[2025-11-05 09:15:51.523659 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001352.cc"
[2025-11-05 09:15:51.523725 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001364.cc"
[2025-11-05 09:15:51.523796 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001376.cc"
[2025-11-05 09:15:51.523863 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001397.cc"
[2025-11-05 09:15:51.523945 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001490.cc"
[2025-11-05 09:15:51.524007 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001640.cc"
[2025-11-05 09:15:51.524069 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001643.cc"
[2025-11-05 09:15:51.524138 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001647.cc"
[2025-11-05 09:15:51.524207 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001660.cc"
[2025-11-05 09:15:51.524278 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001661.cc"
[2025-11-05 09:15:51.524349 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001662.cc"
[2025-11-05 09:15:51.524415 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001664.cc"
[2025-11-05 09:15:51.524490 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001669.cc"
[2025-11-05 09:15:51.524555 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001700.cc"
[2025-11-05 09:15:51.524634 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001722.cc"
[2025-11-05 09:15:51.524705 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001731.cc"
[2025-11-05 09:15:51.524771 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001734.cc"
[2025-11-05 09:15:51.524842 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001735.cc"
[2025-11-05 09:15:51.524908 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001737.cc"
[2025-11-05 09:15:51.524973 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001742.cc"
[2025-11-05 09:15:51.525040 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001761.cc"
[2025-11-05 09:15:51.525106 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001772.cc"
[2025-11-05 09:15:51.525171 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001775.cc"
[2025-11-05 09:15:51.525239 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001779.cc"
[2025-11-05 09:15:51.525311 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001790.cc"
[2025-11-05 09:15:51.525380 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001794.cc"
[2025-11-05 09:15:51.525452 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001795.cc"
[2025-11-05 09:15:51.525526 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001839.cc"
[2025-11-05 09:15:51.525596 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001842.cc"
[2025-11-05 09:15:51.525666 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001883.cc"
[2025-11-05 09:15:51.525733 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001889.cc"
[2025-11-05 09:15:51.525800 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001900.cc"
[2025-11-05 09:15:51.525873 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001973.cc"
[2025-11-05 09:15:51.525939 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001975.cc"
[2025-11-05 09:15:51.526008 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001976.cc"
[2025-11-05 09:15:51.526081 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002132.cc"
[2025-11-05 09:15:51.526161 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002138.cc"
[2025-11-05 09:15:51.526236 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000122.cc"
[2025-11-05 09:15:51.526305 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000148.cc"
[2025-11-05 09:15:51.526374 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000160.cc"
[2025-11-05 09:15:51.526445 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000169.cc"
[2025-11-05 09:15:51.526514 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000173.cc"
[2025-11-05 09:15:51.526592 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000174.cc"
[2025-11-05 09:15:51.526668 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000185.cc"
[2025-11-05 09:15:51.526737 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000207.cc"
[2025-11-05 09:15:51.526805 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000210.cc"
[2025-11-05 09:15:51.526876 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000212.cc"
[2025-11-05 09:15:51.526948 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000420.cc"
[2025-11-05 09:15:51.527016 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000437.cc"
[2025-11-05 09:15:51.527087 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000447.cc"
[2025-11-05 09:15:51.527160 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000470.cc"
[2025-11-05 09:15:51.527235 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000475.cc"
[2025-11-05 09:15:51.527309 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000476.cc"
[2025-11-05 09:15:51.527377 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000495.cc"
[2025-11-05 09:15:51.527450 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000584.cc"
[2025-11-05 09:15:51.527521 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000638.cc"
[2025-11-05 09:15:51.527587 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000644.cc"
[2025-11-05 09:15:51.527658 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000681.cc"
[2025-11-05 09:15:51.527733 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000684.cc"
[2025-11-05 09:15:51.527899 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000686.cc"
[2025-11-05 09:15:51.527985 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000795.cc"
[2025-11-05 09:15:51.528050 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000841.cc"
[2025-11-05 09:15:51.528144 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000940.cc"
[2025-11-05 09:15:51.528224 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000948.cc"
[2025-11-05 09:15:51.528295 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000970.cc"
[2025-11-05 09:15:51.528365 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000975.cc"
[2025-11-05 09:15:51.528433 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000999.cc"
[2025-11-05 09:15:51.528500 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001030.cc"
[2025-11-05 09:15:51.528570 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001032.cc"
[2025-11-05 09:15:51.528642 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001033.cc"
[2025-11-05 09:15:51.528710 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001034.cc"
[2025-11-05 09:15:51.528782 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001064.cc"
[2025-11-05 09:15:51.528851 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001065.cc"
[2025-11-05 09:15:51.528925 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001067.cc"
[2025-11-05 09:15:51.528992 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001150.cc"
[2025-11-05 09:15:51.529059 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001153.cc"
[2025-11-05 09:15:51.529128 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001195.cc"
[2025-11-05 09:15:51.529198 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001211.cc"
[2025-11-05 09:15:51.529267 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001214.cc"
[2025-11-05 09:15:51.529342 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001226.cc"
[2025-11-05 09:15:51.529408 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001227.cc"
[2025-11-05 09:15:51.529487 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001228.cc"
[2025-11-05 09:15:51.529555 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001230.cc"
[2025-11-05 09:15:51.529626 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001280.cc"
[2025-11-05 09:15:51.529694 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001281.cc"
[2025-11-05 09:15:51.529764 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001314.cc"
[2025-11-05 09:15:51.529845 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001373.cc"
[2025-11-05 09:15:51.529918 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001389.cc"
[2025-11-05 09:15:51.529987 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001394.cc"
[2025-11-05 09:15:51.530053 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001395.cc"
[2025-11-05 09:15:51.530126 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001494.cc"
[2025-11-05 09:15:51.530195 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001511.cc"
[2025-11-05 09:15:51.530260 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001519.cc"
[2025-11-05 09:15:51.530328 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001544.cc"
[2025-11-05 09:15:51.530401 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001553.cc"
[2025-11-05 09:15:51.530471 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001613.cc"
[2025-11-05 09:15:51.530542 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001626.cc"
[2025-11-05 09:15:51.530611 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001644.cc"
[2025-11-05 09:15:51.530678 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001690.cc"
[2025-11-05 09:15:51.530743 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001708.cc"
[2025-11-05 09:15:51.530811 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001710.cc"
[2025-11-05 09:15:51.530882 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001712.cc"
[2025-11-05 09:15:51.530950 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001717.cc"
[2025-11-05 09:15:51.531016 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001719.cc"
[2025-11-05 09:15:51.531088 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001723.cc"
[2025-11-05 09:15:51.531156 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001724.cc"
[2025-11-05 09:15:51.531221 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001725.cc"
[2025-11-05 09:15:51.531292 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001770.cc"
[2025-11-05 09:15:51.531356 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001774.cc"
[2025-11-05 09:15:51.531429 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001801.cc"
[2025-11-05 09:15:51.531494 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001802.cc"
[2025-11-05 09:15:51.531564 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001809.cc"
[2025-11-05 09:15:51.531630 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001820.cc"
[2025-11-05 09:15:51.531696 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001833.cc"
[2025-11-05 09:15:51.531760 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001840.cc"
[2025-11-05 09:15:51.531840 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001841.cc"
[2025-11-05 09:15:51.531910 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001844.cc"
[2025-11-05 09:15:51.531976 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001850.cc"
[2025-11-05 09:15:51.532043 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001872.cc"
[2025-11-05 09:15:51.532112 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001874.cc"
[2025-11-05 09:15:51.532186 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001905.cc"
[2025-11-05 09:15:51.532265 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001974.cc"
[2025-11-05 09:15:51.532338 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001978.cc"
[2025-11-05 09:15:51.532409 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002015.cc"
[2025-11-05 09:15:51.532477 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002170.cc"
[2025-11-05 09:15:51.532546 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000001.cc"
[2025-11-05 09:15:51.532674 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000030.cc"
[2025-11-05 09:15:51.532753 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000035.cc"
[2025-11-05 09:15:51.532823 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000058.cc"
[2025-11-05 09:15:51.532890 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000081.cc"
[2025-11-05 09:15:51.532959 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000141.cc"
[2025-11-05 09:15:51.533030 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000191.cc"
[2025-11-05 09:15:51.533097 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000201.cc"
[2025-11-05 09:15:51.533169 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000213.cc"
[2025-11-05 09:15:51.533257 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000216.cc"
[2025-11-05 09:15:51.533324 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000218.cc"
[2025-11-05 09:15:51.533391 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000219.cc"
[2025-11-05 09:15:51.533472 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000260.cc"
[2025-11-05 09:15:51.533557 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000261.cc"
[2025-11-05 09:15:51.533623 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000263.cc"
[2025-11-05 09:15:51.533692 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000265.cc"
[2025-11-05 09:15:51.533774 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000266.cc"
[2025-11-05 09:15:51.533842 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000268.cc"
[2025-11-05 09:15:51.533918 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000307.cc"
[2025-11-05 09:15:51.533995 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000310.cc"
[2025-11-05 09:15:51.534067 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000312.cc"
[2025-11-05 09:15:51.534135 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000424.cc"
[2025-11-05 09:15:51.534205 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000439.cc"
[2025-11-05 09:15:51.534271 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000444.cc"
[2025-11-05 09:15:51.534353 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000473.cc"
[2025-11-05 09:15:51.534420 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000491.cc"
[2025-11-05 09:15:51.534488 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000560.cc"
[2025-11-05 09:15:51.534560 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000567.cc"
[2025-11-05 09:15:51.534637 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000628.cc"
[2025-11-05 09:15:51.534726 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000632.cc"
[2025-11-05 09:15:51.534796 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000635.cc"
[2025-11-05 09:15:51.534867 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000639.cc"
[2025-11-05 09:15:51.534931 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000641.cc"
[2025-11-05 09:15:51.534997 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000647.cc"
[2025-11-05 09:15:51.535063 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000649.cc"
[2025-11-05 09:15:51.535134 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000803.cc"
[2025-11-05 09:15:51.535204 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000804.cc"
[2025-11-05 09:15:51.535268 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000854.cc"
[2025-11-05 09:15:51.535335 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000883.cc"
[2025-11-05 09:15:51.535408 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000887.cc"
[2025-11-05 09:15:51.535483 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000914.cc"
[2025-11-05 09:15:51.535565 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000943.cc"
[2025-11-05 09:15:51.535628 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000946.cc"
[2025-11-05 09:15:51.535695 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000963.cc"
[2025-11-05 09:15:51.535772 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000968.cc"
[2025-11-05 09:15:51.535918 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000972.cc"
[2025-11-05 09:15:51.535993 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001055.cc"
[2025-11-05 09:15:51.536061 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001062.cc"
[2025-11-05 09:15:51.536130 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001071.cc"
[2025-11-05 09:15:51.536199 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001073.cc"
[2025-11-05 09:15:51.536271 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001090.cc"
[2025-11-05 09:15:51.536337 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001095.cc"
[2025-11-05 09:15:51.536403 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001098.cc"
[2025-11-05 09:15:51.536475 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001159.cc"
[2025-11-05 09:15:51.536541 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001212.cc"
[2025-11-05 09:15:51.536635 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001298.cc"
[2025-11-05 09:15:51.536709 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001311.cc"
[2025-11-05 09:15:51.536781 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001313.cc"
[2025-11-05 09:15:51.536852 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001317.cc"
[2025-11-05 09:15:51.536922 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001353.cc"
[2025-11-05 09:15:51.536990 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001372.cc"
[2025-11-05 09:15:51.537063 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001374.cc"
[2025-11-05 09:15:51.537132 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001387.cc"
[2025-11-05 09:15:51.537217 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001421.cc"
[2025-11-05 09:15:51.537292 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001496.cc"
[2025-11-05 09:15:51.537362 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001510.cc"
[2025-11-05 09:15:51.537429 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001512.cc"
[2025-11-05 09:15:51.537498 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001530.cc"
[2025-11-05 09:15:51.537565 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001542.cc"
[2025-11-05 09:15:51.537632 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001543.cc"
[2025-11-05 09:15:51.537709 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001546.cc"
[2025-11-05 09:15:51.537778 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001610.cc"
[2025-11-05 09:15:51.537847 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001615.cc"
[2025-11-05 09:15:51.537923 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001623.cc"
[2025-11-05 09:15:51.537995 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001709.cc"
[2025-11-05 09:15:51.538060 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001713.cc"
[2025-11-05 09:15:51.538133 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001715.cc"
[2025-11-05 09:15:51.538203 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001716.cc"
[2025-11-05 09:15:51.538269 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001726.cc"
[2025-11-05 09:15:51.538340 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001823.cc"
[2025-11-05 09:15:51.538409 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001880.cc"
[2025-11-05 09:15:51.538478 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001955.cc"
[2025-11-05 09:15:51.538548 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001959.cc"
[2025-11-05 09:15:51.538613 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001979.cc"
[2025-11-05 09:15:51.538686 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002047.cc"
[2025-11-05 09:15:51.538757 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002157.cc"
[2025-11-05 09:15:51.538834 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000004.cc"
[2025-11-05 09:15:51.538905 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000008.cc"
[2025-11-05 09:15:51.538975 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000053.cc"
[2025-11-05 09:15:51.539044 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000084.cc"
[2025-11-05 09:15:51.539111 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000121.cc"
[2025-11-05 09:15:51.539181 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000123.cc"
[2025-11-05 09:15:51.539251 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000124.cc"
[2025-11-05 09:15:51.539318 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000125.cc"
[2025-11-05 09:15:51.539384 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000142.cc"
[2025-11-05 09:15:51.539454 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000206.cc"
[2025-11-05 09:15:51.539522 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000214.cc"
[2025-11-05 09:15:51.539592 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000217.cc"
[2025-11-05 09:15:51.539663 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000224.cc"
[2025-11-05 09:15:51.539731 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000229.cc"
[2025-11-05 09:15:51.539803 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000290.cc"
[2025-11-05 09:15:51.539880 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000293.cc"
[2025-11-05 09:15:51.539948 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000294.cc"
[2025-11-05 09:15:51.540020 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000304.cc"
[2025-11-05 09:15:51.540094 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000311.cc"
[2025-11-05 09:15:51.540174 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000339.cc"
[2025-11-05 09:15:51.540245 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000371.cc"
[2025-11-05 09:15:51.540322 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000376.cc"
[2025-11-05 09:15:51.540399 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000380.cc"
[2025-11-05 09:15:51.540468 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000382.cc"
[2025-11-05 09:15:51.540537 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000383.cc"
[2025-11-05 09:15:51.540609 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000386.cc"
[2025-11-05 09:15:51.540693 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000431.cc"
[2025-11-05 09:15:51.540769 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000477.cc"
[2025-11-05 09:15:51.540839 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000492.cc"
[2025-11-05 09:15:51.540909 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000493.cc"
[2025-11-05 09:15:51.540975 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000497.cc"
[2025-11-05 09:15:51.541040 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000531.cc"
[2025-11-05 09:15:51.541108 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000589.cc"
[2025-11-05 09:15:51.541174 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000633.cc"
[2025-11-05 09:15:51.541245 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000640.cc"
[2025-11-05 09:15:51.541319 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000642.cc"
[2025-11-05 09:15:51.541389 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000659.cc"
[2025-11-05 09:15:51.541462 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000782.cc"
[2025-11-05 09:15:51.541534 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000801.cc"
[2025-11-05 09:15:51.541603 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000806.cc"
[2025-11-05 09:15:51.541684 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000853.cc"
[2025-11-05 09:15:51.541755 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000861.cc"
[2025-11-05 09:15:51.541827 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000886.cc"
[2025-11-05 09:15:51.541899 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000908.cc"
[2025-11-05 09:15:51.541968 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000916.cc"
[2025-11-05 09:15:51.542044 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000944.cc"
[2025-11-05 09:15:51.542116 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000952.cc"
[2025-11-05 09:15:51.542187 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000974.cc"
[2025-11-05 09:15:51.542255 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000976.cc"
[2025-11-05 09:15:51.542320 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000977.cc"
[2025-11-05 09:15:51.542403 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001056.cc"
[2025-11-05 09:15:51.542471 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001058.cc"
[2025-11-05 09:15:51.542548 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001070.cc"
[2025-11-05 09:15:51.542628 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001072.cc"
[2025-11-05 09:15:51.542704 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001077.cc"
[2025-11-05 09:15:51.542771 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001158.cc"
[2025-11-05 09:15:51.542837 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001204.cc"
[2025-11-05 09:15:51.542905 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001260.cc"
[2025-11-05 09:15:51.542974 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001261.cc"
[2025-11-05 09:15:51.543044 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001295.cc"
[2025-11-05 09:15:51.543121 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001322.cc"
[2025-11-05 09:15:51.543188 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001340.cc"
[2025-11-05 09:15:51.543258 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001343.cc"
[2025-11-05 09:15:51.543334 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001390.cc"
[2025-11-05 09:15:51.543411 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001493.cc"
[2025-11-05 09:15:51.543484 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001521.cc"
[2025-11-05 09:15:51.543550 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001532.cc"
[2025-11-05 09:15:51.543620 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001541.cc"
[2025-11-05 09:15:51.543690 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001549.cc"
[2025-11-05 09:15:51.543765 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001556.cc"
[2025-11-05 09:15:51.543912 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001592.cc"
[2025-11-05 09:15:51.543982 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001624.cc"
[2025-11-05 09:15:51.544063 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001830.cc"
[2025-11-05 09:15:51.544131 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001831.cc"
[2025-11-05 09:15:51.544206 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001845.cc"
[2025-11-05 09:15:51.544280 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001910.cc"
[2025-11-05 09:15:51.544360 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001965.cc"
[2025-11-05 09:15:51.544432 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002000.cc"
[2025-11-05 09:15:51.544497 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002003.cc"
[2025-11-05 09:15:51.544565 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002048.cc"
[2025-11-05 09:15:51.544708 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002081.cc"
[2025-11-05 09:15:51.544780 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002085.cc"
[2025-11-05 09:15:51.544855 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002111.cc"
[2025-11-05 09:15:51.544924 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000016.cc"
[2025-11-05 09:15:51.544993 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000020.cc"
[2025-11-05 09:15:51.545076 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000041.cc"
[2025-11-05 09:15:51.545151 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000043.cc"
[2025-11-05 09:15:51.545219 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000050.cc"
[2025-11-05 09:15:51.545287 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000054.cc"
[2025-11-05 09:15:51.545357 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000070.cc"
[2025-11-05 09:15:51.545426 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000072.cc"
[2025-11-05 09:15:51.545495 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000083.cc"
[2025-11-05 09:15:51.545576 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000086.cc"
[2025-11-05 09:15:51.545646 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000090.cc"
[2025-11-05 09:15:51.545718 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000155.cc"
[2025-11-05 09:15:51.545785 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000230.cc"
[2025-11-05 09:15:51.545855 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000231.cc"
[2025-11-05 09:15:51.545919 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000235.cc"
[2025-11-05 09:15:51.545986 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000249.cc"
[2025-11-05 09:15:51.546055 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000250.cc"
[2025-11-05 09:15:51.546124 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000334.cc"
[2025-11-05 09:15:51.546193 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000361.cc"
[2025-11-05 09:15:51.546265 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000368.cc"
[2025-11-05 09:15:51.546339 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000378.cc"
[2025-11-05 09:15:51.546416 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000454.cc"
[2025-11-05 09:15:51.546494 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000485.cc"
[2025-11-05 09:15:51.546603 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000522.cc"
[2025-11-05 09:15:51.546684 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000672.cc"
[2025-11-05 09:15:51.546755 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000678.cc"
[2025-11-05 09:15:51.546826 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000788.cc"
[2025-11-05 09:15:51.546897 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000850.cc"
[2025-11-05 09:15:51.546968 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000851.cc"
[2025-11-05 09:15:51.547040 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000871.cc"
[2025-11-05 09:15:51.547127 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000876.cc"
[2025-11-05 09:15:51.547204 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000978.cc"
[2025-11-05 09:15:51.547282 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001011.cc"
[2025-11-05 09:15:51.547353 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001050.cc"
[2025-11-05 09:15:51.547426 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001051.cc"
[2025-11-05 09:15:51.547498 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001100.cc"
[2025-11-05 09:15:51.547572 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001109.cc"
[2025-11-05 09:15:51.547639 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001200.cc"
[2025-11-05 09:15:51.547712 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001210.cc"
[2025-11-05 09:15:51.547786 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001297.cc"
[2025-11-05 09:15:51.547857 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001330.cc"
[2025-11-05 09:15:51.547940 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001339.cc"
[2025-11-05 09:15:51.548014 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001448.cc"
[2025-11-05 09:15:51.548089 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001480.cc"
[2025-11-05 09:15:51.548158 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001481.cc"
[2025-11-05 09:15:51.548227 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001482.cc"
[2025-11-05 09:15:51.548295 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001489.cc"
[2025-11-05 09:15:51.548370 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001520.cc"
[2025-11-05 09:15:51.548454 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001564.cc"
[2025-11-05 09:15:51.548539 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001571.cc"
[2025-11-05 09:15:51.548628 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001579.cc"
[2025-11-05 09:15:51.548699 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001590.cc"
[2025-11-05 09:15:51.548782 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001593.cc"
[2025-11-05 09:15:51.548854 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001595.cc"
[2025-11-05 09:15:51.548933 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001596.cc"
[2025-11-05 09:15:51.549004 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001602.cc"
[2025-11-05 09:15:51.549087 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001614.cc"
[2025-11-05 09:15:51.549168 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001616.cc"
[2025-11-05 09:15:51.549244 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001670.cc"
[2025-11-05 09:15:51.549317 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001674.cc"
[2025-11-05 09:15:51.549390 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001683.cc"
[2025-11-05 09:15:51.549466 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001944.cc"
[2025-11-05 09:15:51.549541 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001966.cc"
[2025-11-05 09:15:51.549632 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001983.cc"
[2025-11-05 09:15:51.549709 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002083.cc"
[2025-11-05 09:15:51.549790 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002084.cc"
[2025-11-05 09:15:51.549873 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002110.cc"
[2025-11-05 09:15:51.549945 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002112.cc"
[2025-11-05 09:15:51.550016 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002123.cc"
[2025-11-05 09:15:51.550089 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002127.cc"
[2025-11-05 09:15:51.550165 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002140.cc"
[2025-11-05 09:15:51.550236 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002143.cc"
[2025-11-05 09:15:51.550308 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002145.cc"
[2025-11-05 09:15:51.550376 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002163.cc"
[2025-11-05 09:15:51.550461 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000002.cc"
[2025-11-05 09:15:51.550535 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000032.cc"
[2025-11-05 09:15:51.550608 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000038.cc"
[2025-11-05 09:15:51.550679 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000051.cc"
[2025-11-05 09:15:51.550753 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000060.cc"
[2025-11-05 09:15:51.550826 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000110.cc"
[2025-11-05 09:15:51.550898 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000114.cc"
[2025-11-05 09:15:51.550977 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000115.cc"
[2025-11-05 09:15:51.551145 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000209.cc"
[2025-11-05 09:15:51.551230 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000330.cc"
[2025-11-05 09:15:51.551319 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000416.cc"
[2025-11-05 09:15:51.551404 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000452.cc"
[2025-11-05 09:15:51.551479 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000480.cc"
[2025-11-05 09:15:51.551553 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000481.cc"
[2025-11-05 09:15:51.551625 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000521.cc"
[2025-11-05 09:15:51.551700 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000535.cc"
[2025-11-05 09:15:51.551771 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000605.cc"
[2025-11-05 09:15:51.551842 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000607.cc"
[2025-11-05 09:15:51.551916 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000613.cc"
[2025-11-05 09:15:51.551998 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000650.cc"
[2025-11-05 09:15:51.552077 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000652.cc"
[2025-11-05 09:15:51.552152 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000675.cc"
[2025-11-05 09:15:51.552226 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000771.cc"
[2025-11-05 09:15:51.552303 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000811.cc"
[2025-11-05 09:15:51.552373 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000814.cc"
[2025-11-05 09:15:51.552448 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000873.cc"
[2025-11-05 09:15:51.552523 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000880.cc"
[2025-11-05 09:15:51.552604 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000885.cc"
[2025-11-05 09:15:51.552690 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001108.cc"
[2025-11-05 09:15:51.552766 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001123.cc"
[2025-11-05 09:15:51.552842 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001140.cc"
[2025-11-05 09:15:51.552916 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001148.cc"
[2025-11-05 09:15:51.552986 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001183.cc"
[2025-11-05 09:15:51.553056 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001271.cc"
[2025-11-05 09:15:51.553128 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001277.cc"
[2025-11-05 09:15:51.553211 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001296.cc"
[2025-11-05 09:15:51.553291 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001450.cc"
[2025-11-05 09:15:51.553363 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001463.cc"
[2025-11-05 09:15:51.553435 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001572.cc"
[2025-11-05 09:15:51.553509 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001578.cc"
[2025-11-05 09:15:51.553584 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001580.cc"
[2025-11-05 09:15:51.553662 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001606.cc"
[2025-11-05 09:15:51.553734 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001671.cc"
[2025-11-05 09:15:51.553805 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001827.cc"
[2025-11-05 09:15:51.553887 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001893.cc"
[2025-11-05 09:15:51.553970 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001920.cc"
[2025-11-05 09:15:51.554064 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001923.cc"
[2025-11-05 09:15:51.554139 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001964.cc"
[2025-11-05 09:15:51.554213 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001968.cc"
[2025-11-05 09:15:51.554284 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001981.cc"
[2025-11-05 09:15:51.554360 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002024.cc"
[2025-11-05 09:15:51.554431 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002027.cc"
[2025-11-05 09:15:51.554516 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002028.cc"
[2025-11-05 09:15:51.554603 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002070.cc"
[2025-11-05 09:15:51.554688 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002073.cc"
[2025-11-05 09:15:51.554772 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002077.cc"
[2025-11-05 09:15:51.554855 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002091.cc"
[2025-11-05 09:15:51.554931 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002101.cc"
[2025-11-05 09:15:51.555005 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002102.cc"
[2025-11-05 09:15:51.555073 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002144.cc"
[2025-11-05 09:15:51.555153 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002161.cc"
[2025-11-05 09:15:51.555234 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002164.cc"
[2025-11-05 09:15:51.555319 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000006.cc"
[2025-11-05 09:15:51.555395 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000009.cc"
[2025-11-05 09:15:51.555484 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000105.cc"
[2025-11-05 09:15:51.555567 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000107.cc"
[2025-11-05 09:15:51.555643 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000301.cc"
[2025-11-05 09:15:51.555723 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000362.cc"
[2025-11-05 09:15:51.555806 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000395.cc"
[2025-11-05 09:15:51.555890 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000486.cc"
[2025-11-05 09:15:51.555974 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000487.cc"
[2025-11-05 09:15:51.556053 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000488.cc"
[2025-11-05 09:15:51.556162 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000507.cc"
[2025-11-05 09:15:51.556241 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000551.cc"
[2025-11-05 09:15:51.556315 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000590.cc"
[2025-11-05 09:15:51.556386 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000591.cc"
[2025-11-05 09:15:51.556464 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000592.cc"
[2025-11-05 09:15:51.556541 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000602.cc"
[2025-11-05 09:15:51.556612 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000603.cc"
[2025-11-05 09:15:51.556694 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000611.cc"
[2025-11-05 09:15:51.556778 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000620.cc"
[2025-11-05 09:15:51.556853 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000621.cc"
[2025-11-05 09:15:51.556926 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000627.cc"
[2025-11-05 09:15:51.556998 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000755.cc"
[2025-11-05 09:15:51.557070 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000872.cc"
[2025-11-05 09:15:51.557138 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001080.cc"
[2025-11-05 09:15:51.557220 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001101.cc"
[2025-11-05 09:15:51.557295 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001139.cc"
[2025-11-05 09:15:51.557377 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001142.cc"
[2025-11-05 09:15:51.557456 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001242.cc"
[2025-11-05 09:15:51.557532 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001247.cc"
[2025-11-05 09:15:51.557600 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001249.cc"
[2025-11-05 09:15:51.557669 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001270.cc"
[2025-11-05 09:15:51.557740 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001307.cc"
[2025-11-05 09:15:51.557809 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001460.cc"
[2025-11-05 09:15:51.557880 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001464.cc"
[2025-11-05 09:15:51.557950 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001588.cc"
[2025-11-05 09:15:51.558032 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001600.cc"
[2025-11-05 09:15:51.558111 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001810.cc"
[2025-11-05 09:15:51.558186 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001811.cc"
[2025-11-05 09:15:51.558261 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001881.cc"
[2025-11-05 09:15:51.558331 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001960.cc"
[2025-11-05 09:15:51.558414 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001993.cc"
[2025-11-05 09:15:51.558489 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002072.cc"
[2025-11-05 09:15:51.558562 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002095.cc"
[2025-11-05 09:15:51.558631 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002142.cc"
[2025-11-05 09:15:51.558739 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002192.cc"
[2025-11-05 09:15:51.558815 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002195.cc"
[2025-11-05 09:15:51.558885 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000242.cc"
[2025-11-05 09:15:51.558960 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000247.cc"
[2025-11-05 09:15:51.559033 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000309.cc"
[2025-11-05 09:15:51.559116 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000325.cc"
[2025-11-05 09:15:51.559224 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000505.cc"
[2025-11-05 09:15:51.559297 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000518.cc"
[2025-11-05 09:15:51.559372 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000547.cc"
[2025-11-05 09:15:51.559455 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000692.cc"
[2025-11-05 09:15:51.559540 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001120.cc"
[2025-11-05 09:15:51.559619 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001303.cc"
[2025-11-05 09:15:51.559697 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001609.cc"
[2025-11-05 09:15:51.559769 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001892.cc"
[2025-11-05 09:15:51.559841 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001898.cc"
[2025-11-05 09:15:51.559917 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002035.cc"
[2025-11-05 09:15:51.559987 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002094.cc"
[2025-11-05 09:15:51.560056 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002190.cc"
[2025-11-05 09:15:51.560138 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002191.cc"
[2025-11-05 09:15:51.560219 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000048.cc"
[2025-11-05 09:15:51.560296 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000240.cc"
[2025-11-05 09:15:51.560370 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000341.cc"
[2025-11-05 09:15:51.560444 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000348.cc"
[2025-11-05 09:15:51.560518 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000350.cc"
[2025-11-05 09:15:51.560590 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000570.cc"
[2025-11-05 09:15:51.560785 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001020.cc"
[2025-11-05 09:15:51.560889 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_002121.cc"
[2025-11-05 09:15:51.560978 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000327.cc"
[2025-11-05 09:15:51.561058 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000340.cc"
[2025-11-05 09:15:51.561128 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000343.cc"
[2025-11-05 09:15:51.561203 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000351.cc"
[2025-11-05 09:15:51.561278 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_001243.cc"
[2025-11-05 09:15:51.561355 +00:00] INFO [src/minimize.rs:78] Kept unique API seed: "/root/promptfuzz/output/cre2/seeds/id_000753.cc"
[2025-11-05 09:15:51.561406 +00:00] INFO [src/minimize.rs:81] Minimized seeds by API pairs. Kept 655 seeds covering 1298 unique pairs.
[2025-11-05 09:15:51.561651 +00:00] INFO [src/fuzzer.rs:556] Minimization complete!
[2025-11-05 09:15:51.561703 +00:00] INFO [src/fuzzer.rs:570] Config: Config {
    generation_mode: ApiCombination,
    target: "cre2",
    n_sample: 10,
    temperature: 1.0,
    disable_power_schedule: false,
    fuzz_round_succ: 1,
    fuzz_converge_round: 10,
    cores: 128,
    max_cores: 0,
    exponent_branch: false,
    recheck: true,
    fuzzer_run: false,
    handler_type: Openai,
    seed_gen_timeout: Some(
        180,
    ),
    quiet_round: 3,
    num_new_pairs: 3,
    enable_cot: false,
}
